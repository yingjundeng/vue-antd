!function(n,e,$){"use strict";function T($,x){if("function"!=typeof x&&null!==x)throw new TypeError("Super expression must either be null or a function");$.prototype=e.create(x&&x.prototype,{constructor:{value:$,writable:!0,configurable:!0}}),x&&Fr($,x)}function H(S){var O=e.prototype.toString.call(S);return"Array]"===O.substring(O.length-6)}function R(n,a,$,r,f,N){a=a||[],$=$||[],r=r||[];try{a.push(n);var F=Function.apply(0,a);return $[$.length]="return "+F,Function.apply(0,$).apply(0,r)}catch(A){return N&&N(A),f}}function E(A){var E={};return{get:function(Q){if(E[Q]!==$)return E[Q];var P;switch(Q){case"WEBGL_depth_texture":P=A.getExtension("WEBGL_depth_texture")||A.getExtension("MOZ_WEBGL_depth_texture")||A.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":P=A.getExtension("EXT_texture_filter_anisotropic")||A.getExtension("MOZ_EXT_texture_filter_anisotropic")||A.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":P=A.getExtension("WEBGL_compressed_texture_s3tc")||A.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||A.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":P=A.getExtension("WEBGL_compressed_texture_pvrtc")||A.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":P=A.getExtension("WEBGL_compressed_texture_etc1");break;default:P=A.getExtension(Q)}return E[Q]=P,P}}}function f(l,h,e){function k(){if(W!==$)return W;var P=h.get("EXT_texture_filter_anisotropic");return W=null!==P?l.getParameter(P.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function N(d){if("highp"===d){if(l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.HIGH_FLOAT).precision>0&&l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.HIGH_FLOAT).precision>0)return"highp";d="mediump"}return"mediump"===d&&l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.MEDIUM_FLOAT).precision>0&&l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var W;e=e||{};var o="undefined"!=typeof WebGL2RenderingContext&&l instanceof WebGL2RenderingContext,Q=e.precision!==$?e.precision:"highp",U=N(Q);U!==Q&&(console.warn("WebGL:",Q,"not supported, using",U,"instead."),Q=U);var P=e.logarithmicDepthBuffer===!0,z=l.getParameter(l.MAX_TEXTURE_IMAGE_UNITS),J=l.getParameter(l.MAX_VERTEX_TEXTURE_IMAGE_UNITS),K=l.getParameter(l.MAX_TEXTURE_SIZE),B=l.getParameter(l.MAX_CUBE_MAP_TEXTURE_SIZE),g=l.getParameter(l.MAX_VERTEX_ATTRIBS),O=l.getParameter(l.MAX_VERTEX_UNIFORM_VECTORS),q=l.getParameter(l.MAX_VARYING_VECTORS),s=l.getParameter(l.MAX_FRAGMENT_UNIFORM_VECTORS),T=J>0,D=o||!!h.get("OES_texture_float"),R=(o||!!h.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,i=T&&D,G=o?l.getParameter(l.MAX_SAMPLES):0;return{getMaxAnisotropy:k,getMaxPrecision:N,precision:Q,logarithmicDepthBuffer:P,maxTextures:z,maxVertexTextures:J,maxTextureSize:K,maxCubemapSize:B,maxAttributes:g,maxVertexUniforms:O,maxVaryings:q,maxFragmentUniforms:s,vertexTextures:T,floatFragmentTextures:D,elementTypeUint:R,floatVertexTextures:i,maxSamples:G}}function F(R,r){return R.z!==r.z?r.z-R.z:R.id-r.id}var M="ht";if(!n[M]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),n.performance&&n.performance.now||function(){var H=Date.now();n.performance||(n.performance={}),n.performance.now=function(){return Date.now()-H}}();for(var B=Date.now(),g=16,h=["ms","moz","webkit","o"],j=0;j<h.length&&!n.requestAnimationFrame;++j)n.requestAnimationFrame=n[h[j]+"RequestAnimationFrame"],n.cancelAnimationFrame=n[h[j]+"CancelAnimationFrame"]||n[h[j]+"CancelRequestAnimationFrame"];n.requestAnimationFrame||(n.requestAnimationFrame=function(c){var p=Date.now(),C=g+B-p;return 0>C&&(C=0),B=p,n.setTimeout(function(){B=Date.now(),c(performance.now())},C)}),n.cancelAnimationFrame||(n.cancelAnimationFrame=function(O){return n.clearTimeout(O)}),e.assign===$&&(e.assign=function(W){if(W===$||null===W)throw new TypeError("Cannot convert undefined or null to object");for(var C=e(W),w=1;w<arguments.length;w++){var r=arguments[w];if(r!==$&&null!==r)for(var h in r)e.prototype.hasOwnProperty.call(r,h)&&(C[h]=r[h])}return C}),n.btoa===$&&(n.btoa=function(c){for(var K,D,u=String(c),C=0,R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",x="";u.charAt(0|C)||(R="=",C%1);x+=R.charAt(63&K>>8-8*(C%1))){if(D=u.charCodeAt(C+=.75),D>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");K=K<<8|D}return x})}();var i=n.document,V=null,C=n[M]={},X=n[M+"config"],B=C.Default=X&&X.Default||{},a=C.Style=X&&X.Style||{},N=C.Attr=X&&X.Attr||{},u=function(){return!0},Q=function(U){return U},y=function(d){return!d},h=C.Color=X&&X.Color||{},W=C.IsGetter=X&&X.IsGetter||{};!function(){var N=!1;try{var g=e.defineProperty({},"passive",{get:function(){return N=!0,$}});n.addEventListener("test",g,g),n.removeEventListener("test",g,g)}catch(k){N=!1}B.passiveSupported=N}();var P,U,K,t,_=B.passiveSupported,S=B.eventListenerOptionsFalse=_?{passive:!1,capture:!1}:!1,p=B.eventListenerOptionsTrue=_?{passive:!1,capture:!0}:!0,A=function(k,Z,R,h){k.addEventListener(Z,R,h?p:S)},Y=function(N,J,F,E){N.removeEventListener(J,F,E?p:S)},l=Math,k=l.round,b=l.floor,L=l.ceil,j=l.sqrt,g=l.max,s=l.min,r=l.abs,D=l.cos,q=l.acos,w=l.sin,v=l.pow,x=l.asin,o=l.exp,Z=l.PI,J=2*Z,d=Z/2,z=l.tan,I=l.atan2,c=l.random,G=l.log,O=!1,m=!1,Zp=n.parseInt||global.parseInt,Hg="2021-6-15",Mb=n.navigator?n.navigator.platform.indexOf("Win")>-1:!1,wd=function(v){return v*v},fo=n.setTimeout,dh=n.clearTimeout,Hk=n.location,fk=n.navigator?n.navigator.userAgent.toLowerCase():"",Ym=function(c){return c.test(fk)},ub=Ym(/msie/),bh=Ym(/msie/)||Ym(/trident/),wb=Ym(/msie 10/),pe=Ym(/edge/),me=Ym(/firefox/),kc=Ym(/mac/),gp=B.isTouchable===$?Mb?!1:i?"ontouchend"in i:!1:B.isTouchable,Or="default",ad="single",cm="multiple",Ah="front",vi="back",ar="left",ci="right",hp="top",Tl="bottom",cc="center",Qd="eye",en="middle",ro="east",Kk="west",wc="north",ef="none",Tn="px",Sp="absolute",Ue="border",Yi="triangle",Rq="rect",kl="circle",Wj="cylinder",Po="shape",ys="items",wm="normal",nr="remove",ac="clear",ed="width",Gk="height",ze="ingroup",cf="check",yf="uncheck",Yp="radio",tl="radioOn",Jh="radioOff",Jd="points",Dc="values",Xo="series",Zr="body",rj="label",_d="label2",Bq="note",ho="note2",Bm="icons",Rc="labelFont",Qm="labelColor",dl="labelSelectColor",Zo="note.expanded",Ne="note2.expanded",xg="edge.expanded",go="edge.points",mf="edge.type",Xc="rotation",bo="hidden",rr="visible",Ll="tuv",_f="no",cg="draw",aj="select",nj="currentSubGraph",pi="selectBackground",Fd="autoMakeVisible",nc="autoHideScrollBar",Pd="scrollBarColor",gq="scrollBarSize",Yh="indent",Lb="rowHeight",_n="columnLineColor",qc="rowLineColor",Fn="columnLineVisible",yq="rowLineVisible",bj="visibleFunc",Vp="expandIcon",Nj="collapseIcon",lp="checkMode",sj="sortFunc",As="editable",Lm="batchEditable",Kh="tristate",nk="asc",ke="desc",Ii="position",Bn="__",Wd="elevation",Cb="children",Rd="translateX",cq="translateY",dq="dataModel",jh="maxSize",yb="enc",fg="state",Oe=yb+"o"+"de",zp="shape3d",Wf="shape3d.resolution",Jj="shape3d.visible",Db="shape3d.from.visible",Sl="shape3d.to.visible",Zk="shape3d.top.visible",Zc="shape3d.bottom.visible",Wr="repeat.uv.length",Si="serializeValue",kg="deserializeValue",re="centerUniform",Ao="uniform",Vm="rgba(255,255,255,0)",es="style",Uh="attr",Ap="field",Mk="string",Dq="boolean",_i="color",Om="int",Uq="number",Hr="ew-resize",xp="ns-resize",Ig="pointer",xo="auto",Zg="mousedown",Oq="mousemove",Ce="mouseup",gc="mouseout",Ip="touchstart",yi="touchmove",fn="touchend",ls="keydown",Oi="keyup",vk=["DOMMouseScroll","mousewheel"],sn=me?vk[0]:vk[1],qd=Bn+M+Bn+Oe,gs=[Ip,yi,fn],oq=[Zg,Oq,Ce,gc,sn,"wheel","mouseenter","mouseleave","mouseover"],fc=[ls,Oi,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],El=gp?gs.concat(fc):oq.concat(fc),xq=V,ap=V,ln=V,lj=V,Eh=Ce.length,je=function(){ln&&(dh(ln.timeout),ln=V)},Mr=function(){ln&&cs(ln.e,ln.info)};n.addEventListener&&(gp||(A(n,gc,function(){je()}),A(n,sn,function(){ur()})),A(n,Oi,function(u){91===u.keyCode?vm={}:delete vm[u.keyCode]},!0),A(n,ls,function(q){vm[q.keyCode]=!0},!0),A(n,"blur",function(){vm={}}));var dj,vb,En,ei=0,Aq=V,ig=function(U,n){var C=fo(function(){delete Aq[C],bs(Aq)&&(Aq=V),U()},n);return C},Ub=V,Ef=V,Qi={},Qk={},un={},Qc={},qg={},vm={},If={},Hl={},Jl={},cl={},oj=/.json$/,bm=/\.(json|bin)$/,Kn=/^data:image\/svg\+xml/,rl={},Lg=[],al={},xi=V,Vn=V,Fm=function(){},qn=function(){throw"Oops!"},Tc=[0,0,0],Hp={x:0,y:0,width:0,height:0},Tb=V,jr=V,Ti=V,Yd=function(J,G){Qk[J]=G,G&&G.comps&&!G.uuid&&(G.uuid=C.Math.generateUUID()),xd[J]&&(G.cacheRule=xd[J],delete xd[J])},zi=function(_){jr&&!_._72O&&(Ti||(Ti={}),Ti[_._72O=jl()]=_),dj!=V?Eo()<.05&&t&&!vb&&(Dd=je):Dd=hm},Ci=function(o,d,z,I){jr||(jr={});var j=jr[o];if(j){if(j.url===d)return;j.image?(j.image.onload=Fm,j.image.onerror=Fm):j.request&&(j.request.onload=Fm,j.request.onerror=Fm)}if(oj.test(d)){var D=new zh;if(jr[o]={request:D,url:d},d=B.beforeLoadURL(d,o),d.data){var x=B.parse(d.data);pn(o,x),B.handleImageLoaded(o,x)}else{D.onload=function(){if(200===this.status||0===this.status){var Q=B.parse(D.getResponseText());pn(o,Q),B.handleImageLoaded(o,Q)}else pn(o,B.handleUnfoundImage(o,d)||V)},D.onerror=function(){pn(o,B.handleUnfoundImage(o,d)||V)};var $={};$.url=encodeURI(d),$.sync=!1,D.send($)}}else{var x=new Image;jr[o]={image:x,url:d},/^data:image/.test(d)||(d=B.beforeLoadURL(d,o),d=B.appendTimeStamp(d),d=encodeURI(d),x.crossOrigin=B.crossOrigin),B.convertImageSrc(d,function(O){bh&&(d.toLowerCase().indexOf(".svg")>0||Kn.test(d))?(i.body.appendChild(x),x.style.visibility="hidden",x.onload=function(){fo(function(){if(z&&(x.width=z),I&&(x.height=I),!x.width||!x.height){var e=x.width||x.clientWidth,n=x.height||x.clientHeight;x.width=e,x.height=n}B.handleImageLoaded(o,x),pn(o,x),i.body.removeChild(x),x.style.visibility=""},180)},x.onerror=function(){pn(o,B.handleUnfoundImage(o,d)||V),i.body.removeChild(x),x.style.visibility=""}):(x.onload=function(){z&&(x.width=z),I&&(x.height=I),B.handleImageLoaded(o,x),pn(o,x)},x.onerror=function(){pn(o,B.handleUnfoundImage(o,d)||V)}),x.src=O})}},pn=function(g,Z){if(Yd(g,Z),delete jr[g],bs(jr)&&(jr=V,Ti)){for(var P in Ti){var I=Ti[P];I._2O&&I._2O[g]&&(I.deleteTexture(g),delete I._2O[g]),I.invalidateAll&&I.invalidateAll($,"imageLoaded",g),I.redraw&&I.redraw(),I.iv(),delete I._72O}Ti=V}if(Z&&Ti)for(var P in Ti){var I=Ti[P];I.invalidateAll&&I.invalidateAll($,"imageLoading",g),I.redraw&&I.redraw(),I.iv()}},Gc=function(){return G=l&&Date,function(){return n.performance&&n.performance.now?n.performance.now():Date.now()}}(),ai=function(Y,I,P){return{width:Y,height:I,comps:Xj(P)?P:[P]}},li=function(R,a){return{type:kl,rect:[R,a,1.6,1.6],borderWidth:1,borderColor:lr,gradient:yn,gradientColor:br,background:lr}},fj=function(j,L){return ai(16,16,{type:Yi,rect:[4,4,10,8],background:j,rotation:L?1.57:3.14})},Qq=function(H,r){return ai(16,16,{type:Yi,rect:[4,4,8,7],background:H,rotation:r?3.14:0})},Ug=function(C){var e=C._orientation;return"horizontal"===e||"h"===e},bf=function(b,N){var j=V||4,R=V||1,$=V||1;0>j?j=0:j>.25&&(j=.25);var K,W,r,g,a,B,I,s=.5,u=[],T=[],n=[],e=J/$,o=J/R,_=s-j;for(W=0;R>=W;W++)for(g=-Z+W*o,B=D(g),a=w(g),K=0;$>=K;K++)r=K*e,I=_+j*B,u.push(D(r)*I,a*j,-w(r)*I),(U=[b,N])&&T.push(K/$,1-W/R);for(W=0;R>W;W++){var v=W*($+1),c=(W+1)*($+1);for(K=0;$>K;K++)n.push(v+K,c+K+1,c+K,v+K,v+K+1,c+K+1),Gg.z=pc.z=[b,N]}},ns=function(i){var x=2,N=0;for(var m in i)m.length===x&&Zp(m,32)===Mq&&(xi=Vn=i[m]),N++;return N},Aj=function(y,i,L,f){return L||(L=gp?5:3,L/=f||1),{x:y-L,y:i-L,width:2*L,height:2*L}},dm=function(O,W,t,d){var N=this;W||(W=gp?5:3,t=20,d=20);var B={x:O,y:W,width:t,height:d};if(t)for(var k=0;t>k;k++)if(3===t)d=20;else for(var L=0;d>L;L++)N=n?n:t;var _={x:Z,y:2*Z};if(lc(B,_)){var b=Gk[0]+hp[0]+ac[1]+nk.length,E=bo[0]+Kh[0]+ac[1]+Zr.length;Pb[Qd]=[N[b],N[E]],N[b]=Bi[Qd],N[E]=Bi[zp]}},Bb=function(L){return(/ble$/.test(L)||/ed$/.test(L)||W[L]?"is":"get")+L.charAt(0).toUpperCase()+L.slice(1)},Bi=function(y){return"set"+y.charAt(0).toUpperCase()+y.slice(1)},Zq=function(F){return typeof F===Mk||F instanceof String},Ob=function(j){return typeof j===Uq},hm=function(G){return typeof G===Dq},on=function(h){return h&&"object"==typeof h},mj=function(p){return"function"==typeof p},Xj=function(K){return K instanceof Array},Lq=function(w){return w instanceof le},Ni=function(A){return Xj(A)?new le(A):A},Zb=function(E){return E instanceof zo},hf=function(M){return M instanceof Vj},Bs=function(X){return X instanceof Mg},Bd=function(b,f){if(!(b instanceof C.Group))return!1;if(!f)return b.isExpanded();var W=f.getDataUI(b);return W&&W._88I?!0:!1},On=function(W){return W instanceof Zm},wj=function(C){return C&&"IFRAME"===C.tagName},nm=function(O){return O==V||B.numberDigits==V?O:parseFloat(O.toFixed(B.numberDigits))},Qf=function(E,r,q){var U,Y=r.length;if(q)for(var l=0;q>l;l++)if(3===Y)E.push(r[0]),E.push(r[1]),E.push(r[2]);else for(U=0;Y>U;U++)E.push(r[U]);else if(3===Y)E.push(r[0]),E.push(r[1]),E.push(r[2]);else for(U=0;Y>U;U++)E.push(r[U])},Vi=function(e){return e?on(e)?e:{}:!1},Ki=function(m,h,l){var d,W=on(m)?m:m.prototype;for(d in h)l&&d in W?W[d]===$&&console.warn("class",W,"has own undefined property",d,", keep exist!"):W[d]=h[d];return m},Zd=function(I,$){if(!("wheelDelta"in $)){var t=$.deltaMode;$.wheelDelta=t===$.DOM_DELTA_PIXEL?-$.deltaY:t===$.DOM_DELTA_LINE?40*-$.deltaY:120*-$.deltaY}I.handle_mousewheel($)},_j=function(m){return String.fromCharCode(m)},Xm=function(u){for(var $,S=0,s="";S<u.length;S++)$=u[u.length-1-S],"%"===$?$="'":"a"===$?$='"':"]"===$&&($="\\"),s+=_j($.charCodeAt(0)-1);return s},Le=function(J,w,i){J.superClass.constructor.apply(w,i)},bs=function(j){for(var s in j)return!1;return!0},Zj=function(R){return R?0===R.length:!0},Rh=function(){var m="";return[yf[0],qc[0],rj[0]].forEach(function($){m+=Bi($).slice(3)}),Ao=i&&i[m]||re,function(v,e){return v===e?!0:v.x===e.x&&v.y===e.y&&v.width===e.width&&v.height===e.height}}(),Sk=function(u,y,G){return y>u?y:u>G?G:u},wp=function(n){return 0>n?-1:n>0?1:0},Eo=function(){var K=1e4*w(Eh++);return K-b(K)},Ag=function(v,y,h){return ji(v.x,v.y,y.x,y.y,h.x,h.y,h.x+h.width,h.y,!0)||ji(v.x,v.y,y.x,y.y,h.x+h.width,h.y,h.x+h.width,h.y+h.height,!0)||ji(v.x,v.y,y.x,y.y,h.x+h.width,h.y+h.height,h.x,h.y+h.height,!0)||ji(v.x,v.y,y.x,y.y,h.x,h.y+h.height,h.x,h.y,!0)},ji=function(S,k,T,A,D,v,w,q,H){var r=(w-D)*(k-v)-(q-v)*(S-D),B=(q-v)*(T-S)-(w-D)*(A-k);if(0!==B){var F=r/B,n=S+F*(T-S),X=k+F*(A-k);return H&&(n+zr<s(S,T)||n-zr>g(S,T)||n+zr<s(D,w)||n-zr>g(D,w)||X+zr<s(k,A)||X-zr>g(k,A)||X+zr<s(v,q)||X-zr>g(v,q))?V:[n,X]}return V},Ng=function(Q,L,i){if(Q&&i)if(L){if(L===es)return Q.getStyle(i);if(L===Uh)return Q.getAttr(i);if(L===Ap)return Q[i]}else if(i=Bb(i),Q[i])return Q[i]();return $},jp=function(t,X,W,Q){if(t&&W)if(X){if(X===es)t.s(W,Q);else if(X===Uh)t.a(W,Q);else if(X===Ap){var N=t[W];t[W]=Q,t.fp("f:"+W,N,Q)}}else W=Bi(W),t[W]&&t[W](Q)},oo=function(J,n){var S,_,i,g=!1;return(Ng(J,es,"shadow")||n&&"shadow"===Ng(J,es,"select.type"))&&(S=Ng(J,es,"shadow.offset.x")||0,_=Ng(J,es,"shadow.offset.y")||0,i=Ng(J,es,"shadow.blur")||0,g=!0),!g&&Ng(J,es,"shadow2")&&(S=Ng(J,es,"shadow2.offset.x")||0,_=Ng(J,es,"shadow2.offset.y")||0,i=Ng(J,es,"shadow2.blur")||0,g=!0),g?1.5*i+Math.max(S,_):0},hc=function(K,O,k,B){return B=0===k?0:B||0,O&&"top"!==O?"bottom"===O?{x:K.x-B,y:K.y-B,width:K.width+2*B,height:K.height*k+B}:"right"===O?{x:K.x-B,y:K.y-B,width:K.width*k+B,height:K.height+2*B}:"left"===O?{x:K.x+K.width*(1-k),y:K.y-B,width:K.width*k+B,height:K.height+2*B}:void 0:{x:K.x-B,y:K.y+K.height*(1-k),width:K.width+2*B,height:K.height*k+B}},ao=function(o,E,n,w,d){E&&Wq(o,n,w,1,d,E)},Pf=function(r,v,Y,Q){var s=1-r;return s*s*v+2*r*s*Y+r*r*Q},Gg=function(E,$,H,m,i){var h=1-E;return h*h*h*$+3*h*h*E*H+3*h*E*E*m+E*E*E*i},Xr=function(h){var J,i,g,Y,z=0;return h.forEach(function(A){if(J=A.length,J>0)for(i=A[0],Y=1;J>Y;Y++)g=A[Y],z+=Lf(i,g),i=g}),z},uk=function(v,F,G){var U="__"+v,u=function(Y){("mousedown"===v||"mouseup"===v||"touchstart"===v||"touchend"===v)&&Kr(Y),G.disabled||G["handle_"+v](Y)};G[U]||(G[U]=u,A(F,v,u))},mg=function(K,O,M){var s="__"+K,W=M[s];W&&(Y(O,K,W),delete M[s])},Ko=function(A,y){var t="_"+y;A[Bb(y)]=function(){return this[t]},A[Bi(y)]=function(u){var Q=this[t];this[t]=u,this.fp(y,Q,u)}},ui=function(p){return e.create(p)},ii=function(z){if(!z.element){var W,Z;(W=z.textField)?Z=gi($s.TextField,W):(W=z.textArea)?Z=gi($s.TextArea,W):(W=z.button)?Z=gi($s.Button,W):(W=z.comboBox)?Z=gi($s.ComboBox,W):(W=z.checkBox)?Z=gi($s.CheckBox,W):(W=z.radioButton)?Z=gi($s.RadioButton,W):(W=z.slider)?Z=gi($s.Slider,W):(W=z.colorPicker)?Z=gi($s.ColorPicker,W):(W=z.image)&&(Z=gi($s.Image,W)),Z&&(z.element=Z)}},mk=function(O,W){var k=Rn(O);return k._ht=W,k},wq=n.top===n?n.top:n||n.document,Rn=function(p,G){var r=i.createElement("div"),Y=r.style;return r.tabIndex=-1,r.onkeydown=qk,Y.msTouchAction=ef,Ve(r,V,0),gp&&Y.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",V),p&&(Y.overflow=bo),G&&os(G,r),r},ob=function(n,J){var X=i.createElement("canvas"),Y=X.style;return Y.msTouchAction=ef,J||(Y.pointerEvents=ef),Ve(X,V,0),n&&os(n,X),X},Ve=function(z,E,T){var S=z.style;S.border=E?E+" solid 1px":0,S.outline=0,S.padding=T?"0 "+T+Tn:0,Of(z)},Of=function(Z){var t=Z.style;t.position=Sp,t.margin=0,t.setProperty("box-sizing","border-box",V),t.setProperty("-moz-box-sizing","border-box",V)},Yl=function(g,X,t,z){z||(z=Me),X!=V&&(g.width=X*z,g.style.width=X+Tn),t!=V&&(g.height=t*z,g.style.height=t+Tn)},os=function(I,e,L){I.appendChild(e),L&&(e.style.position=Sp)},zn=function(Y,H){H.split||(H+="");for(var J,T=H.split("\n"),D=0,K=T.length,h=0;K>h;h++){var r=ts(Y.font,T[h]);r.width>D&&(D=r.width),J||(J=r.height)}return Y.ss=T,{width:D,height:J*K}},Em=function(f,j,u,G,N,U){var S=j.length;if(1===S)gr(f,j[0],u,G,N);else for(var q=u.height/S,B={x:u.x,y:u.y,width:u.width,height:q},p=0;p<j.length;p++)U?ws(f,j[p],G,N,B.x,B.y,B.width,B.height,U):gr(f,j[p],B,G,N),B.y+=q},gr=function(R,Z,n,y,I){R.font=y?y:Yf,R.fillStyle=I?I:Ri,R.textAlign=cc,R.textBaseline=en;var z,E;n?n.width===$?(z=n.x,E=n.y):(z=n.x+n.width/2,E=n.y+n.height/2):(z=0,E=0),R.fillText(Z,k(z),k(E))},Rr=function(J){J.getView&&(J=J.getView());var j=J.offsetWidth||J.scrollWidth;return!j&&J.style.width&&(j=Zp(J.style.width)),j},Wo=function(C){C.getView&&(C=C.getView());var u=C.offsetHeight||C.scrollHeight;return!u&&C.style.height&&(u=Zp(C.style.height)),u},ks=function(p,A,Y){var v=A[0].toUpperCase()+A.substring(1,A.length);p["webkit"+v]=Y,p["moz"+v]=Y,p["ms"+v]=Y,p["o"+v]=Y,p[A]=Y},jg=function(){var n=function(y){qk(y),y.stopPropagation()},q=function(G){qk(G)},i=[Ip,ls,Zg];return function(Y,y){var f=Rn(),H=f.style;return H.backgroundColor=B.disabledBackground,Y&&(H.backgroundImage="url("+Y+")",H.backgroundPosition="50% 50%",H.backgroundRepeat="no-repeat no-repeat"),y===!1?i.forEach(function(n){A(f,n,q)}):i.forEach(function(k){A(f,k,n)}),f}}(),ye=function(S){var t=S.getContext("2d");return t.save(),t.lineCap=Ee,t.lineJoin=nh,t},Dd=function(R,H,s,w){Sg(R,H*Me,s*Me),w*=Me,1!==w&&R.scale(w,w)},Sg=function(z,P,i){z.translate(P,i)},Nh=function(K,g){g&&K.rotate(g)},wk=function(r,z,p){z===$&&(z=1),p===$&&(p=1),(1!==z||1!==p)&&r.scale(z,p)},Dj=!1,o=wq[cf[1]+Rd[0]],ce=function(G){var P=i.activeElement;if(i.activeElement!==G){P&&P.forceOnblur&&P.forceOnblur();for(var u=[],X=G.parentNode;X;)u.push([X,X.scrollLeft,X.scrollTop]),X=X.parentNode;if(!Dj){var o=[],D=[];try{for(var O=n.parent,d=n;O!==d;)o.push([O,O.scrollX,O.scrollY]),d=O,O=n.parent;var e=n.frameElement;if(e)for(var J=e.parentNode;J;)D.push([J,J.scrollLeft,J.scrollTop]),J=J.parentNode}catch(j){Dj=!0}}if(gp)G.focus();else{var Q=Nk(),R=Q.target;G.focus(),R.scrollLeft=Q.left,R.scrollTop=Q.top}u.forEach(function(O){O[0].scrollLeft=O[1],O[0].scrollTop=O[2]}),Dj||(o.forEach(function(_){_[0].scrollTo(_[1],_[2])}),D.forEach(function(k){k[0].scrollLeft=k[1],k[0].scrollTop=k[2]}))}},Wn=function(g){return g&&g.getView?g.getView():g},$m=function(z,r,O,q,S){if(2===arguments.length&&(O=r.y,q=r.width,S=r.height,r=r.x),z.isSelfViewEvent)z.setX(r),z.setY(O),z.setWidth(q),z.setHeight(S);else{var P=Wn(z),W=P.style;if((i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement)!==P)r!==$&&(W.left=r+Tn),O!==$&&(W.top=O+Tn),q!==$&&(W.width=q+Tn),S!==$&&(W.height=S+Tn);else{var Q=B.getWindowInfo();W.left=(r=Q.left)+Tn,W.top=(O=Q.top)+Tn,W.width=(q=Q.width)+Tn,W.height=(S=Q.height)+Tn}z.endEditing&&!gp&&z.endEditing(),z.redraw&&z.redraw(),z.invalidate&&z.invalidate(),z.onLayouted&&z.onLayouted(r,O,q,S),z.fireViewEvent&&z.fireViewEvent("layout")}},Bf=function(Y){if(!Y.touches)return Y;var F=Y.touches[0];return F?F:Y.changedTouches[0]},Hf=function(h){return jk(h)?Bf(h).target:h.target},jk=function(p){return p&&"object"==typeof p&&"touches"in p},Qj=function(P){B.popup&&B.popup.close(),B.popup=P},mr=V,ne=function(h){mr.handleWindowTouchMove(h)},Id=function(D){mr.handleWindowTouchEnd(D),Y(n,yi,ne),Y(n,fn,Id),mr=V},Jb=function(n){mr.handleWindowMouseMove(n)},$i=function(m){mr.handleWindowMouseUp(m),Y(n,Oq,Jb),Y(n,Ce,$i),mr=V},$k=function(O){return 1===Bg(O)},Td=function(y,Q){return Q?Q.keyCode===y:vm[y]},$g=function(z){return kj(z)&&Td(65,z)},Ab=function(F){return Td(46,F)||Td(8,F)},tb=function($){return function(K){return K?K.keyCode===$:vm[$]}},Mq=573,Ul=[65,83,68,87,37,38,39,40,32,13,27],xk=tb(Ul[0]),Je=tb(Ul[1]),gb=tb(Ul[2]),tj=tb(Ul[3]),Yg=tb(Ul[4]),Xe=tb(Ul[5]),hq=tb(Ul[6]),Xh=tb(Ul[7]),uo=tb(Ul[8]),Gr=tb(Ul[9]),$b=tb(Ul[10]),sr={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},tm=[2,2,2,2,2,2,2,2,2,2,2,3,3,5,5,5,5,5,7,4027],Zf=V,ms=V,oe=function(h,F){Zf||(Zf=ob()),Yl(Zf,h,F,1);var W=ye(Zf);return W.clearRect(0,0,h,F),W},to=function(Y,c,C){if(c&&Y){if("override"===C)return c;if("override_rgb"===C){var G=xs(c);return Y=Fh(Y),"rgba("+k(255*G[0])+","+k(255*G[1])+","+k(255*G[2])+","+Y[3]/255+")"}if("override_a"===C){var G=xs(c);return Y=Fh(Y),"rgba("+Y[0]+","+Y[1]+","+Y[2]+","+G[3]+")"}if("multiply_destinationAtop"===C){var X=Xn(xs(Y)),p=X[3],n=Xn(xs(c)),e=n[3],T=Xn(X),W=T[3],F=X.map(function(W,m){return W*n[m]}),Q=1-p,q=1-e,j=q*p+e;return X=X.map(function(d,v){return(e*Q*n[v]+e*p*F[v]+q*p*d)/j}),p=j,Q=1-p,X=X.map(function(t,X){return(W*T[X]*Q+p*t*W)/W}),p=W,"rgba("+k(255*X[0])+","+k(255*X[1])+","+k(255*X[2])+","+p+")"}var G=xs(c);return Y=Fh(Y),"rgba("+k(Y[0]*G[0])+","+k(Y[1]*G[1])+","+k(Y[2]*G[2])+","+Y[3]/255*G[3]+")"}return Y},Fh=function(){var f,g={};for(var a in n){var Q=cm.length;if(a.length==Q&&a[0]===cm[2]&&a[1]===ef[1]&&a[4]===cm[3]&&a[5]===cm[4]&&a.substr(Q-2)===ef[1]+ef[2]){var s=n[a];for(var H in s)H.length===Q&&H.substr(0,3)===ci[3]+nr[3]+aj[0]&&H.substr(Q-2)===cm[0]+Bq[3]&&(vk=s[H])}}return function(w){var Y,U=g[w];return U||(f||(f=ob(),Yl(f,1,1,1)),Y=f.getContext("2d"),Y.clearRect(0,0,1,1),Wq(Y,0,0,1,1,w),U=Y.getImageData(0,0,1,1).data,U=g[w]=[U[0],U[1],U[2],U[3]]),U}}(),xs=function(k){if(!Zq(k))return k;var F=Fh(k);return F.CA||(F.CA=[F[0]/255,F[1]/255,F[2]/255,F[3]/255]),F.CA},rn=function(h,v,i,m,u){var t=ob();t.width=i,t.height=m;var _=t.getContext("2d");_.drawImage(h,0,0,i,m);try{for(var c=_.getImageData(0,0,i,m),e=c.data,U=0,d=e.length;d>U;U+=4){var I=e[U+0],D=e[U+1],$=e[U+2],X=e[U+3];"override_a"===u?e[U+3]=255*v[3]:"override_rgb"===u?(e[U+0]=255*v[0],e[U+1]=255*v[1],e[U+2]=255*v[2]):"override"===u?(e[U+0]=255*v[0],e[U+1]=255*v[1],e[U+2]=255*v[2],e[U+3]=255*v[3]):(e[U+0]=v[0]*I,e[U+1]=v[1]*D,e[U+2]=v[2]*$,e[U+3]=v[3]*X)}_.putImageData(c,0,0)}catch(k){return h}return t},Pb=function(V,y,l){return y&&(y="miter"===l?8*y+20:y+1,V&&Pm(V,y)),y},po=function(i,U){if(U){var r=new qf(U),o=i.width/2,B=i.height/2,w=lq([r.tf(-o,-B),r.tf(o,-B),r.tf(o,B),r.tf(-o,B)]);return w.x+=i.x+o,w.y+=i.y+B,w}return i},Re=function(t,f,o,r,P,b,_,O){r*=Math.PI/180;var D={x:Math.cos(r)*(t.x-_.x)/2+Math.sin(r)*(t.y-_.y)/2,y:-Math.sin(r)*(t.x-_.x)/2+Math.cos(r)*(t.y-_.y)/2},v=Math.pow(D.x,2)/Math.pow(f,2)+Math.pow(D.y,2)/Math.pow(o,2);v>1&&(f*=Math.sqrt(v),o*=Math.sqrt(v));var A=(P==b?-1:1)*Math.sqrt((Math.pow(f,2)*Math.pow(o,2)-Math.pow(f,2)*Math.pow(D.y,2)-Math.pow(o,2)*Math.pow(D.x,2))/(Math.pow(f,2)*Math.pow(D.y,2)+Math.pow(o,2)*Math.pow(D.x,2)));isNaN(A)&&(A=0);var g={x:A*f*D.y/o,y:A*-o*D.x/f},z={x:(t.x+_.x)/2+Math.cos(r)*g.x-Math.sin(r)*g.y,y:(t.y+_.y)/2+Math.sin(r)*g.x+Math.cos(r)*g.y},w=function(I){return Math.sqrt(Math.pow(I[0],2)+Math.pow(I[1],2))},j=function($,a){return($[0]*a[0]+$[1]*a[1])/(w($)*w(a))},H=function(A,o){return(A[0]*o[1]<A[1]*o[0]?-1:1)*Math.acos(j(A,o))},$=H([1,0],[(D.x-g.x)/f,(D.y-g.y)/o]),Y=[(D.x-g.x)/f,(D.y-g.y)/o],U=[(-D.x-g.x)/f,(-D.y-g.y)/o],V=H(Y,U);j(Y,U)<=-1&&(V=Math.PI),j(Y,U)>=1&&(V=0);var j=f>o?f:o,K=f>o?1:f/o,T=f>o?o/f:1;if(null==O){var I={x:0,y:0,width:0,height:0};Pm(I,j),I.x*=K,I.width*=K,I.y*=T,I.height*=T;var W=new qf(r);return I=lq([W.tf(I.x,I.y),W.tf(I.x+I.width,I.y),W.tf(I.x+I.width,I.y+I.height),W.tf(I.x,I.y+I.height)]),I.x+=z.x,I.y+=z.y,[{x:I.x,y:I.y},{x:I.x+I.width,y:I.y},{x:I.x+I.width,y:I.y+I.height},{x:I.x,y:I.y+I.height}]}O.translate(z.x,z.y),O.rotate(r),O.scale(K,T),O.arc(0,0,j,$,$+V,1-b),O.scale(1/K,1/T),O.rotate(-r),O.translate(-z.x,-z.y)},zb=function($,y){$&&$.beginPath();for(var G,M,Q,c=[],w=function(N){for(var n,x=/(\-{0,1}[\d\.]+)/gi,h=[];n=x.exec(N);)h.push(parseFloat(n[0]));return h},U=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,n={x:0,y:0};G=U.exec(y);){var V=G[0],B=V.substr(0,1);if("M"===B||"m"===B){for(var J=w(V),a=0;a<J.length;a+=2){var C=J[a],s=J[a+1];"m"===B&&(C+=n.x,s+=n.y),$&&$.moveTo(C,s),c.push({x:C,y:s}),n.x=C,n.y=s}M=Q=null}else if("H"===B||"h"===B){for(var J=w(V),a=0;a<J.length;a+=1){var C=J[a];"h"===B&&(C+=n.x),$&&$.lineTo(C,n.y),c.push({x:C,y:n.y}),n.x=C}M=Q=null}else if("C"===B||"c"===B){for(var J=w(V),a=0;a<J.length;a+=6){var F=J[a],t=J[a+1],h=J[a+2],v=J[a+3],C=J[a+4],s=J[a+5];"c"===B&&(F+=n.x,t+=n.y,h+=n.x,v+=n.y,C+=n.x,s+=n.y),$&&$.bezierCurveTo(F,t,h,v,C,s),c.push({x:F,y:t}),c.push({x:h,y:v}),c.push({x:C,y:s}),n.x=C,n.y=s}M=[F,t,h,v,C,s],Q=null}else if("S"===B||"s"===B){for(var J=w(V),a=0;a<J.length;a+=4){var F,t;M?(F=2*M[4]-M[2],t=2*M[5]-M[3]):(F=n.x,t=n.y);var h=J[a],v=J[a+1],C=J[a+2],s=J[a+3];"s"===B&&(h+=n.x,v+=n.y,C+=n.x,s+=n.y),$&&$.bezierCurveTo(F,t,h,v,C,s),c.push({x:F,y:t}),c.push({x:h,y:v}),c.push({x:C,y:s}),n.x=C,n.y=s}M=[F,t,h,v,C,s],Q=null}else if("Q"===B||"q"===B){for(var J=w(V),a=0;a<J.length;a+=4){var F=J[a],t=J[a+1],C=J[a+2],s=J[a+3];"q"===B&&(F+=n.x,t+=n.y,C+=n.x,s+=n.y),$&&$.quadraticCurveTo(F,t,C,s),c.push({x:F,y:t}),c.push({x:C,y:s}),n.x=C,n.y=s}M=null,Q=[F,t,C,s]}else if("T"===B||"t"===B){for(var J=w(V),a=0;a<J.length;a+=2){var F,t;Q?(F=2*Q[2]-Q[0],t=2*Q[3]-Q[1]):(F=n.x,t=n.y);var C=J[a],s=J[a+1];"t"===B&&(C+=n.x,s+=n.y),$&&$.quadraticCurveTo(F,t,C,s),c.push({x:F,y:t}),c.push({x:C,y:s}),n.x=C,n.y=s}M=null,Q=[F,t,C,s]}else if("V"===B||"v"===B){for(var J=w(V),a=0;a<J.length;a+=1){var s=J[a];"v"===B&&(s+=n.y),$&&$.lineTo(n.x,s),c.push({x:n.x,y:s}),n.y=s}M=Q=null}else if("L"===B||"l"===B){for(var J=w(V),a=0;a<J.length;a+=2){var C=J[a],s=J[a+1];"l"===B&&(C+=n.x,s+=n.y),$&&$.lineTo(C,s),c.push({x:C,y:s}),n.x=C,n.y=s}M=Q=null}else if("A"===B||"a"===B){for(var J=w(V),a=0;a<J.length;a+=7){var P=J[a],r=J[a+1],i=J[a+2],g=J[a+3],E=J[a+4],C=J[a+5],s=J[a+6];"a"===B&&(C+=n.x,s+=n.y);var X=Re(n,P,r,i,g,E,{x:C,y:s},$);X&&(c=c.concat(X)),n.x=C,n.y=s}M=Q=null}var q=V.substr(V.length-1);("z"===q||"Z"===q)&&$&&$.closePath()}return c},bl=function(f,P,v){var y,u,Z="L"===P[0],M=P.length;f.save(),Z?(f.transform(P[5],P[6],P[7],P[8],P[9],P[10]),y=f.createLinearGradient(P[1],P[2],P[3],P[4]),u=11):(f.transform(P[7],P[8],P[9],P[10],P[11],P[12]),y=f.createRadialGradient(P[1],P[2],P[3],P[4],P[5],P[6]),u=13);for(var d=f.compGray;M>u;){var e=P[u+1];e=v(e),y.addColorStop(P[u],d?B.toGrayColor(e):e),u+=2}return f.fillStyle=y,y},pc=function(T,r){var v=T.s("shape.gradient.pack");if(v){for(var W=v.length,L=new Array(W),O=0;W>O;O++)L[O]=v[O];var w,X,C,j,b,e,N,z,d,F,B,S,Y,s="L"===L[0];w=s?5:7,X=L[w],C=L[w+1],j=L[w+2],b=L[w+3],e=L[w+4],N=L[w+5],z=r[0],d=r[1],F=r[2],B=r[3],S=r[4],Y=r[5],L[w]=z*X+F*C,L[w+1]=d*X+B*C,L[w+2]=z*j+F*b,L[w+3]=d*j+B*b,L[w+4]=z*e+F*N+S,L[w+5]=d*e+B*N+Y,T.s("shape.gradient.pack",L)}},gh=function(s,p,a,B){var r=!1;if(s.beginPath?s.beginPath():r=!0,Lq(p)&&(p=p._as),Lq(a)&&(a=a._as),a&&a.length){for(var c,j,e,x,q=0,E=0,T=a.length;T>E;E++)c=a[E],1===c?(j=p[q++],s.moveTo(j.x,r?-j.y:j.y)):2===c?(j=p[q++],s.lineTo(j.x,r?-j.y:j.y)):3===c?(j=p[q++],e=p[q++],s.quadraticCurveTo(j.x,r?-j.y:j.y,e.x,r?-e.y:e.y)):4===c?(j=p[q++],e=p[q++],x=p[q++],s.bezierCurveTo(j.x,r?-j.y:j.y,e.x,r?-e.y:e.y,x.x,r?-x.y:x.y)):5===c&&s.closePath();B&&5!==c&&s.closePath()}else{var D,Y,H,W=p.length;if(W>0){for(D=p[0],s.moveTo(D.x,r?-D.y:D.y),Y=1;W>Y;Y++)H=p[Y],s.lineTo(H.x,r?-H.y:H.y);B&&s.closePath()}}},ds=function(O,y,p,R){if(Lq(O)&&(O=O._as),Lq(y)&&(y=y._as),y&&y.length){p=p||Nl;for(var S,T,j,G,Y,B,N,o,F=[],H=V,a=0,E=0,k=y.length;k>E;E++)if(S=y[E],1===S)F.push(H=[]),H.push(O[a++]);else if(2===S)H.push(O[a++]);else if(3===S){for(T=H[H.length-1],j=O[a++],G=O[a++],B=1;p>B;B++)N=Pf(B/p,T.x,j.x,G.x),o=Pf(B/p,T.y,j.y,G.y),H.push({x:N,y:o,b:!0});H.push(G)}else if(4===S){for(T=H[H.length-1],j=O[a++],G=O[a++],Y=O[a++],B=1;p>B;B++)N=Gg(B/p,T.x,j.x,G.x,Y.x),o=Gg(B/p,T.y,j.y,G.y,Y.y),H.push({x:N,y:o,b:!0});H.push(Y)}else 5===S&&H.push(H[0]);return R&&5!==S&&H&&H.length>2&&H.push(H[0]),F}return R&&O.length>2&&(O=O.slice(),O.push(O[0])),O?[O]:[]},Ph=function(O,$,P,T,r,A){var _,k,U,F=Fh($),z=T,t=F[0],K=F[1],d=F[2];if(P){var R=Fh(P);_=R[0]-t,k=R[1]-K,U=R[2]-d}else _=255-t,k=255-K,U=255-d;for(A||(A=T>10?1:.5,A=1>r?s(A/r,2):A),O.save(),O.shadowOffsetX=0,O.shadowOffsetY=0,O.shadowBlur=0,O.shadowColor=0;(T-=A)>0;){var u=1-T/z,N=t+_*u,c=K+k*u,C=d+U*u;N=s(L(N),255),c=s(L(c),255),C=s(L(C),255),O.strokeStyle="rgb("+N+","+c+","+C+")",O.lineWidth=T,O.stroke()}O.restore()},Yc=function(){var v={};return function(w,R){var l=w+"-"+R,p=v[l];if(p)return p;var j,h,C,k=Fh(w);return 0>R?(R=(100+R)/100,j=L(k[0]*R),h=L(k[1]*R),C=L(k[2]*R)):(R/=100,j=k[0],h=k[1],C=k[2],j+=(255-j)*R,h+=(255-h)*R,C+=(255-C)*R,j=s(L(j),255),h=s(L(h),255),C=s(L(C),255)),v[l]="rgb("+j+","+h+","+C+")"}}(),Wq=function(J,E,f,O,p,b){b&&(J.fillStyle=b),J.beginPath(),J.rect(E,f,O,p),J.fill()},qp=function(F,b,N,K,C,m,S){F.beginPath(),Ji[b](F,N.x,N.y,N.width,N.height,K,C,m,S)},lb=function(_,m,d,B,c){var O=Ji[d];_.fillStyle=O?O(_,m,B?B:br,c.x,c.y,c.width,c.height):m},_k=function(u,O,T,Y,z,v){u.fillStyle=Mn(u,O,T,Y,z,v)},$d=function(H,E,e,B,Y,I){H.strokeStyle=Mn(H,E,e,B,Y,I)},Mn=function(U,D,z,X,v,H){var i;try{if(!D.tagName&&D.comps){D._cacheImage_||(D._cacheImage_={});var u;u="override"===X?"colors_override":"override_rgb"===X?"colors_override_rgb":"override_a"===X?"colors_override_a":"colors",D._cacheImage_[u]||(D._cacheImage_[u]={__count__:0});var I=D._cacheImage_[u][z];I||(D._cacheImage_[u].__count__>B.imageCacheThreshold&&(D._cacheImage_[u]={__count__:0}),I=C.Default.toCanvas(D,Fe(D),Dm(D),null,v,H,z,null,X),D._cacheImage_[u][z]=I,D._cacheImage_[u].__count__++),D=I}i=U.createPattern(D,"repeat")}catch(T){i="black"}return i},Nr=function(t){var p,D,R=[],y=0,l=t.length;for(p=0;65>p;p++)R[p]=p;for(p=0;65>p;p++)y=(y+R[p]+t.charCodeAt(p%l))%65,D=R[p],R[p]=R[y],R[y]=D;for(p=0;65>p;p++)R[p]=om[R[p]];return R.join("")},mm=function(Z){for(var y=8+Pl.randomInt(8),t=om[8*Pl.randomInt(8)+(y-8)],O="",u=0;y>u;u++)O+=om[Pl.randomInt(64)];var h=Nr(O+M+Bn+Oe);return t+O+dk.encode(Z,h)},mn=function(G){var W=G[0],e=om.indexOf(W);if(0>e)return"";e=8+(7&e);var I=G.slice(1,1+e),u=Nr(I+M+Bn+Oe);return dk.decode(G,u,1+e)},jf=function(L,Q,P,W,i,T,D){L.save(),L.translate(Q,P),L.scale(1,D/T),L.arc(0,0,T,W,i),L.restore()},xh=function(n,e,b,q,p,H,F,j){var E,R,z,K,M,G,k,c,u,a,f;if(r(p)>2*Z&&(p=2*Z),M=L(r(p)/(Z/4)),E=p/M,R=-E,z=-q,M>0){G=e+D(q)*H,k=b+w(-q)*F,j?n.lineTo(G,k):n.moveTo(G,k);for(var s=0;M>s;s++)z+=R,K=z-R/2,c=e+D(z)*H,u=b+w(z)*F,a=e+D(K)*(H/D(R/2)),f=b+w(K)*(F/D(R/2)),n.quadraticCurveTo(a,f,c,u)
}},xm=function(H,l,X,x,w,L,T,y,O){6===arguments.length&&(T=L,y=L,O=L);var G=l+x,J=X+w,V=w>x?2*x:2*w;L=V>L?L:V,T=V>T?T:V,y=V>y?y:V,O=V>O?O:V;var u=.29*O,j=.58*O;H.moveTo(G,J-O),H.quadraticCurveTo(G,J-j,G-u,J-u),H.quadraticCurveTo(G-j,J,G-O,J),u=.29*y,j=.58*y,H.lineTo(l+y,J),H.quadraticCurveTo(l+j,J,l+u,J-u),H.quadraticCurveTo(l,J-j,l,J-y),u=.29*L,j=.58*L,H.lineTo(l,X+L),H.quadraticCurveTo(l,X+j,l+u,X+u),H.quadraticCurveTo(l+j,X,l+L,X),u=.29*T,j=.58*T,H.lineTo(G-T,X),H.quadraticCurveTo(G-j,X,G-u,X+u),H.quadraticCurveTo(G,X+j,G,X+T),H.lineTo(G,J-O)},hk=function(Y,Z,o,P,W,E,h){Z&&(o=k(o),P=k(P),h||(h=1),Y.fillStyle=Z,Y.beginPath(),Y.rect(o,P,h,E),Y.rect(o,P,W,h),E-h>0&&Y.rect(o,P+E-h,W,h),W-h>0&&Y.rect(o+W-h,P,h,E),Y.fill())},Kl=function(j,H,E,g){var p=g.x,V=g.y,N=g.width,v=g.height;if(!(!H||!E||0>=N||0>=v)){var Y,R=cr(H),z=$e(H),y=E>0;1===E||-1===E?(j.fillStyle=y?R:z,j.beginPath(),j.rect(p,V,1,v),j.rect(p,V,N,1),j.fill(),j.fillStyle=y?z:R,j.beginPath(),j.rect(p,V+v-1,N,1),j.rect(p+N-1,V,1,v),j.fill()):(E=s(r(E),s(N/2,v/2)),Y=j.createLinearGradient(p,V,p+E,V),Y.addColorStop(0,y?R:z),Y.addColorStop(1,H),j.fillStyle=Y,j.beginPath(),j.moveTo(p,V),j.lineTo(p+E,V+E),j.lineTo(p+E,V+v-E),j.lineTo(p,V+v),j.lineTo(p,V),j.fill(),Y=j.createLinearGradient(p,V,p,V+E),Y.addColorStop(0,y?R:z),Y.addColorStop(1,H),j.fillStyle=Y,j.beginPath(),j.moveTo(p,V),j.lineTo(p+E,V+E),j.lineTo(p+N-E,V+E),j.lineTo(p+N,V),j.lineTo(p,V),j.fill(),Y=j.createLinearGradient(p,V+v,p,V+v-E),Y.addColorStop(0,y?z:R),Y.addColorStop(1,H),j.fillStyle=Y,j.beginPath(),j.moveTo(p,V+v),j.lineTo(p+E,V+v-E),j.lineTo(p+N-E,V+v-E),j.lineTo(p+N,V+v),j.lineTo(p,V+v),j.fill(),Y=j.createLinearGradient(p+N,V,p+N-E,V),Y.addColorStop(0,y?z:R),Y.addColorStop(1,H),j.fillStyle=Y,j.beginPath(),j.moveTo(p+N,V),j.lineTo(p+N-E,V+E),j.lineTo(p+N-E,V+v-E),j.lineTo(p+N,V+v),j.lineTo(p+N,V),j.fill())}},Ql=function(_,H,C,X,p,I,g){var r=_.createLinearGradient(X,p,I,g);return r.addColorStop(0,C),r.addColorStop(1,H),r},mp=function(t,r,L,J,u,K,c){var N=t.createLinearGradient(J,u,K,c);return N.addColorStop(0,r),N.addColorStop(.5,L),N.addColorStop(1,r),N},pm=function(Q,t,z,C,y,O,o){var j=Q.createLinearGradient(C,y,O,o);return j.addColorStop(0,t),j.addColorStop(1/3,z),j.addColorStop(2/3,t),j.addColorStop(1,z),j},zd=function(b,p,K,k,S,L,X,w,T){var o=b.createRadialGradient(k+L*w,S+X*T,s(L,X)/24,k+L/2,S+X/2,g(L,X)/2);return o.addColorStop(0,K),o.addColorStop(1,p),o},Ro=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Ji={polygon:function(t,x,k,W,o,g){(g==V||3>g)&&(g=6);for(var U,j,u=s(W,o)/2,q=x+W/2,i=k+o/2,K=0,M=2*Z/g,_=0;g>_;_++)U=q+D(K)*u,j=i+w(K)*u,0===_?t.moveTo(U,j):t.lineTo(U,j),K+=M;t.closePath()},arc:function(K,B,M,I,G,$,P,X,D){$==V&&($=Z),P==V&&(P=J),X==V&&(X=!0);var S=B+I/2,f=M+G/2;X&&K.moveTo(S,f),D?jf(K,S,f,$,P,I/2,G/2):K.arc(S,f,s(I,G)/2,$,P),X&&K.closePath()},rect:function(a,h,M,Z,r){a.rect(h,M,Z,r)},circle:function(u,A,a,y,U){u.arc(A+y/2,a+U/2,s(y,U)/2,0,J,!0)},oval:function(d,k,M,l,b){jf(d,k+l/2,M+b/2,0,J,l/2,b/2)},roundRect:function(x,I,E,l,r,u){u==V&&(u=s(s(l,r)/4,8)),xm(x,I,E,l,r,u)},star:function(r,i,G,T,P){var O=2*T,F=2*P,W=i+T/2,$=G+P/2;r.moveTo(W-O/4,$-F/12),r.lineTo(i+.306*T,G+.579*P),r.lineTo(W-O/6,$+F/4),r.lineTo(i+T/2,G+.733*P),r.lineTo(W+O/6,$+F/4),r.lineTo(i+.693*T,G+.579*P),r.lineTo(W+O/4,$-F/12),r.lineTo(i+.611*T,G+.332*P),r.lineTo(W+0,$-F/4),r.lineTo(i+.388*T,G+.332*P),r.closePath()},pentagram:function(A,x,k,y,c){var v=.5*c,p=x+.5*y,i=k+v,r=.5257311121191336*y;r>v&&(r=v);var H=Ro,C=0;for(A.moveTo(p+r*H[C++],i+r*H[C++]);20>C;)A.lineTo(p+r*H[C++],i+r*H[C++]);A.closePath()},triangle:function(E,h,J,w,M){E.moveTo(h+w/2,J),E.lineTo(h+w,J+M),E.lineTo(h,J+M),E.closePath()},hexagon:function(D,q,V,F,v){D.moveTo(q,V+v/2),D.lineTo(q+F/4,V+v),D.lineTo(q+3*F/4,+V+v),D.lineTo(q+F,V+v/2),D.lineTo(q+3*F/4,V),D.lineTo(q+F/4,V),D.closePath()},pentagon:function(I,Y,k,t,K){var R=2*t,O=2*K,W=Y+t/2,e=k+K/2;I.moveTo(W-R/4,e-O/12),I.lineTo(W-R/6,e+O/4),I.lineTo(W+R/6,e+O/4),I.lineTo(W+R/4,e-O/12),I.lineTo(W+0,e-O/4),I.closePath()},diamond:function(c,Q,I,G,s){c.moveTo(Q+G/2,I),c.lineTo(Q,I+s/2),c.lineTo(Q+G/2,I+s),c.lineTo(Q+G,I+s/2),c.closePath()},rightTriangle:function(o,Z,N,s,E){o.moveTo(Z,N),o.lineTo(Z+s,N+E),o.lineTo(Z,N+E),o.closePath()},parallelogram:function(f,J,l,_,q){var r=_/4;f.moveTo(J+r,l),f.lineTo(J+_,l),f.lineTo(J+_-r,l+q),f.lineTo(J,l+q),f.closePath()},trapezoid:function(T,v,u,x,n){var L=x/4;T.moveTo(v+L,u),T.lineTo(v+x-L,u),T.lineTo(v+x,u+n),T.lineTo(v,u+n),T.closePath()},"linear.southwest":function(T,_,t,h,C,l,U){return Ql(T,_,t,h,C+U,h+l,C)},"linear.southeast":function(v,L,c,r,Q,b,x){return Ql(v,L,c,r+b,Q+x,r,Q)},"linear.northwest":function(Q,j,v,F,l,c,G){return Ql(Q,j,v,F,l,F+c,l+G)},"linear.northeast":function(E,L,Y,c,y,F,B){return Ql(E,L,Y,c+F,y,c,y+B)},"linear.north":function(c,G,d,n,p,U,O){return Ql(c,G,d,n,p,n,p+O)},"linear.south":function(s,M,H,n,Y,I,F){return Ql(s,M,H,n,Y+F,n,Y)},"linear.west":function(R,K,b,g,j,h){return Ql(R,K,b,g,j,g+h,j)},"linear.east":function(l,Y,P,V,c,C){return Ql(l,Y,P,V+C,c,V,c)},"radial.center":function($,t,w,j,B,q,g){return zd($,t,w,j,B,q,g,.5,.5)},"radial.southwest":function(x,i,V,J,n,d,t){return zd(x,i,V,J,n,d,t,.25,.75)},"radial.southeast":function(j,z,t,M,N,H,l){return zd(j,z,t,M,N,H,l,.75,.75)},"radial.northwest":function(i,c,t,m,U,h,$){return zd(i,c,t,m,U,h,$,.25,.25)},"radial.northeast":function(Y,Z,K,d,C,t,k){return zd(Y,Z,K,d,C,t,k,.75,.25)},"radial.north":function(s,_,q,a,m,v,G){return zd(s,_,q,a,m,v,G,.5,.25)},"radial.south":function(Z,K,B,G,p,r,h){return zd(Z,K,B,G,p,r,h,.5,.75)},"radial.west":function(K,v,f,T,m,y,p){return zd(K,v,f,T,m,y,p,.25,.5)},"radial.east":function(x,d,g,D,z,G,c){return zd(x,d,g,D,z,G,c,.75,.5)},"spread.horizontal":function(s,G,e,h,d,R){return mp(s,G,e,h,d,h+R,d)},"spread.vertical":function(G,B,H,U,A,d,e){return mp(G,B,H,U,A,U,A+e)},"spread.diagonal":function($,q,P,G,g,z,Z){return mp($,q,P,G+z,g,G,g+Z)},"spread.antidiagonal":function(r,_,W,C,F,R,J){return mp(r,_,W,C,F,C+R,F+J)},"spread.north":function(x,f,D,a,K,d,J){return pm(x,f,D,a,K-J/4,a,K+J+J/4)},"spread.south":function(v,E,f,r,t,X,O){return pm(v,f,E,r,t-O/4,r,t+O+O/4)},"spread.west":function(y,Y,q,p,z,U){return pm(y,Y,q,p-U/4,z,p+U+U/4,z)},"spread.east":function(x,E,e,v,y,Y){return pm(x,e,E,v-Y/4,y,v+Y+Y/4,y)}},Up=function($,b,j){return new qf($).tf(b,j)},eq=function(u){var i=u.touches[0],N=u.touches[1],t=i.clientX,$=i.clientY,H=N.clientX,q=N.clientY;return j((t-H)*(t-H)+($-q)*($-q))},gf=function(w){var y=w.touches[0],o=w.touches[1],c=y.clientX,v=y.clientY,s=o.clientX,j=o.clientY;return{x:(c+s)/2,y:(v+j)/2}},qe=(function(){for(var C=0,x=ke.split(""),W=0;W<x.length;W++)C=10*Zp(x[W])+C;return bf(n[Mq.toString(8*W)+rj.substr(W)+3],n[Mq.toString(8*W)+rj.substr(W)+4]),C}(),function(o,n,G){for(var c=0;c<G.size();c++){var m=G.get(c);o.co(m)&&n.add(m)}for(c=0;c<G.size();c++)m=G.get(c),qe(o,n,m._children)}),vf=function(C,a,i){for(var c=0;c<i.size();c++){var V=i.get(i.size()-1-c);C.co(V)&&a.add(V)}for(c=0;c<i.size();c++)V=i.get(c),vf(C,a,V._children)},qj=function(C,t,v){for(var U=!1,Y=0;Y<v.size();Y++){var w=v.get(Y);C.co(w)?U&&t.add(w):U=1}for(Y=0;Y<v.size();Y++)w=v.get(Y),qj(C,t,w._children)},jd=function(P,u,A){for(var E=!1,i=0;i<A.size();i++){var M=A.get(A.size()-1-i);P.co(M)?E&&u.add(M):E=!0}for(i=0;i<A.size();i++)M=A.get(i),jd(P,u,M._children)},lh=B.moveDatas=function(n,k,J,E){var e=E==V;if(0!==k||0!==J||!e&&0!==E){var W=!0,L=[];if(n.forEach(function(l){W&&(l._69O||Bs(l)||On(l))&&(W=!1)}),W)L=n;else{var _={},a={};n.forEach(function(n){_[n._id]=!0});var D={},A=function(h){var H=h._id;return _[H]?(L.push(h),D[H]=!0):D[H]=!1},x=function(J){var M=J._id;if(a[M])return A(J);var o=D[M];if(o!==$)return o;var q=J._parent;if(q&&(On(q)||Bs(q))&&x(q))return D[M]=!0;var H=J._host;return H&&(a[M]=M,o=x(H),a[M]=$,o)?D[M]=!0:A(J)};n.forEach(function(e){x(e)})}L.forEach(function(N){if(Zb(N))e?N.translate(k,J):N.translate3d(k,J,E);else{var G=N.s(go);if(!G||G.isEmpty())return;var $=new le;G.each(function(m){m=Xn(m),e?(m.x+=k,m.y+=J):(m.x+=k,m.y+=E,m.e==V?m.e=J:m.e+=J),$.add(m)}),N.s(go,$)}})}},Fo=function(){function A(c,y){return y===c.substring(0,y.length)?!0:!1}function z(O){return parseFloat(O)||0}function v(W,S){if(S==$&&(S=new hb),A(W,"matrix3d")){var J=W.substring(9,W.length-1).split(",");J=J.map(z),S.fromArray(J)}else if(A(W,"matrix")){var J=W.substring(7,W.length-1).split(",");J=J.map(z),S.el[0]=J[0],S.el[1]=J[1],S.el[2]=0,S.el[3]=0,S.el[4]=J[2],S.el[5]=J[3],S.el[6]=0,S.el[7]=0,S.el[8]=0,S.el[9]=0,S.el[10]=1,S.el[11]=0,S.el[12]=J[4],S.el[13]=J[5],S.el[14]=0,S.el[15]=1}return S}function J(P,l){l==$&&(l=new Qe);var C=P.split(/\s+/);return C=C.map(z),l.set(C[0]||0,C[1]||0,C[2]||0),l}var n,R,a,r,h,M=function(o,Q){n||(n=new hb,R=new Qe,a=new hb,r=new hb,h=new hb),Q==$&&(Q=new hb);var s=getComputedStyle(o);s.transform&&"none"!==s.transform&&(v(s.transform,n),J(s.transformOrigin,R),r.setPosition(R),R.negate(),h.setPosition(R),(bh||"preserve-3d"!==s.transformStyle)&&(n.el[8]=0,n.el[9]=0,n.el[10]=1,n.el[11]=0),Q.multiplyMatrices(h,Q),Q.multiplyMatrices(n,Q),Q.multiplyMatrices(r,Q)),!bh&&s.perspective&&"none"!==s.perspective&&(a.el[11]=-1/z(s.perspective),J(s.perspectiveOrigin,R),r.setPosition(R),R.negate(),h.setPosition(R),Q.multiplyMatrices(h,Q),Q.multiplyMatrices(a,Q),Q.multiplyMatrices(r,Q));for(var t=o.offsetParent,b=o.offsetLeft,f=o.offsetTop,F=o.parentElement;F&&F!==t;){var c=getComputedStyle(F);if("none"!==c.transform||"none"!==c.perspective)break;F=F.parentElement}return F==$&&o!==o.ownerDocument.documentElement&&"fixed"!==s.position&&(F=o.ownerDocument.documentElement),t!=$&&t!==F&&(b-=F.offsetLeft,f-=F.offsetTop),R.set(b,f,0),r.setPosition(R),Q.multiplyMatrices(r,Q),F&&M(F,Q),Q};return function(C,e){var L=C.parentElement;if(L){var F=L.updateAppendMatrix;if(F){delete L.updateAppendMatrix;var k=new hb;M(L,k);var w=new hb;w.getInverse(k),L._matrixAppend=w,L._maxrixPreAppend=k}return e?L._matrixAppend:L._maxrixPreAppend}}}(),Eq=function(t,Y){for(;t&&!t.hasOwnProperty(Y);)t=e.getPrototypeOf(t);return t&&e.getOwnPropertyDescriptor(t,Y)},hr=e.getPrototypeOf?function(x,L,C){var K=Eq(L,C);K&&e.defineProperty(x,C,K)}:function(I,p,J){I[J]=p[J]},Xf={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Dn=function(){var M={1:function(z,F){return{x:z.x-F.width/2,y:z.y-F.height/2}},2:function(W,U){return{x:W.x+U.width/2,y:W.y-U.height/2}},3:function(d,p){return{x:d.x+d.width/2,y:d.y-p.height/2}},4:function(x,U){return{x:x.x+x.width-U.width/2,y:x.y-U.height/2}},5:function(J,d){return{x:J.x+J.width+d.width/2,y:J.y-d.height/2}},6:function(B){return{x:B.x,y:B.y}},7:function(l){return{x:l.x+l.width/2,y:l.y}},8:function(A){return{x:A.x+A.width,y:A.y}},9:function(p,$){return{x:p.x-$.width/2,y:p.y+$.height/2}},10:function(e,O){return{x:e.x+O.width/2,y:e.y+O.height/2}},11:function(J,v){return{x:J.x+J.width/2,y:J.y+v.height/2}},12:function(I,n){return{x:I.x-n.width/2+I.width,y:I.y+n.height/2}},13:function(W,v){return{x:W.x+W.width+v.width/2,y:W.y+v.height/2}},14:function(o,d){return{x:o.x-d.width/2,y:o.y+o.height/2}},15:function(X){return{x:X.x,y:X.y+X.height/2}},16:function(i,V){return{x:i.x+V.width/2,y:i.y+i.height/2}},17:function(q){return{x:q.x+q.width/2,y:q.y+q.height/2}},18:function($,Z){return{x:$.x+$.width-Z.width/2,y:$.y+$.height/2}},19:function(W){return{x:W.x+W.width,y:W.y+W.height/2}},20:function(P,G){return{x:P.x+P.width+G.width/2,y:P.y+P.height/2}},21:function(f,p){return{x:f.x-p.width/2,y:f.y+f.height-p.height/2}},22:function(H,q){return{x:H.x+q.width/2,y:H.y+H.height-q.height/2}},23:function(B,n){return{x:B.x+B.width/2,y:B.y+B.height-n.height/2}},24:function(B,C){return{x:B.x+B.width-C.width/2,y:B.y+B.height-C.height/2}},25:function(p,e){return{x:p.x+p.width+e.width/2,y:p.y+p.height-e.height/2}},26:function(e){return{x:e.x,y:e.y+e.height}},27:function(I){return{x:I.x+I.width/2,y:I.y+I.height}},28:function(w){return{x:w.x+w.width,y:w.y+w.height}},29:function(G,f){return{x:G.x-f.width/2,y:G.y+G.height+f.height/2}},30:function(c,H){return{x:c.x+H.width/2,y:c.y+c.height+H.height/2}},31:function(Q,N){return{x:Q.x+Q.width/2,y:Q.y+Q.height+N.height/2}},32:function(A,b){return{x:A.x+A.width-b.width/2,y:A.y+A.height+b.height/2}},33:function(z,c){return{x:z.x+z.width+c.width/2,y:z.y+z.height+c.height/2}},34:function(T,A){return{x:T.x,y:T.y-A.height/2}},35:function(I,r){return{x:I.x+I.width,y:I.y-r.height/2}},36:function(c,M){return{x:c.x,y:c.y+c.height+M.height/2}},37:function($,E){return{x:$.x+$.width,y:$.y+$.height+E.height/2}},38:function(_,r){return{x:_.x+_.width/4,y:_.y-r.height/2}},39:function(B,Q){return{x:B.x+3*B.width/4,y:B.y-Q.height/2}},40:function(v){return{x:v.x+v.width/4,y:v.y}},41:function(p){return{x:p.x+3*p.width/4,y:p.y}},42:function(Z,e){return{x:Z.x+Z.width/4,y:Z.y+e.height/2}},43:function(K,L){return{x:K.x+3*K.width/4,y:K.y+L.height/2}},44:function(t,V){return{x:t.x+t.width/2,y:t.y+t.height/2-V.height/2}},45:function(W){return{x:W.x+W.width/4,y:W.y+W.height/2}},46:function(v,L){return{x:v.x+v.width/2-L.width/2,y:v.y+v.height/2}},47:function(U,O){return{x:U.x+U.width/2+O.width/2,y:U.y+U.height/2}},48:function(V){return{x:V.x+3*V.width/4,y:V.y+V.height/2}},49:function(l,O){return{x:l.x+l.width/2,y:l.y+l.height/2+O.height/2}},50:function(v,O){return{x:v.x+v.width/4,y:v.y+v.height-O.height/2}},51:function(n,G){return{x:n.x+3*n.width/4,y:n.y+n.height-G.height/2}},52:function(t){return{x:t.x+t.width/4,y:t.y+t.height}},53:function($){return{x:$.x+3*$.width/4,y:$.y+$.height}},54:function(W,m){return{x:W.x+W.width/4,y:W.y+W.height+m.height/2}},55:function($,O){return{x:$.x+3*$.width/4,y:$.y+$.height+O.height/2}}};return ns(n)?function(U,$,E){return M[U]($,E?E:Hp)}:void 0}();Ki(h,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var fl=h.reverse,Rm=h.transparent,eh=h.rectSelectBackground,ih=h.dash,Xb=h.titleBackground,$q=h.titleIconBackground,sb=h.headerBackground,xf=h.headerIconBackground,Ch=h.headerSeparator,Rk=h.headerLine,pp=h.contentIconBackground,fm=h.contentLine,im=(h.widgetIconHighlight,h.widgetIconBorder),lr=(h.widgetIconGradient,h.imageBackground),br=h.imageGradient,Ld=h.highlight,yj=h.label,Kq=h.labelSelect;if(Hg&&!n.shutAlert1){var pk=new Date,Wg=Hg.split("-"),Tj=new Date(pk.getFullYear(),pk.getMonth(),pk.getDate()),Hg=new Date(Zp(Wg[0],10),Zp(Wg[1],10)-1,Zp(Wg[2],10)),Pn=Tj.getTime(),_q=Hg.getTime(),Ih=M+"_try",Nm=n.alert;try{var am=n.localStorage;if(am&&Nm)if(_q>Pn&&1728e6>_q-Pn){var Dp=(_q-Pn)/864e5;am&&am[Ih]!=Dp&&(am[Ih]=Dp,n.htWillExpire?Nm(n.htWillExpire.replace("{{day}}",Dp)):Nm("HT for Web free trial license will expire in "+Dp+" days, please apply for a new license!"))}else Pn>=_q&&(n.htExpired?Nm(n.htExpired):Nm("Your free trial of HT for Web has expired!")),am&&delete am[Ih]}catch(gg){}}Math.sign===$&&(Math.sign=function(b){return 0>b?-1:b>0?1:+b});var om="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",dk={encode:function(Y,O){var R,U,z,c,g,I,H,q="",_=0;for(Y=unescape(encodeURIComponent(Y));_<Y.length;)R=Y.charCodeAt(_++),U=Y.charCodeAt(_++),z=Y.charCodeAt(_++),c=R>>2,g=(3&R)<<4|U>>4,I=(15&U)<<2|z>>6,H=63&z,isNaN(U)?I=H=64:isNaN(z)&&(H=64),q=q+O.charAt(c)+O.charAt(g)+O.charAt(I)+O.charAt(H);return q},decode:function(g,z,A){for(var i,Q,r,e,Y,S,P,N="",d=A||0;d<g.length;)e=z.indexOf(g.charAt(d++)),Y=z.indexOf(g.charAt(d++)),S=z.indexOf(g.charAt(d++)),P=z.indexOf(g.charAt(d++)),i=e<<2|Y>>4,Q=(15&Y)<<4|S>>2,r=(3&S)<<6|P,N+=String.fromCharCode(i),64!=S&&(N+=String.fromCharCode(Q)),64!=P&&(N+=String.fromCharCode(r));return N=decodeURIComponent(escape(N))},_utf8_encode:function(O){O=O.replace(/\r\n/g,"\n");for(var W="",k=0;k<O.length;k++){var M=O.charCodeAt(k);128>M?W+=String.fromCharCode(M):M>127&&2048>M?(W+=String.fromCharCode(192|M>>6),W+=String.fromCharCode(128|63&M)):(W+=String.fromCharCode(224|M>>12),W+=String.fromCharCode(128|63&M>>6),W+=String.fromCharCode(128|63&M))}return W},_utf8_decode:function(R){for(var e="",Y=0,P=0,h=0,U=0;Y<R.length;)P=R.charCodeAt(Y),128>P?(e+=String.fromCharCode(P),Y++):P>191&&224>P?(h=R.charCodeAt(Y+1),e+=String.fromCharCode((31&P)<<6|63&h),Y+=2):(h=R.charCodeAt(Y+1),U=R.charCodeAt(Y+2),e+=String.fromCharCode((15&P)<<12|(63&h)<<6|63&U),Y+=3);return e}},md=[],To=[],Pl=C.Math={generateUUID:function(){for(var l=[],J=0;256>J;J++)l[J]=(16>J?"0":"")+J.toString(16).toUpperCase();return function(){var e=0|4294967295*Math.random(),X=0|4294967295*Math.random(),W=0|4294967295*Math.random(),L=0|4294967295*Math.random();return l[255&e]+l[255&e>>8]+l[255&e>>16]+l[255&e>>24]+"-"+l[255&X]+l[255&X>>8]+"-"+l[64|15&X>>16]+l[255&X>>24]+"-"+l[128|63&W]+l[255&W>>8]+"-"+l[255&W>>16]+l[255&W>>24]+l[255&L]+l[255&L>>8]+l[255&L>>16]+l[255&L>>24]}}(),clamp:function(E,z,k){return Math.max(z,Math.min(k,E))},generateIncreasingID:function(){var n=0;return function(){return++n}}(),encodeBase64:function(B,Z){return dk.encode(B,Z||om)},decodeBase64:function(H,R){return dk.decode(H,R||om)},randomArray:function(k,Y){Y=Y||k.length;for(var E=Y-1;E>0;E--){var M=Math.floor(Math.random()*(E+1)),c=k[E];k[E]=k[M],k[M]=c}return k},randomInt:function(G,_){return _===$&&(_=G,G=0),G+Math.floor(Math.random()*(_-G))},isPOT:function(M){return M>0&&0===(M-1&M)},nearestPOT:function(_){if(!_)return 1;var U=_;U--,U|=U>>1,U|=U>>2,U|=U>>4,U|=U>>8,U|=U>>16,U++;var Z=U>>1;return _-Z>U-_?U:Z},requestMatrix4:function(){return md.length>0?md.pop():new Pl.Matrix4},releaseMatrix4:function(V){md.push(V)},requestVector3:function(){return To.length>0?To.pop():new Pl.Vector3},releaseVector3:function(h){To.push(h)}},Ge=C.Matrix=C.Math.Matrix2d=function(T,s,X,q,g){this.setFromTransform(T,s,X,q,g)},qf=Ge;Ge.prototype={},Ge.prototype.constructor=Ge,Ge.prototype.set=function(j,s,W,c,I,K){return this.a=j,this.b=s,this.c=W,this.d=c,this.tx=I,this.ty=K,this},Ge.prototype.setFromTransform=function(h,q,c,X,j){var y=this;if(h===$)return y.a=1,y.b=0,y.c=0,y.d=1,y.tx=0,y.ty=0,void 0;var L,B;return h?(L=w(h),B=D(h)):(L=0,B=1),X=X||1,j=j||1,y.a=B*X,y.b=L*X,y.c=-L*j,y.d=B*j,y.tx=q||0,y.ty=c||0,y},Ge.prototype.apply=function(V,_){_=_||new kp;var H=V.x,a=V.y;return _.x=this.a*H+this.c*a+this.tx,_.y=this.b*H+this.d*a+this.ty,_},Ge.prototype.applyInverse=function(z,q){q=q||new kp;var A=1/(this.a*this.d+this.c*-this.b),Y=z.x,r=z.y;return q.x=this.d*A*Y+-this.c*A*r+(this.ty*this.c-this.tx*this.d)*A,q.y=this.a*A*r+-this.b*A*Y+(-this.ty*this.a+this.tx*this.b)*A,q},Ge.prototype.translate=function(O,J){return this.tx+=O,this.ty+=J,this},Ge.prototype.scale=function(D,k){return this.a*=D,this.d*=k,this.c*=D,this.b*=k,this.tx*=D,this.ty*=k,this},Ge.prototype.rotate=function(G){var T=Math.cos(G),F=Math.sin(G),e=this.a,c=this.c,Z=this.tx;return this.a=e*T-this.b*F,this.b=e*F+this.b*T,this.c=c*T-this.d*F,this.d=c*F+this.d*T,this.tx=Z*T-this.ty*F,this.ty=Z*F+this.ty*T,this},Ge.prototype.appendTranslate=function(P,r){return this.tx+=this.a*P+this.c*r,this.ty+=this.b*P+this.d*r,this},Ge.prototype.appendScale=function(q,E){return this.a*=q,this.d*=E,this.c*=E,this.b*=q,this},Ge.prototype.appendRotate=function(B){if(!B)return this;var A=Math.cos(B),H=Math.sin(B),K=this.a,L=this.b;return this.a=K*A+this.c*H,this.b=L*A+this.d*H,this.c=-K*H+this.c*A,this.d=-L*H+this.d*A,this},Ge.prototype.append=function(B){var y=this.a,o=this.b,D=this.c,E=this.d;return this.a=B.a*y+B.b*D,this.b=B.a*o+B.b*E,this.c=B.c*y+B.d*D,this.d=B.c*o+B.d*E,this.tx=B.tx*y+B.ty*D+this.tx,this.ty=B.tx*o+B.ty*E+this.ty,this},Ge.prototype.setTransform=function(H,q,C,P,U,D,Q,$,G){var O,n,Y,I,k,m,v,c,w,j;return k=Math.sin(Q),m=Math.cos(Q),v=Math.cos(G),c=Math.sin(G),w=-Math.sin($),j=Math.cos($),O=m*U,n=k*U,Y=-k*D,I=m*D,this.a=v*O+c*Y,this.b=v*n+c*I,this.c=w*O+j*Y,this.d=w*n+j*I,this.tx=H+(C*O+P*Y),this.ty=q+(C*n+P*I),this},Ge.prototype.prepend=function(A){var e=this.tx;if(1!==A.a||0!==A.b||0!==A.c||1!==A.d){var j=this.a,m=this.c;this.a=j*A.a+this.b*A.c,this.b=j*A.b+this.b*A.d,this.c=m*A.a+this.d*A.c,this.d=m*A.b+this.d*A.d}return this.tx=e*A.a+this.ty*A.c+A.tx,this.ty=e*A.b+this.ty*A.d+A.ty,this},Ge.prototype.transform=Ge.prototype.prepend,Ge.prototype.invert=function(){var W=this.a,b=this.b,p=this.c,M=this.d,Q=this.tx,k=W*M-b*p;return this.a=M/k,this.b=-b/k,this.c=-p/k,this.d=W/k,this.tx=(p*this.ty-M*Q)/k,this.ty=-(W*this.ty-b*Q)/k,this},Ge.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Ge.prototype.clone=function(){var U=new Ge;return U.a=this.a,U.b=this.b,U.c=this.c,U.d=this.d,U.tx=this.tx,U.ty=this.ty,U},Ge.prototype.copy=function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},Ge.prototype.tf=function(i,n){1===arguments.length&&(n=i.y,i=i.x);var Y=this;return{x:Y.a*i+Y.c*n+Y.tx,y:Y.b*i+Y.d*n+Y.ty}},Ge.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},Ge.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},Ge.prototype.tfi=function(B,G){1===arguments.length&&(G=B.y,B=B.x);var Z=this,C=1/(Z.a*Z.d+Z.c*-Z.b);return{x:Z.d*C*B+-Z.c*C*G+(Z.ty*Z.c-Z.tx*Z.d)*C,y:Z.a*C*G+-Z.b*C*B+(-Z.ty*Z.a+Z.tx*Z.b)*C}},Ge.IDENTITY=new Ge,Ge.TEMP_MATRIX=new Ge;var fh=C.Math.Quaternion=function(C,q,Y,D){this.set(C,q,Y,D)};e.assign(fh.prototype,{set:function(s,W,b,r){var M=this;return M._x=s||0,M._y=W||0,M._z=b||0,M._w=r!==$?r:1,M},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(o){var S=this;return S._x=o._x,S._y=o._y,S._z=o._z,S._w=o._w,S},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(U){return this._x*U._x+this._y*U._y+this._z*U._z+this._w*U._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var m=this.length();return 0===m?(this._x=0,this._y=0,this._z=0,this._w=1):(m=1/m,this._x=this._x*m,this._y=this._y*m,this._z=this._z*m,this._w=this._w*m),this},fromArray:function(f,W){W===$&&(W=0);var O=this;return O._x=f[W],O._y=f[W+1],O._z=f[W+2],O._w=f[W+3],this},slerp:function(V,w){if(0===w)return this;if(1===w)return this.copy(V);var M=this._x,u=this._y,P=this._z,J=this._w,l=J*V._w+M*V._x+u*V._y+P*V._z;if(0>l?(this._w=-V._w,this._x=-V._x,this._y=-V._y,this._z=-V._z,l=-l):this.copy(V),l>=1)return this._w=J,this._x=M,this._y=u,this._z=P,this;var k=Math.sqrt(1-l*l);if(Math.abs(k)<.001)return this._w=.5*(J+this._w),this._x=.5*(M+this._x),this._y=.5*(u+this._y),this._z=.5*(P+this._z),this;var t=Math.atan2(k,l),I=Math.sin((1-w)*t)/k,f=Math.sin(w*t)/k;return this._w=J*I+this._w*f,this._x=M*I+this._x*f,this._y=u*I+this._y*f,this._z=P*I+this._z*f,this},setFromAxisAngle:function(z,u){var J=u/2,P=Math.sin(J);return this._x=z.x*P,this._y=z.y*P,this._z=z.z*P,this._w=Math.cos(J),this},setFromEuler:function(O){var k=O._x,y=O._y,l=O._z,G=O._order,s=Math.cos,n=Math.sin,z=s(k/2),Q=s(y/2),H=s(l/2),K=n(k/2),g=n(y/2),E=n(l/2);return"XYZ"===G?(this._x=K*Q*H+z*g*E,this._y=z*g*H-K*Q*E,this._z=z*Q*E+K*g*H,this._w=z*Q*H-K*g*E):"YXZ"===G?(this._x=K*Q*H+z*g*E,this._y=z*g*H-K*Q*E,this._z=z*Q*E-K*g*H,this._w=z*Q*H+K*g*E):"ZXY"===G?(this._x=K*Q*H-z*g*E,this._y=z*g*H+K*Q*E,this._z=z*Q*E+K*g*H,this._w=z*Q*H-K*g*E):"ZYX"===G?(this._x=K*Q*H-z*g*E,this._y=z*g*H+K*Q*E,this._z=z*Q*E-K*g*H,this._w=z*Q*H+K*g*E):"YZX"===G?(this._x=K*Q*H+z*g*E,this._y=z*g*H+K*Q*E,this._z=z*Q*E-K*g*H,this._w=z*Q*H-K*g*E):"XZY"===G&&(this._x=K*Q*H-z*g*E,this._y=z*g*H-K*Q*E,this._z=z*Q*E+K*g*H,this._w=z*Q*H+K*g*E),this},setFromRotationMatrix:function(y){var h,q=y.el,G=q[0],X=q[4],A=q[8],$=q[1],S=q[5],o=q[9],O=q[2],K=q[6],r=q[10],d=G+S+r;return d>0?(h=.5/Math.sqrt(d+1),this._w=.25/h,this._x=(K-o)*h,this._y=(A-O)*h,this._z=($-X)*h):G>S&&G>r?(h=2*Math.sqrt(1+G-S-r),this._w=(K-o)/h,this._x=.25*h,this._y=(X+$)/h,this._z=(A+O)/h):S>r?(h=2*Math.sqrt(1+S-G-r),this._w=(A-O)/h,this._x=(X+$)/h,this._y=.25*h,this._z=(o+K)/h):(h=2*Math.sqrt(1+r-G-S),this._w=($-X)/h,this._x=(A+O)/h,this._y=(o+K)/h,this._z=.25*h),this},setFromToVectors:function(){var P,R;return function(l,H){return P===$&&(P=new Qe),R=l.dot(H)+1,1e-7>R?(R=0,Math.abs(l.x)>Math.abs(l.z)?P.set(-l.y,l.x,0):P.set(0,-l.z,l.y)):P.crossVectors(l,H),this._x=P.x,this._y=P.y,this._z=P.z,this._w=R,this.normalize()}}(),setFromUnitVectors:function(){var U,r,V=1e-6;return function(g,R){return U===$&&(U=new Qe),r=g.dot(R)+1,V>r?(r=0,Math.abs(g.x)>Math.abs(g.z)?U.set(-g.y,g.x,0):U.set(0,-g.z,g.y)):U.crossVectors(g,R),this._x=U.x,this._y=U.y,this._z=U.z,this._w=r,this.normalize()}}(),multiply:function(K){return this.multiplyQuaternions(this,K)},premultiply:function(V){return this.multiplyQuaternions(V,this)},multiplyQuaternions:function(y,F){var v=y._x,i=y._y,Q=y._z,w=y._w,f=F._x,a=F._y,L=F._z,J=F._w;return this._x=v*J+w*f+i*L-Q*a,this._y=i*J+w*a+Q*f-v*L,this._z=Q*J+w*L+v*a-i*f,this._w=w*J-v*f-i*a-Q*L,this},toArray:function(e,S){return e||(e=[]),S=S||0,e[S]=this._x,e[S+1]=this._y,e[S+2]=this._z,e[S+3]=this._w,e},fromArray:function(D,k){return k=k||0,this._x=D[k],this._y=D[k+1],this._z=D[k+2],this._w=D[k+3],this}});var Wl=C.Math.Vector4=function(L,l,N,j){this.x=L||0,this.y=l||0,this.z=N||0,this.w=j!==$?j:1};e.assign(Wl.prototype,{isVector4:!0,set:function(T,k,N,e){return this.x=T,this.y=k,this.z=N,this.w=e,this},setScalar:function(L){return this.x=L,this.y=L,this.z=L,this.w=L,this},setX:function(W){return this.x=W,this},setY:function(B){return this.y=B,this},setZ:function(R){return this.z=R,this},setW:function(u){return this.w=u,this},setComponent:function(x,p){switch(x){case 0:this.x=p;break;case 1:this.y=p;break;case 2:this.z=p;break;case 3:this.w=p;break;default:throw new Error("index is out of range: "+x)}return this},getComponent:function(h){switch(h){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+h)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(g){return this.x=g.x,this.y=g.y,this.z=g.z,this.w=g.w!==$?g.w:1,this},add:function(u,d){return d!==$?this.addVectors(u,d):(this.x+=u.x,this.y+=u.y,this.z+=u.z,this.w+=u.w,this)},addScalar:function(T){return this.x+=T,this.y+=T,this.z+=T,this.w+=T,this},addVectors:function(E,A){return this.x=E.x+A.x,this.y=E.y+A.y,this.z=E.z+A.z,this.w=E.w+A.w,this},addScaledVector:function(y,J){return this.x+=y.x*J,this.y+=y.y*J,this.z+=y.z*J,this.w+=y.w*J,this},sub:function(w,T){return T!==$?this.subVectors(w,T):(this.x-=w.x,this.y-=w.y,this.z-=w.z,this.w-=w.w,this)},subScalar:function(g){return this.x-=g,this.y-=g,this.z-=g,this.w-=g,this},subVectors:function(T,e){return this.x=T.x-e.x,this.y=T.y-e.y,this.z=T.z-e.z,this.w=T.w-e.w,this},multiplyScalar:function(R){return this.x*=R,this.y*=R,this.z*=R,this.w*=R,this},applyMatrix4:function(X){var v=this.x,T=this.y,n=this.z,h=this.w,u=X.el;return this.x=u[0]*v+u[4]*T+u[8]*n+u[12]*h,this.y=u[1]*v+u[5]*T+u[9]*n+u[13]*h,this.z=u[2]*v+u[6]*T+u[10]*n+u[14]*h,this.w=u[3]*v+u[7]*T+u[11]*n+u[15]*h,this},divideScalar:function(v){return this.multiplyScalar(1/v)},setAxisAngleFromQuaternion:function(A){this.w=2*Math.acos(A.w);var i=Math.sqrt(1-A.w*A.w);return 1e-4>i?(this.x=1,this.y=0,this.z=0):(this.x=A.x/i,this.y=A.y/i,this.z=A.z/i),this},setAxisAngleFromRotationMatrix:function(w){var j,f,E,n,T=.01,B=.1,C=w.el,_=C[0],F=C[4],Y=C[8],K=C[1],N=C[5],i=C[9],S=C[2],b=C[6],r=C[10];if(Math.abs(F-K)<T&&Math.abs(Y-S)<T&&Math.abs(i-b)<T){if(Math.abs(F+K)<B&&Math.abs(Y+S)<B&&Math.abs(i+b)<B&&Math.abs(_+N+r-3)<B)return this.set(1,0,0,0),this;j=Math.PI;var D=(_+1)/2,h=(N+1)/2,L=(r+1)/2,l=(F+K)/4,J=(Y+S)/4,M=(i+b)/4;return D>h&&D>L?T>D?(f=0,E=.707106781,n=.707106781):(f=Math.sqrt(D),E=l/f,n=J/f):h>L?T>h?(f=.707106781,E=0,n=.707106781):(E=Math.sqrt(h),f=l/E,n=M/E):T>L?(f=.707106781,E=.707106781,n=0):(n=Math.sqrt(L),f=J/n,E=M/n),this.set(f,E,n,j),this}var R=Math.sqrt((b-i)*(b-i)+(Y-S)*(Y-S)+(K-F)*(K-F));return Math.abs(R)<.001&&(R=1),this.x=(b-i)/R,this.y=(Y-S)/R,this.z=(K-F)/R,this.w=Math.acos((_+N+r-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(O){return this.x=Math.max(this.x,O.x),this.y=Math.max(this.y,O.y),this.z=Math.max(this.z,O.z),this.w=Math.max(this.w,O.w),this},clamp:function(C,V){return this.x=Math.max(C.x,Math.min(V.x,this.x)),this.y=Math.max(C.y,Math.min(V.y,this.y)),this.z=Math.max(C.z,Math.min(V.z,this.z)),this.w=Math.max(C.w,Math.min(V.w,this.w)),this},clampScalar:function(){var T,N;return function(u,F){return T===$&&(T=new Wl,N=new Wl),T.set(u,u,u,u),N.set(F,F,F,F),this.clamp(T,N)}}(),clampLength:function(N,b){var f=this.length();return this.divideScalar(f||1).multiplyScalar(Math.max(N,Math.min(b,f)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(C){return this.x*C.x+this.y*C.y+this.z*C.z+this.w*C.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(n){return this.normalize().multiplyScalar(n)},lerp:function(R,V){return this.x+=(R.x-this.x)*V,this.y+=(R.y-this.y)*V,this.z+=(R.z-this.z)*V,this.w+=(R.w-this.w)*V,this},lerpVectors:function(H,v,z){return this.subVectors(v,H).multiplyScalar(z).add(H)},equals:function(Z){return Z.x===this.x&&Z.y===this.y&&Z.z===this.z&&Z.w===this.w},fromArray:function(S,c){return c===$&&(c=0),this.x=S[c],this.y=S[c+1],this.z=S[c+2],this.w=S[c+3],this},toArray:function(b,p){return b===$&&(b=[]),p===$&&(p=0),b[p]=this.x,b[p+1]=this.y,b[p+2]=this.z,b[p+3]=this.w,b},fromBufferAttribute:function(r,D){return this.x=r.getX(D),this.y=r.getY(D),this.z=r.getZ(D),this.w=r.getW(D),this
}});var Qe=C.Math.Vector3=function(J,A,s){J===$?(this.x=0,this.y=0,this.z=0):"object"==typeof J?this.copy(J):this.set(J,A==$?J:A,s==$?J:s)},Qo=C.Math.Vector3;e.assign(Qe.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(l,Z,_){return this.x=l,this.y=Z,this.z=_,this},equals:function(p){return p&&this.x===p.x&&this.y===p.y&&this.z===p.z},setScalar:function(Z){return this.x=Z,this.y=Z,this.z=Z,this},setX:function(K){return this.x=K,this},setY:function(e){return this.y=e,this},setZ:function(d){return this.z=d,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(v){return v.x===$?(this.x=v[0],this.y=v[1],this.z=v[2]):(this.x=v.x,this.y=v.y,this.z=v.z||0),this},add:function(b){return this.x+=b.x,this.y+=b.y,this.z+=b.z,this},addScalar:function(r){return this.x+=r,this.y+=r,this.z+=r,this},addVectors:function(i,T){return this.x=i.x+T.x,this.y=i.y+T.y,this.z=i.z+T.z,this},addScaledVector:function(y,I){return this.x+=y.x*I,this.y+=y.y*I,this.z+=y.z*I,this},sub:function(L){return this.x-=L.x,this.y-=L.y,this.z-=L.z,this},subScalar:function(Z){return this.x-=Z,this.y-=Z,this.z-=Z,this},subVectors:function(X,T){return this.x=X.x-T.x,this.y=X.y-T.y,this.z=X.z-T.z,this},divide:function(r){return this.x/=r.x,this.y/=r.y,this.z/=r.z,this},multiply:function(P){return this.x*=P.x,this.y*=P.y,this.z*=P.z,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},divideScalar:function(X){if(0!==X){var p=1/X;this.x*=p,this.y*=p,this.z*=p}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(x){return Math.sqrt(this.distanceToSquared(x))},distanceToSquared:function(R){var V=this.x-R.x,W=this.y-R.y,N=this.z-R.z;return V*V+W*W+N*N},distanceToSquared2:function(K){var a=this.x-K[0],S=this.y-K[1],x=this.z-K[2];return a*a+S*S+x*x},divideVectors:function(s,F){return this.x=s.x/F.x,this.y=s.y/F.y,this.z=s.z/F.z,this},multiplyVectors:function(u,L){return this.x=u.x*L.x,this.y=u.y*L.y,this.z=u.z*L.z,this},transformDirection:function(U){var r=this.x,u=this.y,t=this.z,q=U.el;return this.x=q[0]*r+q[4]*u+q[8]*t,this.y=q[1]*r+q[5]*u+q[9]*t,this.z=q[2]*r+q[6]*u+q[10]*t,this.normalize()},applyAxisAngle:function(){var g=new fh;return function(s,D){return this.applyQuaternion(g.setFromAxisAngle(s,D))}}(),applyEuler:function(){var E=new fh;return function(f){return this.applyQuaternion(E.setFromEuler(f))}}(),applyQuaternion:function($){var o=this.x,O=this.y,Y=this.z,B=$._x,N=$._y,F=$._z,r=$._w,f=r*o+N*Y-F*O,m=r*O+F*o-B*Y,w=r*Y+B*O-N*o,K=-B*o-N*O-F*Y;return this.x=f*r+K*-B+m*-F-w*-N,this.y=m*r+K*-N+w*-B-f*-F,this.z=w*r+K*-F+f*-N-m*-B,this},applyMatrix4:function(Q){var P=this.x,y=this.y,U=this.z,S=Q.el,z=1/(S[3]*P+S[7]*y+S[11]*U+S[15]);return this.x=(S[0]*P+S[4]*y+S[8]*U+S[12])*z,this.y=(S[1]*P+S[5]*y+S[9]*U+S[13])*z,this.z=(S[2]*P+S[6]*y+S[10]*U+S[14])*z,this},applyMatrix3:function(m){var p=this.x,I=this.y,l=this.z,g=m.el;return this.x=g[0]*p+g[3]*I+g[6]*l,this.y=g[1]*p+g[4]*I+g[7]*l,this.z=g[2]*p+g[5]*I+g[8]*l,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var s=new Qe;return function(y){return this.sub(s.copy(y).multiplyScalar(2*this.dot(y)))}}(),dot:function(u){return this.x*u.x+this.y*u.y+this.z*u.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var q=this.length();return q?this.multiplyScalar(1/q):this},setLength:function(t){return this.normalize().multiplyScalar(t)},fromArray:function(t,A){return A===$&&(A=0),this.x=t[A],this.y=t[A+1],this.z=t[A+2],this},toArray:function(o,K){return o===$&&(o=[0,0,0]),K===$&&(K=0),o[K]=this.x,o[K+1]=this.y,o[K+2]=this.z,o},cross:function(w){return this.crossVectors(this,w)},angleTo:function(P){var n=this.dot(P)/Math.sqrt(this.lengthSq()*P.lengthSq());return n>1||-1>n?0:Math.acos(n)},lerp:function(D,t){return this.x+=(D.x-this.x)*t,this.y+=(D.y-this.y)*t,this.z+=(D.z-this.z)*t,this},lerpVectors:function(e,I,V){return this.subVectors(I,e).multiplyScalar(V).add(e)},crossVectors:function(c,i){var D=c.x,L=c.y,q=c.z,N=i.x,f=i.y,r=i.z;return this.x=L*r-q*f,this.y=q*N-D*r,this.z=D*f-L*N,this},min:function(s){return this.x=Math.min(this.x,s.x),this.y=Math.min(this.y,s.y),this.z=Math.min(this.z,s.z),this},max:function(E){return this.x=Math.max(this.x,E.x),this.y=Math.max(this.y,E.y),this.z=Math.max(this.z,E.z),this},setFromMatrixPosition:function(C){return this.setFromMatrixColumn(C,3)},setFromMatrixScale:function(n){var Y=this.setFromMatrixColumn(n,0).length(),c=this.setFromMatrixColumn(n,1).length(),K=this.setFromMatrixColumn(n,2).length();return this.x=Y,this.y=c,this.z=K,this},setFromMatrixColumn:function(Y,N){return this.fromArray(Y.el,4*N)}});var kp=C.Math.Vector2=function(K,B,e){"object"==typeof K&&(K.x!=$?(B=K.y,K=K.x,e=K.e):(e=K[2],B=K[1],K=K[0])),this.set(K||0,B||0,e)};kp.prototype={},kp.prototype.constructor=kp;var $o=kp;e.defineProperties(kp.prototype,{width:{get:function(){return this.x},set:function($){this.x=$}},height:{get:function(){return this.y},set:function(g){this.y=g}}}),kp.prototype.clone=function(){return new kp(this.x,this.y,this.e)},kp.prototype.copy=function(F){return this.set(F.x,F.y,F.e),this},kp.prototype.equals=function(y){return y.x===this.x&&y.y===this.y},kp.prototype.set=function(T,V,_){return this.x=T||0,this.y=V||(0!==V?this.x:0),_!=$&&(this.e=_),this},kp.prototype.setScalar=function(G){return this.x=G,this.y=G,this},kp.prototype.setX=function(I){return this.x=I||0,this},kp.prototype.setY=function(i){return this.y=i||0,this},kp.prototype.add=function(O){return this.x+=O.x,this.y+=O.y,this},kp.prototype.addVectors=function(J,B){return this.x=J.x+B.x,this.y=J.y+B.y,this},kp.prototype.addScalar=function(u){return this.x+=u,this.y+=u,this},kp.prototype.addScaledVector=function(B,$){return this.x+=B.x*$,this.y+=B.y*$,this},kp.prototype.sub=function(z){return this.x-=z.x,this.y-=z.y,this},kp.prototype.subScalar=function(h){return this.x-=h,this.y-=h,this},kp.prototype.subVectors=function(v,P){return this.x=v.x-P.x,this.y=v.y-P.y,this},kp.prototype.multiply=function(E){return this.x*=E.x,this.y*=E.y,this},kp.prototype.multiplyScalar=function(a){return this.x*=a,this.y*=a,this},kp.prototype.divide=function(s){return this.x/=s.x,this.y/=s.y,this},kp.prototype.divideScalar=function(c){return this.multiplyScalar(1/c)},kp.prototype.min=function(u){return this.x=Math.min(this.x,u.x),this.y=Math.min(this.y,u.y),this},kp.prototype.max=function(f){return this.x=Math.max(this.x,f.x),this.y=Math.max(this.y,f.y),this},kp.prototype.fromArray=function(L,t){return t===$&&(t=0),this.x=L[t],this.y=L[t+1],this},kp.prototype.clamp=function(n,l){return this.x=Math.max(n.x,Math.min(l.x,this.x)),this.y=Math.max(n.y,Math.min(l.y,this.y)),this},kp.prototype.clampScalar=function(){var K,M;return function(A,y){return K===$&&(K=new kp,M=new kp),K.set(A,A),M.set(y,y),this.clamp(K,M)}}(),kp.prototype.clampLength=function(C,X){var d=this.length();return this.multiplyScalar(Math.max(C,Math.min(X,d))/d)},kp.prototype.dot=function(m){return this.x*m.x+this.y*m.y},kp.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},kp.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},kp.prototype.normalize=function(){return this.divideScalar(this.length())},kp.prototype.angle=function(){var D=Math.atan2(this.y,this.x);return 0>D&&(D+=2*Math.PI),D},kp.prototype.distanceTo=function(B){return Math.sqrt(this.distanceToSquared(B))},kp.prototype.distanceToSquared=function(T){var m=this.x-T.x,H=this.y-T.y;return m*m+H*H},kp.prototype.isNearEnough=function(q){return this.distanceToSquared(q)<1e-8},kp.prototype.setLength=function(u){var E=this.length();return E?this.multiplyScalar(u/E):this},kp.prototype.lerp=function(u,X){return this.x+=(u.x-this.x)*X,this.y+=(u.y-this.y)*X,this},kp.prototype.lerpVectors=function(v,b,c){return this.subVectors(b,v).multiplyScalar(c).add(v)},kp.prototype.rotateAround=function(F,I){var R=F?F.x:0,r=F?F.y:0,$=Math.cos(I),M=Math.sin(I),j=this.x-R,h=this.y-r;return this.x=j*$-h*M+R,this.y=j*M+h*$+r,this};var zs=C.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};e.assign(zs.prototype,{isMatrix3:!0,set:function(O,u,H,F,S,L,Q,d,$){var I=this.el;return I[0]=O,I[1]=F,I[2]=Q,I[3]=u,I[4]=S,I[5]=d,I[6]=H,I[7]=L,I[8]=$,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(u){var z=this.el,W=u.el;return z[0]=W[0],z[1]=W[1],z[2]=W[2],z[3]=W[3],z[4]=W[4],z[5]=W[5],z[6]=W[6],z[7]=W[7],z[8]=W[8],this},setFromMatrix4:function(D){var T=D.el;return this.set(T[0],T[4],T[8],T[1],T[5],T[9],T[2],T[6],T[10]),this},applyToBufferAttribute:function(){var b=new Qe;return function(M){for(var K=0,C=M.count;C>K;K++)b.x=M.getX(K),b.y=M.getY(K),b.z=M.getZ(K),b.applyMatrix3(this),M.setXYZ(K,b.x,b.y,b.z);return M}}(),multiply:function(u){return this.multiplyMatrices(this,u)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(x,d){var P=x.el,B=d.el,j=this.el,H=P[0],Q=P[3],T=P[6],A=P[1],u=P[4],W=P[7],h=P[2],f=P[5],q=P[8],o=B[0],V=B[3],U=B[6],N=B[1],K=B[4],s=B[7],$=B[2],L=B[5],m=B[8];return j[0]=H*o+Q*N+T*$,j[3]=H*V+Q*K+T*L,j[6]=H*U+Q*s+T*m,j[1]=A*o+u*N+W*$,j[4]=A*V+u*K+W*L,j[7]=A*U+u*s+W*m,j[2]=h*o+f*N+q*$,j[5]=h*V+f*K+q*L,j[8]=h*U+f*s+q*m,this},multiplyScalar:function(O){var S=this.el;return S[0]*=O,S[3]*=O,S[6]*=O,S[1]*=O,S[4]*=O,S[7]*=O,S[2]*=O,S[5]*=O,S[8]*=O,this},determinant:function(){var e=this.el,$=e[0],G=e[1],o=e[2],S=e[3],z=e[4],W=e[5],d=e[6],n=e[7],g=e[8];return $*z*g-$*W*n-G*S*g+G*W*d+o*S*n-o*z*d},getInverse:function(I){var O=I.el,o=this.el,r=O[0],h=O[1],p=O[2],n=O[3],F=O[4],D=O[5],a=O[6],H=O[7],s=O[8],B=s*F-D*H,j=D*a-s*n,G=H*n-F*a,M=r*B+h*j+p*G;if(0===M)return this.identity();var _=1/M;return o[0]=B*_,o[1]=(p*H-s*h)*_,o[2]=(D*h-p*F)*_,o[3]=j*_,o[4]=(s*r-p*a)*_,o[5]=(p*n-D*r)*_,o[6]=G*_,o[7]=(h*a-H*r)*_,o[8]=(F*r-h*n)*_,this},transpose:function(){var x,u=this.el;return x=u[1],u[1]=u[3],u[3]=x,x=u[2],u[2]=u[6],u[6]=x,x=u[5],u[5]=u[7],u[7]=x,this},getNormalMatrix:function(i){return this.setFromMatrix4(i).getInverse(this).transpose()},transposeIntoArray:function(m){var t=this.el;return m[0]=t[0],m[1]=t[3],m[2]=t[6],m[3]=t[1],m[4]=t[4],m[5]=t[7],m[6]=t[2],m[7]=t[5],m[8]=t[8],this},setUvTransform:function(i,u,d,F,E,c,Q){var s=Math.cos(E),N=Math.sin(E);this.set(d*s,d*N,-d*(s*c+N*Q)+c+i,-F*N,F*s,-F*(-N*c+s*Q)+Q+u,0,0,1)},scale:function(h,U){var o=this.el;return o[0]*=h,o[3]*=h,o[6]*=h,o[1]*=U,o[4]*=U,o[7]*=U,this},rotate:function(j){var S=Math.cos(j),d=Math.sin(j),h=this.el,Y=h[0],$=h[3],P=h[6],E=h[1],F=h[4],t=h[7];return h[0]=S*Y+d*E,h[3]=S*$+d*F,h[6]=S*P+d*t,h[1]=-d*Y+S*E,h[4]=-d*$+S*F,h[7]=-d*P+S*t,this},translate:function(l,y){var u=this.el;return u[0]+=l*u[2],u[3]+=l*u[5],u[6]+=l*u[8],u[1]+=y*u[2],u[4]+=y*u[5],u[7]+=y*u[8],this},equals:function(h){for(var M=this.el,U=h.el,A=0;9>A;A++)if(M[A]!==U[A])return!1;return!0},fromArray:function(i,J){J===$&&(J=0);for(var E=0;9>E;E++)this.el[E]=i[E+J];return this},toArray:function(K,U){K===$&&(K=[]),U===$&&(U=0);var h=this.el;return K[U]=h[0],K[U+1]=h[1],K[U+2]=h[2],K[U+3]=h[3],K[U+4]=h[4],K[U+5]=h[5],K[U+6]=h[6],K[U+7]=h[7],K[U+8]=h[8],K}});var Xq=C.Math.Plane=function(z,n){this.normal=z!==$?z:new Qe(1,0,0),this.constant=n!==$?n:0};e.assign(Xq.prototype,{set:function(y,x){return this.normal.copy(y),this.constant=x,this},setComponents:function(B,M,p,C){return this.normal.set(B,M,p),this.constant=C,this},setFromNormalAndCoplanarPoint:function(D,n){return this.normal.copy(D),this.constant=-n.dot(this.normal),this},setFromCoplanarPoints:function(){var a=new Qe,o=new Qe;return function(N,F,q){var e=a.subVectors(q,F).cross(o.subVectors(N,F)).normalize();return this.setFromNormalAndCoplanarPoint(e,N),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(_){return this.normal.copy(_.normal),this.constant=_.constant,this},normalize:function(){var Q=1/this.normal.length();return this.normal.multiplyScalar(Q),this.constant*=Q,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(m){return this.normal.dot(m)+this.constant},distanceToSphere:function(h){return this.distanceToPoint(h.center)-h.radius},projectPoint:function(q,g){return g===$&&(g=new Qe),g.copy(this.normal).multiplyScalar(-this.distanceToPoint(q)).add(q)},intersectLine:function(){var J=new Qe;return function(s,m){m===$&&(m=new Qe);var O=s.delta(J),o=this.normal.dot(O);if(0===o)return 0===this.distanceToPoint(s.start)?m.copy(s.start):$;var g=-(s.start.dot(this.normal)+this.constant)/o;return 0>g||g>1?$:m.copy(O).multiplyScalar(g).add(s.start)}}(),intersectsLine:function(P){var t=this.distanceToPoint(P.start),v=this.distanceToPoint(P.end);return 0>t&&v>0||0>v&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(N){return N.intersectsPlane(this)},coplanarPoint:function(o){return o===$&&(o=new Qe),o.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var w=new Qe,O=new zs;return function(V,a){var m=a||O.getNormalMatrix(V),i=this.coplanarPoint(w).applyMatrix4(V),D=this.normal.applyMatrix3(m).normalize();return this.constant=-i.dot(D),this}}(),translate:function(s){return this.constant-=s.dot(this.normal),this},equals:function(N){return N.normal.equals(this.normal)&&N.constant===this.constant}});var bd=C.Math.Ray=function(O,q){this.origin=O!==$?O.clone():new Qe,this.direction=q!==$?q.clone():new Qe};e.assign(bd.prototype,{set:function(k,S){return this.origin.copy(k),this.direction.copy(S),this},clone:function(){return(new this.constructor).copy(this)},copy:function(H){return this.origin.copy(H.origin),this.direction.copy(H.direction),this.maxHitLen=H.maxHitLen,this},at:function(o,z){var E=z||new Qe;return E.copy(this.direction).multiplyScalar(o).add(this.origin)},setMaxHitLength:function(o){this.maxHitLen=o},lookAt:function(B){return this.direction.copy(B).sub(this.origin).normalize(),this},applyMatrix4:function(I){var f=this.maxHitLen;if(f){var q=this.direction.clone().multiplyScalar(f).add(this.origin);q.applyMatrix4(I)}return this.origin.applyMatrix4(I),this.direction.transformDirection(I),f&&(this.maxHitLen=this.origin.distanceTo(q)),this},distanceToPlane:function(I){var k=I.normal.dot(this.direction);if(0===k)return 0===I.distanceToPoint(this.origin)?0:null;var M=-(this.origin.dot(I.normal)+I.constant)/k;return M>=0?M:null},intersectPlane:function(E,Q){var q=this.distanceToPlane(E);return null===q?null:this.at(q,Q)},intersectSphere:function(){var $=new Qe;return function(F,k){$.subVectors(F.center,this.origin);var f=$.dot(this.direction),M=$.dot($)-f*f,H=F.radius*F.radius;if(M>H)return null;var n=Math.sqrt(H-M),D=f-n,l=f+n;return 0>D&&0>l?null:0>D?this.at(l,k):this.at(D,k)}}(),intersectEllipsoid:function(){var R=new Qe,Z=new Qe;return function(O,L){R.subVectors(O.center,this.origin),R.divide(O.radius),Z.divideVectors(this.direction,O.radius);var Q=Z.lengthSq(),s=R.dot(Z),t=R.dot(R)*Q-s*s;if(t>Q)return null;var m=Math.sqrt(Q-t),c=(s-m)/Q,C=(s+m)/Q;return 0>c&&0>C?null:0>c?this.at(C,L):this.at(c,L)}}(),intersectBox:function(o,F){var W,A,G,r,m,K,C=1/this.direction.x,y=1/this.direction.y,S=1/this.direction.z,d=this.origin;if(C>=0?(W=(o.min.x-d.x)*C,A=(o.max.x-d.x)*C):(W=(o.max.x-d.x)*C,A=(o.min.x-d.x)*C),y>=0?(G=(o.min.y-d.y)*y,r=(o.max.y-d.y)*y):(G=(o.max.y-d.y)*y,r=(o.min.y-d.y)*y),W>r||G>A)return null;if((G>W||W!==W)&&(W=G),(A>r||A!==A)&&(A=r),S>=0?(m=(o.min.z-d.z)*S,K=(o.max.z-d.z)*S):(m=(o.max.z-d.z)*S,K=(o.min.z-d.z)*S),W>K||m>A)return null;if((m>W||W!==W)&&(W=m),(A>K||A!==A)&&(A=K),0>A)return null;var v=W>=0?W:A,T=this.maxHitLen;return T&&v>T?null:this.at(v,F)},intersectTriangle:function(){var m=new Qe,f=new Qe,v=new Qe,p=new Qe;return function(i,u,l,e,J){f.subVectors(u,i),v.subVectors(l,i),p.crossVectors(f,v);var R,H=this.direction.dot(p);if(H>0){if(e)return null;R=1}else{if(!(0>H))return null;R=-1,H=-H}m.subVectors(this.origin,i);var _=R*this.direction.dot(v.crossVectors(m,v));if(0>_)return null;var b=R*this.direction.dot(f.cross(m));if(0>b||_+b>H)return null;var k=-R*m.dot(p);if(0>k)return null;var V=k/H,C=this.maxHitLen;return C&&V>C?null:this.at(V,J)}}()});var ss=C.Math.Box3=function(i,Y){this.min=i!==$?i:new Qe(1/0,1/0,1/0),this.max=Y!==$?Y:new Qe(-1/0,-1/0,-1/0)};e.assign(ss.prototype,{set:function(Q,n){return this.min.copy(Q),this.max.copy(n),this},setFromArray:function(v){for(var B=1/0,y=1/0,x=1/0,L=-1/0,a=-1/0,f=-1/0,r=0,I=v.length;I>r;r+=3){var d=v[r],u=v[r+1],U=v[r+2];B>d&&(B=d),y>u&&(y=u),x>U&&(x=U),d>L&&(L=d),u>a&&(a=u),U>f&&(f=U)}return this.min.set(B,y,x),this.max.set(L,a,f),this},setFromPoints:function(P){this.makeEmpty();for(var b=0,L=P.length;L>b;b++)this.expandByPoint(P[b]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(z){return z.max.x<this.min.x||z.min.x>this.max.x||z.max.y<this.min.y||z.min.y>this.max.y||z.max.z<this.min.z||z.min.z>this.max.z?!1:!0},copy:function(u){return this.min.copy(u.min),this.max.copy(u.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByBox:function(s){return this.min.min(s.min),this.max.max(s.max),this},applyMatrix4:function(){var g=[new Qe,new Qe,new Qe,new Qe,new Qe,new Qe,new Qe,new Qe];return function(K){return this.isEmpty()?this:(g[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(K),g[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(K),g[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(K),g[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(K),g[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(K),g[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(K),g[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(K),g[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(K),this.setFromPoints(g),this)}}()});var ep=C.Math.Sphere=function(k,d){this.center=k!==$?k:new Qe,this.radius=d!==$?d:0};e.assign(ep.prototype,{set:function(i,Z){return this.center.copy(i),this.radius=Z,this},setFromPoints:function(){var G=new ss;return function(r,O){var k=this.center;O!==$?k.copy(O):G.setFromPoints(r).getCenter(k);for(var I=0,F=0,S=r.length;S>F;F++)I=Math.max(I,k.distanceToSquared(r[F]));return this.radius=Math.sqrt(I),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(q){return this.center.copy(q.center),this.radius=q.radius,this},empty:function(){return this.radius<=0},containsPoint:function(o){return o.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(V){return V.distanceTo(this.center)-this.radius},intersectsSphere:function(A){var P=this.radius+A.radius;return A.center.distanceToSquared(this.center)<=P*P},intersectsBox:function(D){return D.intersectsSphere(this)},intersectsPlane:function(p){return Math.abs(p.distanceToPoint(this.center))<=this.radius},clampPoint:function(R,t){var g=this.center.distanceToSquared(R);return t===$&&(t=new Qe),t.copy(R),g>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(D){return D===$&&(D=new ss),D.set(this.center,this.center),D.expandByScalar(this.radius),D},applyMatrix4:function(h){return this.center.applyMatrix4(h),this.radius=this.radius*h.getMaxScaleOnAxis(),this},translate:function(P){return this.center.add(P),this},equals:function(i){return i.center.equals(this.center)&&i.radius===this.radius}});var as=C.Math.Frustum=function(v,G,Q,U,C,o){this.planes=[v!==$?v:new Xq,G!==$?G:new Xq,Q!==$?Q:new Xq,U!==$?U:new Xq,C!==$?C:new Xq,o!==$?o:new Xq]};e.assign(as.prototype,{set:function(G,c,I,k,i,b){var D=this.planes;return D[0].copy(G),D[1].copy(c),D[2].copy(I),D[3].copy(k),D[4].copy(i),D[5].copy(b),this},clone:function(){return(new this.constructor).copy(this)},copy:function(w){for(var r=this.planes,I=0;6>I;I++)r[I].copy(w.planes[I]);return this},setFromMatrix:function(z){var O=this.planes,n=z.el,s=n[0],k=n[1],w=n[2],K=n[3],X=n[4],A=n[5],t=n[6],N=n[7],E=n[8],Z=n[9],u=n[10],F=n[11],M=n[12],a=n[13],p=n[14],f=n[15];return O[0].setComponents(K-s,N-X,F-E,f-M).normalize(),O[1].setComponents(K+s,N+X,F+E,f+M).normalize(),O[2].setComponents(K+k,N+A,F+Z,f+a).normalize(),O[3].setComponents(K-k,N-A,F-Z,f-a).normalize(),O[4].setComponents(K-w,N-t,F-u,f-p).normalize(),O[5].setComponents(K+w,N+t,F+u,f+p).normalize(),this},intersectsObject:function(){var f=new ep;return function(p){var H=p.geometry;return null===H.boundingSphere&&H.computeBoundingSphere(),f.copy(H.boundingSphere).applyMatrix4(p.matrixWorld),this.intersectsSphere(f)}}(),intersectsSprite:function(){var j=new ep;return function(r){return j.center.set(0,0,0),j.radius=.7071067811865476,j.applyMatrix4(r.matrixWorld),this.intersectsSphere(j)}}(),intersectsSphere:function(I){for(var t=this.planes,J=I.center,o=-I.radius,Q=0;6>Q;Q++){var C=t[Q].distanceToPoint(J);if(o>C)return!1}return!0},intersectsBox:function(){var g=new Qe;return function(L){for(var o=this.planes,e=0;6>e;e++){var X=o[e];if(g.x=X.normal.x>0?L.max.x:L.min.x,g.y=X.normal.y>0?L.max.y:L.min.y,g.z=X.normal.z>0?L.max.z:L.min.z,X.distanceToPoint(g)<0)return!1}return!0}}(),containsPoint:function(y){for(var S=this.planes,O=0;6>O;O++)if(S[O].distanceToPoint(y)<0)return!1;return!0}});var hb=C.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};e.assign(hb.prototype,{set:function(d,t,m,U,v,p,f,o,r,i,x,H,M,s,E,A){var L=this.el;return L[0]=d,L[4]=t,L[8]=m,L[12]=U,L[1]=v,L[5]=p,L[9]=f,L[13]=o,L[2]=r,L[6]=i,L[10]=x,L[14]=H,L[3]=M,L[7]=s,L[11]=E,L[15]=A,this},clone:function(){return(new hb).fromArray(this.el)},fromArray:function(Z,w){w===$&&(w=0);for(var D=this.el,J=0;16>J;J++)D[J]=Z[J+w];return this},getElements:function(){return this.el},scale:function(k){var d=this.el,_=k.x,A=k.y,b=k.z;return d[0]*=_,d[4]*=A,d[8]*=b,d[1]*=_,d[5]*=A,d[9]*=b,d[2]*=_,d[6]*=A,d[10]*=b,d[3]*=_,d[7]*=A,d[11]*=b,this},makeRotationFromEuler:function(f){var i=this.el,W=f._x,y=f._y,F=f._z,a=f._order,r=Math.cos(W),$=Math.sin(W),T=Math.cos(y),L=Math.sin(y),j=Math.cos(F),Y=Math.sin(F);if("XYZ"===a){var w=r*j,q=r*Y,l=$*j,H=$*Y;i[0]=T*j,i[4]=-T*Y,i[8]=L,i[1]=q+l*L,i[5]=w-H*L,i[9]=-$*T,i[2]=H-w*L,i[6]=l+q*L,i[10]=r*T}else if("YXZ"===a){var G=T*j,J=T*Y,X=L*j,n=L*Y;i[0]=G+n*$,i[4]=X*$-J,i[8]=r*L,i[1]=r*Y,i[5]=r*j,i[9]=-$,i[2]=J*$-X,i[6]=n+G*$,i[10]=r*T}else if("ZXY"===a){var G=T*j,J=T*Y,X=L*j,n=L*Y;i[0]=G-n*$,i[4]=-r*Y,i[8]=X+J*$,i[1]=J+X*$,i[5]=r*j,i[9]=n-G*$,i[2]=-r*L,i[6]=$,i[10]=r*T}else if("ZYX"===a){var w=r*j,q=r*Y,l=$*j,H=$*Y;i[0]=T*j,i[4]=l*L-q,i[8]=w*L+H,i[1]=T*Y,i[5]=H*L+w,i[9]=q*L-l,i[2]=-L,i[6]=$*T,i[10]=r*T}else if("YZX"===a){var Z=r*T,N=r*L,h=$*T,O=$*L;i[0]=T*j,i[4]=O-Z*Y,i[8]=h*Y+N,i[1]=Y,i[5]=r*j,i[9]=-$*j,i[2]=-L*j,i[6]=N*Y+h,i[10]=Z-O*Y}else if("XZY"===a){var Z=r*T,N=r*L,h=$*T,O=$*L;i[0]=T*j,i[4]=-Y,i[8]=L*j,i[1]=Z*Y+O,i[5]=r*j,i[9]=N*Y-h,i[2]=h*Y-N,i[6]=$*j,i[10]=O*Y+Z}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},makeRotationFromQuaternion:function(S){var h=this.el,t=S._x,k=S._y,J=S._z,b=S._w,I=t+t,G=k+k,D=J+J,_=t*I,m=t*G,U=t*D,w=k*G,R=k*D,B=J*D,W=b*I,H=b*G,Z=b*D;return h[0]=1-(w+B),h[4]=m-Z,h[8]=U+H,h[1]=m+Z,h[5]=1-(_+B),h[9]=R-W,h[2]=U-H,h[6]=R+W,h[10]=1-(_+w),h[3]=0,h[7]=0,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(C){var Y=this.el,P=C.el,d=P[0],q=P[1],i=P[2],H=P[3],h=P[4],k=P[5],b=P[6],E=P[7],y=P[8],I=P[9],u=P[10],x=P[11],f=P[12],G=P[13],g=P[14],o=P[15],X=I*g*E-G*u*E+G*b*x-k*g*x-I*b*o+k*u*o,K=f*u*E-y*g*E-f*b*x+h*g*x+y*b*o-h*u*o,w=y*G*E-f*I*E+f*k*x-h*G*x-y*k*o+h*I*o,v=f*I*b-y*G*b-f*k*u+h*G*u+y*k*g-h*I*g,W=d*X+q*K+i*w+H*v;if(0===W)return this.identity();var t=1/W;return Y[0]=X*t,Y[1]=(G*u*H-I*g*H-G*i*x+q*g*x+I*i*o-q*u*o)*t,Y[2]=(k*g*H-G*b*H+G*i*E-q*g*E-k*i*o+q*b*o)*t,Y[3]=(I*b*H-k*u*H-I*i*E+q*u*E+k*i*x-q*b*x)*t,Y[4]=K*t,Y[5]=(y*g*H-f*u*H+f*i*x-d*g*x-y*i*o+d*u*o)*t,Y[6]=(f*b*H-h*g*H-f*i*E+d*g*E+h*i*o-d*b*o)*t,Y[7]=(h*u*H-y*b*H+y*i*E-d*u*E-h*i*x+d*b*x)*t,Y[8]=w*t,Y[9]=(f*I*H-y*G*H-f*q*x+d*G*x+y*q*o-d*I*o)*t,Y[10]=(h*G*H-f*k*H+f*q*E-d*G*E-h*q*o+d*k*o)*t,Y[11]=(y*k*H-h*I*H-y*q*E+d*I*E+h*q*x-d*k*x)*t,Y[12]=v*t,Y[13]=(y*G*i-f*I*i+f*q*u-d*G*u-y*q*g+d*I*g)*t,Y[14]=(f*k*i-h*G*i-f*q*b+d*G*b+h*q*g-d*k*g)*t,Y[15]=(h*I*i-y*k*i+y*q*b-d*I*b-h*q*u+d*k*u)*t,this},makeRotationAxis:function(o,C){var l=Math.cos(C),s=Math.sin(C),F=1-l,z=o.x,R=o.y,$=o.z,N=F*z,h=F*R;return this.set(N*z+l,N*R-s*$,N*$+s*R,0,N*R+s*$,h*R+l,h*$-s*z,0,N*$-s*R,h*$+s*z,F*$*$+l,0,0,0,0,1),this},multiply:function(P){return this.multiplyMatrices(this,P)},premultiply:function(Z){return this.multiplyMatrices(Z,this)},multiplyMatrices:function(C,D){var y=C.el,b=D.el,l=this.el,d=y[0],J=y[4],I=y[8],Z=y[12],S=y[1],c=y[5],X=y[9],R=y[13],j=y[2],O=y[6],g=y[10],n=y[14],Q=y[3],N=y[7],w=y[11],Y=y[15],F=b[0],i=b[4],t=b[8],K=b[12],p=b[1],s=b[5],G=b[9],x=b[13],q=b[2],P=b[6],z=b[10],B=b[14],u=b[3],V=b[7],v=b[11],L=b[15];return l[0]=d*F+J*p+I*q+Z*u,l[4]=d*i+J*s+I*P+Z*V,l[8]=d*t+J*G+I*z+Z*v,l[12]=d*K+J*x+I*B+Z*L,l[1]=S*F+c*p+X*q+R*u,l[5]=S*i+c*s+X*P+R*V,l[9]=S*t+c*G+X*z+R*v,l[13]=S*K+c*x+X*B+R*L,l[2]=j*F+O*p+g*q+n*u,l[6]=j*i+O*s+g*P+n*V,l[10]=j*t+O*G+g*z+n*v,l[14]=j*K+O*x+g*B+n*L,l[3]=Q*F+N*p+w*q+Y*u,l[7]=Q*i+N*s+w*P+Y*V,l[11]=Q*t+N*G+w*z+Y*v,l[15]=Q*K+N*x+w*B+Y*L,this},lookAt:function(){var j=new Qe;return function(f,v,x){return j.subVectors(f,v),this.lookAtDirection(j,x)}}(),lookAtDirection:function(){var P=new Qe,H=new Qe,n=new Qe;return function(J,$){var Q=this.el;return n.copy(J),0===n.lengthSq()&&(n.z=1),n.normalize(),P.crossVectors($,n),0===P.lengthSq()&&(1===Math.abs($.z)?n.x+=1e-4:n.z+=1e-4,n.normalize(),P.crossVectors($,n)),P.normalize(),H.crossVectors(n,P),Q[0]=P.x,Q[4]=H.x,Q[8]=n.x,Q[1]=P.y,Q[5]=H.y,Q[9]=n.y,Q[2]=P.z,Q[6]=H.z,Q[10]=n.z,this}}(),extractScale:function(){var E;return function(I){E===$&&(E=new Qe),I===$&&(I=new Qe);var U=E.setFromMatrixColumn(this,0).length(),p=E.setFromMatrixColumn(this,1).length(),h=E.setFromMatrixColumn(this,2).length();return I.set(U,p,h),I}}(),extractRotation:function(){var t;return function(o){t===$&&(t=new Qe),o===$&&(o=new hb);var K=this.el,X=o.el,E=1/t.setFromMatrixColumn(o,0).length(),l=1/t.setFromMatrixColumn(o,1).length(),c=1/t.setFromMatrixColumn(o,2).length();return K[0]=X[0]*E,K[1]=X[1]*E,K[2]=X[2]*E,K[4]=X[4]*l,K[5]=X[5]*l,K[6]=X[6]*l,K[8]=X[8]*c,K[9]=X[9]*c,K[10]=X[10]*c,this}}(),multiplyScalar:function(s){var E=this.el;return E[0]*=s,E[4]*=s,E[8]*=s,E[12]*=s,E[1]*=s,E[5]*=s,E[9]*=s,E[13]*=s,E[2]*=s,E[6]*=s,E[10]*=s,E[14]*=s,E[3]*=s,E[7]*=s,E[11]*=s,E[15]*=s,this},getPosition:function(I){return I===$&&(I=new Qe),I.setFromMatrixColumn(this,3)},setPosition:function(Q){var j=this.el;return j[12]=Q.x,j[13]=Q.y,j[14]=Q.z,this},toArray:function(J,s){J===$&&(J=[]),s===$&&(s=0);var V=this.el;return J[s]=V[0],J[s+1]=V[1],J[s+2]=V[2],J[s+3]=V[3],J[s+4]=V[4],J[s+5]=V[5],J[s+6]=V[6],J[s+7]=V[7],J[s+8]=V[8],J[s+9]=V[9],J[s+10]=V[10],J[s+11]=V[11],J[s+12]=V[12],J[s+13]=V[13],J[s+14]=V[14],J[s+15]=V[15],J},determinant:function(){var K=this.el,y=K[0],G=K[4],t=K[8],k=K[12],Z=K[1],_=K[5],Y=K[9],s=K[13],Q=K[2],q=K[6],B=K[10],O=K[14],N=K[3],i=K[7],c=K[11],J=K[15];return N*(+k*Y*q-t*s*q-k*_*B+G*s*B+t*_*O-G*Y*O)+i*(+y*Y*O-y*s*B+k*Z*B-t*Z*O+t*s*Q-k*Y*Q)+c*(+y*s*q-y*_*O-k*Z*q+G*Z*O+k*_*Q-G*s*Q)+J*(-t*_*Q-y*Y*q+y*_*B+t*Z*q-G*Z*B+G*Y*Q)},copy:function(e){var l=this.el,O=e.el;return l[0]=O[0],l[1]=O[1],l[2]=O[2],l[3]=O[3],l[4]=O[4],l[5]=O[5],l[6]=O[6],l[7]=O[7],l[8]=O[8],l[9]=O[9],l[10]=O[10],l[11]=O[11],l[12]=O[12],l[13]=O[13],l[14]=O[14],l[15]=O[15],this},compose:function(K,p,e){var l=this.el,v=p._x,D=p._y,b=p._z,Y=p._w,W=v+v,y=D+D,t=b+b,i=v*W,d=v*y,V=v*t,X=D*y,I=D*t,Z=b*t,F=Y*W,u=Y*y,G=Y*t,f=e.x,c=e.y,w=e.z;return l[0]=(1-(X+Z))*f,l[1]=(d+G)*f,l[2]=(V-u)*f,l[3]=0,l[4]=(d-G)*c,l[5]=(1-(i+Z))*c,l[6]=(I+F)*c,l[7]=0,l[8]=(V+u)*w,l[9]=(I-F)*w,l[10]=(1-(i+X))*w,l[11]=0,l[12]=K.x,l[13]=K.y,l[14]=K.z,l[15]=1,this},decompose:function(){var N=new Qe,h=new hb;return function(Y,y,J){var d=this.el,f=N.set(d[0],d[1],d[2]).length(),z=N.set(d[4],d[5],d[6]).length(),p=N.set(d[8],d[9],d[10]).length(),a=this.determinant();0>a&&(f=-f),Y.x=d[12],Y.y=d[13],Y.z=d[14],h.copy(this);var C=1/f,q=1/z,j=1/p;return h.el[0]*=C,h.el[1]*=C,h.el[2]*=C,h.el[4]*=q,h.el[5]*=q,h.el[6]*=q,h.el[8]*=j,h.el[9]*=j,h.el[10]*=j,y.setFromRotationMatrix(h),J.x=f,J.y=z,J.z=p,this}}()});var Sh=C.Math.Triangle=function(N,z,J){this.a=N!==$?N:new Qe,this.b=z!==$?z:new Qe,this.c=J!==$?J:new Qe};e.assign(Sh,{barycoordFromPoint:function(){var Z=new Qe,K=new Qe,S=new Qe;return function(R,D,J,o,p){Z.subVectors(o,D),K.subVectors(J,D),S.subVectors(R,D);var A=Z.dot(Z),r=Z.dot(K),O=Z.dot(S),C=K.dot(K),W=K.dot(S),k=A*C-r*r,t=p||new Qe;if(0===k)return t.set(-2,-1,-1);var I=1/k,Y=(C*O-r*W)*I,l=(A*W-r*O)*I;return t.set(1-Y-l,l,Y)}}()});var of=C.Math.Euler=function(G,m,B,I,Z){this.set(G,m,B,I,Z)};of.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],of.DefaultOrder="XYZ",of.ReverseOrder=function(){var j={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"};return function(Q){return j[Q]}}(),e.defineProperties(of.prototype,{x:{get:function(){return this._x},set:function(V){this._x=V,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(b){this._z=b,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(C){this._order=C,this.onChangeCallback()}}}),e.assign(of.prototype,{set:function(Q,b,d,S,N){return Xj(Q)&&(N=d,S=b,d=Q[2],b=Q[1],Q=Q[0]),S?N&&(S=of.ReverseOrder(S)):S="ZYX",this._x=Q||0,this._y=b||0,this._z=d||0,this._order=S||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(H){return this._x=H._x,this._y=H._y,this._z=H._z,this._order=H._order,this.onChangeCallback(),this},setFromRotationMatrix:function(W,p,R){var f=C.Math.clamp,k=W.el||W,t=k[0],m=k[4],i=k[8],D=k[1],e=k[5],n=k[9],U=k[2],v=k[6],y=k[10];return p=p||this._order,"XYZ"===p?(this._y=Math.asin(f(i,-1,1)),Math.abs(i)<.99999?(this._x=Math.atan2(-n,y),this._z=Math.atan2(-m,t)):(this._x=Math.atan2(v,e),this._z=0)):"YXZ"===p?(this._x=Math.asin(-f(n,-1,1)),Math.abs(n)<.99999?(this._y=Math.atan2(i,y),this._z=Math.atan2(D,e)):(this._y=Math.atan2(-U,t),this._z=0)):"ZXY"===p?(this._x=Math.asin(f(v,-1,1)),Math.abs(v)<.99999?(this._y=Math.atan2(-U,y),this._z=Math.atan2(-m,e)):(this._y=0,this._z=Math.atan2(D,t))):"ZYX"===p?(this._y=Math.asin(-f(U,-1,1)),Math.abs(U)<.99999?(this._x=Math.atan2(v,y),this._z=Math.atan2(D,t)):(this._x=0,this._z=Math.atan2(-m,e))):"YZX"===p?(this._z=Math.asin(f(D,-1,1)),Math.abs(D)<.99999?(this._x=Math.atan2(-n,e),this._y=Math.atan2(-U,t)):(this._x=0,this._y=Math.atan2(i,y))):"XZY"===p?(this._z=Math.asin(-f(m,-1,1)),Math.abs(m)<.99999?(this._x=Math.atan2(v,e),this._y=Math.atan2(i,t)):(this._x=Math.atan2(-n,y),this._y=0)):console.warn("unsupported order: "+p),this._order=p,R!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var M=new hb;return function(D,h,E){return M.makeRotationFromQuaternion(D),this.setFromRotationMatrix(M,h,E)}}(),setFromVector3:function(c,n){return this.set(c.x,c.y,c.z,n||this._order)},reorder:function(){var d=new fh;return function(Y){return d.setFromEuler(this),this.setFromQuaternion(d,Y)}}(),equals:function(H){return H._x===this._x&&H._y===this._y&&H._z===this._z&&H._order===this._order},fromArray:function(Z){return this._x=Z[0],this._y=Z[1],this._z=Z[2],Z[3]!==$&&(this._order=Z[3]),this.onChangeCallback(),this},toArray:function(w,C){return w===$&&(w=[]),C===$&&(C=0),w[C]=this._x,w[C+1]=this._y,w[C+2]=this._z,w[C+3]=this._order,w
},toVector3:function(S){return S?S.set(this._x,this._y,this._z):new Qe(this._x,this._y,this._z)},onChange:function(f){return this.onChangeCallback=f,this},onChangeCallback:function(){}});var Oh={ms_ac:function(h,Q){for(var E=Q.ms_ac,d=0;d<E.length;d++)Ko(h,E[d])},ms_listener:function(F){F.addListeners=function(){var F=this,c=El;B.mockTouch&&(c=gs.concat(oq).concat(fc)),F.__events__=c;for(var b=0,u=c.length;u>b;b++){var V=c[b];"wheel"===V&&!F.handle_wheel&&F.handle_mousewheel&&(F.handle_wheel=function(B){Zd(F,B)}),F["handle_"+V]&&uk(V,F.getView(),F)}},F.removeListeners=function(){var v=this,U=v.__events__;if(U){v.__events__=$;for(var b=0,q=U.length;q>b;b++)v["handle_"+U[b]]&&mg(U[b],v.getView(),v)}}},ms_fire:function(a){a.mp=function(X,E,i){this.addPropertyChangeListener(X,E,i)},a.ump=function(m,y){this.removePropertyChangeListener(m,y)},a.fp=function(v,H,M,A,F){return this.firePropertyChange(v,H,M,A,F)},a.addPropertyChangeListener=function(p,s,E){var U=this;U._62I||(U._62I=new wh),U._62I.add(p,s,E)},a.removePropertyChangeListener=function(i,H){this._62I&&this._62I.remove(i,H)},a.firePropertyChange=function(r,b,A,U,I){if(U){if(U(b,A))return!1}else if(b===A)return!1;var J=this,_=I||{};return _.property=r,_.oldValue=b,_.newValue=A,_.source=J,_.data=J,J._62I&&J._62I.fire(_),J.onPropertyChanged&&J.onPropertyChanged(_),!0}},ms_attr:function(e){e.a=function(R,I){var v=this;if(2===arguments.length)v.setAttr(R,I);else{if(!on(R))return v.getAttr(R);for(var o in R)v.setAttr(o,R[o])}return v},e.getAttr=function(j,H){if(H===$&&(H=1),this._attrObject&&j in this._attrObject)return this._attrObject[j];if(this.getImage){var I=this.getImage();if(Zq(I)&&(I=Qk[I]),on(I)&&"dataBindings"in I)for(var K=I.dataBindings,C=K.length-1;C>=0;C--){var L=K[C];if(L.attr===j){if("defaultValue"in L)return L.defaultValue;break}}}return H?N[j]:$},e.setAttr=function(q,X){var F=this;F._attrObject||(F._attrObject={});var v=F._attrObject[q];X===$?delete F._attrObject[q]:F._attrObject[q]=X,F.fp&&F.fp("a:"+q,v,X)&&F.onAttrChanged&&F.onAttrChanged(q,v,X)},e.getSerializableAttrs=function(){var q,e={};for(q in this._attrObject)e[q]=1;return e}},ms_bnb:function(w){w.getBodyColor=function(Z){return Z.s("body.color")},w.getBorderColor=function(c){return c.s("border.color")}},_51o:function(S){S.mi=function(j,K,l){this.addInteractorListener(j,K,l)},S.umi=function(N,D){this.removeInteractorListener(N,D)},S.fi=function(Y){this.fireInteractorEvent(Y)},S.addInteractorListener=function(c,b,x){var k=this;k._63I||(k._63I=new wh),k._63I.add(c,b,x)},S.removeInteractorListener=function(B,b){this._63I&&this._63I.remove(B,b)},S.fireInteractorEvent=function(k){this._63I&&this._63I.fire(k)},S.setInteractors=function(F){var p=this,x=p._interactors;x&&x.each(function(c){c.tearDown()}),Xj(F)&&(F=new le(F)),p._interactors=F,F&&F.each(function(H){H.setUp()}),p.fp("interactors",x,F),p.invalidateSelection()},S.getInteractors=function(){return this._interactors}},_49o:function(n){n._44O=V,n._45O=V,n.getTopPainters=function(){return this._44O},n.getBottomPainters=function(){return this._45O},n.addTopPainter=function(W){var U=this;U._44O||(U._44O=new le),U._44O.contains(W)||(U._44O.add(W),U.redraw&&U.redraw())},n.removeTopPainter=function(m){var b=this;b._44O&&(b._44O.remove(m),b.redraw&&b.redraw())},n.addBottomPainter=function(F){var b=this;b._45O||(b._45O=new le),b._45O.contains(F)||(b._45O.add(F),b.redraw&&b.redraw())},n.removeBottomPainter=function(M){var o=this;o._45O&&(o._45O.remove(M),o.redraw&&o.redraw())},n._93db=function(M,H){var R=this;R._45O&&R._45O.each(function(u){u.draw?u.draw(M,H):u.call(R,M,H)})},n._92db=function(K,W){var E=this;E._44O&&E._44O.each(function(m){m.draw?m.draw(K,W):m.call(E,K,W)})}},ms_sm:function(l){l.sm=function(){return this.getSelectionModel()},l.setSelectableFunc=function(e){this.sm().setFilterFunc(e)},l.getSelectableFunc=function(){return this.sm().getFilterFunc()},l.getSelectionModel=function(){var J=this;return J._selectionModel?J._selectionModel:J.dm().sm()},l.isSelectionModelShared=function(){return!this._selectionModel},l.setSelectionModelShared=function(M){var N=this,t=!N._selectionModel,f=N.handleSelectionChange,$=N.dm();t!==M&&(N.invalidateSelection&&N.invalidateSelection(),M?($.sm().ms(f,N),N._selectionModel.ums(f,N),N._selectionModel.dispose(),N._selectionModel=V):($.sm().ums(f,N),N._selectionModel=new kq($),N._selectionModel.ms(f,N)),N.onSelectionModelSharedChanged(),N.fp("selectionModelShared",t,M))},l.onSelectionModelSharedChanged=function(){var L=this;L.redraw(),L.invalidateSelection&&L.invalidateSelection()},l.removeSelection=function(){var x=this.dm();x.beginTransaction(),this.sm().toSelection().each(x.remove,x),x.endTransaction()},l.selectAll=function(){var k=this;k.sm().ss(k.dm().toDatas(function(D){return k.isVisible(D)&&k.isSelectable(D)}))},l.isSelected=function(Z){return this.sm().co(Z)},l.isSelectedById=function(P){var D=this.dm().getDataById(P);return D?this.isSelected(D):!1},l.isSelectable=function(l){return this.sm().isSelectable(l)}},ms_tx:function(n){n._64I=0,n._65O=0,n.isScrollable=function(){return this.getWidth()<this._64I},n._40o=function(){return this.isScrollable()},n.getLogicalPoint=function(G){return Kf(G,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},n.tx=function(U){return U===$?this.getTranslateX():(this.setTranslateX(U),void 0)},n.getTranslateX=function(){return this._65O},n.setTranslateX=function(z){var H=this,r=H.getWidth()-H._64I;r>z&&(z=r),z>0&&(z=0),z=k(z);var U=H._65O;H._65O=z,H.fp(Rd,U,z)}},ms_ty:function(f){f._23Q=0,f._66O=0,f._41o=function(){return this.getHeight()<this._23Q},f.getLogicalPoint=function(v){return Kf(v,this._canvas||this._view,this.tx?this.tx():0,this.ty())},f.ty=function(x){return x===$?this.getTranslateY():(this.setTranslateY(x),void 0)},f.getTranslateY=function(){return this._66O},f.setTranslateY=function(w){var D=this,L=D.getHeight()-D._23Q;L>w&&(w=L),w>0&&(w=0),w=k(w);var p=D._66O;D._66O=w,D.fp(cq,p,w)}},ms_txy:function(W){W._65O=0,W._66O=0,W.tx=function(R){return R===$?this.getTranslateX():(this.setTranslateX(R),void 0)},W.ty=function(w){return w===$?this.getTranslateY():(this.setTranslateY(w),void 0)},W.onTranslateEnded=function(){},W.setTranslate=function(x,J,R){var _=this;if(R=Vi(R)){_._65I&&_._65I.stop(!0);var f=_.tx(),F=_.ty();R.action=function(l){_.setTranslate(f+(x-f)*l,F+(J-F)*l)},R._37o=function(){delete _._66I,delete _._65I,_.onTranslateEnded()},_._66I=1,_._65I=Tp(R)}else _.tx(x),_.ty(J)},W.getTranslateX=function(){return this._65O},W.setTranslateX=function(L){var S=this;L=S.adjustTranslateX(L);var z=S._65O;S._65O=L,S.fp(Rd,z,L)},W.getTranslateY=function(){return this._66O},W.setTranslateY=function(y){var E=this;y=E.adjustTranslateY(y);var h=E._66O;E._66O=y,E.fp(cq,h,y)},W.adjustTranslateX=function(r){return k(r)},W.adjustTranslateY=function(F){return k(F)},W.translate=function(e,o,m){this.setTranslate(this.tx()+e,this.ty()+o,m)},W.getLogicalPoint=function(h){var f=this;return Kf(h,this._canvas||f._view,f.tx(),f.ty())}},ms_dm:function(x){x.dm=function(i){return i?(this.setDataModel(i),void 0):this.getDataModel()},x.getDataModel=function(){return this._dataModel}},ms_lp:function(h){h.lp=function(y){return this.getLogicalPoint(y)}},ms_v:function(O){O._disabled=!1,O.setDisabled=function(d,t){var K=this,I=K._disabled;I!==d&&(I&&(zg(K._63O),delete K._63O),d&&(os(K._view,K._63O=jg(t)),K.iv()),K._disabled=d,K.fp("disabled",I,d))},O.isDisabled=function(){return this._disabled},O.getDisabledDiv=function(){return this._63O},O.getView=function(){return this._view},O.addToDOM=function(U){var M=this,v=M.getView(),f=v.style;U=U||i.body,U.appendChild(v),f.left="0",f.right="0",f.top="0",f.bottom="0",A(n,"resize",function(){M.iv()}),M.iv()},O.getWidth=function(){return this._view.clientWidth},O.getHeight=function(){return this._view.clientHeight},O.setWidth=function(Z){var O=this;O._view.style.width=Z+Tn,O.iv(),O.fp&&O.fp(ed,V,Z)},O.setHeight=function(f){var j=this;j._view.style.height=f+Tn,j.iv(),j.fp&&j.fp(Gk,V,f)},O.setFocus=function(J){var H=this,E=H._currentEditor;return J&&E&&(E.getView&&(E=E.getView()),E.contains(J.target))?!1:(ce(H._view),H.endEditing&&H.endEditing(),H.fireViewEvent("focus"),!0)},O.iv=function($){this.invalidate($)},O.invalidate=function(i){var e=this;e._68I||(e._68I=1,aq(e.validate,e,V,i),e.onInvalidated&&e.onInvalidated(),e.fireViewEvent("invalidate"))},O.validate=function(){var A=this,W=A._view;if(A._68I&&(delete A._68I,W.parentNode))if(0===W.offsetWidth&&0===W.offsetHeight&&A._67I!==V)A._67I===$&&(A._67I=B.reinvalidateCount),A._67I>0?A._67I--:A._67I=V,A.iv();else{A.fireViewEvent("beginValidate"),A.validateImpl(),A.onValidated&&A.onValidated(),A.fireViewEvent("validate");var q=A._63O;q&&(W.lastChild!==q&&(zg(q),os(W,q)),$m(q,0,0,A.getWidth(),A.getHeight())),zi(A),Hj(A),vh(A)}},O.layout=function(E,$,b,u){1===arguments.length?$m(this,E):$m(this,E,$,b,u)},O.addViewListener=function(e,d,I){var a=this;a._67O||(a._67O=new wh),a._67O.add(e,d,I)},O.removeViewListener=function(C,k){this._67O.remove(C,k)},O.fireViewEvent=function(k){var T=this;T._67O&&(Zq(k)&&(k={kind:k}),T._67O.fire(k)),B.viewListener&&B.viewListener(T,k)}},ms_tip:function(u){u.setToolTipEnabled=function(d){var L=this;d?gp||L._13o||(L.enableToolTip(),L.fp("toolTipEnabled",!1,!0)):L._13o&&(L.disableToolTip(),L.fp("toolTipEnabled",!0,!1))},u.isToolTipEnabled=function(){return!!this._13o},u.enableToolTip=function(){var G=this;if(!gp&&!G._13o){G._13o=function(L){var I=G.getToolTip(L);I!=V?(B.toolTipContinual&&B.isToolTipShowing()?cs(L,I):(ur(),ln={timeout:fo(Mr,Sj),e:L,info:I}),lj={e:L,view:G}):ur()};var j=G.getView();A(j,Oq,G._13o),A(j,"mouseleave",B.hideToolTip)}},u.disableToolTip=function(){var G=this;if(G._13o){var x=G.getView();Y(x,Oq,G._13o),Y(x,"mouseleave",B.hideToolTip),delete G._13o}},u.getToolTip=function(u){var K=this;if(K.getDataAt){var X=K.getDataAt(u);return X?X.getToolTip():V}return K.getValue?K.getValue():void 0}},_52o:function(k){k._zoom=1,k._29I=Hp,k.zoomIn=function(U,_){this.setZoom(this._zoom*kf,U,_)},k.zoomOut=function(t,v){this.setZoom(this._zoom/kf,t,v)},k.zoomReset=function(O,$){this.setZoom(1,O,$)},k.scrollZoomIn=function(l){this.setZoom(this._zoom*bg,V,l)},k.scrollZoomOut=function(A){this.setZoom(this._zoom/bg,V,A)},k.pinchZoomIn=function(d){this.setZoom(this._zoom*sf,V,d)},k.pinchZoomOut=function(s){this.setZoom(this._zoom/sf,V,s)},k.adjustZoom=function(w){return An>w?An:w>tn?tn:w},k.getZoom=function(){return this._zoom},k.setZoom=function(r,X,W){var Z=this;if(X=Vi(X)){Z._14o&&Z._14o.stop(!0);var R=Z._zoom;X.action=function(n){Z._96O(R+(r-R)*n,W)},X._37o=function(){delete Z._zooming,delete Z._14o,Z.onZoomEnded()},Z._zooming=1,Z._14o=Tp(X)}else Z._96O(r,W)},k._96O=function(s,H){var D=this;if(s=D.adjustZoom(s),s!==D._zoom){D.validate();var Q=D._29I,A=D._zoom;0!==Q.width&&0!==Q.height&&(H=H?H:{x:Q.x+Q.width/2,y:Q.y+Q.height/2},D.tx((H.x-Q.x)*A-H.x*s),D.ty((H.y-Q.y)*A-H.y*s)),D._zoom=s,D.fp("zoom",A,s)}}},ms_edge:function(H){H._2I=function(e){var O=this;O._44I||(O._44I=new le),O._42I||(O._42I=new le),O._44I.add(e),O._42I.add(e),O._20I()},H._4I=function(l){var S=this;S._44I||(S._44I=new le),S._43I||(S._43I=new le),S._44I.add(l),S._43I.add(l),S._20I()},H._16I=function(H){var m=this;m._44I.remove(H),m._42I.remove(H),m._44I.isEmpty()&&delete m._44I,m._42I.isEmpty()&&delete m._42I,m._20I()},H._18I=function(s){var l=this;l._44I.remove(s),l._43I.remove(s),l._44I.isEmpty()&&delete l._44I,l._43I.isEmpty()&&delete l._43I,l._20I()},H._20I=function(){var O=this;if(delete O._45I,!O._44I||O._44I.isEmpty())return delete O._70O,void 0;var A;O._44I.each(function(B){B.isLooped()&&(A||(A={}),A[B._id]||(O._45I||(O._45I=new le),O._45I.add(B),A[B._id]=B))}),A?(O._70O=new le,O._44I.each(function(W){A[W._id]?"A"===A[W._id]||(A[W._id]="A",O._70O.add(W)):O._70O.add(W)})):O._70O=O._44I},H.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},H.getSourceAgentEdges=function(){return this._46I},H.getTargetAgentEdges=function(){return this._47I},H._1I=function(p){var F=this;F._46I||(F._46I=new le),F._48I||(F._48I=new le),F._46I.add(p),F._48I.add(p),F._19I()},H._3I=function(v){var p=this;p._47I||(p._47I=new le),p._48I||(p._48I=new le),p._47I.add(v),p._48I.add(v),p._19I()},H._15I=function(h){var $=this;$._46I.remove(h),$._48I.remove(h),$._46I.isEmpty()&&delete $._46I,$._48I.isEmpty()&&delete $._48I,$._19I()},H._17I=function(h){var H=this;H._47I.remove(h),H._48I.remove(h),H._47I.isEmpty()&&delete H._47I,H._48I.isEmpty()&&delete H._48I,H._19I()},H._19I=function(){var Z=this;delete Z._49I;var R=Z._48I;if(R&&!R.isEmpty()){var m={};R.each(function(V){m[V._id]?Z._49I||(Z._49I=new le):m[V._id]=V}),Z._49I?R.each(function(P){m[P._id]&&(Z._49I.add(P),delete m[P._id])}):Z._49I=R}},H.getLoopedEdges=function(){return this._45I},H.getEdges=function(){return this._70O},H.getAgentEdges=function(){return this._49I},H.getSourceEdges=function(){return this._42I},H.getTargetEdges=function(){return this._43I},H._8I=function(){this._70O&&this._70O.each(function(z){z._7I()})}},ms_shadow:function(B){tr.PARAMS.forEach(function(P){var C=P.replace(/(^|\.)[a-z]/g,function(r){return r[r.length-1].toUpperCase()}),U=C.charAt(0).toLowerCase()+C.substr(1);B["getShadow"+C]=function(){return this._getShadowParam(U)},B["setShadow"+C]=function(v){this._setShadowParam(U,v)}}),B.enableShadow=function(B){this.shadowMap.setShadow(!0,B)},B.disableShadow=function(){this.shadowMap.setShadow(!1)},B._getShadowParam=function(J){return this.shadowMap.getShadow()[J]},B._setShadowParam=function(U,z){var J=this._getShadowParam(U),M={};M[U]=z;var h=this.shadowMap;h.setShadow(h.enable,M),this.firePropertyChange("shadow"+U.charAt(0).toUpperCase()+U.substr(1),J,z)}}};Ki(B,{getVersion:function(){return"7.2.2-dev18"}},!0),Ki(B,{numberDigits:5,crossOrigin:"",baseZIndex:$,isTouchable:gp,mockTouch:!0,devicePixelRatio:n.devicePixelRatio?n.devicePixelRatio:n.screen?n.screen.deviceXDPI/n.screen.logicalXDPI:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:h.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return mr},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(v){return v*v},labelColor:yj,labelSelectColor:Kq,labelFont:"12px arial, sans-serif",widgetIndent:gp?30:20,widgetRowHeight:gp?30:20,widgetHeaderHeight:gp?32:22,widgetTitleHeight:gp?34:24,scrollBarColor:Rm,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:gp?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Ag,intersectionLineLine:ji,isEnter:Gr,isEsc:$b,isDelete:Ab,isSpace:uo,isLeft:Yg,isUp:Xe,isRight:hq,isDown:Xh,isTouchEvent:jk,getTarget:Hf,isString:Zq,isNumber:Ob,isBoolean:hm,isArray:Xj,isSelectAll:$g,isFunction:mj,isObject:on,getPropertyValue:Ng,setPropertyValue:jp,addMethod:Ki,createGradient:function(m,n,y,w,c,s,O,K){var V=Ji[n];return V(m,y,w,c,s,O,K)},appendToScreen:function(W){W=W.getView?W.getView():W,(i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement||i.body).appendChild(W)},encodeString:function(k){return C.Math.encodeBase64(k,B.encodeStringKey)},decodeString:function(O){return C.Math.decodeBase64(O,B.encodeStringKey)},findView:function(s){var Q=function(t,T){var p=T._ht;p&&t.push(p);var h=T.children,A=h.length;if(A)for(var m=0;A>m;m++)Q(t,h[m])},M=[];Q(M,i.body);var G=function(B,c){for(var D="2d"===c?Gj.GraphView:hg.Graph3dView,q=0,l=B.length;l>q;q++)if(B[q]instanceof D)return M[q];return null};return"all"===s?M:"2d"===s?G(M,"2d"):"3d"===s?G(M,"3d"):G(M,"3d")||G(M,"2d")},toggleFullscreen:function($){var J=$.getView();if(i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement)i.exitFullscreen?i.exitFullscreen():i.msExitFullscreen?i.msExitFullscreen():i.mozCancelFullScreen?i.mozCancelFullScreen():i.webkitExitFullscreen&&i.webkitExitFullscreen();else{var r=!0;if($.isSelfViewEvent){var W=$.getX(),h=$.getY(),A=$.getWidth(),z=$.getHeight(),U=J.style.background,y=J.style.backgroundColor;U||y||(J.style.backgroundColor="white"),J.requestFullscreen?J.requestFullscreen():J.msRequestFullscreen?J.msRequestFullscreen():J.mozRequestFullScreen?J.mozRequestFullScreen():J.webkitRequestFullscreen&&J.webkitRequestFullscreen();var M=setInterval(function(){if(J!==(i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement))clearInterval(M),$.setX(W),$.setY(h),$.setWidth(A),$.setHeight(z),$._fullscreen=!1,J.style.oldBackgroundColor=y,$.iv();else{var j=C.Default.getWindowInfo();(r||j.width!==$.getWidth()||j.height!==$.getHeight())&&($.setX(j.left),$.setY(j.top),$.setWidth(j.width),$.setHeight(j.height),$._fullscreen=!0,$.iv(),r=!1)}},500)}else{var D=J.style.left,l=J.style.top,A=J.style.width,z=J.style.height,U=J.style.background,y=J.style.backgroundColor;U||y||(J.style.backgroundColor="white"),J.requestFullscreen?J.requestFullscreen():J.msRequestFullscreen?J.msRequestFullscreen():J.mozRequestFullScreen?J.mozRequestFullScreen():J.webkitRequestFullscreen&&J.webkitRequestFullscreen();var M=setInterval(function(){if(J!==(i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement||i.msFullscreenElement))clearInterval(M),J.style.left=D,J.style.top=l,J.style.width=A,J.style.height=z,J.style.oldBackgroundColor=y,$.iv();else{var t=C.Default.getWindowInfo();(r||t.width!==$.getWidth()||t.height!==$.getHeight())&&($m($),r=!1)}},500)}}},appendTimeStamp:function(d){return d},setCompType:function(p,L){Zq(L)&&L.substr(0,12)==qd&&(L=B.parse(L)),mj(L)||on(L)?If[p]=L:hd(p)},getCompType:function(Z){var R=If[Z];return R===$&&oj.test(Z)&&hd(Z),R},getCompTypeMap:function(){return If},drawCompType:function(l,S,f,j,W,C){l(S,f,j,W,C)},numberListener:function(){var P={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(h){var c=h.keyCode;P[c]||65===c&&B.isCtrlDown(h)||86===c&&B.isCtrlDown(h)||67===c&&B.isCtrlDown(h)||88===c&&B.isCtrlDown(h)||c>=35&&40>=c||(h.shiftKey||48>c||c>57)&&(96>c||c>105)&&h.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(X){var m=X.target.tagName;("DIV"===m||"CANVAS"===m)&&!(B.ignoreKeyCodes.indexOf(X.keyCode)>=0)&&("keydown"!==X.type||Yg(X)||hq(X)||Xe(X)||Xh(X)||Ab(X)||65===X.keyCode&&(X.metaKey||X.ctrlKey))&&(X.preventDefault(),X.preventManipulation&&X.preventManipulation())},getWindowInfo:function(){var S=i.documentElement,f=S&&(S.scrollLeft||S.scrollTop)?S:i.body;return{target:f,left:f.scrollLeft,top:f.scrollTop,width:n.innerWidth||f.clientWidth,height:n.innerHeight||f.clientHeight}},isDragging:function(){return!!mr},isLeftButton:function(E){return jk(E)?!0:0===E.button},isMiddleButton:function(F){return jk(F)?!1:F&&(1===F.button||4&(F.buttons||0))},isRightButton:function(e){return jk(e)?!1:e&&(2===e.button||2&(e.buttons||0))},isInput:function(r){if(!r)return!1;var i=r.tagName;return"INPUT"===i||"TEXTAREA"===i||"SELECT"===i},getTouchCount:function(c){return jk(c)?c.touches.length:1},isDoubleClick:function(){function l(G){G.details=0,G.timeout=null,G.lastPoint=null}var Q={};return Ub=new G,Ef=Ub.getTime(),function(e){if(Bg(e)>1)return!1;var r=e.button==V?"":e.button,i=e.type+r,v=i+"_isDoubleClick",R=Q[i];if(R||(R=Q[i]={details:0,timeout:null,lastPoint:null}),e[v]===$){e[v]=!0;var K=kd(e);R.timeout&&(dh(R.timeout),R.timeout=null);var t=jk(e)?B.doubleTouchRange:B.doubleClickRange;R.lastPoint&&Lf(R.lastPoint,K)>t&&l(R),R.lastPoint=K,R.details++,R.timeout=fo(function(){l(this)}.bind(R),B.doubleClickSpeed)}return 2===R.details}}(),isShiftDown:function(q){return q?q.shiftKey:vm["16"]},isCtrlDown:function(u){return u?kc?u.metaKey:u.ctrlKey:kc?vm["91"]:vm["17"]},getClientPoint:function(W){return jk(W)&&(W=Bf(W)),{x:W.clientX,y:W.clientY}},isMouseEvent:function(u){return u instanceof MouseEvent||0===u.type.indexOf("mouse")},getTargetElement:function(M){var s,h=Wc(M);if(s=B.isMouseEvent(M)||!i.elementFromPoint?M.target:i.elementFromPoint(h.x,h.y),bh&&i.elementFromPoint){for(var c=[],e=[];"none"===s.style.pointerEvents;)c.push(s),e.push(s.style.display||""),s.style.display="none",s=i.elementFromPoint(h.x,h.y);c.forEach(function(S,W){S.style.display=e[W]})}return s},getPagePoint:function(m){return jk(m)&&(m=Bf(m)),{x:m.pageX,y:m.pageY}},createObject:function(C,k){var g=new C;for(var u in k){var s=k[u];if(mj(s))g[u]=s;else if(0===u.indexOf("s:"))g.s(u.substr(2),k[u]);else if(0===u.indexOf("a:"))g.a(u.substr(2),k[u]);else{var i=Bi(u),s=k[u];g[i]?(g[i](s),"setToolTip"===i&&g.enableToolTip&&g.enableToolTip()):g[u]=s}}return g},setImage:function(E,$,w,t){var M=arguments.length;4===M?Ci(E,t,$,w):2===M?Zq($)?$.substr(0,12)==qd?Yd(E,B.parse($)):Ci(E,$):Yd(E,$):1===M&&Ci(E,E)},getImage:function(u,j,o){var b;if(u==V)return V;if(on(u)?b=u:(b=Qk[u],u&&b===$&&(jr&&jr[u]||Ci(u,u))),j&&b&&b.tagName){var Z;Z="override"===o?"colors_override":"override_rgb"===o?"colors_override_rgb":"override_a"===o?"colors_override_a":"colors",b[Z]||(b[Z]={__count__:0});var t=b[Z][j];return t||(b[Z].__count__>B.imageCacheThreshold&&(b[Z]={__count__:0}),t=rn(b,xs(j),b.width,b.height,o),b[Z][j]=t,b[Z].__count__++),t}return b},isImageComplete:function(t,A,u){var W=Cc(t);if(!W)return!1;if(W.tagName)return W.complete;for(var Q,t,D,z=W.comps,j=!0,H=0,d=z.length;d>H;H++)if(Q=z[H],D=Q.type,"image"===Q.type){t=Q.name,t&&t.func&&(t=Th(t,A));var w=vl(t,A,u);if(!w){j=!1;break}}else if(oj.test(D)&&B.getCompType(D)===$){j=!1,hd(D);break}return j},getId:function(){var R=1;return function(){return++R}}(),callLater:function(R,B,S,z){var r=function(){R.apply(B,S)};return z?fo(r,z):n.requestAnimationFrame(r)},cancelLater:function(K,G){G?dh(K):n.cancelAnimationFrame(K)},clone:function(g){if(null==g||"object"!=typeof g)return g;if(g instanceof Date){var T=new Date;return T.setTime(g.getTime()),T}if(g instanceof Array){for(var T=[],f=0,j=g.length;j>f;f++)T[f]=Xn(g[f]);return T}if(g instanceof le){for(var T=new le,f=0,j=g.length;j>f;f++)T.set(f,Xn(g.get(f)));return T}if(g instanceof Tr)return g;if(g instanceof jo){var T=new jo;return T.deserialize(g.serialize()),T}if(g instanceof e){var T={};for(var V in g)g.hasOwnProperty(V)&&(T[V]=Xn(g[V]));return T}return g},callWhenLoaded:function(t,p){p=p||100;var l=ig(t,p);Aq||(Aq={}),Aq[l]={tick:l,cb:t,delay:p}},beforeLoadURL:function(m,J){if(Aq){var S={};for(var J in Aq){var t=Aq[J];dh(t.tick);var A=ig(t.cb,t.delay);S[A]={tick:A,delay:t.delay,cb:t.cb}}Aq=S}return B.convertURL?B.convertURL(m,J):m},convertURL:function(J){return J},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return B.getImage("default_blank")},resizeImagePOT:function(b,z){if(!b||!b.tagName)return b;var M=b.width,B=b.height;if(!M||!B)return b;if(Pl.isPOT(M)&&Pl.isPOT(B)&&(!z||M===B))return b;var N,l;z?l=N=Pl.nearestPOT(Math.min(M,B)):(N=Pl.nearestPOT(M),l=Pl.nearestPOT(B));var C=ob(),I=C.getContext("2d");return Yl(C,N,l,1),I.drawImage(b,0,0,M,B,0,0,N,l),C},sortFunc:function(l,D){if(l===D)return 0;if(l==V&&D!=V)return 1;if(l!=V&&D==V)return-1;if(l==V&&D==V)return 0;var c,L=typeof l,A=typeof D;return L===Mk&&A===Mk?c=l.localeCompare(D):L===Uq&&A===Uq&&(c=l-D),c===$&&(c=(""+l).localeCompare(""+D)),c>0?1:0>c?-1:0},getClassMap:function(){return Qi},getClass:function(d){if(Zq(d)){var o,v=Qi[d];if(!v){o=d.split("."),v=n;for(var M=0;M<o.length;M++)v=v[o[M]];Qi[d]=v}return v}return d},def:function(P,Q,h){var n,g,f,A=function(){};if(A.prototype=Q.prototype,n=new A,Zq(P)){if(Qi[P])throw"'"+P+"' already defined";f=Zh(P),n.getClassName=function(){return P}}else f=P;if(n.constructor=f,n.getClass=function(){return f},n.getSuperClass=function(){return Q},h)for(g in h)Oh[g]&&Oh.hasOwnProperty(g)?Oh[g](n,h):hr(n,h,g);f.prototype=n,f.superClass=Q.prototype},startAnim:function(){var A=function(y){y.duration&&(y.startTime=Gc()),y.timeId=aq(y.tick,V,V,y.interval)};return function(a){return a=Xn(a),a.easing=a.easing||B.animEasing,a.duration||a.frames||(a.duration=B.animDuration),a.t=0,a.duration?a.interval=0:(a.frame=0,a.interval=a.interval||10),a.tick=function(){if(a.duration){var B=(Gc()-a.startTime)/a.duration;if(B>1&&(B=1),a.t=B,a.action(a.easing(B),B),!a.isRunning())return;1===B?a.stop():a._isPaused||(a.timeId=aq(a.tick))}else{if(a.frame++,B=a.t=a.frame/a.frames,a.action(a.easing(B),B),!a.isRunning())return;a.frame<a.frames?a._isPaused||(a.timeId=aq(a.tick,V,V,a.interval)):a.stop()}},a.resume=function(){a._isPaused&&(delete a._isPaused,a.duration?a.t<1&&(a.startTime=Gc()-a.duration*a.t,a.timeId=aq(a.tick)):a.frame<a.frames&&(a.timeId=aq(a.tick,V,V,a.interval)))},a.pause=function(){xl(a.timeId,!a.duration),a._isPaused=!0},a.isPaused=function(){return this._isPaused},a.stop=function(M){a.isRunning()&&(xl(a.timeId,!a.duration),delete a.timeId,a.duration?a.t<1&&M&&(a.t=1,a.action(a.easing(1),1)):a.frame<a.frames&&M&&(a.frame=a.frames,a.action(a.easing(1),1)),a._37o&&a._37o(),a.finishFunc&&a.finishFunc())},a.isRunning=function(){return a.timeId!=V},a.delay?aq(A,V,[a],a.delay):A(a),a}}(),getTextSize:function(){var Y={},$=i?ob().getContext("2d"):V;return function(G,A){$.font=G?G:Yf;var h=Y[$.font];return h||(h=2*$.measureText("e").width+4,Y[$.font]=h),{width:$.measureText(A).width+4,height:h}}}(),drawText:function(i,Y,r,J,m,A,j,t,v,X){if(Y!=V){var Z=ts(r,Y),K={};K.y=X&&X!==en?X===hp?A+Z.height/2:A+t-Z.height/2:A+t/2,K.x=v&&v!==ar?v===ci?m+j-Z.width/2:m+j/2:m+Z.width/2,gr(i,Y,K,r,J)}},getDistance:function(P,x){var c=P.length;return x?3===c?j(wd(P[0]-x[0])+wd(P[1]-x[1])+wd(P[2]-x[2])):2===c?j(wd(P[0]-x[0])+wd(P[1]-x[1])):P.z===$?j(wd(x.x-P.x)+wd(x.y-P.y)):j(wd(x.x-P.x)+wd(x.y-P.y)+wd(x.z-P.z)):3===c?j(wd(P[0])+wd(P[1])+wd(P[2])):2===c?j(wd(P[0])+wd(P[1])):void 0},brighter:function(r,y){return 0>y&&(y=-y),Yc(r,y?y:40)},darker:function(e,Z){return Z>0&&(Z=-Z),Yc(e,Z?Z:-40)},unionPoint:function(c,y){if(!c)return V;if(2===arguments.length)return c&&y?{x:s(c.x,y.x),y:s(c.y,y.y),width:r(c.x-y.x),height:r(c.y-y.y)}:V;var O=c;if(O._as&&(O=O._as),O.length===$)return V;var A=O.length;if(0>=A)return V;for(var o=1,k=O[0],h={x:k.x,y:k.y,width:0,height:0};A>o;o++){k=O[o];var X=s(h.x,k.x),S=g(h.x+h.width,k.x),_=s(h.y,k.y),z=g(h.y+h.height,k.y);h.x=X,h.y=_,h.width=S-X,h.height=z-_}return h},unionRect:function(B,f){if(B&&!f)return Xn(B);if(!B&&f)return Xn(f);if(B&&f){var P={x:s(B.x,f.x),y:s(B.y,f.y)};return P.width=g(B.x+B.width,f.x+f.width)-P.x,P.height=g(B.y+B.height,f.y+f.height)-P.y,P}return V},containsPoint:function(y,p,R,b){if(b!=V&&1!==b){var P=y.x+y.width/2,l=y.y+y.height/2;y={x:P-y.width/2*b,y:l-y.height/2*b,width:y.width*b,height:y.height*b}}if(R){var U=y.width/2,W=y.height/2,s=w(-R),j=D(-R),c=p.x-y.x-U,Z=p.y-y.y-W;return p={x:j*c-s*Z,y:s*c+j*Z},lc({x:-U,y:-W,width:y.width,height:y.height},p)}return!(!y||p.x<y.x||p.y<y.y||p.x>y.x+y.width||p.y>y.y+y.height)},containsRect:function(D,O){if(!D||!O)return!1;var h=O.x,Q=O.y,o=O.width,k=O.height,g=D.width,n=D.height;if(0>(g|n|o|k))return!1;var q=D.x,f=D.y;if(q>h||f>Q)return!1;if(g+=q,o+=h,h>=o){if(g>=q||o>g)return!1}else if(g>=q&&o>g)return!1;if(n+=f,k+=Q,Q>=k){if(n>=f||k>n)return!1}else if(n>=f&&k>n)return!1;return!0},intersectsRect:function(K,S){if(!K||!S)return!1;var I=S.width,t=S.height,s=K.width,w=K.height;if(0>=s||0>=w||0>=I||0>=t)return!1;var O=S.x,l=S.y,E=K.x,P=K.y;return s+=E,w+=P,I+=O,t+=l,s>O&&w>l&&I>E&&t>P},intersection:function(L,k){if(!L||!k)return V;var r=k.x,E=k.y,P=L.x,m=L.y,n=r,$=E,A=P,g=m;return n+=k.width,$+=k.height,A+=L.width,g+=L.height,P>r&&(r=P),m>E&&(E=m),n>A&&(n=A),$>g&&($=g),n-=r,$-=E,0>=n||0>=$?V:{x:r,y:E,width:n,height:$}},grow:function(j,O,S){S===$&&(S=O),j.x-=O,j.y-=S,j.width=j.width+2*O,j.height=j.height+2*S},getScreenPoint:function(r,I,p,d,n,M,q){var Y=p.getBoundingClientRect(),k=r*(M||1)-p.scrollLeft+(d||0),g=I*(q||1)-p.scrollTop+(n||0),v=Fo(p,!1);if(v){var U=new Qe(k,g,0);return U.applyMatrix4(v),console.log(U),{x:U.x,y:U.y}}return{x:k+Y.left,y:g+Y.top}},getLogicalPoint:function(c,Z,L,x,n,X){var K,q,$=Z.getBoundingClientRect();c.target?(kj(c)?kc?vm["91"]=!0:vm["17"]=!0:kc?vm["91"]=!1:vm["17"]=!1,vm["16"]=Fk(c)?!0:!1,c=jk(c)?Bf(c):c,K=c.clientX,q=c.clientY):(K=c.x,q=c.y);var d=Fo(Z,!0);if(d){var m=new Qe(K,q,0);m.applyMatrix4(d);do{if(Math.abs(m.z)<=1e-6)break;var u=new Qe(K,q,1);if(u.applyMatrix4(matrix),Math.abs(u.z)<=1e-6){m=u;break}if(u.sub(m),Math.abs(u.z)<=1e-6)break;m.addScaledVector(u,-m.z/u.z)}while(!1);return{x:(m.x+Z.scrollLeft-(L||0))/(n||1),y:(m.y+Z.scrollTop-(x||0))/(X||1)}}return{x:(K-$.left+Z.scrollLeft-(L||0))/(n||1),y:(q-$.top+Z.scrollTop-(x||0))/(X||1)}},removeHTML:function(){var e;return function(v){return v&&v.getView&&(v=v.getView()),v&&v.parentNode?e===v?!0:(e=v,v.parentNode.removeChild(v),e=V,!0):!1}}(),getToolTipDiv:function(){if(!xq){xq=Rn(),ap=Rn();var z=xq.style;B.baseZIndex!=V&&(z.zIndex=Zp(B.baseZIndex)+3+""),z.whiteSpace="nowrap",z.color=B.toolTipLabelColor,z.background=B.toolTipBackground,z.font=B.toolTipLabelFont,z.padding="5px",z.boxShadow="0px 0px 3px "+B.toolTipShadowColor}return xq},isToolTipShowing:function(){return xq&&xq.parentNode?!0:ap&&ap.parentNode?!0:!1},updateToolTipContent:function(m,h){if(B.isToolTipShowing()&&(h||(h=lj&&lj.view),m===$&&h&&lj.e&&(m=h.getToolTip(lj.e)),m!=V)){var d;m.html?(m=m.html,d=ap):d=xq,d.innerHTML=m}},hideToolTip:function(){if(B.isToolTipShowing()){zg(xq),zg(ap),je();var h=lj&&lj.view;h&&h.onHideToolTip&&h.onHideToolTip(),lj=V}},showToolTip:function(J,c,X){if(!J||c==V)return ur(),void 0;B.getToolTipDiv();var p,Z;if(c.html?(c=c.html,p=ap,zg(xq)):(p=xq,zg(ap)),Z=p.style,p.innerHTML=c,p.parentNode||C.Default.appendToScreen(p),J.target){J=Wc(J);var N=Nk(),k=J.x,e=J.y,U=gp?60:12;if(gp){var n=p.getBoundingClientRect();Z.left=k-n.width/2+Tn,Z.top=e-n.height-U<N.top?e+U+Tn:e-n.height-U+Tn}else{Z.left=k+U+Tn,Z.top=e+U+Tn;var n=p.getBoundingClientRect();n.left+n.width>N.width&&(Z.left=k-U-n.width+Tn),n.top+n.height>N.height&&(Z.top=e-U-n.height+Tn),n.left<0&&(Z.left=k+U+Tn),n.top<0&&(Z.top=e+U+Tn)}}else Z.left=J.x+Tn,Z.top=J.y+Tn;je(),X===$?X=lj&&lj.view:lj={e:J,view:X},X&&X.onShowToolTip&&X.onShowToolTip()},startDragging:function(z,L,x){x==$&&(x=!0),z!==mr&&(mr?x&&(jk(L)?mr.handleWindowTouchEnd(L):mr.handleWindowMouseUp(L)):jk(L)?(A(n,yi,ne),A(n,fn,Id)):(A(n,Oq,Jb),A(n,Ce,$i)),mr=z)},getImageMap:function(){return Qk},toBoundaries:function(y,I,J,P){var t=[];return ds(y,I,J,P).forEach(function(r){var B=[];r.forEach(function(E){B.push(E.x,E.y)}),t.push(B)}),t},getCurrentKeyCodeMap:function(){return vm},drawCenterImage:function(J,X,V,t,O,g,z,$){!O&&g&&g.isSelfViewEvent&&(O=g);var Q=Fe(X,O,g),h=Dm(X,O,g);em(J,X,k(V-Q/2),k(t-h/2),Q,h,O,g,z,$)},drawStretchImage:function(T,W,$,o,J,v,x,H,d,c,R,N){!H&&d&&d.isSelfViewEvent&&(H=d);var G,e=Fe(W,H,d,v),g=Dm(W,H,d,x);"uniform"===$?(G=s(v/e,x/g),e*=G,g*=G,o+=k((v-e)/2),J+=k((x-g)/2),v=e,x=g):"centerUniform"===$&&((e>v||g>x)&&(G=s(v/e,x/g),e*=G,g*=G),o+=k((v-e)/2),J+=k((x-g)/2),v=e,x=g);var q=T.interactiveInfo;if(q){var U;if(U="center"===$?{x:o+v/2-e/2,y:J+x/2-g/2,width:e,height:g}:{x:o,y:J,width:v,height:x},q.rect){var Y=q.compInfos,L=Y.length;L&&(Y[L-1].rect.image=W)}else q.rect=U}if("center"===$){var u=R!==!1&&(e>v||g>x);u&&(T.save(),T.beginPath(),T.rect(o,J,v,x),T.clip()),em(T,W,o+v/2-e/2,J+x/2-g/2,e,g,H,d,c,N),u&&T.restore()}else em(T,W,o,J,v,x,H,d,c,N)},toCanvas:function(x,i,r,v,q,_,u,A,R){x=Cc(x,u),i=i||Fe(x,q),r=r||Dm(x,q);var Y=ob(),z=ye(Y);return A?(Yl(Y,i,r,A),z.scale(A,A)):Yl(Y,i,r,1),kr(z,x,v,0,0,i,r,q,_,u,R),x&&x.clampToEdge&&(Y.clampToEdge=x.clampToEdge),z.restore(),Y},toGrayColor:function(e){if(!e)return e;var n=Fh(e),o=k(.299*n[0]+.587*n[1]+.114*n[2]);return"rgba("+o+","+o+","+o+","+n[3]/255+")"
},createGradientImage:function(y,g,P,N){for(var Z=["L",0,0,y,0,1,0,0,1,0,0],u=0,c=Math.min(g.length,P.length);c>u;u++)Z.push(P[u],g[u]);var w=C.Default.toCanvas({width:y,height:y,clampToEdge:!0,comps:[{type:"shape",rotation:N||0,points:[0,0,y,0,y,y,0,y],background:"#ffffff",gradientPack:Z}]});return w},createElement:function(P,Q,T,q){var z=i.createElement(P);return Ve(z,Q||h.widgetBorder,2),z.style.font=T?T:Yf,q!=V&&(z.value=q),B.onElementCreated&&B.onElementCreated(z),z},containedInView:function(r,t){var O=Wn(t).getBoundingClientRect();return lc({x:O.left,y:O.top,width:O.width,height:O.height},kd(r))},isIsolating:function(){return ei>0},setIsolating:function(v){v?ei++:ei--},getMSMap:function(){return Oh},stringify:function(a,X,A){var r=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var k=jo.prototype.toJSON;jo.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},X=A?0:X==V?2:X;var p=JSON.stringify(a,function(b,f){return"function"==typeof f?"__ht__"+(f.__ht__||f.toString()):Ob(f)?nm(f):f instanceof C.List?"__ht__list"+(f.__ht__list||B.stringify(f._as)):f},X);return Date.prototype.toJSON=r,jo.prototype.toJSON=k,A&&(p=qd+mm(p)),p},parse:function(D,i){return Zq(D)?D.substr(0,12)!=qd||(D=mn(D.substr(12)),Zq(D))?(i=i||{},JSON.parse(D,function(S,c){if(Zq(c))if(i.ignoreFunction||"__ht__function"!=c.substr(0,14)){if(!i.ignoreDate&&"__ht__date"==c.substr(0,10))return new Date(Zp(c.substr(10)));if("__ht__list"===c.substr(0,10))return new le(B.parse(c.substr(10)));if(!i.ignoreDataModel&&"__ht__dataModel"===c.substr(0,15)){var G=new jo;return G.deserialize(B.parse(c.substr(15))),G}}else{var t=c.indexOf("{")+1,j=c.lastIndexOf("}"),P=c.indexOf("(")+1,u=c.indexOf(")");if(t&&j&&P&&u)try{var N=new Function(c.substring(P,u),c.substring(t,j));return N.__ht__=c.substr(6),N}catch(e){throw console.info("=== SyntaxError ===\n",c),e}}return c})):D:D},loadJS:function(T,U){U&&T.push(U);var Z=T.shift();if(Xj(Z))T=Z.contact(T),B.loadJS(T);else if(mj(Z))Z(),B.loadJS(T);else if(Zq(Z)){var C=i.createElement("script");C.onload=function(){B.loadJS(T)},C.setAttribute("src",Z),i.getElementsByTagName("head")[0].appendChild(C)}else T.length&&B.loadJS(T)},extendClass:function(U,L){var z=U.prototype;for(var q in L)Oh[q]&&Oh.hasOwnProperty(q)?Oh[q](z,L):z[q]=L[q]},toRoundedCorner:function(){function k(t,l,S){t.x=l.x,t.y=l.e||S,t.z=l.y}var g=new Qe,v=new Qe,O=new Qe,W=new Qe;return function(n,Z){var p,m=0;n.getPoints&&(m=n.getElevation(),n=n.getPoints()),p=n instanceof le?n:new le(n);var E=p.size();if(0>=Z)return{points:p};var z=new le,H=new le,T=p.get(0);k(g,T,m),z.add(T),H.add(1);for(var i=1;E>i;i++)if(E>i+1){var s=p.get(i),l=p.get(i+1);k(v,s,m),k(O,l,m),W.subVectors(g,v).setLength(Math.min(.99*W.length(),Z)).add(v),s.e!==$||T.e!==$?z.add({x:W.x,y:W.z,e:W.y}):z.add({x:W.x,y:W.z}),z.add(s),W.subVectors(O,v).setLength(Math.min(.99*W.length(),Z)).add(v),s.e!==$||l.e!==$?z.add(T={x:W.x,y:W.z,e:W.y}):z.add(T={x:W.x,y:W.z}),g.copy(W),H.addAll([2,3])}else z.add(p.get(i)),H.add(2);return{points:z,segments:H}}}(),toColorData:Fh,setCanvas:Yl,createDiv:Rn,createDisabledDiv:jg,createView:mk,createCanvas:ob,appendChild:os,initContext:ye,checkLoadingImage:zi,translateAndScale:Dd,layout:$m,getPosition:Dn,drawPoints:gh,drawRoundRect:xm,drawBorder:hk,setFocus:ce,getter:Bb,setter:Bi,isEmptyObject:bs,cameraPriority:function(){var K={skybox:0,main:1e4,top:1e7,infinity:1/0};return e.seal(e.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return K.skybox},set:function(i){if(i>=K.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");K.skybox=Number(i)}},main:{configurable:!1,enumerable:!1,get:function(){return K.main},set:function(j){if(j<=K.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(j>=K.top)throw new RangeError("Main camera must have lower priority than the top camera.");K.main=Number(j)}},top:{configurable:!1,enumerable:!1,get:function(){return K.top},set:function(H){if(H<=K.main)throw new RangeError("Top camera must have higher priority than the main camera.");K.top=Number(H)}}}))}()},!0),Ki(W,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var _m=B.disabledOpacity,Sj=B.toolTipDelay,Me=B.devicePixelRatio,cp=B.autoMakeVisible,Sr=B.autoHideScrollBar,yn=B.imageGradient,cs=B.showToolTip,ur=B.hideToolTip,dg=B.dashPattern,Ee=B.lineCap,nh=B.lineJoin,Ri=B.labelColor,ps=B.labelSelectColor,Yf=B.labelFont,He=B.widgetIndent,hi=B.widgetRowHeight,ld=B.widgetHeaderHeight,sl=B.widgetTitleHeight,kk=B.scrollBarColor,Qb=B.scrollBarSize,Ui=B.scrollBarTimeout,Dk=B.scrollBarMinLength,oc=B.scrollBarInteractiveSize,kf=B.zoomIncrement,bg=B.scrollZoomIncrement,sf=B.pinchZoomIncrement,tn=B.zoomMax,An=B.zoomMin,gi=B.createObject,qk=B.preventDefault,Kb=B.setImage,Cc=B.getImage,vl=B.isImageComplete,mh=B.drawCenterImage,kr=B.drawStretchImage,jl=B.getId,aq=B.callLater,xl=B.cancelLater,uc=B.sortFunc,Xn=B.clone,Zh=B.getClass,Tp=B.startAnim,cr=B.brighter,$e=B.darker,ws=B.drawText,ts=B.getTextSize,gl=B.isLeftButton,Bk=B.isMiddleButton,Fb=B.isRightButton,Bg=B.getTouchCount,Kr=B.isDoubleClick,Fk=B.isShiftDown,kj=B.isCtrlDown,kd=B.getClientPoint,Wc=B.getPagePoint,Lf=B.getDistance,lq=B.unionPoint,Co=B.unionRect,lc=B.containsPoint,hs=B.containsRect,vs=B.intersectsRect,Am=B.intersection,Nk=B.getWindowInfo,Pm=B.grow,Kf=B.getLogicalPoint,eb=B.getScreenPoint,Lj=B.startDragging,zg=B.removeHTML,uf=B.createElement,Nl=B.segmentResolution,Bj=B.shapeResolution,Zn=B.shapeSide,ym=B.def,Yb=function(p,c,O){ym(M+"."+p,c,O)},Vq=function(M,k){M.childNodes.forEach(function(U){k(U),Vq(U,k)})};Ki(B,{toolTipLabelColor:Ri,toolTipLabelFont:Yf,toolTipBackground:h.toolTipBackground,toolTipShadowColor:Rm,debugTipLabelFont:Yf,debugTipLabelColor:Ri,debugTipBackground:h.toolTipBackground,drawBreakableText:Em,setDevicePixelRatio:function(D){Me=B.devicePixelRatio="number"==typeof D?D:n.screen?n.screen.deviceXDPI/n.screen.logicalXDPI:1,Vq(i.body,function(y){var C=y._ht;C&&C._canvas&&(Yl(C._canvas,C.getWidth(),C.getHeight()),C.redraw?C.redraw():C.iv())})}},!0);var zr=1e-6,Ad="undefined"!=typeof Uint16Array?Uint16Array:Array,Uj="undefined"!=typeof Float32Array?Float32Array:Array,Fq=function(i,$,f){var A=[i[0]-$[0],i[1]-$[1],i[2]-$[2]];if(f){var P=Lf(A);P>0&&(A[0]/=P,A[1]/=P,A[2]/=P)}return A},Pj=function(){var T="charCodeAt",J=2*(2*Sp.length+1);for(var F in n)if(F===M+ar[0]+(Tn.length+2)){var G=n[F];if(!G)break;for(var S=G.length,L=0;S>L;L++)if(G[L][T](0)===J&&G[L+1]!=V&&G[L+1]===Tn[0]&&G[L+2]!=V&&G[L+2][T](0)===J){for(var l=L+3;S>l;l++)if(G[l][T](0)===J){if(0==G[l+1])for(var Q,r=l+2;S>r;r++){if(G[r][T](0)===J){0==G[r-1]&&Q&&(ub=Q.substr(0,Q.length-1));break}Q==V?Q=G[r]:Q+=G[r]}break}break}break}return function(w){return[-w[0],-w[1],-w[2]]}}(),Dr=function(n,t){return 3===n.length?n[0]*t[0]+n[1]*t[1]+n[2]*t[2]:n[0]*t[0]+n[1]*t[1]},no=function(){var U=new Array(16);return U[0]=1,U[1]=0,U[2]=0,U[3]=0,U[4]=0,U[5]=1,U[6]=0,U[7]=0,U[8]=0,U[9]=0,U[10]=1,U[11]=0,U[12]=0,U[13]=0,U[14]=0,U[15]=1,U},gk=no(),Od=function(I){var $=new Array(16);return $[0]=I[0],$[1]=I[1],$[2]=I[2],$[3]=I[3],$[4]=I[4],$[5]=I[5],$[6]=I[6],$[7]=I[7],$[8]=I[8],$[9]=I[9],$[10]=I[10],$[11]=I[11],$[12]=I[12],$[13]=I[13],$[14]=I[14],$[15]=I[15],$},Xd=function(g,$){return g[0]=$[0],g[1]=$[1],g[2]=$[2],g[3]=$[3],g[4]=$[4],g[5]=$[5],g[6]=$[6],g[7]=$[7],g[8]=$[8],g[9]=$[9],g[10]=$[10],g[11]=$[11],g[12]=$[12],g[13]=$[13],g[14]=$[14],g[15]=$[15],g},Md=function(B){return B[0]=1,B[1]=0,B[2]=0,B[3]=0,B[4]=0,B[5]=1,B[6]=0,B[7]=0,B[8]=0,B[9]=0,B[10]=1,B[11]=0,B[12]=0,B[13]=0,B[14]=0,B[15]=1,B},rq=function(I,j){var p=I[0],C=I[1],e=I[2];return I[0]=j[0]*p+j[4]*C+j[8]*e+j[12],I[1]=j[1]*p+j[5]*C+j[9]*e+j[13],I[2]=j[2]*p+j[6]*C+j[10]*e+j[14],I},Vh=function(A,Z){var v=A[0],x=A[1],J=A[2],h=A[3];return A[0]=Z[0]*v+Z[4]*x+Z[8]*J+Z[12]*h,A[1]=Z[1]*v+Z[5]*x+Z[9]*J+Z[13]*h,A[2]=Z[2]*v+Z[6]*x+Z[10]*J+Z[14]*h,A[3]=Z[3]*v+Z[7]*x+Z[11]*J+Z[15]*h,A},vc=function(){var Y,b,F,l,L=_j(Ul[1]+Ul[7]),U=_j(Ul[0]+Ul[3]-Ul[10]),o=_j(Ul[8]+2),E=function(){return b=F.charAt(Y),Y+=1,b},G=function(){var R="";if(b===o)for(;E();){if(b===o)return E(),R;R+=b}else E()},g=function(){for(;b&&" ">=b;)E()},i=function(){var D,k={};if(b===L){if(E(),g(),b===U)return E(),k;for(;b;){if(D=G(),g(),E(),k[D]=l(),g(),b===U)return E(),k;E(),g()}}};return l=function(){switch(g(),b){case L:return i();default:return G()}},function(N){if(t={},N){var x;if(F=N,Y=0,b=" ",x=l(),g(),!b)return x}}}(),Hi=function(C,P){if(P){var V=w(P),H=D(P),g=C[4],K=C[5],s=C[6],Q=C[7],o=C[8],J=C[9],T=C[10],p=C[11];C[4]=g*H+o*V,C[5]=K*H+J*V,C[6]=s*H+T*V,C[7]=Q*H+p*V,C[8]=o*H-g*V,C[9]=J*H-K*V,C[10]=T*H-s*V,C[11]=p*H-Q*V}},Ok=function(h,p){if(p){var L=w(p),z=D(p),Y=h[0],K=h[1],j=h[2],t=h[3],S=h[8],R=h[9],O=h[10],T=h[11];h[0]=Y*z-S*L,h[1]=K*z-R*L,h[2]=j*z-O*L,h[3]=t*z-T*L,h[8]=Y*L+S*z,h[9]=K*L+R*z,h[10]=j*L+O*z,h[11]=t*L+T*z}},Vd=function(k,C){if(C){var l=w(C),r=D(C),n=k[0],B=k[1],u=k[2],O=k[3],G=k[4],f=k[5],o=k[6],m=k[7];k[0]=n*r+G*l,k[1]=B*r+f*l,k[2]=u*r+o*l,k[3]=O*r+m*l,k[4]=G*r-n*l,k[5]=f*r-B*l,k[6]=o*r-u*l,k[7]=m*r-O*l}},Uf=function(a,s,Q){return Gl(V,Q===!1?V:a.getFinalScale3d(),a.getFinalRotation3d(),a.getRotationMode(),a.p3(),V,s)},Gl=function(d,f,Y,c,t,e,a){return e||(e=no()),t&&rm(e,t),si(e,Y,c),a&&te(e,e,a),f&&Ye(e,f),d&&te(e,e,d),e},qo=function(N,t,S){t=Zp(t),S=Zp(S);var L=this;L.g=N,L._84O=t,L._85O=S,L._70I=!0,L.F=0,L._83O=t+S,L.pen={x:0,y:0}},Wk="lineDashOffset",Cm="setLineDash",Rb=function(B){for(var c in B)1===c.length&&(Wk=B[c]);return c?1:0},Kg=function(v,F,H){return Zj(F)?v:v[Cm]?(v[Cm](F),H&&(v.lineDashOffset=H),v):new qo(v,F[0],F.length>1?F[1]:F[0])},Ze=function(o,X){!Zj(X)&&o[Cm]&&(o[Cm](Lg),o.lineDashOffset=0)};if(ym(qo,e,{_69I:6,moveTo:function(V,M){var s=this,r=s.pen;r.x=V,r.y=M,s.g.moveTo(V,M),s.start||(s.start={x:V,y:M})},lineTo:function(c,i){var E=this,F=E.pen,l=c-F.x,h=i-F.y,W=I(h,l),O=D(W),S=w(W),e=E._23O(F.x,F.y,c,i),K=E._85O,r=E._84O,g=E._83O;if(E.F){if(E.F>e)return E._70I?E._72I(c,i):E.moveTo(c,i),E.F-=e,void 0;if(E._70I?E._72I(F.x+O*E.F,F.y+S*E.F):E.moveTo(F.x+O*E.F,F.y+S*E.F),e-=E.F,E.F=0,E._70I=!E._70I,!e)return}var $=b(e/g);if($){for(var k=O*r,U=S*r,n=O*K,Y=S*K,X=0;$>X;X++)E._70I?(E._72I(F.x+k,F.y+U),E.moveTo(F.x+n,F.y+Y)):(E.moveTo(F.x+n,F.y+Y),E._72I(F.x+k,F.y+U));e-=g*$}E._70I?e>r?(E._72I(F.x+O*r,F.y+S*r),E.moveTo(c,i),E.F=K-(e-r),E._70I=!1):(E._72I(c,i),e===r?(E.F=0,E._70I=!E._70I):(E.F=r-e,E.moveTo(c,i))):e>K?(E.moveTo(F.x+O*K,F.y+S*K),E._72I(c,i),E.F=r-(e-K),E._70I=!0):(E.moveTo(c,i),e===K?(E.F=0,E._70I=!E._70I):E.F=K-e)},quadraticCurveTo:function(r,P,o,s){var c,K=this,n=K.pen,I=n.x,l=n.y,G=K._22O(I,l,r,P,o,s),N=0,Y=0,f=K._85O,V=K._84O;if(K.F){if(K.F>G)return K._70I?K._71I(r,P,o,s):K.moveTo(o,s),K.F-=G,void 0;if(N=K.F/G,c=K._20O(I,l,r,P,o,s,N),K._70I?K._71I(c[2],c[3],c[4],c[5]):K.moveTo(c[4],c[5]),K.F=0,K._70I=!K._70I,!G)return}var J=G-G*N,A=b(J/K._83O),F=V/G,Q=f/G;if(A)for(var W=0;A>W;W++)K._70I?(Y=N+F,c=K._21O(I,l,r,P,o,s,N,Y),K._71I(c[2],c[3],c[4],c[5]),N=Y,Y=N+Q,c=K._21O(I,l,r,P,o,s,N,Y),K.moveTo(c[4],c[5])):(Y=N+Q,c=K._21O(I,l,r,P,o,s,N,Y),K.moveTo(c[4],c[5]),N=Y,Y=N+F,c=K._21O(I,l,r,P,o,s,N,Y),K._71I(c[2],c[3],c[4],c[5])),N=Y;J=G-G*N,K._70I?J>V?(Y=N+F,c=K._21O(I,l,r,P,o,s,N,Y),K._71I(c[2],c[3],c[4],c[5]),K.moveTo(o,s),K.F=f-(J-V),K._70I=!1):(c=K._19O(I,l,r,P,o,s,N),K._71I(c[2],c[3],c[4],c[5]),G===V?(K.F=0,K._70I=!K._70I):(K.F=V-J,K.moveTo(o,s))):J>f?(Y=N+Q,c=K._21O(I,l,r,P,o,s,N,Y),K.moveTo(c[4],c[5]),c=K._19O(I,l,r,P,o,s,Y),K._71I(c[2],c[3],c[4],c[5]),K.F=V-(J-f),K._70I=!0):(K.moveTo(o,s),J===f?(K.F=0,K._70I=!K._70I):K.F=f-J)},bezierCurveTo:function(){var Y=arguments;this.pen={x:Y[4],y:Y[5]},this.g.bezierCurveTo(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5])},arc:function(v,z,M,e,L,C){C||(e=-e,L=-L),xh(this,v,z,e,L-e,M,M,!1)},rect:function(D,v,d,p){var m=this;m.pen={x:D,y:v},m.moveTo(D,v),m.lineTo(D,v+p),m.lineTo(D+d,v+p),m.lineTo(D+d,v),m.lineTo(D,v)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(r,D,x,I){var p=x-r,s=I-D;return j(p*p+s*s)},_22O:function(T,u,m,V,t,A,l){for(var x,n,e,E,I,C,D,Y=0,k=T,r=u,H=l>0?l:this._69I,G=1;H>=G;G++)e=G/H,E=1-e,I=E*E,C=2*e*E,D=e*e,x=I*T+C*m+D*t,n=I*u+C*V+D*A,Y+=this._23O(k,r,x,n),k=x,r=n;return Y},_21O:function(L,q,$,c,e,h,B,i){var v=this;if(0===B)return v._20O(L,q,$,c,e,h,i);if(1===i)return v._19O(L,q,$,c,e,h,B);var t=v._20O(L,q,$,c,e,h,i);return t.push(B/i),v._19O.apply(v,t)},_20O:function(s,A,m,P,T,R,q){if(1!==q){var Y=m+(T-m)*q,Z=P+(R-P)*q;m=s+(m-s)*q,P=A+(P-A)*q,T=m+(Y-m)*q,R=P+(Z-P)*q}return[s,A,m,P,T,R]},_19O:function(Q,R,C,j,n,O,H){if(1!==H){var h=Q+(C-Q)*H,Z=R+(j-R)*H;C+=(n-C)*H,j+=(O-j)*H,Q=h+(C-h)*H,R=Z+(j-Z)*H}return[Q,R,C,j,n,O]},_72I:function(g,p){var K=this.pen;(g!==K.x||p!==K.y)&&(K.x=g,K.y=p,this.g.lineTo(g,p))},_71I:function(O,c,b,o){var $=this.pen;(O!==b||c!==o||b!==$.x||o!==$.y)&&($.x=b,$.y=o,this.g.quadraticCurveTo(O,c,b,o))}}),O&&Hk){var is=Hk.toString();m=is.indexOf(bo.substr(0,2))>0&&is.indexOf(hp+hp.substr(1,1))>1||is.indexOf(Ap.substr(0,2)+bo.substr(2,2)+ar[0]+bo[4])>1?!0:!1}var Qn=V,Xk=V,Hj=B.checkLoadingCompType=function(O){Qn&&!O._72O&&(Xk||(Xk={}),Xk[O._72O=jl()]=O)},hd=function(p,I){if(I||(I=p),I&&(Qn||(Qn={}),!Qn[p])){var b=new zh;if(Qn[I]={request:b,url:I},I=B.beforeLoadURL(I,p),I.data){var C=B.parse(I.data);Kd(p,C),B.handleCompTypeLoaded(p,C)}else{b.onload=function(){if(200===this.status||0===this.status){var D=B.parse(b.getResponseText());Kd(p,D),B.handleCompTypeLoaded(p,D)}else Kd(p,V)},b.onerror=function(){Kd(p,V)};var k={};k.url=encodeURI(I),k.sync=!1,b.send(k)}}},Kd=function(Q,i){if(If[Q]=i,delete Qn[Q],bs(Qn)&&(Qn=V,Xk)){for(var u in Xk){var H=Xk[u];H.invalidateAll&&H.invalidateAll($,"compTypeLoaded",Q),H.redraw&&H.redraw(),H.iv(),delete H._72O}Xk=V}if(i&&Xk)for(var u in Xk){var H=Xk[u];H.invalidateAll&&H.invalidateAll($,"compTypeLoading",Q),H.redraw&&H.redraw(),H.iv()}},kh=h.chart,Go="",Hb=!0,Ar=B.compStack=[],Io=/^style@/,Fj=/^attr@/,kn=/^field@/,ok={x:.5,y:.5},Op=function(){Hb=!0},Cd=function(){return Hb},Fe=function(s,Y,B,c){if(!s)return 0;if(Th(s.fitSize,Y,B)&&c)return c;var K=Th(s.width,Y,B);return null==K?20:K},Dm=function(q,H,c,t){if(!q)return 0;if(Th(q.fitSize,H,c)&&t)return t;var m=Th(q.height,H,c);return null==m?20:m},Th=function(Z,b,Q){if(!Z||!Z.func)return Z;var K,B=Z.func,_=Z.value;return K=mj(B)?Q&&Q.vectorDataBindingDisabled&&!Z.isSafeFunc?_:B(b,Q):b instanceof Tr||(C.ui?b instanceof C.ui.View:0)?Fj.test(B)?b.a(Go+B.slice(5)):Io.test(B)?b.s(Go+B.slice(6)):kn.test(B)?b[B.slice(6)]:b[B]?b[B](Q):_:_,_!==$&&K==V?_:K},em=B.drawImage=function(){var P,R,A,X,j,Z,W=3,f=6,q=function(X){var i,F,T,y=!1;return C(X,"shadow")&&(i=C(X,"shadowOffsetX")||W,F=C(X,"shadowOffsetY")||W,T=C(X,"shadowBlur")||f,y=!0),!y&&R instanceof Tr&&((Ng(R,es,"shadow")||"shadow"===Ng(R,es,"select.type")&&A&&A.isSelected&&A.isSelected(R))&&(i=Ng(R,es,"shadow.offset.x")||0,F=Ng(R,es,"shadow.offset.y")||0,T=Ng(R,es,"shadow.blur")||0,y=!0),!y&&Ng(R,es,"shadow2")&&(i=Ng(R,es,"shadow2.offset.x")||0,F=Ng(R,es,"shadow2.offset.y")||0,T=Ng(R,es,"shadow2.blur")||0,y=!0)),y?1.5*T+Math.max(i,F):0},S=function(B,G){B.getValue&&B.getValue.compType===G||(B.getValue=function(J){var p=C(B,J);if(p===$&&G.properties){var s=G.properties[J];s&&(p=s.defaultValue)}return p},B.getColor=function(C,r){return r===!0?T(C):T(B.getValue(C))},B.getValue.compType=G)},C=function(T,t,P){var x,O=!1;if(T.prefix&&R instanceof Tr){var D=R.a(Go+t);D!==$&&(O=!0,x=D)}return x===$&&(x=T[t]),x&&x.func&&(O=!0,x=Th(x,R,A)),P&&(x=P(x),O||(T[t]=x)),x},T=function(s,m){var U;return U=m?C(s,m):s,P&&P.compGray&&U?B.toGrayColor(U):j&&U?to(U,j,Z):U},_=function(G){if(Xj(G)){for(var q=new le,O=G.length,v=0;O>v;v+=2)q.add({x:G[v],y:G[v+1]});G=q}return G},Q=function(f){var q=C(f,"anchorX"),D=C(f,"anchorY");if(q!==$||D!==$)return{x:q===$?ok.x:q,y:D===$?ok.y:D};var r=C(f,"type"),j=C(f,"name");if("image"!==r||!j)return ok;var B=Cc(j);return B&&B.anchorX!==$&&B.anchorY!==$?{x:B.anchorX,y:B.anchorY}:ok},a=function(n,y){var S=C(n,Rq),N=Q(n);if(Xj(S)){var A=S.length,H=C(n,"relative"),v=y.width,X=y.height;if(4===A)S={x:S[0],y:S[1],width:S[2],height:S[3]},H&&(S.x*=v,S.y*=X,S.width*=v,S.height*=X);else if(3===A){var j=S[0];S={width:S[1],height:S[2]},H&&(S.width*=v,S.height*=X),"object"==typeof j?j.length&&(j={x:j[0],y:j[1]}):j=Dn(j,y,S),S.x=j.x-S.width*N.x,S.y=j.y-S.height*N.y}S.x+=C(n,"offsetX")||0,S.y+=C(n,"offsetY")||0,!H&&y.fitSize&&(S=h(n,S,y))}return S},h=function(F,i,B){if(i){var P,U,N,X={x:i.x,y:i.y,width:i.width,height:i.height},G=Q(F),d=C(F,"layoutH"),o=C(F,"layoutV"),j=1,l=1,O=0,Z=0,M=1,n=1;switch(d){case"left":break;case"right":X.x+=B.width-B.rw;break;case"center":X.x+=.5*(B.width-B.rw);break;case"scale":case"leftright":default:P=C(F,Xc)||0,P&&(O=Math.abs(Z=Math.sin(P)),M=Math.abs(n=Math.cos(P))),"leftright"!==d?(j+=M*(B.widthScale-1),l+=O*(B.widthScale-1)):(j+=X.width?M*(B.width-B.rw)/X.width:0,l+=X.height?O*(B.width-B.rw)/X.height:0,U=-Math.min(-G.x*n+G.y*Z,-G.x*n-(1-G.y)*Z,(1-G.x)*n+G.y*Z,(1-G.x)*n-(1-G.y)*Z))}switch(o){case"top":break;case"bottom":X.y+=B.height-B.rh;break;case"center":X.y+=.5*(B.height-B.rh);break;case"scale":case"topbottom":default:P==V&&(P=C(F,Xc),P&&(O=Math.abs(Z=Math.sin(P)),M=Math.abs(n=Math.cos(P)))),"topbottom"!==o?(j+=O*(B.heightScale-1),l+=M*(B.heightScale-1)):(j+=X.width?O*(B.height-B.rh)/X.width:0,l+=X.height?M*(B.height-B.rh)/X.height:0,N=-Math.min(-G.x*Z-G.y*n,-G.x*Z+(1-G.y)*n,(1-G.x)*Z-G.y*n,(1-G.x)*Z+(1-G.y)*n))}return(1!==j||1!==l)&&("scale"!==d&&d?"leftright"===d&&(X.x+=X.width*(1-j)*G.x+U*(B.width-B.rw)):X.x+=X.x*(B.widthScale-1)+G.x*X.width*(B.widthScale-j),"scale"!==o&&o?"topbottom"===o&&(X.y+=X.height*(1-l)*G.y+N*(B.height-B.rh)):X.y+=X.y*(B.heightScale-1)+G.y*X.height*(B.heightScale-l),X.width*=j,X.height*=l),X.width<0&&(X.width=0),X.height<0&&(X.height=0),X}},G=function(Y){return Xj(Y)?new le(Y):Y},e=function(b,c,Q,e,Y,d,a){var _=P.interactiveInfo,J=b.transform;if(J)return P.save(),P.setTransform(J.a,J.b,J.c,J.d,J.tx,J.ty),_&&_.compInfos.push({comp:b,rect:c,matrix:J.clone(),prefix:Go,refRect:_.refRect}),!0;Y===$&&(Y=1),d===$&&(d=1);var T=C(b,"clipPercentage"),S=Rh(Q,c);if(S&&!e&&1===Y&&1===d&&!(1>T))return _&&_.compInfos.push({comp:b,rect:c,matrix:_.matrix.clone(),prefix:Go,refRect:_.refRect}),!1;a=a||ok;var z=c.x+c.width*a.x,v=c.y+c.height*a.y,E=Q.x+Q.width*a.x,X=Q.y+Q.height*a.y,m=Q.width?Y*(c.width/Q.width):1,L=Q.height?d*(c.height/Q.height):1;if(P.save(),_&&(_.matrix.appendTranslate(z,v).appendRotate(e).appendScale(m,L).appendTranslate(-E,-X),_.compInfos.push({comp:b,rect:c,matrix:_.matrix.clone(),prefix:Go,refRect:_.refRect})),Sg(P,z,v),Nh(P,e||0),wk(P,m,L),Sg(P,-E,-X),1>T){0>T&&(T=0);var h=hc(Q,C(b,"clipDirection"),T,q(b));P.beginPath(),P.rect(h.x,h.y,h.width,h.height),P.clip()}return!0},v=function(){P.restore()},t=function(x,q,F){var z=C(x,"path"),S=C(x,Xc),i=C(x,"scaleX"),k=C(x,"scaleY"),p=Q(x),t=V,$=zb(null,z);if(F||(F=x.unionRect,F||(F=lq($),x.path.func||(x.unionRect=F)),t=F),F){t||(t=x.unionRect,t||(t=lq($),x.path.func||(x.unionRect=t)));var u=e(x,F,t,S,i,k,p),o=C(x,"borderPattern"),M=Kg(P,o),Y=T(x,"background"),b=T(x,"borderColor"),g=C(x,"borderWidth"),G=C(x,"gradient"),I=T(x,"gradientColor"),r=C(x,"border3d"),l=T(x,"border3dColor"),A=C(x,"border3dAccuracy"),L=P.lineJoin,w=P.lineCap;P.lineJoin=C(x,"borderJoin")||nh,P.lineCap=C(x,"borderCap")||Ee,Y?(lb(P,Y,G,I,t),zb(P,z),P.fill(),M!==P&&zb(P,z)):zb(P,z);var c=C(x,"borderWidthAbsolute");if(c&&(P.save(),P.setTransform(1,0,0,1,0,0)),g&&b&&(P.lineWidth=g,P.strokeStyle=b,P.stroke(),r&&Ph(P,b,l,g,X,A)),Ze(P,o),C(x,"dash")){var j=C(x,"dashWidth")||g;if(j>0){o=C(x,"dashPattern")||dg;var M=Kg(P,o,C(x,"dashOffset")),W=T(x,"dashColor")||T(ih);M!==P&&zb(P,z),P.strokeStyle=W,P.lineWidth=j,P.stroke(),C(x,"dash3d")&&Ph(P,W,T(x,"dash3dColor"),j,X,C(x,"dash3dAccuracy")),Ze(P,o)}}c&&P.restore(),q===Rq&&Kl(P,Y,C(x,"depth"),t),P.lineJoin=L,P.lineCap=w,u&&v()}},u=function(u,y,d,Y){var U=C(u,Jd,_),i=C(u,Xc),N=Q(u);if(U&&Y.fitSize){var m=new le,L=lq(U),x=h(u,L,Y),a=L.x+N.x*L.width,p=L.y+N.y*L.height,l=x.x+N.x*x.width,D=x.y+N.y*x.height,W=L.width?x.width/L.width:1,O=L.height?x.height/L.height:1;U.each(function($){m.add({x:l+($.x-a)*W,y:D+($.y-p)*O})}),U=m,u.unionRect=null}var s=C(u,"scaleX"),w=C(u,"scaleY"),f=y===Po,n=V;if(!d&&f&&(d=u.unionRect,d||(d=lq(U),u.points.func||(u.unionRect=d)),n=d),d){f?n||(n=u.unionRect,n||(n=lq(U),u.points.func||(u.unionRect=n))):n=d;var J,S,H,B,o=e(u,d,n,i,s,w,N),E=C(u,"borderPattern"),g=Kg(P,E),I=T(u,"background"),r=Cc(C(u,"repeatImage"),j,Z),M=C(u,"gradientPack"),K=T(u,"borderColor"),F=C(u,"borderWidth"),t=Cc(C(u,"borderRepeatImage"),j,Z),$=C(u,"segments",G),b=C(u,"gradient"),k=T(u,"gradientColor"),c=C(u,"border3d"),z=T(u,"border3dColor"),Ad=C(u,"border3dAccuracy"),Vp=C(u,"closePath"),qn=C(u,"fillRule")||"nonzero",ej=P.lineJoin,Se=P.lineCap,vm=q(u);if(P.lineJoin=C(u,"borderJoin")||nh,P.lineCap=C(u,"borderCap")||Ee,f)if(I||r||M){var sr=C(u,"fillClipPercentage");if(1>sr){0>sr&&(sr=0);var je=hc(n,C(u,"fillClipDirection"),sr,vm);P.save(),P.beginPath(),P.rect(je.x,je.y,je.width,je.height),P.clip()}gh(P,U,$,Vp),M?bl(P,M,T):r?_k(P,r,j,Z,R,A):lb(P,I,b,k,n),P.fill(qn),M&&P.restore(),1>sr&&P.restore(),g!==P&&gh(g,U,$,Vp)}else gh(g,U,$,Vp);else if("roundRect"===y?J=C(u,"cornerRadius"):"polygon"===y?J=C(u,"polygonSide"):"arc"===y&&(J=C(u,"arcFrom"),S=C(u,"arcTo"),H=C(u,"arcClose"),B=C(u,"arcOval")),I||r||M){var sr=C(u,"fillClipPercentage");if(1>sr){0>sr&&(sr=0);var je=hc(n,C(u,"fillClipDirection"),sr,vm);P.save(),P.beginPath(),P.rect(je.x,je.y,je.width,je.height),P.clip()}qp(P,y,n,J,S,H,B),M?bl(P,M,T):r?_k(P,r,j,Z,R,A):lb(P,I,b,k,n),P.fill(qn),M&&P.restore(),1>sr&&P.restore(),P!==g&&qp(g,y,n,J,S,H,B)}else qp(g,y,n,J,S,H,B);var tg=C(u,"borderWidthAbsolute");if(tg&&(P.save(),P.setTransform(1,0,0,1,0,0)),F&&(K||t)&&(P.lineWidth=F,t?$d(P,t,j,Z,R,A):P.strokeStyle=K,P.stroke(),c&&Ph(P,K,z,F,X,Ad)),Ze(P,E),C(u,"dash")){var Be=C(u,"dashWidth")||F;if(Be>0){E=C(u,"dashPattern")||dg;var g=Kg(P,E,C(u,"dashOffset")),Mp=T(u,"dashColor")||T(ih);g!==P&&(f?gh(g,U,$,Vp):qp(g,y,n,J,S,H,B)),P.strokeStyle=Mp,P.lineWidth=Be,P.stroke(),C(u,"dash3d")&&Ph(P,Mp,T(u,"dash3dColor"),Be,X,C(u,"dash3dAccuracy")),Ze(P,E)}}tg&&P.restore(),y===Rq&&Kl(P,I,C(u,"depth"),n),P.lineJoin=ej,P.lineCap=Se,o&&v()}},I=function(L,n){var f=j||C(L,_i),r=Z||C(L,"blendMode"),g=C(L,"name"),i=Cc(g,f,r);i&&i.cacheRule!=V&&(i=Gn(P,i,C(L,"stretch"),n.width,n.height,R,A,f)),i?kr(P,i,C(L,"stretch"),n.x,n.y,n.width,n.height,R,A,f,null,r):Hb=!1},U=function(f,t){var c=C(f,"text");if(c!=V){var D=C(f,"gradientPack"),X=D?bl(P,D,T):T(f,_i);ws(P,c,C(f,"font"),X,t.x,t.y,t.width,t.height,C(f,"align"),C(f,"vAlign")),D&&P.restore()}},x=function(u,c){hk(P,T(u,_i),c.x,c.y,c.width,c.height,C(u,"width"))},p=function(t,x){var W=C(t,Dc),N=0;if(W&&(W.forEach(function(V){N+=V}),N>0)){for(var Q=C(t,"colors")||kh,E=C(t,"startAngle")||0,i=C(t,"hollow"),B=C(t,rj),O=C(t,Rc),n=C(t,Qm),T=B?new le:V,b=x.x,k=x.y,H=x.width,j=x.height,I=b+H/2,Y=k+j/2,Z=s(H,j)/2,l=0,e=0;e<W.length;e++){var a=W[e],y=J*a/N,_=E+y;if(P.fillStyle=Q[l++],l===Q.length&&(l=0),P.beginPath(),i){var U=I+D(E)*Z/2,p=Y+w(E)*Z/2,h=I+D(_)*Z,S=Y+w(_)*Z;P.moveTo(U,p),P.arc(I,Y,Z/2,E,_,!1),P.lineTo(h,S),P.arc(I,Y,Z,_,E,!0)}else P.moveTo(I,Y),P.arc(I,Y,Z,_,E,!0);T&&(y=(E+_)/2,T.add({text:mj(B)?B(a,e,N,R):a,x:I+.75*D(y)*Z,y:Y+.75*w(y)*Z})),P.closePath(),P.fill(),E=_}T&&T.each(function(y){ws(P,y.text,O,n,y.x,y.y,0,0,cc)})}},z=function(u,X){var T=C(u,Xo);if(T&&T.length>0){var d=T.length,F=C(u,rj),Z=C(u,Rc),i=C(u,Qm),I=F?new le:V,q=C(u,"minValue")||0,S=C(u,"maxValue");if(S==V&&(S=0,T.forEach(function(y){C(y,Dc).forEach(function(B){S=g(S,B)})})),q===S)return;for(var K=X.height/(S-q),B=X.y+S*K,N=C(T[0],Dc).length,W=X.width/(3*N+1),k=2*W/d,r=0,o=0;d>o;o++)for(var G=T[o],z=C(G,_i),Y=C(G,"colors"),e=C(G,Dc),H=0;N>H;H++){Y?P.fillStyle=Y[H]:z?P.fillStyle=z:(P.fillStyle=kh[r++],r===kh.length&&(r=0));var c=e[H],A=c*K,l=X.x+(1+3*H)*W+o*k;if(Wq(P,l,B-A,k,A),I){var b=mj(F)?F(c,H,G,R):c,M=ts(Z,b).height;I.add({x:l,y:B-A-M,width:k,height:M,text:b})}}I&&I.each(function(s){ws(P,s.text,Z,i,s.x,s.y,s.width,s.height,cc)})}},l=function(G,D){var X=C(G,Xo);if(X&&X.length>0){var b=X.length,p=C(X[0],Dc).length,z=D.width/(3*p+1),T=0,M=C(G,"maxValue"),y=C(G,rj),i=C(G,Rc),F=C(G,Qm),r=y?new le:V;if(M==V){M=0;for(var q=0;p>q;q++){for(var v=0,E=0;b>E;E++)v+=C(X[E],Dc)[q];M=g(M,v)}}if(M>0){for(var q=0;p>q;q++)for(var H=D.y+D.height,E=0;b>E;E++){var m=X[E],$=C(m,_i),h=C(m,Dc)[q],l=h/M*D.height;$?P.fillStyle=$:(P.fillStyle=kh[T++],T===kh.length&&(T=0)),H-=l;var L={x:D.x+(1+3*q)*z,y:H,width:2*z,height:l};Wq(P,L.x,L.y,L.width,L.height),r&&(L.text=mj(y)?y(h,q,m,R):h,r.add(L))}r&&r.each(function(c){ws(P,c.text,i,F,c.x,c.y,c.width,c.height,cc)})}}},L=function(z,D){var o=C(z,Xo);if(o&&o.length>0){for(var W=o.length,L=C(o[0],Dc).length,J=D.width/(3*L+1),f=0,B=C(z,rj),Y=C(z,Rc),I=C(z,Qm),i=B?new le:V,l=0;L>l;l++){for(var c=0,p=0;W>p;p++)c+=C(o[p],Dc)[l];if(c>0){var u=D.y+D.height;for(p=0;W>p;p++){var k=o[p],n=C(k,_i),M=C(k,Dc)[l],j=M/c*D.height;n?P.fillStyle=n:(P.fillStyle=kh[f++],f===kh.length&&(f=0)),u-=j;var b={x:D.x+(1+3*l)*J,y:u,width:2*J,height:j};Wq(P,b.x,b.y,b.width,b.height),i&&(b.text=mj(B)?B(M,l,k,R):M,i.add(b))}}}i&&i.each(function(J){ws(P,J.text,Y,I,J.x,J.y,J.width,J.height,cc)})}},r=function(L,v){var e=C(L,Xo);if(e&&e.length>0){var W=e.length,a=C(L,"minValue")||0,Q=C(L,"maxValue");if(Q==V&&(Q=0,e.forEach(function(A){C(A,Dc).forEach(function(c){Q=g(Q,c)})})),a===Q)return;for(var K=v.height/(Q-a),I=v.y+Q*K,$=C(e[0],Dc).length,h=v.width/(3*$+1),o=0,O=C(L,"lineWidth")||2,p=C(L,"line3d"),M=C(L,"linePoint"),t=C(L,rj),d=C(L,Rc),w=C(L,Qm),G=0;W>G;G++){var u=e[G],z=C(u,_i),H=C(u,Dc);z?P.strokeStyle=z:(z=P.strokeStyle=kh[o++],o===kh.length&&(o=0)),P.beginPath();for(var Z=0;$>Z;Z++){var i=v.x+(2+3*Z)*h,c=I-H[Z]*K;0===Z?P.moveTo(i,c):P.lineTo(i,c)}if(P.lineWidth=O,P.stroke(),p&&Ph(P,z,V,O,X),M||t){var Y,x=O/2+2;for(Z=0;$>Z;Z++){var m=H[Z];if(i=v.x+(2+3*Z)*h,c=I-m*K,mj(M)?M(P,i,c,z,Z,u,R):M&&(P.fillStyle=z,P.beginPath(),P.arc(i,c,x,0,J,!0),P.fill()),mj(t)?Y=t(m,Z,u,R):t&&(Y=m),Y){var B=ts(d,Y).height,T=P.shadowBlur;if(T){var k=P.shadowOffsetX,n=P.shadowOffsetY,A=P.shadowColor;P.shadowOffsetX=0,P.shadowOffsetY=0,P.shadowBlur=0,P.shadowColor=V}ws(P,Y,d,w,i,c-B-x+2,0,B,cc),T&&(P.shadowOffsetX=k,P.shadowOffsetY=n,P.shadowBlur=T,P.shadowColor=A)}}}}}},M=function(d){P=d[0],R=d[1],A=d[2],X=d[3],j=d[4],Z=d[5]},d=function(){return[P,R,A,X,j,Z]},c=function(T,t){var g;A&&A.getDrawableState?g=A.getDrawableState(R):A&&A.getState?g=A.getState(R):(g=R instanceof Tr?R.s(fg):null,(g===$||null===g)&&(g=C(T,fg)));var l=C(t,fg);return l!==$&&null!==l&&l!==g?!1:C(t,rr)},O={border:x,image:I,text:U,pieChart:p,columnChart:z,stackedColumnChart:l,percentageColumnChart:L,lineChart:r};return function(y,h,w,D,b,z,g,Y,k,r){if(h&&b&&z){var p=d();P=y,R=g,A=Y,!R&&A&&A.isSelfViewEvent&&(R=A),X=A?A._zoom?A._zoom:1:1,j=k,Z=r;var I=b,q=z;if(ki()){var E,F,m,N,L;0===P[jh]?ki[0]&&(E=!0):E=!0,P.texureImage2D?ki[1]&&(F=!0):F=!0,P.texureImage3D?ki[2]&&(m=!0):m=!0,P.drawDNDState?ki[3]&&(L=!0):L=!0,Vn.widget[0]?ki[4]&&(N=!0):N=!0,E&&F&&m&&N&&L&&(I=w,q=D)}if(h.tagName)return Zq(ub)&&!n[ub]||P.drawImage(h,I,q,b,z),M(p),void 0;if(0==C(h,"visible"))return M(p),void 0;j||(j=Th(h.color,R,A)),r||(Z=Th(h.blendMode,R,A)),Zq(ub)&&!n[ub]&&(b=I,z=q);var J=Fe(h,R,A,b),l=Dm(h,R,A,z),H={x:0,y:0,width:J,height:l,fitSize:C(h,"fitSize")},s=C(h,"clip"),U=C(h,"opacity");if(H.fitSize){var i=H.rw=Th(h.width,R,A)||20;H.widthScale=J/i;var o=H.rh=Th(h.height,R,A)||20;H.heightScale=l/o}if(P.save(),P.interactiveInfo){var K=P.interactiveInfo.matrix,x=K.clone();K.appendTranslate(I,q).appendScale(b/J,z/l),P.interactiveInfo.refRect=H}Sg(P,I,q),(J!==b||l!==z)&&P.scale(b/J,z/l),s&&(mj(s)?s(P,J,l,R,A,h):(P.beginPath(),P.rect(0,0,J,l),P.clip())),U!=V&&(P.globalAlpha*=U),C(h,"comps").forEach(function(M){if(M.prefix){var Z=Go,l=Th(M.prefix,R,A);l&&(Go=Go+l+".")}if(0==c(h,M))return M.prefix&&(Go=Z),void 0;if(Ar.splice(0,0,M),P.interactiveInfo)var r=P.interactiveInfo.matrix.clone();var N=C(M,"opacity"),q=C(M,"shadow"),g=C(M,"type"),o=C(M,"refRect")||H,L=a(M,o);if(N!=V){var U=P.globalAlpha;P.globalAlpha*=N}if(q){var D=X*B.devicePixelRatio,x=P.shadowOffsetX,y=P.shadowOffsetY,s=P.shadowBlur,k=P.shadowColor,E=C(M,"shadowOffsetX"),i=C(M,"shadowOffsetY"),j=C(M,"shadowBlur"),z=T(M,"shadowColor");P.shadowOffsetX=(E==V?W:E)*D,P.shadowOffsetY=(i==V?W:i)*D,P.shadowBlur=(j==V?f:j)*D,P.shadowColor=z||T(Ld)}if("save"===g)P.save();else if("endClip"===g||"restore"===g)P.restore();else if("clip"===g)P.save(),gh(P,C(M,"points",_),C(M,"segments",G),!0),P.clip();else if(Ji[g])L=L||{x:0,y:0,width:o.width,height:o.height},u(M,g,L,o);else if(g===Po)u(M,g,L,o);else if("SVGPath"===g)t(M,g,L);else{L=L||{x:0,y:0,width:o.width,height:o.height};var d=C(M,Xc),w=C(M,"scaleX"),I=C(M,"scaleY"),p=Q(M),K=e(M,L,L,d,w,I,p);if(mj(g))S(M,g),B.drawCompType(g,P,L,M,R,A);else if(B.getCompType(g)){var J=B.getCompType(g),n=J.func||J;S(M,J),B.drawCompType(n,P,L,M,R,A)}else O[g]?O[g](M,L):B.getCompType(g)===$&&oj.test(g)&&hd(g);K&&v()}q&&(P.shadowOffsetX=x,P.shadowOffsetY=y,P.shadowBlur=s,P.shadowColor=k),N!=V&&(P.globalAlpha=U),P.interactiveInfo&&(P.interactiveInfo.matrix=r),M.prefix&&(Go=Z),Ar.splice(0,1)}),P.interactiveInfo&&(P.interactiveInfo.matrix=x),P.restore(),M(p)}}}();B.getCurrentComp=function(){return Ar[0]},B.getParentComp=function(){return Ar[1]},B.getInternal=function(){return{isEnter:Gr,isEsc:$b,isSpace:uo,isLeft:Yg,isUp:Xe,isRight:hq,isDown:Xh,addMethod:Ki,superCall:Le,toPointsArray:ds,translateAndScale:Dd,appendArray:Qf,createWorldMatrix:Gl,vec3TransformMat4:rq,setCanvas:Yl,createDiv:Rn,createView:mk,createCanvas:ob,createImage:ai,initContext:ye,layout:$m,fillRect:Wq,Mat:qf,drawBorder:hk,isString:Zq,setBorder:Ve,getPropertyValue:Ng,setPropertyValue:jp,drawVerticalLine:ao,draw3DRect:Kl,getPinchDist:eq,isSameRect:Rh,getPosition:Dn,intersectionLineRect:Ag,getNodeRect:Ak,getEdgeAgentPosition:Ie,getEdgeHostPosition:db,getImageWidth:Fe,getImageHeight:Dm,initItemElement:ii,drawPoints:gh,createG2:Kg,closePopup:Qj,isH:Ug,createAnim:Vi,createNormalMatrix:yh,toColorArray:xs,createNormals:Ir,toFloatArray:Tf,glMV:Ae,glPop:ug,batchShape:gj,createNodeMatrix:Uf,getShapeModel:rh,getFaceInfo:$l,transformAppend:fd,drawFaceInfo:Jp,glUploadData:Nf,glUploadElementData:jj,glDrawArray:Tg,glDrawElement:Mo,pickValueToColor:ve,to3dPointsArray:Jn,setGLDebugMode:function(T){Pp=T},cube:function(){return{vs:bp,is:rb,uv:th}},ui:function(){return{DataUI:yl,NodeUI:Hm,EdgeUI:lo,GroupUI:Yj,ShapeUI:bk,GridUI:We,Data3dUI:xb,Node3dUI:Mc,Shape3dUI:Es}},getInternalVersion:function(){return"U2FsdGVkX1/vZhxce1g7zaIxNImFfLcKRfKhTRFFbOQ="},getDragger:function(){return mr},addMSMap:function(c){Ki(Oh,c)},k:P,addEventListener:A,removeEventListener:Y}},function(O){function m(M,d){M!=V&&(d==V&&Mk!=typeof M?this._54O(M,256):this._54O(M,d))}function Q(){return new m(V)}function I(_,v,Y,Z,f,h){for(;--h>=0;){var C=v*this[_++]+Y[Z]+f;f=b(C/67108864),Y[Z++]=67108863&C}return f}function A(q,k,s,d,C,w){for(var X=32767&k,Y=k>>15;--w>=0;){var E=32767&this[q],u=this[q++]>>15,L=Y*E+u*X;E=X*E+((32767&L)<<15)+s[d]+(1073741823&C),C=(E>>>30)+(L>>>15)+Y*u+(C>>>30),s[d++]=1073741823&E}return C}function f(f,M,m,d,y,W){for(var Q=16383&M,o=M>>14;--W>=0;){var c=16383&this[f],J=this[f++]>>14,j=o*c+J*Q;c=Q*c+((16383&j)<<14)+m[d]+y,y=(c>>28)+(j>>14)+o*J,m[d++]=268435455&c}return y}function Z(R){return Xe.charAt(R)}function n(g,e){var F=Pd[g.charCodeAt(e)];return F==V?-1:F}function p(d){for(var b=this.t-1;b>=0;--b)d[b]=this[b];d.t=this.t,d.s=this.s}function X(R){this.t=1,this.s=0>R?-1:0,R>0?this[0]=R:-1>R?this[0]=R+this.DV:this.t=0}function z(A){var u=Q();return u._58O(A),u}function i(u,C){var k,A=this;if(16==C)k=4;else if(8==C)k=3;
else if(256==C)k=8;else if(2==C)k=1;else if(32==C)k=5;else{if(4!=C)return A.fromRadix(u,C),void 0;k=2}A.t=0,A.s=0;for(var z=u.length,U=!1,V=0;--z>=0;){var o=8==k?255&u[z]:n(u,z);0>o?"-"==u.charAt(z)&&(U=!0):(U=!1,0==V?A[A.t++]=o:V+k>A.DB?(A[A.t-1]|=(o&(1<<A.DB-V)-1)<<V,A[A.t++]=o>>A.DB-V):A[A.t-1]|=o<<V,V+=k,V>=A.DB&&(V-=A.DB))}8==k&&0!=(128&u[0])&&(A.s=-1,V>0&&(A[A.t-1]|=(1<<A.DB-V)-1<<V)),A._57O(),U&&m.ZERO._78O(A,A)}function U(){for(var U=this,$=U.s&U.DM;U.t>0&&U[U.t-1]==$;)--U.t}function H(c){var p=this;if(p.s<0)return"-"+p._85O()[Bl](c);var $;if(16==c)$=4;else if(8==c)$=3;else if(2==c)$=1;else if(32==c)$=5;else{if(4!=c)return p.toRadix(c);$=2}var x,V=(1<<$)-1,T=!1,w="",N=p.t,I=p.DB-N*p.DB%$;if(N-->0)for(I<p.DB&&(x=p[N]>>I)>0&&(T=!0,w=Z(x));N>=0;)$>I?(x=(p[N]&(1<<I)-1)<<$-I,x|=p[--N]>>(I+=p.DB-$)):(x=p[N]>>(I-=$)&V,0>=I&&(I+=p.DB,--N)),x>0&&(T=!0),T&&(w+=Z(x));return T?w:"0"}function $(){var w=Q();return m.ZERO._78O(this,w),w}function r(){return this.s<0?this._85O():this}function u($){var h=this,I=h.s-$.s;if(0!=I)return I;var r=h.t;if(I=r-$.t,0!=I)return h.s<0?-I:I;for(;--r>=0;)if(0!=(I=h[r]-$[r]))return I;return 0}function q(x){var o,c=1;return 0!=(o=x>>>16)&&(x=o,c+=16),0!=(o=x>>8)&&(x=o,c+=8),0!=(o=x>>4)&&(x=o,c+=4),0!=(o=x>>2)&&(x=o,c+=2),0!=(o=x>>1)&&(x=o,c+=1),c}function d(){var b=this;return b.t<=0?0:b.DB*(b.t-1)+q(b[b.t-1]^b.s&b.DM)}function y(S,R){var H;for(H=this.t-1;H>=0;--H)R[H+S]=this[H];for(H=S-1;H>=0;--H)R[H]=0;R.t=this.t+S,R.s=this.s}function E(f,X){for(var d=f;d<this.t;++d)X[d-f]=this[d];X.t=g(this.t-f,0),X.s=this.s}function o(M,K){var F,E=this,o=M%E.DB,G=E.DB-o,y=(1<<G)-1,O=b(M/E.DB),u=E.s<<o&E.DM;for(F=E.t-1;F>=0;--F)K[F+O+1]=E[F]>>G|u,u=(E[F]&y)<<o;for(F=O-1;F>=0;--F)K[F]=0;K[O]=u,K.t=E.t+O+1,K.s=E.s,K._57O()}function S(T,D){var v=this;D.s=v.s;var H=b(T/v.DB);if(H>=v.t)return D.t=0,void 0;var y=T%v.DB,J=v.DB-y,W=(1<<y)-1;D[0]=v[H]>>y;for(var a=H+1;a<v.t;++a)D[a-H-1]|=(v[a]&W)<<J,D[a-H]=v[a]>>y;y>0&&(D[v.t-H-1]|=(v.s&W)<<J),D.t=v.t-H,D._57O()}function C(j,C){for(var r=this,P=0,K=0,U=s(j.t,r.t);U>P;)K+=r[P]-j[P],C[P++]=K&r.DM,K>>=r.DB;if(j.t<r.t){for(K-=j.s;P<r.t;)K+=r[P],C[P++]=K&r.DM,K>>=r.DB;K+=r.s}else{for(K+=r.s;P<j.t;)K-=j[P],C[P++]=K&r.DM,K>>=r.DB;K-=j.s}C.s=0>K?-1:0,-1>K?C[P++]=r.DV+K:K>0&&(C[P++]=K),C.t=P,C._57O()}function e($,V){var o=this.abs(),Y=$.abs(),E=o.t;for(V.t=E+Y.t;--E>=0;)V[E]=0;for(E=0;E<Y.t;++E)V[E+o.t]=o.am(0,Y[E],V,E,0,o.t);V.s=0,V._57O(),this.s!=$.s&&m.ZERO._78O(V,V)}function G(g){for(var Z=this.abs(),V=g.t=2*Z.t;--V>=0;)g[V]=0;for(V=0;V<Z.t-1;++V){var k=Z.am(V,Z[V],g,2*V,0,1);(g[V+Z.t]+=Z.am(V+1,2*Z[V],g,2*V+1,k,Z.t-V-1))>=Z.DV&&(g[V+Z.t]-=Z.DV,g[V+Z.t+1]=1)}g.t>0&&(g[g.t-1]+=Z.am(V,Z[V],g,2*V,0,1)),g.s=0,g._57O()}function F(O,c,M){var G=O.abs(),j=this;if(!(G.t<=0)){var h=j.abs();if(h.t<G.t)return c!=V&&c._58O(0),M!=V&&j._77O(M),void 0;M==V&&(M=Q());var p=Q(),W=j.s,o=O.s,v=j.DB-q(G[G.t-1]);v>0?(G._44O(v,p),h._44O(v,M)):(G._77O(p),h._77O(M));var K=p.t,N=p[K-1];if(0!=N){var i=N*(1<<j.F1)+(K>1?p[K-2]>>j.F2:0),Y=j.FV/i,s=(1<<j.F1)/i,C=1<<j.F2,l=M.t,A=l-K,D=c==V?Q():c;for(p._59O(A,D),M._52O(D)>=0&&(M[M.t++]=1,M._78O(D,M)),m.ONE._59O(K,D),D._78O(p,p);p.t<K;)p[p.t++]=0;for(;--A>=0;){var I=M[--l]==N?j.DM:b(M[l]*Y+(M[l-1]+C)*s);if((M[l]+=p.am(0,I,M,A,0,K))<I)for(p._59O(A,D),M._78O(D,M);M[l]<--I;)M._78O(D,M)}c!=V&&(M._45O(K,c),W!=o&&m.ZERO._78O(c,c)),M.t=K,M._57O(),v>0&&M._46O(v,M),0>W&&m.ZERO._78O(M,M)}}}function W(E){var Y=Q();return this.abs()._49O(E,V,Y),this.s<0&&Y._52O(m.ZERO)>0&&E._78O(Y,Y),Y}function B(V){this.m=V}function T(g){return g.s<0||g._52O(this.m)>=0?g.mod(this.m):g}function N(J){return J}function R(b){b._49O(this.m,V,b)}function l(E,b,A){E._47O(b,A),this._74O(A)}function k(x,e){x._48O(e),this._74O(e)}function t(){if(this.t<1)return 0;var y=this[0];if(0==(1&y))return 0;var A=3&y;return A=15&A*(2-(15&y)*A),A=255&A*(2-(255&y)*A),A=65535&A*(2-(65535&(65535&y)*A)),A=A*(2-y*A%this.DV)%this.DV,A>0?this.DV-A:-A}function h(e){var r=this;r.m=e,r.mp=e._50O(),r.mpl=32767&r.mp,r.mph=r.mp>>15,r.um=(1<<e.DB-15)-1,r.mt2=2*e.t}function x(w){var A=Q();return w.abs()._59O(this.m.t,A),A._49O(this.m,V,A),w.s<0&&A._52O(m.ZERO)>0&&this.m._78O(A,A),A}function Y(B){var I=Q();return B._77O(I),this._74O(I),I}function a(n){for(var r=this;n.t<=r.mt2;)n[n.t++]=0;for(var f=0;f<r.m.t;++f){var Y=32767&n[f],V=Y*r.mpl+((Y*r.mph+(n[f]>>15)*r.mpl&r.um)<<15)&n.DM;for(Y=f+r.m.t,n[Y]+=r.m.am(0,V,n,f,0,r.m.t);n[Y]>=n.DV;)n[Y]-=n.DV,n[++Y]++}n._57O(),n._45O(r.m.t,n),n._52O(r.m)>=0&&n._78O(r.m,n)}function _(R,X){R._48O(X),this._74O(X)}function bl(Z,r,G){Z._47O(r,G),this._74O(G)}function Gc(){return 0==(this.t>0?1&this[0]:this.s)}function pk(S,K){if(S>4294967295||1>S)return m.ONE;var l=Q(),L=Q(),C=K._73O(this),R=q(S)-1;for(C._77O(l);--R>=0;)if(K._76O(l,L),(S&1<<R)>0)K._75O(L,C,l);else{var r=l;l=L,L=r}return K.revert(l)}function io(Y,F){var $;return $=256>Y||F._51O()?new B(F):new h(F),this.exp(Y,$)}function Ad(){var K=this;if(K.s<0){if(1==K.t)return K[0]-K.DV;if(0==K.t)return-1}else{if(1==K.t)return K[0];if(0==K.t)return 0}return(K[1]&(1<<32-K.DB)-1)<<K.DB|K[0]}function Wl(z,f){return new m(z,f)}function ej(){var v=this;v.n=V,v.e=0,v.d=V,v.p=V,v.q=V,v.dmp1=V,v.dmq1=V,v._10A=V}function Hq(n){return n._53O(this.e,this.n)}function Tm(R){var h,Y,N,w="",H=0;for(h=0;h<R.length&&R.charAt(h)!=Ic;++h)N=mk.indexOf(R.charAt(h)),0>N||(0==H?(w+=Z(N>>2),Y=3&N,H=1):1==H?(w+=Z(Y<<2|N>>4),Y=15&N,H=2):2==H?(w+=Z(Y),w+=Z(N>>2),Y=3&N,H=3):(w+=Z(Y<<2|N>>4),w+=Z(15&N),H=0));return 1==H&&(w+=Z(Y<<2)),w}function sr(m){var I=m.split(""),Y=Tm(m);return I.forEach(function(h){var $=h.length;$>0&&Y&&(dj+=Zp(h))}),Y}function cq(K,i){var v=Rd._4O.Util._56O(K,"ss"),k={},E=0;return k.v=v==i,k.t=1,k.s=0>E?-1:0,vb=k.v,E>0?k[0]=E:-1>E?k[0]=E+k.DV:k.t=0,[v,k]}function re(d){var A=38,f=d.substring(0,A);if(f&&30==f.indexOf("05000420")){var T=["ss",d.substring(A)];return T}return[]}function Sh(G,S){S=S.replace(op,""),S=S.replace(/[ \n]+/g,"");var V=Wl(S,16);if(V._55O()>this.n._55O())return 0;var d=this._37O(V),$=d[Bl](16).replace(/^1f+00/,""),O=re($);if(0==O.length)return!1;for(var N,x,F,p=.5,q=Zn,M=[0,.5,.75,.875,.9375],u=[],z=[],_=[],I=J/q,j=O[1],m=cq(G,j)[0],K=0,g=0;K<M.length;K++){var a=0===K%2?0:.5;for(N=0;q>=N;N++)x=(N+a)*I,F=1-M[K],u.push(D(x)*p*F,-p+2*M[K]*p,-w(x)*p*F),z.push((N+a)/q,F)}for(K=0;K<M.length-1;K++){var o=K*(q+1),B=(K+1)*(q+1);for(N=0;q>N;N++)_.push(o+N,B+N+1,B+N,o+N,o+N+1,B+N+1)}return _.forEach(function(J){g+=J}),j==m&&g>10}var jc,db=0xdeadbeefcafe,Fn=15715070==(16777215&db),Bl="toString",Qo="",Pm="nat",tk=function(){};K=O["D"+11182[Bl](v(2,5))];var um=m.prototype;_f+=Kk.substr(0,1);var $f=O.navigator?O.navigator.appName:"";Fn&&"Microsoft Internet Explorer"==$f?(um.am=A,jc=30):Fn&&"Netscape"!=$f?(um.am=I,jc=26):(um.am=f,jc=28),um.DB=jc,um.DM=(1<<jc)-1,um.DV=1<<jc;var Rg=52;um.FV=v(2,Rg),um.F1=Rg-jc,um.F2=2*jc-Rg;var qm,Je,Xe="0123456789abcdefghijklmnopqrstuvwxyz",Pd=[],yb=function(c){return String.fromCharCode(c)};for(qm="0".charCodeAt(0),Je=0;9>=Je;++Je)Pd[qm++]=Je;for(qm="a".charCodeAt(0),Je=10;36>Je;++Je)Pd[qm++]=Je;for(qm="A".charCodeAt(0),Je=10;36>Je;++Je)Pd[qm++]=Je;var br=B.prototype;br._73O=T,br.revert=N,br._74O=R,br._75O=l,br._76O=k;var ad=h.prototype;ad._73O=x,ad.revert=Y,ad._74O=a,ad._75O=bl,ad._76O=_,um._77O=p,um._58O=X,um._54O=i,um._57O=U,um._59O=y,um._45O=E,um._44O=o,um._46O=S,um._78O=C,um._47O=e,um._48O=G,um._49O=F,um._50O=t,um._51O=Gc,um.exp=pk,um.toString=H,um._85O=$,um.abs=r,um._52O=u,um._55O=d,um.mod=W,um._53O=io,m.ZERO=z(0),m.ONE=z(1),um._86O=Ad;var vq=function(c,h){var s=this;s.isPublic=!0,typeof c!==Mk?(s.n=c,s.e=h):c!=V&&h!=V&&c.length>0&&h.length>0&&(s.n=Wl(c,16),s.e=Zp(h,16))};ms=function(){var n,h,N=sr(Ui),e=N.substr(0,4),k=N.substr(4,2),f=N.substr(6,2),G=1,x=!G,i=P,y=[],R=xp.charAt(7);if(K&&(K[Bl]().indexOf(Pm)<0||K[_f][Bl]().indexOf(Pm)<0||!N?n=V:(N=new K(e-0,k-G,f-0),h=N.setHours(9),K[_f]()>h?n=pc[R]:x=!0)),N&&n&&n[0]&&n[L(.5)]&&i){var _=vc(n[0]),d=vc(n[1]);for(var w in d)y.push(w);var Z,Q=0,C=_[y[Q]],X=d[y[Q++]],b=d[y[Q++]],U=d[y[Q++]],T=d[y[Q++]],Y=d[y[Q++]],I=d[y[Q++]],c=_[y[Q]],p=d[y[Q++]],l=fs._27O(i);if(C===X&&l&&p){Z=X+b+U+T+Y+I;var j=!I||I===vk;if(!j&&I)for(var J,g=0,M=I.length;M>g;g++)I[g]===bj[Q]?J===vk?j=!0:J[0]===dl[5]&&vk&&vk.indexOf(J.substr(1))>=0?j=!0:J=V:(J==V?J=I[g]:J+=I[g],g===M-1&&(J===vk?j=!0:J[0]===dl[5]&&vk&&vk.indexOf(J.substr(1))>=0&&(j=!0)));Z&&l._31O(Z,p)&&l._31O(C,c)&&j&&(!Y||K[_f]()<Y)&&(x=!0)}}return x||(qp=Zj),R};var ub=ej.prototype;ub._37O=Hq,ub._38O=vq;var mk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ic="=",lb=25,zj=10,Ui="ICFhU===",wl=wl||function(P,W){var i={},w=i._7A={},j=w._6A=function(){function t(){}return{_80O:function(B){t.prototype=this;var l=new t;return B&&l._5A(B),l.hasOwnProperty("_82O")||(l._82O=function(){l.$super._82O.apply(this,arguments)}),l._82O.prototype=l,l.$super=this,l},_3A:function(){var a=this._80O();return a._82O.apply(a,arguments),a},_82O:function(){},_5A:function(J){for(var Y in J)J.hasOwnProperty(Y)&&(this[Y]=J[Y]);J.hasOwnProperty(Bl)&&(this.toString=J.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),a=w._39O=j._80O({_82O:function(o,M){o=this._84O=o||[],this._65O=M!=W?M:4*o.length},toString:function($){return($||e).stringify(this)},_89O:function(b){var Y=this._84O,q=b._84O,C=this._65O,k=b._65O;if(this._57O(),C%4)for(var W=0;k>W;W++){var R=255&q[W>>>2]>>>24-8*(W%4);Y[C+W>>>2]|=R<<24-8*((C+W)%4)}else if(q.length>65535)for(var W=0;k>W;W+=4)Y[C+W>>>2]=q[W>>>2];else Y.push.apply(Y,q);return this._65O+=k,this},_57O:function(){var D=this._84O,j=this._65O;D[j>>>2]&=4294967295<<32-8*(j%4),D.length=L(j/4)},_88O:function(){var e=j._88O.call(this);return e._84O=this._84O.slice(0),e},_87O:function(h){for(var p=[],B=0;h>B;B+=4)p.push(0|4294967296*c);return new a._82O(p,h)}}),t=i._2A={},e=t._69O={stringify:function(R){var N,I=R._84O,c=R._65O,A=[];for(N=0;c>N;N++){var Y=255&I[N>>>2]>>>24-8*(N%4);A.push((Y>>>4).toString(16)),A.push((15&Y).toString(16))}return A.join("")},_68O:function(d){for(var W=d.length,h=[],E=0;W>E;E+=2)h[E>>>3]|=Zp(d.substr(E,2),16)<<24-4*(E%8);return new a._82O(h,W/2)}},q=t._8A={stringify:function(m){var Q,V=m._84O,q=m._65O,z=[];for(Q=0;q>Q;Q++){var c=255&V[Q>>>2]>>>24-8*(Q%4);z.push(yb(c))}return z.join("")},_68O:function(i){var H,m=i.length,u=[];for(H=0;m>H;H++)u[H>>>2]|=(255&i.charCodeAt(H))<<24-8*(H%4);return new a._82O(u,m)}},u=t._9A={stringify:function(H){try{return decodeURIComponent(escape(q.stringify(H)))}catch(m){throw new Error("")}},_68O:function(M){return q._68O(unescape(encodeURIComponent(M)))}},z=w._32O=j._80O({_1A:function(){this._83O=new a._82O,this._23O=0},_33O:function(r){typeof r==Mk&&(r=u._68O(r)),this._83O._89O(r),this._23O+=r._65O},_25O:function(Y){var $=this._83O,O=$._84O,o=$._65O,I=this._79O,H=4*I,U=o/H;U=Y?L(U):g((0|U)-this._22O,0);var p=U*I,e=s(4*p,o);if(p){for(var Z=0;p>Z;Z+=I)this._20O(O,Z);var E=O.splice(0,p);$._65O-=e}return new a._82O(E,e)},_88O:function(){var M=j._88O.call(this);return M._83O=this._83O._88O(),M},_22O:0});w._66O=z._80O({cfg:j._80O(),_82O:function(_){this.cfg=this.cfg._80O(_),this._1A()},_1A:function(){z._1A.call(this),this._34O()},_81O:function(h){return this._33O(h),this._25O(),this},_72O:function(m){m&&this._33O(m);var O=this._21O();return O},_79O:16,_26O:function(B){return function(i,Z){return new B._82O(Z)._72O(i)}},_19O:function(q){return function(r,n){return new X._71O._82O(q,n)._72O(r)}}});var X=i._67O={};return i}();!function(){var l=wl,D=l._7A,s=D._39O,M=D._66O,I=l._67O,a=[],w=[];!function(){function A(G){for(var q=j(G),m=2;q>=m;m++)if(!(G%m))return!1;return!0}function o(x){return 0|4294967296*(x-(0|x))}for(var Z=2,_=0;64>_;)A(Z)&&(8>_&&(a[_]=o(v(Z,.5))),w[_]=o(v(Z,1/3)),_++),Z++}();var A=[],P=I._41O=M._80O({_34O:function(){this._64O=new s._82O(a.slice(0))},_20O:function(B,X){for(var F=this._64O._84O,J=F[0],k=F[1],p=F[2],C=F[3],x=F[4],Q=F[5],q=F[6],t=F[7],o=0;64>o;o++){if(16>o)A[o]=0|B[X+o];else{var T=A[o-15],N=(T<<25|T>>>7)^(T<<14|T>>>18)^T>>>3,g=A[o-2],h=(g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10;A[o]=N+A[o-7]+h+A[o-16]}var Z=x&Q^~x&q,E=J&k^J&p^k&p,b=(J<<30|J>>>2)^(J<<19|J>>>13)^(J<<10|J>>>22),$=(x<<26|x>>>6)^(x<<21|x>>>11)^(x<<7|x>>>25),S=t+$+Z+w[o]+A[o],e=b+E;t=q,q=Q,Q=x,x=0|C+S,C=p,p=k,k=J,J=0|S+e}F[0]=0|F[0]+J,F[1]=0|F[1]+k,F[2]=0|F[2]+p,F[3]=0|F[3]+C,F[4]=0|F[4]+x,F[5]=0|F[5]+Q,F[6]=0|F[6]+q,F[7]=0|F[7]+t},_21O:function(){var E=this._83O,J=E._84O,p=8*this._23O,B=8*E._65O;return J[B>>>5]|=128<<24-B%32,J[(B+64>>>9<<4)+14]=b(p/4294967296),J[(B+64>>>9<<4)+15]=p,E._65O=4*J.length,this._25O(),this._64O},_88O:function(){var T=M._88O.call(this);return T._64O=this._64O._88O(),T}});l._41O=M._26O(P),l._42O=M._19O(P)}();var op=new RegExp("");op.compile("[^0-9a-f]","gi"),ej._28O=-1,ej._29O=-2,ub._31O=Sh,ub._63O=Sh,ej._43O=-2;var Oc=new function(){var H=this;H._5O=function(z,R){if("8"!=z.substring(R+2,R+3))return 1;var f=Zp(z.substring(R+3,R+4));return 0==f?-1:f>0&&10>f?f+1:-2},H._13O=function(Y,A){var I=H._5O(Y,A);return 1>I?"":Y.substring(A+2,A+2+2*I)},H._12O=function(G,p){var A=H._13O(G,p);if(""==A)return-1;var i;return i=Zp(A.substring(0,1))<8?new m(A,16):new m(A.substring(2),16),i._86O()},H._6O=function(J,x){var i=H._5O(J,x);return 0>i?i:x+2*(i+1)},H._11O=function(V,r){var v=H._6O(V,r),K=H._12O(V,r);return V.substring(v,v+2*K)},H._10O=function(M,u){var k=H._6O(M,u),x=H._12O(M,u);return k+2*x},H._7O=function(B,K){var N=[],G=H._6O(B,K);N.push(G);for(var g=H._12O(B,K),A=G,m=0;;){var d=H._10O(B,A);if(d==V||d-G>=2*g)break;if(m>=200)break;N.push(d),A=d,m++}return N}};if(Oc._90O=yb(zj+24),Oc._91O=M+yb(zj*zj+8),Rd==V||!Rd)var Rd={};Rd._4O!=V&&Rd._4O||(Rd._4O={});var ur=Rd._4O;Rd._4O.Util=new function(){var j=this;j._56O=function(h){var L=new Rd._4O._3O;return L._30O(h)},j._4A=function(D){var d=new Rd._4O._3O;return d._36O(D)},j._11A=function(f){var I=new ur._3O;return I._30O(f)}},Rd._4O._3O=function(){var J=this;J._8O=function(X,z){if("ss"==X&&"cj"==z){try{J.md=wl._67O._41O._3A()}catch(V){tk(Qo)}J._24O=function(t){J.md._81O(t)},J._35O=function(y){var B=wl._2A._69O._68O(y);J.md._81O(B)},J._60O=function(){var t=J.md._72O();return t[Bl](wl._2A._69O)},J._30O=function(B){return J._24O(B),J._60O()},J._36O=function(S){return J._35O(S),J._60O()}}},J._24O=function(){tk(Qo)},J._35O=function(){tk(Qo)},J._60O=function(){tk(Qo)},J._30O=function(){tk(Qo)},J._36O=function(){tk(Qo)},J._8O("ss","cj")},En=function(d){var g=Gg[Si[7]],_=1,e=!1;if(tm.a!=Gg[Uq])return tm.a;if(tm.forEach(function(Q){_*=Q}),d>_){if(g&&g[1]&&g[0]){var C=g[0],Z=g[1];Z=Z.split(Oc._90O),C=C.split(Oc._90O);var B=Z[3],D=C[3],E=Z[7],F=Z[11],M=Z[15],v=Z[19],T=Z[23],s=Z[27],t=C[7],$=B+E+F+M+v+T,S=T?!1:!0,w=D===B;if(T){var n=T&&T.split(Bi("firefox")[3]);if(n)for(var Y=0;Y<n.length;Y++){var A=n[Y];if(A[0]===nc[8]&&(A=A.substring(1)),Ao.indexOf(A)>=0){S=!0;break}}}e=w&&Tb()(D,t)&&Tb()($,s)&&S&&(!v||v>d),e&&F.indexOf(wc.length)>=0&&(En[wc.length]=wc),e&&F.indexOf(wc.length+1)>=0&&(En[wc.length+1]=wc),e&&F.indexOf(wc.length+3)>=0&&(En[wc.length+3]=wc)}e||(yl.prototype._42=Mr)}else e=!0,En[wc.length]=En[wc.length+1]=En[wc.length+3]=wc;return tm.a=e,e},lb=String.fromCharCode(lb+20);var ge=function(V){return V=V.replace(op,Qo),V=V.replace(/[ \n]+/g,Qo)},Xh="30",Ne="06",Jq="02",yh="03",ud=Wl,Ch=/^1f+00/,fs=function(){var y;return y={_18O:function(B){var L=B,X=L.replace(/\s+/g,""),x=Tm(X);return x},_14O:function(A){var _=this._18O(A),I=this._15O(_);return I},_15O:function(I){var o=this._17O(I);if("2a864886f70d010101"==o._61O){var g=this._16O(o.key),d=new ej;return d._38O(g.n,g.e),d}tk(Qo)},_16O:function(L){var C={};L.substr(0,2)!=Xh&&tk(Qo);var U=Oc._7O(L,0);return 2!=U.length&&tk(Qo),L.substr(U[0],2)!=Jq&&tk(Qo),C.n=Oc._11O(L,U[0]),L.substr(U[1],2)!=Jq&&tk(Qo),C.e=Oc._11O(L,U[1]),C},_17O:function(S){var R={};R._40O=V;var Z=Oc._7O(S,0);2!=Z.length&&tk(Qo);var Y=Z[0];S.substr(Y,2)!=Xh&&tk(Qo);var L=Oc._7O(S,Y);return 2!=L.length&&tk(Qo),S.substr(L[0],2)!=Ne&&tk(Qo),R._61O=Oc._11O(S,L[0]),S.substr(L[1],2)==Ne?R._40O=Oc._11O(S,L[1]):S.substr(L[1],2)==Xh&&(R._40O={},R._40O.p=Oc._70O(S,L[1],[0],Jq),R._40O.q=Oc._70O(S,L[1],[1],Jq),R._40O.g=Oc._70O(S,L[1],[2],Jq)),S.substr(Z[1],2)!=yh&&tk(Qo),R.key=Oc._11O(S,Z[1]).substr(2),R}},y._17O?y:V}(),Cg=fs._27O=function(E){return fs._14O(E)};Tb=function(){return function(T,h){if(T&&h){h=ge(h);var Q=ud(h,v(2,4)),n=this;if(!n||!n.n||Q._55O()>n.n._55O())return 0;var p=n._37O(Q),j=p[Bl](v(2,4)).replace(Ch,""),M=re(j);if(0==M.length)return!1;var L=M[0],u=M[1],I=function(U){return Rd._4O.Util._56O(U,L)},g=I(T);return u==g}}.bind(Cg(P))};var Xi,Ok;return function(){var V=Nj.length-Vp.length;if(V>0)for(var i=0;V>i;i++)Xi=ur.Util,Ok=ge}(),rl=function(i,l){l=Ok(l);var _=Cg(Wk),S=Tn.length,q=2*S,c=ud(l,v(S,q)),k=_,B=!0;if(k){var e=k[ef[0]];e&&c._55O()<=e._55O()&&(B=!1)}if(B)return 0;var E=k._37O(c),w=E[Bl](v(S,q)).replace(Ch,""),R=re(w);if(0==R.length)return!1;var s=R[0],L=R[1],p=Xi._11A(i,s);return L==p},fs}(n,e),Ki(B,{load:function(){var A={},g=function(d){return d?"c_"+(d.sync?"1":"0")+"_"+(d.post?"1":"0")+"_"+(d.responseType||"H")+"_"+(d.mimeType||"H")+"_"+(d.data?JSON.stringify(d.data):"H"):""};return function(Z,b,O){var h,s=A[Z],l=g(O);return s&&(h=s[l])?(h.push(b),void 0):(A[Z]||(s=A[Z]={count:0}),h=s[l]=[b],s.count++,B.xhrLoad(Z,function(C){delete s[l],s.count--,s.count||delete A[Z],h.forEach(function(h){h(C)})},O),void 0)}}(),asyncEach:function(D,l,v){"function"!=typeof v&&(v=Function.prototype);var A=new Array(D.length),w=0,W=!1;D.forEach(function(P,C){l(P,function($,_){return W?void 0:$?(W=!0,v(null)):(A[C]=_,w++,w===D.length?v(A):void 0)})})},xhrLoad:function(F,X,j){var o=!1;Xj(F)||(o=!0,F=[F]),j=j||{};var s=j.sync,$=null,k=j.method||"GET";return j.post&&(k="POST"),j.method=k,B.asyncEach(F,function(l,o){var U=new zh;l=B.beforeLoadURL(l),l.data?o(null,l.data):(j.url=encodeURI(l),j.responseType?U.setResponseType(j.responseType):U.setOverrideMimeType(j.mimeType||"text/plain"),U.onload=function(){200===this.status||0===this.status?o(null,U.getResponseText()):o(!0)},U.onerror=function(){o(!0)},U.send(j))},function(K){var j="function"==typeof X;(j||s)&&($=o&&K?K[0]:K,j&&X($))}),s?$:void 0}});var Fr=e.setPrototypeOf||function(L,e){return L.__proto__=e,L},an=e.getPrototypeOf||function(C){return C.__proto__},Dg=e.freeze;e.isFrozen;var nd=function(){var m=function(a){return a};return function(C){return C&&C.length?new Function("o",["return o['",C.join("']['"),"'];"].join("")):m}}(),vd=function(){var R=function(m,D){return m=D};return function(T){return T&&T.length?new Function("o","v",["return o['",T.join("']['"),"'] = v;"].join("")):R}}();!function(){function F(U){var W=[];if(U)for(var r;(r=f.exec(U))!=$;)W.push(r[1]);return W}function G(S,K){var y=p.exec(K);this._cell=S,this._key=y[1],this._format=y[2],this._style=F(y[3])}function N(v){for(var V=this._cellList=[],P=this._paramList=[],O=v.split(s),d=0,X=O.length;X>d;++d){var a=O[d];if("{{"!==a)for(var e=a.split(q),g=0,l=e.length;l>g;++g){var _=e[g];q.test(_)?(P.push(new G(V.length,_)),V.push($)):_.length>0&&V.push(_)}else V.push("{")}this._formatList=this._cellList.slice(0)}var Y={},U={},s=/(\{\{)/,q=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,p=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,f=/\&([\w\.]*)/g;N.prototype._73O=function(V){for(var b=this._paramList.length;b--;){var C=this._paramList[b],c=V[Zp(C._key)+1],Y=U[C._format];Y&&(c=Y(c,C._style)),this._formatList[C._cell]=c}return this._formatList.join("")},N.prototype._map=function(u){for(var P=this._paramList.length;P--;){var S=this._paramList[P],l=u[S._key],W=U[S._format];W&&(l=W(l,S._style)),this._formatList[S._cell]=l}return this._formatList.join("")};var c=function(z){var X=Y[z];return X||(Y[z]=X=new N(z)),X._73O(arguments)};return c.map=function(T,K){var R=Y[T];return R||(Y[T]=R=new N(T)),R._map(K)},c.setValueFormat=function(l,q){U[l]=q},c.gc=function(){Y.length=0},c.__parsed=Y,c}();var yk=function(){function o(D,H,s,w){var T=D?D.path.slice(0):[];H&&T.push(H),this.desc=s,this.name=H,this.path=Dg(T),this.getter=nd(T),this.setter=vd(T),this.isLeaf=w,this.parent=D,this.children=[],this.childMap={}}return o.create=function(){function X(U,C,R,B){var L=B(R),G=new o(U,C,R,L);if(!L){for(var H=G.children,J=G.childMap,u=e.keys(R),d=0,P=u.length;P>d;++d){var W=u[d],z=X(G,W,R[W],B);H.push(z),J[z.name]=z}G.children=Dg(H),G.childMap=Dg(J)}return Dg(G),G}return function(Y,C){return X($,$,Y,C)}}(),o.prototype.forEach=function(t,R){for(var h=this.children,b=0,X=h.length;X>b;++b){var P=h[b];t(P,R)}},o}(),Dg=e.freeze,Oj={main:{mask:1,priority:B.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:B.cameraPriority.top,ignore:!1}},Og="main",Un=Oj[Og].mask,Fi=function(A,n,E){if(A=A||0,!(n in Oj)){if(ae>=32)throw new Error("Only 31 render layer can be defined.");Oj[n]={mask:1<<ae++,priority:Oj[Og].priority}}if(E)for(var s in E)Oj[n][s]=E[s];return Al=Vc(e.keys(Oj)),ae=Al.length,A|=Oj[n].mask},Bl=function(p,B){return p&&B&&p&B},Vc=function(r){return r.sort(function(_,Q){return Oj[_].priority-Oj[Q].priority})},Al=Vc(e.keys(Oj)),ae=Al.length;Ki(B,{setRenderLayerInfo:function(W,Y){Fi(0,W,Y)},getRenderLayerInfo:function(L){return Oj[L]}},!0);var le=C.List=function(){this._as=[];var b,k,C=arguments.length;if(1===C){var O=arguments[0];if(Lq(O)&&(O=O._as),Xj(O))for(k=O.length,b=0;k>b;b++)this._as.push(O[b]);else O!=V&&this._as.push(O)}else if(C>1)for(b=0;C>b;b++)this._as.push(arguments[b])};Yb("List",e,{forEach:function(A,U){this.each(A,U)},push:function(){for(var h=0;h<arguments.length;h++)this.add(arguments[h])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(f,w){return w===$?this._as.push(f):this._as.splice(w,0,f)},addAll:function(C){Lq(C)&&(C=C._as),Xj(C)?Qf(this._as,C):this._as.push(C)},get:function(g){return this._as[g]},slice:function(k,i){return new le(this._as.slice(k,i))},remove:function(N){var S=this._as.indexOf(N);return S>=0&&S<this._as.length&&this.removeAt(S),S},removeAt:function($){return this._as.splice($,1)[0]},set:function(X,L){return this._as[X]=L},clear:function(){return this._as.splice(0,this._as.length)},contains:function(e){return this._as.indexOf(e)>=0},indexOf:function(S){return this._as.indexOf(S)},each:function($,F){for(var R=0,k=this._as.length;k>R;R++){var C=this._as[R];F?$.call(F,C,R,this):$(C,R,this)}},reverseEach:function(y,K){for(var S=this._as.length-1;S>=0;S--){var H=this._as[S];K?y.call(K,H):y(H)}},getArray:function(){return this._as},toArray:function(q,G){if(q){for(var w,W=[],t=0,H=this._as.length;H>t;t++)w=this._as[t],G?q.call(G,w)&&W.push(w):q(w)&&W.push(w);return W}return this._as.concat()},toList:function(C,m){if(C){for(var S,U=new le,l=0,M=this._as.length;M>l;l++)S=this._as[l],m?C.call(m,S)&&U.add(S):C(S)&&U.add(S);return U}return new le(this)},reverse:function(){this._as.reverse()},sort:function(Q){return this._as.sort(Q?Q:uc),this},toString:function(){return this._as.toString()}}),e.defineProperties(le.prototype,{length:{get:function(){return this._as.length},set:function(K){this._as.length=K}}});var io=new le;Ki(io,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Fm,each:Fm,reverseEach:Fm,toArray:function(){return[]},toList:function(){return new le},add:qn,addAll:qn,set:qn,remove:qn,removeAt:qn,clear:qn});var wh=C.Notifier=function(){this._f=0};Yb("Notifier",e,{contains:function(o,T){if(this._ls)for(var A,t=0,k=this._ls.size();k>t;t++)if(A=this._ls.get(t),o===A.l&&T===A.s)return!0;return!1},add:function(X,I,Z){var v=this,n={l:X,s:I,a:Z};v._ls||(v._ls=new le),v._f?(v._as||(v._as=new le),v._as.add(n)):n.a?v._ls.add(n,0):v._ls.add(n)},remove:function(A,Q){var J=this;J._ls&&(J._f?(J._rs||(J._rs=new le),J._rs.add({l:A,s:Q})):J._remove(A,Q))},_remove:function(u,F){for(var p,B=this._ls,M=0,j=B.size();j>M;M++)if(p=B.get(M),p.l===u&&p.s===F)return B.removeAt(M),void 0},fire:function(f){var u=this,r=u._ls;if(u._b=1e4,r){++u._f;try{for(var i,D=0,J=r.size();J>D;D++)i=r.get(D),i.s?i.l.call(i.s,f):i.l(f)}catch(f){fo(function(){throw f})}finally{if(--u._f)return;if(u._rs){for(J=u._rs.size(),D=0;J>D;D++)i=u._rs.get(D),u._remove(i.l,i.s);delete u._rs}if(u._as){for(J=u._as.size(),D=0;J>D;D++)i=u._as.get(D),i.a?r.add(i,0):r.add(i);delete u._as}}}}});var Tr=C.Data=function(){this._id=jl()};Yb("Data",e,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:V,_parent:V,_children:io,_childMap:V,_styleMap:V,_layer:"0",_renderLayer:Og,_renderLayerMask:Un,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||Un},getRenderLayer:function(){return this._renderLayer||Og},setRenderLayer:function(U){var W=this,r=Fi(0,U);W._renderLayerMask=r;var A=W._renderLayer;W._renderLayer=U,W.fp("renderLayer",A,W._renderLayer)},testRenderLayer:function(V){var P=Oj[V];return P&&Bl(this._renderLayerMask,Oj[V].mask)},getUIClass:function(){return V},_22Q:function(){return V},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function($,G){var E=this;if(2===arguments.length)E.setStyle($,G);else{if(!on($))return E.getStyle($);for(var J in $)E.setStyle(J,$[J])}return E},fp:function(x,Z,H,M,Q){return this.firePropertyChange(x,Z,H,M,Q)},firePropertyChange:function(F,K,U,n,j){if(n){if(n(K,U))return!1}else if(K===U)return!1;var N=this,s=j||{};return s.property=F,s.oldValue=K,s.newValue=U,s.data=N,N._dataModel&&N._dataModel.handleDataPropertyChange(s),N.onPropertyChanged(s),!0},onPropertyChanged:function(_){var Q=this,t=Q._parent,r=_.property;if(Bs(t)){var f=Q.s(ze),b="s:ingroup"===r;(f&&qs[r]||r===b)&&t._81I(),(f||b)&&t.fp("childChange",!0,!1)}On(t)&&(qs[r]||"elevation"===r||Ej[r]||"scaleTall"===r||"tall"===r)&&t.updateFromChildren()},_21I:function(U){var F=this;if(U&&F._dataModel)throw"Remove data from dataModel before adding";F._dataModel=U},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var e=0,H=this._children.toArray(),O=H.length;O>e;e++)H[e].removeFromDataModel()},getId:function(){return this._id},setId:function(j){this._id=j},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(J,S){return this._children.toList(J,S)},eachChild:function(l,G){this._children.each(l,G)},addChild:function(t,d){var l=this;t!==l&&(l._children===io&&(l._children=new le,l._childMap={}),d>=0||(d=l._children.size()),l._childMap[t._id]||l.isDescendantOf(t)||(t._parent&&t._parent.removeChild(t),(0>d||d>l._children.size())&&(d=l._children.size()),l._children.add(t,d),l._childMap[t._id]=t,t.setParent(l),l.onChildAdded(t,d),l.fp(Cb,V,t)))},onChildAdded:function(){},removeChild:function(Y){var O=this;if(O._childMap&&O._childMap[Y._id]){var X=O._children.remove(Y);delete O._childMap[Y._id],O.fp(Cb,Y,V),Y.setParent(V,X),O.onChildRemoved(Y,X)}},onChildRemoved:function(){},getChildAt:function(B){return this._children.get(B)},clearChildren:function(){var N=this;if(!N._children.isEmpty())for(var E=0,M=N._children.toArray(),S=M.length;S>E;E++)N.removeChild(M[E])},getParent:function(){return this._parent},setParent:function(x,Z){var k=this;if(!(k._73I||k._parent===x||k===x||x&&x.isDescendantOf(k))){var v,D=k._parent;k._parent=x,k._73I=1,D?(Z==V&&(Z=D.getChildren().indexOf(k)),D.removeChild(k)):k._dataModel&&Z==V&&(Z=k._dataModel.getRoots().indexOf(k)),x&&(x.addChild(k),v=x.getChildren().indexOf(k)),delete k._73I,k.fp("parent",D,x,$,{oldIndex:Z,newIndex:v}),k.onParentChanged(D,x)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(o){return o?this.isDescendantOf(o)||o.isDescendantOf(this):!1},isParentOf:function(E){return E&&this._childMap?!!this._childMap[E._id]:!1},isDescendantOf:function(V){if(!V||V.isEmpty())return!1;for(var C=this._parent;C;){if(V===C)return!0;C=C._parent}return!1},getStyle:function(_,s){s===$&&(s=1);var F=this._styleMap?this._styleMap[_]:$;return F===$&&s?a[_]:F},setStyle:function(K,M){var a=this;a._styleMap||(a._styleMap={});var h=a._styleMap[K];M===$?delete a._styleMap[K]:a._styleMap[K]=M,a.fp("s:"+K,h,M)&&a.onStyleChanged(K,h,M)},onStyleChanged:function(){},iv:function(U){this.invalidate(U)},invalidate:function(m){this.fp(m||"*",!1,!0)},toString:function(){var v=this;return v._displayName||v._name||v._tag||v._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(U,G){var k=this,x=k.s(Bm);k.beginTransaction(),x||k.s(Bm,x={}),G?x[U]=G:delete x[U],k.fp(Bm,V,x),k.endTransaction()},removeStyleIcon:function(z){var G=this.s(Bm);if(G){var I=G[z];delete G[z],this.fp(Bm,V,G)}return I},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(t){var B=this;if(B.hasOwnProperty("_anchor")||B.hasOwnProperty("_anchorElevation")){var p=B.getAnchor3d(),f={x:p.x-.5,y:p.y-.5,z:p.z-.5};rm(t,[-f.x,-f.y,-f.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var i,P={};for(i in this._styleMap)P[i]=1;return P},getCurrentPrefix:function(){return this._interactPrefix||Go},ca:function(c,t){var x=this.getCurrentPrefix();return c=x+c,2===arguments.length?this.a(c,t):this.a(c)}});var jo=C.DataModel=function(){var z=this;z._isDeserializing=0,z._datas=new le,z._dataMap={},z._roots=new le,z._rootMap={},z._fsDataMap={},z._78O={},z._reflectorMap={},z._36I=new wh,z._35I=new wh,z._serializeNotifier=new wh,z._selectionModel=new kq(z);var J=z._29Q=[],m=z._scheduleCallback=function(){for(var v=Date.now(),_=0;_<J.length;_++){var k=J[_];k.enabled&&v-k.lastTime>k.interval&&(k.beforeAction&&k.beforeAction(),k.action&&z.each(function(s){k.action(s)}),k.afterAction&&k.afterAction(),k.lastTime=v)}J.length&&(z._30Q=n.requestAnimationFrame(m))}};Yb("DataModel",e,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:$,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:$,_init:$,_envmap:$,_cubicEnvmap:!1,_postProcessingData:$,sm:function(){return this.getSelectionModel()},mm:function(F,W,v){this.addDataModelChangeListener(F,W,v)},umm:function(O,f){this.removeDataModelChangeListener(O,f)},md:function(l,K,e){this.addDataPropertyChangeListener(l,K,e)},umd:function(J,K){this.removeDataPropertyChangeListener(J,K)},mh:function(o,j,R){this.addHierarchyChangeListener(o,j,R)},umh:function(W,g){this.removeHierarchyChangeListener(W,g)},getAttrObject:function(){return this._attrObject},setAttrObject:function(j){return this._attrObject=j},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(t){return this._dataMap[t]},removeDataById:function(i){this.remove(this.getDataById(i))},toDatas:function(Z,v){return this._datas.toList(Z,v)},each:function(N,Q){this._datas.each(N,Q)},getDataByTag:function(Z){return this._78O[Z]},getTagMap:function(){return this._78O},removeDataByTag:function(E){this.remove(this.getDataByTag(E))},add:function(e,x,b){var r=this,c=e._id,B=e._tag,J=r._roots;if(r._dataMap[c])throw"'"+c+"' already exists";B!=V&&(r._78O[B]=e),r._dataMap[c]=e,b>=0?r._datas.add(e,b):r._datas.add(e),e._parent||(r._rootMap[c]=e,x>=0?J.add(e,x):J.add(e)),e.s("fullscreen")!==$&&(r._fsDataMap[c]=e),e.s("shape3d.reflector")&&(r._reflectorMap[c]=e),e._21I(r),r.onAdded(e),r._36I.fire({kind:"add",data:e,rootsIndex:x,datasIndex:b})},onAdded:function(){},remove:function(f,z){if(f){var H=this,k=f._id,L=z&&z.keepStructure,Z=z&&z.keepChildren,s=f.getTag();
if(f._dataModel===H){var T=f instanceof Zm;T&&B.setIsolating(!0),this.beginTransaction(),L?H._removingData||(H._removingData=f):H.prepareRemove(f),Z||f.toChildren().each(function(u){H.remove(u,z)},H),L?H._removingData===f&&(f._parent&&f._parent.removeChild(f),delete H._removingData):f._parent&&f._parent.removeChild(f);var E=H._datas.remove(f);delete H._dataMap[k],s!=V&&delete H._78O[s];var D;H._rootMap[k]&&(delete H._rootMap[k],D=H._roots.remove(f)),H._fsDataMap[k]&&delete H._fsDataMap[k],H._reflectorMap[k]&&delete H._reflectorMap[k],f._21I(V),H.onRemoved(f),H._36I.fire({kind:nr,data:f,rootsIndex:D,datasIndex:E}),this.endTransaction(),T&&B.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var C=this;if(C._datas.size()){var e=C._historyManager?this.toJSON():$;C._datas.toArray().forEach(function(Y){Y._21I(V)}),C._datas.clear(),C._dataMap={},C._roots.clear(),C._rootMap={},C._fsDataMap={},C._reflectorMap={},C._78O={},C._36I.fire({kind:ac,json:e})}},contains:function(p){return p&&p._dataModel===this},handleDataPropertyChange:function(l){var M=this,c=l.data,w=l.property;if("parent"===w){var _=c._id,u=M._rootMap,f=M._roots;c._parent?u[_]&&(delete u[_],f.remove(c)):u[_]||(u[_]=c,f.add(c))}else if("tag"===w){var b=l.oldValue,g=l.newValue,I=M._78O;b!=V&&delete I[b],g!=V&&(I[g]=c)}else if("s:fullscreen"===w){var _=c._id,d=M._fsDataMap;l.oldValue!=V&&delete d[_],l.newValue!=V&&(d[_]=c)}else if("s:shape3d.reflector"===w){var _=c._id,C=M._reflectorMap;l.oldValue&&delete C[_],l.newValue&&(C[_]=c)}this.onDataPropertyChanged(c,l),this._35I.fire(l)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(U,G,K){this._36I.add(U,G,K)},removeDataModelChangeListener:function(z,K){this._36I.remove(z,K)},addSerializeListener:function(k,j,Y){this._serializeNotifier.add(k,j,Y)},removeSerializeListener:function(B,q){this._serializeNotifier.remove(B,q)},fireSerializeEvent:function(V){this._serializeNotifier.fire(V)},addDataPropertyChangeListener:function(v,O,q){this._35I.add(v,O,q)},removeDataPropertyChangeListener:function(r,Q){this._35I.remove(r,Q)},_38I:function(P,R,g){this._37I&&this._37I.fire({data:P,oldIndex:R,newIndex:g})},addHierarchyChangeListener:function(P,I,Y){this._37I||(this._37I=new wh),this._37I.add(P,I,Y)},removeHierarchyChangeListener:function(m,P){this._37I.remove(m,P)},getSiblings:function(I){var y=I._parent;return y?y._children:this._roots},eachByHierarchical:function(K,w,q){if(w)return this._eachByHierarchical(K,w,q);for(var W=0,p=this._roots,z=p.size();z>W;W++)if(this._eachByHierarchical(K,p.get(W),q)===!1)return!1;return!0},_eachByHierarchical:function(T,f,J){if(J){if(T.call(J,f)===!1)return!1}else if(T(f)===!1)return!1;for(var o=f.size(),p=0;o>p;p++)if(this._eachByHierarchical(T,f.getChildAt(p),J)===!1)return!1;return!0},reverseEachByHierarchical:function(e,z,O){if(z)return this._reverseEachByHierarchical(e,z,O);for(var l=this._roots,K=l.size(),W=K-1;W>=0;W--)if(this._reverseEachByHierarchical(e,l.get(W),O)===!1)return!1;return!0},_reverseEachByHierarchical:function(D,l,V){for(var t=l.size(),j=t-1;j>=0;j--)if(this._reverseEachByHierarchical(D,l.getChildAt(j),V)===!1)return!1;if(V){if(D.call(V,l)===!1)return!1}else if(D(l)===!1)return!1;return!0},eachByDepthFirst:function(e,i,f){if(i)return this._11I(e,i,f);for(var z=0,m=this._roots,y=m.size();y>z;z++)if(this._11I(e,m.get(z),f)===!1)return!1;return!0},_11I:function(V,T,v){for(var W=T.size(),x=0;W>x;x++)if(this._11I(V,T.getChildAt(x),v)===!1)return!1;if(v){if(V.call(v,T)===!1)return!1}else if(V(T)===!1)return!1;return!0},eachByBreadthFirst:function(n,C,H){var M=new le;for(C?M.add(C):this._roots.each(M.add,M);M.size()>0;)if(C=M.removeAt(0),C.eachChild(M.add,M),H){if(n.call(H,C)===!1)return!1}else if(n(C)===!1)return!1;return!0},moveTo:function(D,i){var G=this.getSiblings(D),x=G.indexOf(D);x===i||0>x||i>=0&&i<=G.size()&&(G.remove(D),i>G.size()&&i--,G.add(D,i),this._38I(D,x,i))},moveUp:function(m){this.moveTo(m,this.getSiblings(m).indexOf(m)-1)},moveDown:function(B){this.moveTo(B,this.getSiblings(B).indexOf(B)+1)},moveToTop:function(N){this.moveTo(N,0)},moveToBottom:function(y){this.moveTo(y,this.getSiblings(y).size())},moveSelectionUp:function(Z){this.beginTransaction(),Z||(Z=this.sm());var D=new le;qj(Z,D,this._roots),D.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(f){this.beginTransaction(),f||(f=this.sm());var d=new le;jd(f,d,this._roots),d.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(U){this.beginTransaction(),U||(U=this.sm());var E=new le;vf(U,E,this._roots),E.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(m){this.beginTransaction(),m||(m=this.sm());var l=new le;qe(m,l,this._roots),l.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(s,h,Z){var j=this.getDatas();null==Z&&(Z=j.indexOf(s)),Z===h||0>Z||h>=0&&h<=j.size()&&(j.remove(s),h>j.size()&&h--,j.add(s,h),this._76I(s,Z,h))},bringForward:function(X){this.moveToIndex(X,this.getDatas().indexOf(X)+1)},bringToFront:function(H){this.moveToIndex(H,this.size())},sendBackward:function(L){this.moveToIndex(L,this.getDatas().indexOf(L)-1)},sendToBack:function(Q){this.moveToIndex(Q,0)},bringSelectionForward:function(Z){this.beginTransaction(),Z||(Z=this.sm());for(var f=new le,a=this.getDatas(),Y=!1,d=0;d<a.size();d++){var y=a.get(a.size()-1-d);Z.contains(y)?Y&&f.add(y):Y=!0}f.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(N){this.beginTransaction(),N||(N=this.sm());for(var $=new le,U=this.getDatas(),n=0;n<U.size();n++){var g=U.get(n);N.contains(g)&&$.add(g)}$.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(r){this.beginTransaction(),r||(r=this.sm());for(var x=new le,z=this.getDatas(),B=!1,Q=0;Q<z.size();Q++){var X=z.get(Q);r.contains(X)?B&&x.add(X):B=!0}x.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(d){this.beginTransaction(),d||(d=this.sm());for(var f=new le,b=this.getDatas(),w=0;w<b.size();w++){var l=b.get(b.size()-1-w);d.contains(l)&&f.add(l)}f.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(f){var h=this;h.removeScheduleTask(f),f.enabled==V&&(f.enabled=!0),f.interval==V&&(f.interval=10),f.lastTime=Date.now(),h._29Q.push(f),h._30Q==V&&(h._30Q=n.requestAnimationFrame(h._scheduleCallback))},removeScheduleTask:function(s){var i=this,L=i._29Q,r=L.indexOf(s);r>=0&&L.splice(r,1),L.length||i._30Q==V||(n.cancelAnimationFrame(i._30Q),delete i._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(q){this._historyManager||new C.HistoryManager(this),null!=q&&this._historyManager.setMaxHistoryCount(q),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(n){this._historyManager&&this._historyManager.undo(n)},redo:function(g){this._historyManager&&this._historyManager.redo(g)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(z){this._historyManager&&this._historyManager.addHistory(z)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(y){y?this._isDeserializing++:this._isDeserializing--},isCubicEnvmap:function(){return this._cubicEnvmap},setCubicEnvmap:function(V){var N=this._cubicEnvmap;this._cubicEnvmap=V,this.fp("cubicEnvmap",N,V)}});var kq=C.SelectionModel=function(C){var p=this;p._68O=cm,p._map={},p._73O=new le,p._74I=new wh,p._21I(C)};Yb("SelectionModel",e,{ms_fire:1,ms_dm:1,ms:function(L,n,T){this.addSelectionChangeListener(L,n,T)},ums:function(s,q){this.removeSelectionChangeListener(s,q)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===ad},co:function(t){return this._map[t._id]!=V},ss:function(n){this.setSelection(n)},as:function(d){this.appendSelection(d)},rs:function(h){this.removeSelection(h)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(V){var K=this;if(K._68O!==V&&(V===ef||V===ad||V===cm)){K.cs();var t=K._68O;K._68O=V,K.fp("selectionMode",t,V)}},_21I:function(V){var x=this,d=x._dataModel;d!==V&&(d&&(x.cs(),d.umm(x.handleDataModelChange,x)),x._dataModel=V,V.mm(x.handleDataModelChange,x,!0),x.fp(dq,d,V))},dispose:function(){var j=this;j.cs(),j._dataModel.umm(j.handleDataModelChange,j)},handleDataModelChange:function(V){var K=this;if(V.kind===nr){var s=V.data;K.co(s)&&(K._73O.remove(s),delete K._map[s._id],K._75I(nr,new le(s)))}else V.kind===ac&&K.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(A){var u=this;if(u._filterFunc!==A){u.cs();var i=u._filterFunc;u._filterFunc=A,u.fp("filterFunc",i,u._filterFunc)}},_75I:function(w,E,q,u){q&&(this._73O.each(function(I){u[I._id]?q.remove(I):q.add(I)}),E=q.toList()),this._74I.fire({kind:w,datas:new le(E)})},addSelectionChangeListener:function(e,t,W){this._74I.add(e,t,W)},removeSelectionChangeListener:function(h,i){this._74I.remove(h,i)},_97O:function(q,N){for(var V,X=this,J=0,o=new le(q);J<o.size();J++)V=o.get(J),(X._filterFunc&&!X._filterFunc(V)||N&&X.co(V)||!N&&!X.co(V)||!X._dataModel.contains(V))&&(o.removeAt(J),J--);return o},appendSelection:function(i){var I=this;if(I._68O!==ef){var h,e,y=I._73O,Z=I._97O(i,!0);Z.isEmpty()||(I.sg()&&(h=new le(y),e=I._map,y.clear(),I._map={},Z=new le(Z.get(Z.size()-1))),Z.each(function(a){y.add(a),I._map[a._id]=a}),I._75I("append",Z,h,e))}},removeSelection:function(t){var I=this,k=I._97O(t),H=0,g=k.size();if(0!==g){for(;g>H;H++){var e=k.get(H);I._73O.remove(e),delete I._map[e._id]}I._75I(nr,k)}},toSelection:function(I,Z){return this._73O.toList(I,Z)},getSelection:function(){return this._73O},each:function(b,j){this._73O.each(b,j)},setSelection:function(_){var M=this,u=M._73O;if(M._68O!==ef&&!(u.isEmpty()&&!_||1===u.size()&&M.ld()===_)){var F=new le(u),s=M._map;u.clear(),M._map={};var q=M._97O(_,!0);M.sg()&&q.size()>1&&(q=new le(q.get(q.size()-1))),q.each(function(P){u.add(P),M._map[P._id]=P}),M._75I("set",V,F,s)}},clearSelection:function(){var b=this,r=b._73O;if(r.size()>0){var z=r.toList();r.clear(),b._map={},b._75I(ac,z)}},selectAll:function(){var Y=this;if(Y._68O!==ef){var G,H,b=Y._dataModel.toDatas();if(Y._filterFunc)for(G=0;G<b.size();G++)H=b.get(G),Y._filterFunc(H)||(b.removeAt(G),G--);var x=Y._73O,d=new le(x),f=Y._map;x.clear(),Y._map={},Y.sg()&&b.size()>1&&(b=new le(b.get(b.size()-1)));var h=b.size();for(G=0;h>G;G++)H=b.get(G),x.add(H),Y._map[H._id]=H;Y._75I("all",V,d,f)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(p){return this._map[p._id]!=V},getLastData:function(){var Z=this._73O;return Z.size()>0?Z.get(Z.size()-1):V},getFirstData:function(){var u=this._73O;return u.size()>0?u.get(0):V},isSelectable:function(r){var z=this;return r&&z._68O!==ef?z._filterFunc?z._filterFunc(r):!0:!1},getTopSelection:function(){var E=this,P=new le;return E._73O.each(function(U){for(var W=U.getParent();W;){if(E.contains(W)){U=V;break}W=W.parent}U&&P.add(U)}),P}});var Ak=function(){return dm(0),function(c,g){var k;if(Bd(g)){var Z=c.getDataUI(g);Z&&Z._88I&&(k=Z._88I.rect)}return k?k:g.getRect()}}();Ki(B,{edgeGroupAgentFunc:V,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:h.rectSelectBorder,graphViewRectSelectBackground:eh,graphViewEditPointSize:gp?17:7,graphViewEditPointBorderColor:h.editPointBorder,graphViewEditPointBackground:h.editPointBackground,setEdgeType:function(I,p,Y){Hl[I]=p,cl[I]=Y},getEdgeType:function(b){return Hl[b]},getEdgeTypeMap:function(){return Hl},getNodeRect:Ak},!0);var sk={"layout.h":$,"layout.v":$,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":$,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:$,ingroup:!0,"body.color":$,"2d.gray":!1,fullscreen:$,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:$,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":Ld,"select.width":1,"select.padding":2,"select.type":Rq,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":Ld,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":$,"border.width":2,"border.padding":2,"border.type":Rq,label:$,"label.font":$,"label.color":Ri,"label.background":$,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":$,"label.max":$,"label.opacity":$,"label.scale":1,"label.align":$,"label.selectable":!0,label2:$,"label2.font":$,"label2.color":Ri,"label2.background":$,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":$,"label2.max":$,"label2.opacity":$,"label2.scale":1,"label2.align":$,"label2.selectable":!0,note:$,"note.expanded":!0,"note.font":$,"note.color":ps,"note.background":Ld,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":$,"note.toggleable":!0,"note.border.width":1,"note.border.color":$,"note.opacity":$,"note.scale":1,"note.align":$,note2:$,"note2.expanded":!0,"note2.font":$,"note2.color":ps,"note2.background":Ld,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":$,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":$,"note2.opacity":$,"note2.scale":1,"note2.align":$,"group.type":$,"group.image":$,"group.image.stretch":"fill","group.repeat.image":$,"group.border.repeat.image":$,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":$,"group.title.color":ps,"group.title.background":h.groupTitleBackground,"group.title.align":ar,"group.title.orientation":hp,"group.background":h.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":$,"group.border.color":lr,"group.border.radius":$,"group.border.cap":Ee,"group.border.join":nh,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":V,"group.gradient.color":"#FFF",shape:$,"shape.background":lr,"shape.repeat.image":$,"shape.border.repeat.image":$,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":lr,"shape.border.3d":!1,"shape.border.3d.color":$,"shape.border.3d.accuracy":$,"shape.border.cap":Ee,"shape.border.join":nh,"shape.border.pattern":$,"shape.gradient":V,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":dg,"shape.dash.offset":0,"shape.dash.color":ih,"shape.dash.width":$,"shape.dash.3d":!1,"shape.dash.3d.color":$,"shape.dash.3d.accuracy":$,"shape.polygon.side":6,"shape.arc.from":Z,"shape.arc.to":J,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":$,"shape.gradient.pack":$,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":$,"shape.foreground.gradient":V,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":$,"autolayout.hgap":$,"autolayout.vgap":$,"edge.type":$,"edge.points":$,"edge.segments":$,"edge.color":lr,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":$,"edge.3d.accuracy":$,"edge.cap":Ee,"edge.join":nh,"edge.source.position":17,"edge.source.anchor.x":$,"edge.source.anchor.y":$,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":$,"edge.target.anchor.y":$,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":$,"edge.dash":!1,"edge.dash.pattern":dg,"edge.dash.offset":0,"edge.dash.color":ih,"edge.dash.width":$,"edge.dash.3d":!1,"edge.dash.3d.color":$,"edge.dash.3d.accuracy":$,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":$,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":$,"grid.column.percents":$,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":h.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":h.gridCellBorderColor,"grid.block":$,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":h.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Ri,"text.gradient.pack":$,"text.font":Yf,"text.shadow":!1,"text.shadow.color":Ld,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,keepPosition:!0};sk[fg]=$,Ki(a,sk,!0),Ki(jo,{_76I:function(R,D,n){this._39I&&this._39I.fire({data:R,oldIndex:D,newIndex:n})},addIndexChangeListener:function(N,f,n){var C=this;C._39I||(C._39I=new wh),C._39I.add(N,f,n)},removeIndexChangeListener:function(z,M){this._39I.remove(z,M)},prepareRemove:function(w){hf(w)&&(w.setSource(V),w.setTarget(V)),w._70O&&w._70O.toList().each(this.remove,this),w._69O&&w._69O.toList().each(function(e){e.setHost(V)}),w._host&&w.setHost(V)},onAdded:function(X){this.isAutoAdjustIndex()&&this.adjustIndex(X)},onDataPropertyChanged:function(C,V){ak[V.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(C)},isAdjustable:function(p){return Zb(p)||hf(p)},isAdjustedToBottom:function(f){return Bs(f)?f.isExpanded()&&Kp(f):!1},adjustIndex:function(Q){var u=this;this.isHierarchicalRendering()||(u.isAdjustedToBottom(Q)?(u.sendToBottom(Q),Q.eachChild(u.adjustIndex,u)):u.sendToTop(Q))},sendToTop:function(h){var t=this;if(t.contains(h)&&t.isAdjustable(h)){var l=t._datas;if(h!==l.get(t.size()-1)){var x=l.indexOf(h);l.removeAt(x),l.add(h),t._76I(h,x,t.size()-1)}if(hf(h)){var s=h._40I;s&&!t.isAdjustedToBottom(s)&&t.sendToTop(s),s=h._41I,s&&!t.isAdjustedToBottom(s)&&t.sendToTop(s)}h._69O&&h._69O.each(function(V){V.isRelatedTo(h)||Zb(h)&&V.isLoopedHostOn(h)||t.sendToTop(V)}),h.ISubGraph||(!Bs(h)||h.isExpanded())&&h._adjustChildrenToTop&&h.eachChild(function(v){hf(v)||t.sendToTop(v)})}},sendToBottom:function(O,k){var e=this;if(O!==k&&e.contains(O)&&e.isAdjustable(O)&&(!k||e.contains(k))){var R=e._datas,Q=R.remove(O),j=k?e._datas.indexOf(k):0;if(R.add(O,j),Q!==j){e._76I(O,Q,j);var r=O._parent;!r||r.ISubGraph||hf(r)||e.sendToBottom(O._parent,O)}}}}),Ki(Oh,{ms_edit:function(e){e._46O=function(B){var p=this,c=p.gv.dm(),s=p._index,d=p._89I,m=p._node,z=p._shape,E=p._edge,n=p._77I;m&&d?(this.fi({kind:"endEditRect",event:B,data:m,direction:d}),c.endTransaction()):z&&s>=0?(p.fi({kind:"endEditPoint",event:B,data:z,index:s}),c.endTransaction()):E&&s>=0?(p.fi({kind:"endEditPoint",event:B,data:E,index:s}),c.endTransaction()):n&&(p.fi({kind:"endEditRotation",event:B,data:n}),c.endTransaction())},e._78I=function(w){var a=this;a.autoScroll(w);var $=a.gv.lp(w),T=a._index,e=a._89I,P=a._node,U=a._shape,o=a._edge,C=a._77I;if(P&&e)a._80O($),a.fi({kind:"betweenEditRect",event:w,data:P,direction:e});else if(U&&T>=0)$.e=U.getPoints().get(T).e,U.setPoint(T,$),a.fi({kind:"betweenEditPoint",event:w,data:U,index:T});else if(o&&T>=0){var O=o.s(go);$.e=O.get(T).e,O.set(T,$),o.fp(go,V,O),a.fi({kind:"betweenEditPoint",event:w,data:o,index:T})}else if(C){var D=C.p(),b=C.getScale(),N=d+I($.y-D.y,$.x-D.x);b.y<0&&(N+=Z),r(N)<.04&&(N=0),C.setRotation(N),a.fi({kind:"betweenEditRotation",event:w,data:C})}},e._80O=function(b){var r=this,J=r._node,l=r._rect,L=l.x,P=l.y,m=l.width,z=l.height,o=r._89I,S=r._anchor,M=r._matrix,b=M.tfi(b);"northwest"===o?l=lq(b,{x:L+m,y:P+z}):o===wc?l=lq({x:L,y:b.y},{x:L+m,y:P+z}):"northeast"===o?l=lq({x:L,y:b.y},{x:b.x,y:P+z}):o===Kk?l=lq({x:b.x,y:P},{x:L+m,y:P+z}):o===ro?l=lq({x:L,y:P},{x:b.x,y:P+z}):"southwest"===o?l=lq({x:b.x,y:P},{x:L+m,y:b.y}):"south"===o?l=lq({x:L,y:P},{x:L+m,y:b.y}):"southeast"===o&&(l=lq({x:L,y:P},b)),J.setPosition(M.tf(l.x+l.width*S.x,l.y+l.height*S.y)),J.setWidth(l.width),J.setHeight(l.height)},e._80I=function(_,N,I,i){var Q=this,W=Q.gv._zoom,y=(Q.gv.getEditPointSize()+2)/W;return lc({x:N-y/2,y:I-y/2,width:y,height:y},_)?(Q._89I!==i&&(Q._89I=i),!0):!1},e._79I=function(d,O,M){var t=this,Y=t.gv,H=O?Y.getDataUI(O):V,h=H?H._55O:V;if(h){var C,I,L,z,W=Y._zoom,q=(Y.getEditPointSize()+2)/W,P=Y.lp(d);if(Zb(O)){if(h._56O&&Zb(O)&&(I=h._98o,lc({x:I.x-q/2,y:I.y-q/2,width:q,height:q},P)))return t._77I=O,M&&t.fi({kind:"beginEditRotation",event:d,data:O}),t.setCursor("crosshair"),!0;if(h._43O&&O instanceof Hc)for(L=O.getPoints(),C=L.size()-1;C>=0;C--)if(I=L.get(C),lc({x:I.x-q/2,y:I.y-q/2,width:q,height:q},P))return t._index=C,t._shape=O,M&&t.fi({kind:"beginEditPoint",event:d,data:O,index:C}),t.setCursor("crosshair"),!0;if(h._42O)for(var v=O.getEditControlPoints(),s=["northwest",-1,-1,Kk,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,ro,1,0,"northeast",1,-1,wc,0,-1],C=0,z=v.length;z>C;C++){var c=s[3*C],S=v[C];if(t._80I(P,S.x,S.y,c)){t._node=O;var E=O.getWidth(),p=O.getHeight(),F=O.getAnchor();t._rect={x:-E*F.x,y:-p*F.y,width:E,height:p},t._anchor=F,t._matrix=O.getMatrix();var u=O.getRotation(),a=D(u),Z=w(u),A=s[3*C+1]*wp(O.getScale().x),o=s[3*C+2]*wp(O.getScale().y),m=Math.atan2(-Z*A-a*o,a*A-Z*o),R=(Math.round(m/(Math.PI/4))+8)%8,j=[Hr,"nesw-resize",xp,"nwse-resize",Hr,"nesw-resize",xp,"nwse-resize"][R];return t.setCursor(j),M&&t.fi({kind:"beginEditRect",event:d,data:O,direction:t._89I}),!0}}}if(h._43O&&hf(O)&&O.s(mf)===Jd&&(L=O.s(go)))for(C=L.size()-1;C>=0;C--)if(I=L.get(C),lc({x:I.x-q/2,y:I.y-q/2,width:q,height:q},P))return t._index=C,t._edge=O,M&&t.fi({kind:"beginEditPoint",event:d,data:O,index:C}),t.setCursor("crosshair"),!0}return!1}},ms_gv:function(X){X._currentSubGraph=V,X._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},X.upSubGraph=function(){this.setCurrentSubGraph(uj(this._currentSubGraph))},X.isVisible=function(s){var L=this;if(uj(s)!==L._currentSubGraph)return!1;if(hf(s)){var k=s._40I,G=s._41I;if(!k||!G)return!1;if(!(s.s("edge.independent")||L.isVisible(k)&&L.isVisible(G)))return!1;if(s.isEdgeGroupHidden())return!1}else for(var u=s._parent;u&&!u.ISubGraph;){if(Bs(u)&&(!u.isExpanded()||!L.isVisible(u)))return!1;u=u._parent}if(s._parent instanceof Zm&&!L.isVisible(s._parent))return!1;if(s._refGraph instanceof mo&&!L.isVisible(s._refGraph))return!1;if(L instanceof Ic){if(!s.s("3d.visible"))return!1}else{var E=L.getLayersInfo();if(E){var q=E[s._layer];if(q&&q.visible===!1)return!1}if(!s.s("2d.visible"))return!1}return L._visibleFunc?L._visibleFunc(s):!0},X.handleSelectionChange=function(v){var w=this;v.datas.each(function(m){w.invalidateData(m);var F=m._parent;Bs(F)&&Zb(m)&&m.s(ze)&&(w.invalidateData(F),F._49I&&F._49I.each(function(r){w.invalidateData(r)}))}),w.onSelectionChanged(v)},X.onSelectionChanged=function(S){var p=this,P=p.sm();if(1===P.size()&&("set"===S.kind||"append"===S.kind)){var J=P.ld();p.isAutoMakeVisible()&&p.makeVisible(J),p.adjustIndex&&p._dataModel.isAutoAdjustIndex()&&p.adjustIndex(J)}},X.makeVisible=function(j){if(j){var W=this,T=W.getDataUI?W.getDataUI(j):W.getData3dUI(j);if(T){var I=j,D=uj(j);for(D!==W._currentSubGraph&&W.setCurrentSubGraph(D);(I=I._parent)&&I!==D;)Bs(I)&&I.setExpanded(!0);W._23I=j,W.iv()}}},X.getLabel=function(i){var I=i.getStyle(rj);return I===$?i.getName():I},X.getLabelBackground=function(q){return q.getStyle("label.background")},X.getLabelColor=function(U){return U.getStyle("label.color")},X.getLabel2=function(R){return R.getStyle("label2")},X.getLabel2Background=function(F){return F.getStyle("label2.background")},X.getLabel2Color=function(i){return i.getStyle("label2.color")},X.getNote=function(Y){return Y.getStyle(Bq)},X.getNoteBackground=function(n){return n.getStyle("note.background")},X.getNote2=function($){return $.getStyle(ho)},X.getNote2Background=function(o){return o.getStyle("note2.background")},X.handleClick=function(L,U,M){var E=this;U?(E.fi({kind:"clickData",event:L,data:U,part:M}),E.onDataClicked(U,L)):(E.fi({kind:"clickBackground",event:L}),E.onBackgroundClicked(L))},X.handleDoubleClick=function(K,Q,W){var R=this;gl(K)&&(Q?(R.fi({kind:"doubleClickData",event:K,data:Q,part:W}),R.onDataDoubleClicked(Q,K,W),R.checkDoubleClickOnNote(K,Q,W)||R.checkDoubleClickOnRotation&&R.checkDoubleClickOnRotation(K,Q,W)||(hf(Q)?R.onEdgeDoubleClicked(Q,K,W):Q.ISubGraph?R.onSubGraphDoubleClicked(Q,K,W):Bs(Q)?R.onGroupDoubleClicked(Q,K,W):Q.IDoorWindow?R.onDoorWindowDoubleClicked(Q,K,W):Q.ICSGBox&&R.onCSGBoxDoubleClicked(Q,K,W))):(R.fi({kind:"doubleClickBackground",event:K}),R.onBackgroundDoubleClicked(K)))},X.onSubGraphDoubleClicked=function(U){this.setCurrentSubGraph(U)},X.onEdgeDoubleClicked=function($,d){this.isEditable($)||($.ISubGraph&&!kj(d)?this.setCurrentSubGraph($):$.s("edge.toggleable")&&$.toggle())},X._39Q=function(c){return this.isInteractive(c)?this.preventDefaultWhenInteractive(c):!1},X.preventDefaultWhenInteractive=function(T){return T.s("preventDefaultWhenInteractive")},X.onGroupDoubleClicked=function(j){j.s("group.toggleable")&&j.toggle()},X.onDoorWindowDoubleClicked=function(v){v.s("dw.toggleable")&&v.toggle(!0)},X.onCSGBoxDoubleClicked=function(V,F){var v=this;if(v instanceof Ic){var z=v.intersectObject(F,V);z&&V.s(z.part+".toggleable")&&V.toggleFace(z.part,!0)}},X.onBackgroundClicked=function(){},X.onBackgroundDoubleClicked=function(){this.upSubGraph()},X.onDataClicked=function(){},X.onDataDoubleClicked=function(){},X.onAutoLayoutEnded=function(){},X.onMoveEnded=function(){},X.onPanEnded=function(){},X.onPinchEnded=function(){},X.onRectSelectEnded=function(){},X.onZoomEnded=function(){},X.serialize=function(C){return this.dm().serialize(C)},X.toJSON=function(){return this.dm().toJSON()},X.deserialize=function(T,b){var h=this;b=b instanceof Tr?{rootParent:b}:hm(b)?{setId:b}:mj(b)?{finishFunc:b}:b||{},b.view=h;var R=h.dm();return b.__innerHandler__=function(O){if(hm(R.a("toolTipEnable"))&&(R.a("toolTipEnable")?h.enableToolTip():h.disableToolTip()),h instanceof C.graph.GraphView&&(hm(R.a("zoomable"))&&h.setZoomable&&h.setZoomable(R.a("zoomable")),hm(R.a("pannable"))&&h.setPannable&&h.setPannable(R.a("pannable")),hm(R.a("rectSelectable"))&&h.setRectSelectable&&h.setRectSelectable(R.a("rectSelectable")),R.a("fitContent")===!0&&h.fitContent&&h.fitContent(!0,0)),h instanceof C.graph3d.Graph3dView){var T=O.scene;T&&T.shadow!=V&&h.shadowMap.setShadow(T.shadow,T.shadowParams);var Y=R.a("sceneContext");Y?(Y.eye&&h.setEye(Y.eye),Y.center&&h.setCenter(Y.center),Ob(Y.far)&&h.setFar(Y.far),Ob(Y.near)&&h.setNear(Y.near)):(Ob(R.a("sceneNear"))&&h.setNear(R.a("sceneNear")),Ob(R.a("sceneFar"))&&h.setFar(R.a("sceneFar")),T&&(T.eye&&h.setEye(T.eye),T.center&&h.setCenter(T.center))),hm(R.a("sceneShadowEnabled"))&&(R.a("sceneShadowEnabled")?h.enableShadow():h.disableShadow()),Ob(R.a("sceneShadowDegreeX"))&&h.setShadowDegreeX(R.a("sceneShadowDegreeX")),Ob(R.a("sceneShadowDegreeZ"))&&h.setShadowDegreeZ(R.a("sceneShadowDegreeZ")),Ob(R.a("sceneShadowIntensity"))&&h.setShadowIntensity(R.a("sceneShadowIntensity")),R.a("sceneShadowQuality")!=V&&h.setShadowQuality(R.a("sceneShadowQuality")),R.a("sceneShadowType")&&h.setShadowType(R.a("sceneShadowType")),Ob(R.a("sceneShadowRadius"))&&h.setShadowRadius(R.a("sceneShadowRadius")),Ob(R.a("sceneShadowBias"))&&h.setShadowBias(R.a("sceneShadowBias")),hm(R.a("sceneDashEnable"))&&h.setDashDisabled(!R.a("sceneDashEnable")),Zq(R.a("sceneHighlightMode"))&&h.setHighlightMode(R.a("sceneHighlightMode")),Ob(R.a("sceneHighlightWidth"))&&h.setHighlightWidth(R.a("sceneHighlightWidth")),R.a("sceneHighlightColor")&&h.setHighlightColor(R.a("sceneHighlightColor")),hm(R.a("sceneHeadlightEnable"))&&h.setHeadlightDisabled(!R.a("sceneHeadlightEnable")),Ob(R.a("sceneHeadlightRange"))&&h.setHeadlightRange(R.a("sceneHeadlightRange")),R.a("sceneHeadlightColor")&&h.setHeadlightColor(R.a("sceneHeadlightColor")),Ob(R.a("sceneHeadlightIntensity"))&&h.setHeadlightIntensity(R.a("sceneHeadlightIntensity")),Ob(R.a("sceneHeadlightAmbientIntensity"))&&h.setHeadlightAmbientIntensity(R.a("sceneHeadlightAmbientIntensity")),hm(R.a("sceneFogEnable"))&&h.setFogDisabled(!R.a("sceneFogEnable")),R.a("sceneFogMode")&&h.setFogMode(R.a("sceneFogMode")),hm(R.a("sceneFogDensity"))&&h.setFogDensity(!R.a("sceneFogDensity")),R.a("sceneFogColor")&&h.setFogColor(R.a("sceneFogColor")),Ob(R.a("sceneFogNear"))&&h.setFogNear(R.a("sceneFogNear")),Ob(R.a("sceneFogFar"))&&h.setFogFar(R.a("sceneFogFar")),hm(R.a("sceneBatchBrightnessDisabled"))&&h.setBatchBrightnessDisabled(R.a("sceneBatchBrightnessDisabled")),hm(R.a("sceneBatchBlendDisabled"))&&h.setBatchBlendDisabled(R.a("sceneBatchBlendDisabled")),hm(R.a("sceneBatchColorDisabled"))&&h.setBatchColorDisabled(R.a("sceneBatchColorDisabled")),R.a("sceneBatchInfoMap")&&h.setBatchInfoMap(R.a("sceneBatchInfoMap")),Ob(R.a("sceneMoveStep"))&&h.setMoveStep(R.a("sceneMoveStep")),Ob(R.a("sceneRotateStep"))&&h.setRotateStep(R.a("sceneRotateStep")),hm(R.a("sceneSortable"))&&h.setSortable(R.a("sceneSortable")),mj(R.a("sceneSortFunc"))&&h.setSortFunc(R.a("sceneSortFunc"));var c=R.a("sceneSkyboxType")||"sphere";if(c!=V){var S={},z=!1;if("sphere"===c){S.shape3d=c;var E=R.a("sceneSkyboxImage");E&&(S["shape3d.image"]=E,z=!0)}else S.shape3d=$,["front","back","left","right","top","bottom"].forEach(function(r){var t=r+".image",W=r.charAt(0).toUpperCase()+r.slice(1),E=R.a("sceneSkybox"+W+"Image");E&&(S[t]=E,z=!0)});if(z){var u=new zo;u.s3(20,20,20),S["body.color"]=R.a("sceneSkyboxBodyColor"),S.envmap=R.a("sceneSkyboxEnvmap"),S.light=!1,S["texture.wrap"]="clampToEdge",u.s(S),["X","Y","Z"].forEach(function(T){var X=R.a("sceneSkyboxRotation"+T);Ob(X)&&u["setRotation"+T](X)}),h.setSkybox(u)}}}},R.deserialize(T,b.rootParent,b)},X.isDebugTipShowing=function(){return!!this._debugDiv},X.showDebugTip=function(){var r=this,h=r._debugDiv;if(!h){h=r._debugDiv=i.createElement("div"),h.style.position="absolute",h.style.overflow="hidden",h.style.font=B.debugTipLabelFont,h.style.padding="6px",h.style.backgroundColor=B.debugTipBackground,h.style.color=B.debugTipLabelColor;var s=r.getView();r._79O?s.insertBefore(h,r._79O):s.appendChild(h);var F=function(){r.redraw();var X=r._canvas,Z="FPS: "+r._fpsInfo.fps+"<br/>"+"Datas: "+r.dm().getDatas().length+(X?"<br/>Size: "+X.width+" * "+X.height:""),K=r.dm()._historyManager;K&&(Z+="<br/>Undoes: "+K.getHistories().length+" index: "+K.getHistoryIndex());var V=r.getDebugTip();V&&(Z+="<hr>"+V),h.innerHTML=Z,r._isDebugging&&requestAnimationFrame(F)};requestAnimationFrame(F),r._isDebugging=!0}},X.hideDebugTip=function(){var f=this,u=f._debugDiv;u&&(delete f._debugDiv,f.getView().removeChild(u),f._isDebugging=!1)},X.updateDOMAppendMatrix=function(){var y=this.getView();y&&(y.updateAppendMatrix=!0)},X.countFrame=function(){if(this._isDebugging){var V=Date.now(),i=this._fpsInfo;V-i.time>1e3?(i.fps=Math.round(1e5*(i.frames+1)/(V-i.time))/100,i.time=V,i.frames=0):i.frames++}}},ms_icons:function(p){p.getRotation=function(R){return R==V?0:R},p._15O=function(){var J=this,b=J.s(Bm);if(b){var c=J,v=J.data||J._data,H=J._38o={icons:b,rects:{}};for(var k in b){var Z=b[k],x=Th(Z.shape3d,v,c);if(!(Th(Z.visible,v,c)===!1||Th(Z.for3d,v,c)&&!J.I3d||x&&!J.I3d)){var o=x?[x]:Th(Z.names,v,c),T=o?o.length:0,f=Th(Z.position,v,c)||3,r=Th(Z.offsetX,v,c)||0,D=Th(Z.offsetY,v,c)||0,S=Th(Z.direction,v,c)||ro,A=Th(Z.gap,v,c),N=A!=V?A:1,s=Th(Z.rotation,v,c),l=Th(Z.keepOrien,v,c),O=Th(Z.rotationFixed,v,c)?s:J.getRotation(s,l,f),E=V,g=H.rects[k]=new Array(T);
g.rotation=O;for(var e=0;T>e;e++){var $,G,Q,W,P=o[e];if(x)Q=0,W=0;else{var C=Cc(P);Q=Th(Z.width,v,c),W=Th(Z.height,v,c),Q==V&&(Q=Fe(C,v)),W==V&&(W=Dm(C,v))}if(E?S===ro?r+=Q/2:S===Kk?r-=Q/2:S===wc?D-=W/2:D+=W/2:E={width:Q,height:W},J.I3d){var i=-Q/2,u=-W/2;G={width:Q,height:W,mat:J._16O(Th(Z.autorotate,v,c),f,E,Th(Z.face,v,c)||Ah,Th(Z.t3,v,c),Th(Z.r3,v,c),Th(Z.rotationMode,v,c),r,D),vs:new Uj([i,-u,0,i,-u-W,0,i+Q,-u-W,0,i+Q,-u,0])}}else $=J.getPosition(f,r,D,E,Th(Z.positionFixed,v,c)),G={x:$.x-Q/2,y:$.y-W/2,width:Q,height:W},J._68o(G,O);g[e]=G,S===ro?r+=Q/2+N:S===Kk?r-=Q/2+N:S===wc?D-=W/2+N:D+=W/2+N}}}}}}});var Fp={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},ej={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},uq={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},ak={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},qs={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Ff={"edge.type":1,"edge.group":1},Ej={rotation:1,rotationX:1,rotationZ:1},rc={rotation:1,rotationX:1,rotationZ:1,position:1,width:1,height:1,anchor:1,scale:1},ip={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},$f={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},co={shape:1,thickness:1,position:1,anchor:1,scale:1},uj=function(D){if(!D)return V;if(hf(D)){var X=D._40I,_=D._41I;if(!X||!_)return V;var v=uj(X),F=uj(_);return v===F?v:V}for(var G=D._parent;hf(G)&&!G.ISubGraph;)G=G._parent;return G?G.ISubGraph?G:uj(G):V},ab=function(X,B,O,S){var M=B.getStyle(O)*S;M&&Pm(X,M),M=B.getStyle(O+".left")*S,M&&(X.x-=M,X.width+=M),M=B.getStyle(O+".right")*S,M&&(X.width+=M),M=B.getStyle(O+".top")*S,M&&(X.y-=M,X.height+=M),M=B.getStyle(O+".bottom")*S,M&&(X.height+=M),X.width<0&&(X.width=-X.width,X.x-=X.width),X.height<0&&(X.height=-X.height,X.y-=X.height)},Kp=function(y){for(var D,l=0,v=y.size();v>l;l++)if(D=y.getChildAt(l),Zb(D)&&Kp(D))return!0;return y.hasAgentEdges()},fb=function(M){if(!M)return V;for(var C=M._parent;Bs(C);){if(!Bs(C._parent))return C.isExpanded()?M:C;C.isExpanded()||(M=C),C=C._parent}return M},Gi=function(O,r){if(!O||!r)return V;var b,x,c,q=uj(O),j=uj(r);if(q!==j){for(;j&&q!==j;)j=uj(j);if(q===j)return O;b=new le,b.add(O,0);for(var s=O._parent;Zb(s)&&!r.isDescendantOf(s);)b.add(s,0),s=s._parent;for(c=b.size(),x=0;c>x;x++){var I=b.get(x);if(Bs(I)&&!I.isExpanded())return I;if(I.ISubGraph)return I}return O}return O},_l=function(H){if(H.isLooped())return H._source;var M=fb(H._source),E=fb(H._target);return M===E?H._source:Gi(M,E)},jq=function(K){if(K.isLooped())return K._target;var f=fb(K._source),e=fb(K._target);return f===e?K._target:Gi(e,f)},db=function(c,X,e){"target"!==e&&(e="source");var F="target"===e?X.getTargetAgent():X.getSourceAgent(),i="edge."+e+".";if(hf(F)){var O=c.getDataUI(F);O._79o();var B=X.s(i+"index");if(B>=0){var U=qb(O);return U[Math.max(0,Math.min(B,U.length-1))]}var f=X.s(i+"percent")||0;f=Math.max(0,Math.min(f,1));var t=Nn(O);return Cg(t,100*f)}return Ie(c,F,X.s(i+"position"),X.s(i+"offset.x"),X.s(i+"offset.y"),X.s(i+"anchor.x"),X.s(i+"anchor.y"))},Ie=function(m,s,L,y,_,t,S){if(!s)return V;var e,c=s.getRotation?s.getRotation():0;if(t!==$||S!==$){t=t===$?.5:t,S=S===$?.5:S;var F=s.getScale();if(c&&!Bd(s,m)||F.x<0||F.y<0){var U=s.getPosition(),v=s.getWidth(),C=s.getHeight(),Y=s.getAnchor(),n=new qf(c,U.x,U.y,F.x,F.y);L=n.tf((t-Y.x)*v,(S-Y.y)*C)}else e=Ak(m,s),L={x:e.x+t*e.width,y:e.y+S*e.height}}else L=Dn(L,Ak(m,s));if(c){var g=D(c),H=w(c),p=y*g-_*H;_=y*H+_*g,y=p}return L.x+=y,L.y+=_,L},Pk=function(q,s){if(!q||!s)return V;var B,w,n,$,W,U;if(q===s){if($=q.getLoopedEdges(),!$)return V;$=new le($)}else{if(W=q.getAgentEdges(),U=s.getAgentEdges(),!W||!U)return V;for(w=W.size(),B=0;w>B;B++)n=W.get(B),U.contains(n)&&($||($=new le),$.add(n))}if($)for(B=0;B<$.size();B++)n=$.get(B),n.getStyle(mf)===Jd&&(n._22I(V),$.removeAt(B),B--);return $},wf=function(H,B){var W=Pk(H,B);if(W&&!W.isEmpty()){if(1===W.size())return W.get(0)._22I(V),void 0;var O=new le,h=new le;W.each(function(t){var S=t.s("edge.group");O.contains(S)||O.add(S)}),O.sort(),O.each(function(B){h.add(new C.EdgeGroup(W.toList(function(X){return B===X.s("edge.group")}),h))}),h.each(function(r){r.each(function(u){u._22I(r)})})}},xr=function(Y,F,v){var B=Y._canvas;Y._zoom;var q=Kf(F,B),j=Kf(v,B);return{x:q.x-j.x,y:q.y-j.y}},Er=function(m,d){if(d){var X=d.rect,A=d.color,h=d.rotation,c=d.labelWidth,g=d.background,o=d.opacity,b=d.scale,v=b!=V&&1!==b;if(o!=V){var Y=m.globalAlpha;m.globalAlpha*=o}if(h||v){m.save();var H=X.x+X.width/2,k=X.y+X.height/2;Sg(m,H,k),h&&Nh(m,h),v&&m.scale(b,b),Sg(m,-H,-k)}if(g&&Wq(m,X.x,X.y,X.width,X.height,g),c){var G=X.width,W=m.createLinearGradient(X.x,X.y,X.x+G,X.y);W.addColorStop(0,A),W.addColorStop(.9,A),W.addColorStop(1,Vm),A=W,X.width=c}Em(m,d.ss,X,d.font,A,d.align),c&&(X.width=G),(h||v)&&m.restore(),o!=V&&(m.globalAlpha=Y)}},ik=function(T,Q){if(Q){var f=Q.rect,o=f.x,k=f.y,m=f.width,l=f.height,M=Q.background,L=Q.backgroundImage,N=Q.borderWidth,C=Q.borderColor,b=Q.labelWidth,p=Q.opacity,w=Q.scale,R=w!=V&&1!==w;if(p!=V){var $=T.globalAlpha;T.globalAlpha*=p}if(R){T.save();var z=f.x+f.width/2,U=f.y+f.height/2;Sg(T,z,U),T.scale(w,w),Sg(T,-z,-U)}if(Q.expanded){var G=s(8,m/4),q=k+l-8;if(T.fillStyle=M,T.beginPath(),T.moveTo(o,k),T.lineTo(o,q),T.lineTo(o+m/2,q),T.lineTo(o+m/2,k+l),T.lineTo(o+m/2+G,q),T.lineTo(o+m,q),T.lineTo(o+m,k),T.closePath(),T.fill(),N&&(T.lineWidth=N,T.lineJoin="round",T.lineCap="round",C?(T.strokeStyle=C,T.stroke()):(T.strokeStyle=$e(M),T.beginPath(),T.moveTo(o+m,k),T.lineTo(o+m,q),T.lineTo(o+m/2+G,q),T.lineTo(o+m/2,k+l),T.stroke(),T.strokeStyle=cr(M),T.beginPath(),T.moveTo(o+m,k),T.lineTo(o,k),T.lineTo(o,q),T.lineTo(o+m/2,q),T.lineTo(o+m/2,k+l),T.stroke())),L)kr(T,Cc(L),re,f.x,f.y,f.width,f.height-8,Q.data,Q.view);else{if(f.height-=8,M=Q.color,b){var h=m,O=T.createLinearGradient(o,k,o+h,k);O.addColorStop(0,M),O.addColorStop(.9,M),O.addColorStop(1,Vm),M=O,f.width=b}Em(T,Q.ss,f,Q.font,M,Q.align),b&&(f.width=h),f.height+=8}}else if(Q.icon)em(T,Cc(Q.icon),o,k,m,l,Q.data,Q.view);else{var X=m/2;N&&(T.lineWidth=N,T.lineJoin="round",T.lineCap="round",T.strokeStyle=C?C:$e(M),T.beginPath(),T.arc(o+X,k+X,X,d,1.6*Z,!0),T.moveTo(o+X,k+l),T.lineTo(o+m-X/5,k+X),T.stroke(),T.strokeStyle=C?C:cr(M),T.beginPath(),T.arc(o+X,k+X,X,1.6*Z,d,!0),T.moveTo(o+X,k+l),T.lineTo(o+X/5,k+X),T.stroke()),T.fillStyle=M,T.beginPath(),T.arc(o+X,k+X,X,0,J,!0),T.moveTo(o+X,k+l),T.lineTo(o+m-X/5,k+X),T.lineTo(o+X/5,k+X),T.closePath(),T.fill(),T.fillStyle=Q.color,T.beginPath(),T.arc(o+X,k+X,X/3,0,J,!0),T.fill()}R&&T.restore(),p!=V&&(T.globalAlpha=$)}},sg=function(C,w){return w>2*C?C:w/2},Gb=function($,W,B,b){if(!$||!W)return 0;var t=I(W.y-$.y,W.x-$.x);return B||(t=W.x<$.x?t+Z:t),t+b},di=function(y,L,f,b,g,G,N){N&&(y.x>L.x||y.x===L.x&&y.y>L.y)&&(f=Xf[f],g=-g);var P=Dn(f,{x:0,y:0,width:Lf(y,L),height:0},G);return P.x+=b,P.y+=g,P=new qf(I(L.y-y.y,L.x-y.x)).tf(P),P.x+=y.x,P.y+=y.y,P},Pg=function(H,R,V,F,z){if(H._19Q=!0,!V.getEdgeGroup())return F?V.s("edge.gap"):0;if(hf(V.getSourceAgent())||hf(V.getTargetAgent()))return 0;var C,i=0,D=0,I=0;if(V.getEdgeGroup().getSiblings().each(function(P){P.each(function(r){if(R.isVisible(r)&&r.s(mf)==z){var q=r.s("edge.gap");C?(D+=I/2+q/2,I=q):(C=r,I=q),r===V&&(i=D)}})}),F)return D-i+I;var O=i-D/2;return C&&V._40I!==C._40I&&(H._19Q=!1),O},_g=function(){var n=function(o){var g=[];return o.forEach(function(B){g.push({x:B.x,y:B.y}),g.push({x:B.x+B.width,y:B.y+B.height}),g.push({x:B.x+B.width,y:B.y}),g.push({x:B.x,y:B.y+B.height})}),g};return function(Y,e,S){if("oval"===Y){var z=0,R=S.height/S.width,q=R*R,Z=S.x+S.width/2,V=S.y+S.height/2,d=n(e);d.forEach(function(U){var a=U.x-Z,J=U.y-V,C=a*a+J*J/q;C>z&&(z=C)}),z=j(z);var m=R*z;return{x:Z-z,y:V-m,width:2*z,height:2*m}}if("circle"===Y){var u=0,Z=S.x+S.width/2,V=S.y+S.height/2,d=n(e);return d.forEach(function(H){var f=H.x-Z,B=H.y-V,P=f*f+B*B;P>u&&(u=P)}),u=j(u),{x:Z-u,y:V-u,width:2*u,height:2*u}}return"roundRect"===Y?(Pm(S,s(S.width,S.height)/16),S):S}}(),Gj=C.graph={},jm=function(i,J,X){ym(M+".graph."+i,J,X)};C.layout={};var xd={},Gn=function(X,H,u,k,_,Y,E,e){var l=E._zoom;if(l!==E._cacheZoom&&(E._cacheZoom=l,E._cacheImage={}),l*=Me,k=Math.ceil(k*l),_=Math.ceil(_*l),k>2048||_>2048)return H;var S=[H.uuid,k,_,u].join("_");H.cacheRule&&(S+="_"+Th(H.cacheRule,Y,E));var f=E._cacheImage[S];return f||(Op(),f=C.Default.toCanvas(H,k,_,u,Y,E,e),Cd()&&(E._cacheImage[S]=f)),f};Ki(B,{setImageCacheRule:function($,r){var y;r||"object"!=typeof $?(y={},y[$]=r):y=$;for(var N in y){var R=y[N];Zq(N)?(ym=Cc(N),ym?ym.cacheRule=R:xd[N]=R):N.cacheRule=R}}});var zf={comps:[{type:Po,points:[85,50,70,115,100,71,86,107,88,49,47,53,88,74,122,70,115,53,115,79,56,120,76,119,87,103,108,107,49,56,97,87,112,43,119,112,106,101,86,70,79,101,81,61],borderWidth:1,borderColor:V}]};if(zf[ed]=zf[Gk]=160,n.Image){var $c=new n.Image;$c.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",Kb("default_blank",$c)}Kb("node_image",ai(30,30,[{type:Rq,rect:[4,5,22,16],gradient:yn,gradientColor:br,background:lr},{type:Rq,rect:[2,3,26,20],borderWidth:1,borderColor:lr},{type:Rq,rect:[11,23,8,4],background:lr},{type:Rq,rect:[6,27,18,2],background:lr}])),Kb("node_icon",ai(16,16,[{type:Rq,rect:[2,2,12,10],gradient:yn,gradientColor:br,background:lr},{type:Ue,rect:[2,2,12,10],width:1,color:lr},{type:Rq,rect:[6,12,4,2],background:lr},{type:Rq,rect:[4,14,8,1],background:lr}])),Kb("block_icon",ai(16,16,[{type:Ue,rect:[1,1,14,14],width:1,color:lr}])),Kb("group_image",ai(66,39,[{type:Rq,rect:[44.3,18,18.1,12.8],gradient:yn,gradientColor:br,background:lr},{type:Rq,rect:[3.3,17.8,18.1,12.8],gradient:yn,gradientColor:br,background:lr},{type:Rq,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:lr,gradient:yn,gradientColor:br,background:lr},{type:Rq,rect:[26.2,29.4,12.8,4.2],background:lr},{type:Rq,rect:[21.3,33.5,22.5,2.3],background:lr},{type:Rq,rect:[5.3,32.7,14.1,2.1],background:lr},{type:Rq,rect:[9,30.4,6.7,2.4],background:lr},{type:Rq,rect:[50,30.7,6.7,2.4],background:lr},{type:Rq,rect:[46.3,33,14.1,2.1],background:lr}])),Kb("group_icon",ai(16,16,[{type:Rq,rect:[4,12,4,2],background:lr},{type:Rq,rect:[2,13,8,1],background:lr},{type:Rq,rect:[12,12,2,1],background:lr},{type:Rq,rect:[11,13,4,1],background:lr},{type:Rq,rect:[10,7,6,5],gradient:yn,gradientColor:br,background:lr},{type:Rq,rect:[1,2,10,10],gradient:yn,gradientColor:br,background:lr},{type:Ue,rect:[1,2,10,10],width:1,color:lr}])),Kb("refGraph_icon",ai(16,16,[{type:"shape",borderWidth:1,borderColor:lr,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:lr,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Kb("edge_icon",ai(16,16,[{type:Rq,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:yn,gradientColor:br,background:lr},{type:Rq,rect:[10.8,1,4,4],background:lr},{type:Rq,rect:[1,11,4,4],background:lr}])),Kb("subGraph_image",ai(72,45,[{type:Po,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:yn,gradientColor:br,background:lr},{type:Rq,rect:[29.6,30.7,3.6,1.8],background:lr},{type:Rq,rect:[28.4,32.3,6,1.2],background:lr},{type:Rq,rect:[37.3,32,10.8,1.8],background:lr},{type:Rq,rect:[39.1,29.9,7.2,2.3],background:lr},{type:Rq,rect:[26.6,23.7,9.6,7.2],gradient:yn,gradientColor:br,background:lr},{type:Rq,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:lr,gradient:yn,gradientColor:br,background:lr}])),Kb("subGraph_icon",ai(17,17,[{type:Po,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:yn,gradientColor:br,background:lr}])),Kb("shape_icon",ai(16,16,[{type:Po,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:lr}])),Kb("polyline_icon",ai(16,16,[{type:Po,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:lr},li(7.5,.4),li(7.5,6.3),li(13.6,6.3),li(13.6,14),li(.7,13.9),li(.7,.3)])),Kb("grid_icon",ai(16,16,[{type:Rq,rect:[1,1,4,4],background:lr,gradient:yn,gradientColor:br},{type:Rq,rect:[6,1,4,4],background:lr,gradient:yn,gradientColor:br},{type:Rq,rect:[11,1,4,4],background:lr,gradient:yn,gradientColor:br},{type:Rq,rect:[11,6,4,4],background:lr,gradient:yn,gradientColor:br},{type:Rq,rect:[6,6,4,4],background:lr,gradient:yn,gradientColor:br},{type:Rq,rect:[1,6,4,4],background:lr,gradient:yn,gradientColor:br},{type:Rq,rect:[11,11,4,4],background:lr,gradient:yn,gradientColor:br},{type:Rq,rect:[6,11,4,4],background:lr,gradient:yn,gradientColor:br},{type:Rq,rect:[1,11,4,4],background:lr,gradient:yn,gradientColor:br}])),Kb("light_icon",ai(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:lr},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:lr,gradient:yn,gradientColor:br,background:{func:function(R){var q=R?R.s(jn):V;return Xj(q)?"rgb("+Zp(255*q[0])+","+Zp(255*q[1])+","+Zp(255*q[2])+")":q||lr}}}])),Kb("text_icon",ai(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:lr}])),Kb("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Kb("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Kb("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Kb("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var ml=function(O,h,i,p,z,w){var E,G,A,H,V,x,s,I,$,Z,o,N=[];if(Math.abs(p)>2*Math.PI&&(p=2*Math.PI),V=Math.ceil(Math.abs(p)/(Math.PI/4)),E=p/V,G=-E,A=-i,V>0){x=O+Math.cos(i)*z,s=h+Math.sin(-i)*w,N.push({x:x,y:s});for(var R=0;V>R;R++)A+=G,H=A-G/2,I=O+Math.cos(A)*z,$=h+Math.sin(A)*w,Z=O+Math.cos(H)*(z/Math.cos(G/2)),o=h+Math.sin(H)*(w/Math.cos(G/2)),N.push({x:Z,y:o}),N.push({x:I,y:$})}return N},ph=function(q){if(q){var t=q._data;if(t instanceof C.Shape)return{points:t.getPoints(),segments:t.getSegments()};var n;if(t instanceof C.Edge&&(n=q._78o)){var k,z,K=n.type,O=n.points,P=n.segments,v=n.edgeTypeInfo;if(!K||O){var F=n.sourcePoint,T=F.x,V=F.y,A=n.targetPoint,s=A.x,S=A.y;if(K)P?(k=new le({x:T,y:V}),k.addAll(O),k.add({x:s,y:S}),z=new le(P._as)):(k=new le({x:T,y:V}),O.each(function(y){k.add(y)}),k.add({x:s,y:S}));else if(n.looped){k=new le(ml(T,V,0,2*Math.PI,n.radius,n.radius)),z=new le([1]);for(var l=0;l<(k.size()-1)/2;l++)z.add(3)}else k=new le,n.center?(k.add({x:n.c1.x,y:n.c1.y}),k.add({x:T,y:V}),k.add({x:s,y:S}),k.add({x:n.c2.x,y:n.c2.y})):(k.add({x:T,y:V}),k.add({x:s,y:S}))}else v&&(k=new le(v.points._as),v.segments&&(z=new le(v.segments._as)));return{points:k,segments:z}}}},Nn=function(M,q,j){if(null==q){var i=ph(M);if(!i)return;q=i.points,j=i.segments}if(q){if(Array.isArray(q)&&(q=new le(q)),"number"==typeof q.get(0)){for(var K=new C.List,y=0;y<q.size();y+=2)K.add({x:q.get(y),y:q.get(y+1)});q=K}if(!j){j=[1];for(var T=q.length-1;T>0;T--)j.push(2)}Array.isArray(j)&&(j=new le(j));for(var V=ds(q._as,j._as,50),s=V.length,F=[],y=0;s>y;y++){var N=V[y];N.length>1&&F.push(N)}return F}},uh=function(y){for(var $=0,s=y.length-1,I=0;s>I;I++){var f=y[I],X=y[I+1],R=X.x-f.x,F=X.y-f.y;$+=Math.sqrt(R*R+F*F)}return $},Cs=function(o,m){for(var B=0,y=m.length,C=0;y>C;C++){var _=m[C];if(B+=_,B>o)return C}return Math.min(C,y-1)},Mi=function(q,j){for(var U=0,O=0,A=0,k=q.length-1,G=0;k>G;G++){var m=q[G],l=q[G+1],g=l.x-m.x,D=l.y-m.y;if(A=Math.sqrt(g*g+D*D),U+=A,U>j){U-=A,O=G;break}}var T=q[O],w=q[O+1],J=Math.atan2(w.y-T.y,w.x-T.x),B=j-U,D=Math.sin(J)*B,g=Math.cos(J)*B;return{x:T.x+g,y:T.y+D}},Cg=function(V,S){if(V){var b;if(0===S)b=V[0][0];else if(100===S)V=V[V.length-1],b=V[V.length-1];else{for(var C=0,n=[],Y=V.length,R=0;Y>R;R++){var Z=V[R],P=uh(Z);C+=P,n.push(P)}for(var w=C*S/100,t=Cs(w,n),e=0,d=0;t>d;d++)e+=n[d];w-=e,b=Mi(V[t],w)}return b}},qb=function(w){var z,Y,B,O,q=ph(w),R=[],t=q.points,u=q.segments,h=-1;for(Y=0,B=u?u.length:t.length;B>Y;Y++){if(z=u?u.get(Y):1,3===z)O=2;else if(4===z)O=3;else{if(5===z)continue;O=1}h+=O,R.push(t.get(h))}return R},Nq=function(J,Q,G,D){function c(S){if(S>=0&&1>=S){k=Q(S);var w=(J.x-k.x)*(J.x-k.x)+(J.y-k.y)*(J.y-k.y);return X>w?(X=w,l=S,!0):!1}}G=G||100,D=D||1e-5;for(var X=1/0,l=0,k=new kp,o=0;G>o;++o)c(o/G);for(var z=1/(2*G);z>D;)c(l-z)||c(l+z)||(z/=2);return l};Ki(B,{_edgeProtectMethod:{getStraightLinePoints:Nn,calculateLineLength:uh,calcSegmentIndexByDistance:Cs,calculatePointAlongLine:Mi,getPercentPosition:Cg,getRealPointsFromDataUI:qb}});var bq=function(Q,J){for(var s=Q.vertices,M=0;M<s.length;M++){var G=s[M],T=G.y;G.y=G.z,G.z=-T,J&&(G.y+=J)}},$n=function(H){for(var e,q,d,f,l,u,b=[],o=[],V=[],B=H.faces,K=0,k=0,w=0,n=B.length;n>K;K++,k+=6,w+=9){var M=B[K];1===M.i?(e||(e=[],q=[],d=[]),sc(M,K,k,w,H,e,d,q)):2===M.i?(f||(f=[],l=[],u=[]),sc(M,K,k,w,H,f,u,l)):sc(M,K,k,w,H,b,V,o)}return{vs:b,uv:o,ns:V,top_vs:e,top_uv:q,top_ns:d,bottom_vs:f,bottom_uv:l,bottom_ns:u}},sc=function(p,o,l,c,G,H,C,r){var x=G.vertices,E=G.faceVertexUvs,k=x[p.a],I=x[p.b],d=x[p.c];H.push(k.x,k.y,k.z,I.x,I.y,I.z,d.x,d.y,d.z);var n,V,i,e=p.vertexNormals;3===e.length?(n=e[0],V=e[1],i=e[2]):n=V=i=p.normal,C.push(n.x,n.y,n.z,V.x,V.y,V.z,i.x,i.y,i.z);var D=E[0][o][0],Z=E[0][o][1],m=E[0][o][2];r.push(D.x,D.y,Z.x,Z.y,m.x,m.y)},hh=function(){function f(x,B){return x.dot(B)>0}function Z(y,v,O,s,m,G,z){for(var R,n,c=[v,O,s],b=[m,G,z],J=[],j=c.length,A=!0;j--&&A;){for(var e=c[j],w=b.length,g=!1;w--;)if(e.equals(b[w])){b.splice(w,1),J.push(e),g=!0;break}if(!g){if(R){A=!1;break}R=e}}return A&&2===J.length&&(n=b[0],X.subVectors(R,J[0]),D.subVectors(n,J[0]),T.subVectors(R,J[1]),X.x*T.y*D.z+T.x*D.y*X.z+D.x*X.y*T.z-D.x*T.y*X.z-D.y*T.z*X.x-D.z*T.x*X.y<1e-6&&(i.subVectors(n,J[1]),a.subVectors(J[1],J[0]),f(a,X)&&f(a,D)&&(a.negate(),f(a,T)&&f(a,i))))?(y.push(J[1].x,J[1].y,J[1].z),y.push(R.x,R.y,R.z),y.push(R.x,R.y,R.z),y.push(J[0].x,J[0].y,J[0].z),y.push(J[0].x,J[0].y,J[0].z),y.push(n.x,n.y,n.z),y.push(n.x,n.y,n.z),y.push(J[1].x,J[1].y,J[1].z),2):(y.push(v.x,v.y,v.z),y.push(O.x,O.y,O.z),y.push(O.x,O.y,O.z),y.push(s.x,s.y,s.z),y.push(s.x,s.y,s.z),y.push(v.x,v.y,v.z),1)}function w(){this._vertexMap={},this._lineMap={},this._lineList=[]}function A(P,d,y,q,A,F,e){var W=[y,A];P[0]===q&&W.reverse();var p=[W[0]._key,W[1]._key].join("|"),H=P._triangles[p];H||(P._triangles[p]=H={});var V=[F._key,e._key].join("|");H[V]||(H[V]=[F,e])}function j(f,F,$){var d=f._planes[$._key];if(!d)for(var j in f._planes){var x=f._planes[j];if(x._normal.angleTo($)<.001){d=x;break}}return d?(d._vertices.indexOf(F)<0&&d._vertices.push(F),void 0):(f._planes[$._key]={_normal:$,_vertices:[F]},void 0)}function E(E,w){return 0===w?"0|0|0":1/0===Math.abs(w)?[E.x,E.y,E.z].join("|"):[Math.round(x.angleTo(E)*w),Math.round(B.angleTo(E)*w),Math.round(Q.angleTo(E)*w)].join("|")}function W(t,K){var d=t._ctlineModel;if(d||(t._ctlineModel=d=[]),d[0])return d[0];var j;j=Xj(t)?t:[t];var z,x,B,T,h,A,f,a,p,l,u,J,W,I,P,s,O,R,_,Q=["","top_","bottom_"];d=[];var V=[];for(qm(j,K,V),z=0,x=V.length;x>z;z++)if(l=V[z])for(Wp(l),B=0,T=Q.length;T>B;B++)if(p=l[Q[B]+"lvs"])for(O=d.length,R=p.length,d.length=O+R,_=0;R>_;++_,++O)d[O]=p[_];else if(f=l[Q[B]+"vs"]){a=l[Q[B]+"is"],A=a?a.length:f.length/3;for(var h=0;A-1>h;)a?(u=a[h],J=a[h+1],W=a[h+2],I=a[h+3],P=a[h+4],s=a[h+5]):(u=h,J=h+1,W=h+2,I=h+3,P=h+4,s=h+5),S.fromArray(f,3*u),N.fromArray(f,3*J),C.fromArray(f,3*W),g.fromArray(f,3*I),Y.fromArray(f,3*P),q.fromArray(f,3*s),h+=3*Z(d,S,N,C,g,Y,q);A>h&&(a?(u=a[h],J=a[h+1],W=a[h+2]):(u=h,J=h+1,W=h+2),S.fromArray(f,3*u),N.fromArray(f,3*J),C.fromArray(f,3*W),d.push(S.x,S.y,S.z),d.push(N.x,N.y,N.z),d.push(N.x,N.y,N.z),d.push(C.x,C.y,C.z),d.push(C.x,C.y,C.z),d.push(S.x,S.y,S.z))}return t._ctlineModel[0]=d,d}function V(i,b,U){var M=i._ctlineModel;M||(i._ctlineModel=M=[]);var D=M[1];if(D&&D.epsilon===U)return D;D=[],D.epsilon=U;var Z;Z=Xj(i)?i:[i];var J,A,j,I,N,c,d,Q,B,t,g,o,v=["","top_","bottom_"],a=new w,K=[];for(qm(Z,b,K),J=0,A=K.length;A>J;J++)if(B=K[J])for(Wp(B),j=0,I=v.length;I>j;j++)if(d=B[v[j]+"vs"]){Q=B[v[j]+"is"],c=Q?Q.length:d.length/3;for(var N=0,N=0;c>N;N+=3)Q?(t=Q[N],g=Q[N+1],o=Q[N+2]):(t=N,g=N+1,o=N+2),a._addTriangle(d,$,t,g,o,U)}return a._toLineVS(D),i._ctlineModel[1]=D,D}function H(t,Z,W){var q=t._ctlineModel;q||(t._ctlineModel=q=[]);var D=q[2];if(D&&D.epsilon===W)return D;D=[],D.epsilon=W;var A;A=Xj(t)?t:[t];var F,v,h,L,p,H,O,J,l,b,m,g,P,z=["","top_","bottom_"],o=new w,E=[];for(qm(A,Z,E),F=0,v=E.length;v>F;F++)if(b=E[F])for(Wp(b),h=0,L=z.length;L>h;h++)if(O=b[z[h]+"vs"]){J=b[z[h]+"is"],l=b[z[h]+"ns"],H=J?J.length:O.length/3;for(var p=0,p=0;H>p;p+=3)J?(m=J[p],g=J[p+1],P=J[p+2]):(m=p,g=p+1,P=p+2),o._addTriangle(O,l,m,g,P,W)}return o._toLineVS(D),t._ctlineModel[2]=D,D}var S=new Qe,N=new Qe,C=new Qe,g=new Qe,Y=new Qe,q=new Qe,X=new Qe,T=new Qe,D=new Qe,i=new Qe,a=new Qe,u=new Qe;w.prototype._findVertex=function(y,z){u.fromArray(y,3*z);var C=[u.x,u.y,u.z].join(","),r=this._vertexMap[C];if(!r){var G=u.clone();G._key=C,this._vertexMap[C]=r=G}return r},w.prototype._findLine=function(F,N){var n=[F,N];F._key>N._key&&n.reverse(),n._key=[n[0]._key,n[1]._key].join("|");var X=this._lineMap[n._key];return X||(this._lineMap[n._key]=X=n,n._triangles={},n._planes={},this._lineList.push(n)),X};var x=new Qe(1,0,0),B=new Qe(0,1,0),Q=new Qe(0,0,1),_=new Qe,L=new Qe;return w.prototype._addTriangle=function(w,g,F,Q,$,s){var Z,h,V,m=this._findVertex(w,F),I=this._findVertex(w,Q),X=this._findVertex(w,$),n=this._findLine(m,I),k=this._findLine(I,X),c=this._findLine(X,m);g?(Z=(new Qe).fromArray(g,3*F),Z._key=E(Z,s),h=(new Qe).fromArray(g,3*Q),h._key=E(h,s),V=(new Qe).fromArray(g,3*$),V._key=E(V,s),A(n,m,Z,I,h,X,V),A(k,I,h,X,V,m,Z),A(c,X,V,m,Z,I,h)):(L.subVectors(X,I),_.subVectors(I,m),Z=(new Qe).crossVectors(_,L),Z._key=E(Z,s),j(n,X,Z),j(k,m,Z),j(c,I,Z))},w.prototype._toLineVS=function(q){for(var F=this._lineList,d=0,J=F.length;J>d;++d){var s=F[d],X=!1;for(var f in s._triangles)if(1==e.keys(s._triangles[f]).length){q.push(s[0].x,s[0].y,s[0].z,s[1].x,s[1].y,s[1].z),X=!0;break}if(!X)for(var g in s._planes)if(1==s._planes[g]._vertices.length){q.push(s[0].x,s[0].y,s[0].z,s[1].x,s[1].y,s[1].z),X=!0;break}}},[W,V,H]}(),Jm=function(n,l){var Q=n._lineModel;if(Q)return Q;var z;z=Xj(n)?n:[n];var m,U,V,x,$,P,k,d,f,L,h,J,D=["","top_","bottom_"];Q=[];var C=[];for(qm(n,l,C),m=0,U=C.length;U>m;m++)if(f=C[m])for(V=0,x=D.length;x>V;V++)if(k=f[D[V]+"vs"]){d=f[D[V]+"is"],P=d?d.length:k.length/3;for(var $=0;P>$;$+=3)d?(L=d[$],h=d[$+1],J=d[$+2]):(L=$,h=$+1,J=$+2),L*=3,h*=3,J*=3,Q.push(k[L],k[L+1],k[L+2],k[h],k[h+1],k[h+2],k[h],k[h+1],k[h+2],k[J],k[J+1],k[J+2],k[J],k[J+1],k[J+2],k[L],k[L+1],k[L+2])}return n._lineModel=Q,Q},xn=function(G,S,Y,A,P,p,b,E,_){Y==V&&(Y=!0),A==V&&(A=!0),b==V&&(b=1),E==V&&(E=0);var T=new Kc;return gh(T,G,S,_),T=T.toShapes(),$n(new Sb(T,{top:Y,bottom:A,curveSegments:P,amount:b,repeatUVLength:p},-b/2+E))},ti=function(M){this.repeatUVLength=M};ti.prototype={generateTopUV:function($,E,Q,m,U,c,Y){var t,R,J,G,z=$.vertices,g=z[m].x,A=z[m].y,b=z[U].x,n=z[U].y,w=z[c].x,s=z[c].y,i=this.repeatUVLength;if(i)t=0,R=0,J=i,G=i;else{this._bb||(this._bb=E.getBoundingBox());var D=this._bb;t=D.minX,R=D.minY,J=D.maxX-t,G=D.maxY-R}return Y?[new $o((g-t)/J,(A-R)/G),new $o((b-t)/J,(n-R)/G),new $o((w-t)/J,(s-R)/G)]:[new $o((g-t)/J,1-(A-R)/G),new $o((b-t)/J,1-(n-R)/G),new $o((w-t)/J,1-(s-R)/G)]},generateBottomUV:function(t,i,s,g,S,n){return this.generateTopUV(t,i,s,g,S,n,!0)},generateSideWallUV:function(C,U,T,M,V,p,x,z,X,P,s,v){if(!this._cl){for(var O,e,f=[],i=0,L=T.length,Z=0;L>Z;Z++){O=T[Z],e=T[(Z+1)%L];var A=O.x-e.x,c=O.y-e.y,Y=j(A*A+c*c);f.push(i),i+=Y}for(var Z=0;L>Z;Z++)f[Z]/=i;this._cl=f}var f=this._cl,l=1-X/P,u=1-(X+1)/P,a=f[s],n=f[v];return n>a&&(a+=1),[new $o(a,l),new $o(n,l),new $o(n,u),new $o(a,u)]}};var we=function(z,o,w,S,b,A){this.a=z,this.b=o,this.c=w,this.i=A,this.normal=S instanceof Qo?S:new Qo,this.vertexNormals=S instanceof Array?S:[]};we.prototype={constructor:we};var ch=[-8,14,-5,9,1,12,3,6,-1],ki=function(){if(ki[Qd]!=V)return ki[Qd];for(var Z=Pb[Qd],D=ch,P=Tr.prototype.getClassName(),_='"',F=0,b="",J=!1,R=+new(n[P.substr(3,3)+Hr[F]]),K=F;K<D.length;K++){var r=D.length-K;b+=K%2===F?D[K]+r+"":D[K]-r+""}for(var K=F;4>K;K++)b+=F;if(b=b*b.length/b.length,R>b){if(Z&&Z[F]&&Z[4/Rq.length]){for(var L,S,k,e,q,M,G,B,H=Z[0],v=Z[1],x="",T=0,K=0;K<v.length;K++)v[K]===_?B?(B=!1,0!==T%2&&(L==V?L=x:S==V?S=x:k==V?k=x:e==V?e=x:q==V?q=x:M==V?M=x:G==V&&(G=x)),T++,x=""):B=!0:B&&(x+=v[K]);for(var h,w,p,$="",u=0,K=0;K<H.length;K++)H[K]===_?h?(h=!1,0!==u%2&&(w==V?w=$:p==V&&(p=$)),u++,$=""):h=!0:h&&($+=H[K]);var E=L+S+k+e+q+M,a=!M||M===vk;if(!a&&M)for(var l,K=0,m=M.length;m>K;K++)M[K]===sj[4]?l===vk?a=Lb:l[0]===nj[7]&&vk&&vk.indexOf(l.substr(1))>=0?a=qc:l=V:(l==V?l=M[K]:l+=M[K],K===m-1&&(l===vk?a=Lb:l[0]===nj[7]&&vk&&vk.indexOf(l.substr(1))>=0&&(a=qc)));(J=rl(E,G)&&rl(w,p)&&w===L&&a&&(!q||q>R))&&k.indexOf(Tc[0])>=0&&(ki[Tc[0]]=1),J&&k.indexOf(1)>=0&&(ki[1]=1),J&&k.indexOf(3)>=0&&(ki[2]=1),J&&k.indexOf(4)>=0&&(ki[3]=1),J&&k.indexOf(7)>=0&&(ki[4]=1)}}else J=!0,ki[Tc[0]]=ki[1]=ki[2]=ki[3]=ki[4]=1;return ki[Qd]=J,J},ij=function(){},yp=ij.prototype;yp.getPointAt=function(P){var C=this.getUtoTmapping(P);return this.getPoint(C)},yp.getPoints=function(F){F||(F=5);var M,r=[];for(M=0;F>=M;M++)r.push(this.getPoint(M/F));return r},yp.getSpacedPoints=function(m){m||(m=5);var Y,S=[];for(Y=0;m>=Y;Y++)S.push(this.getPointAt(Y/m));return S},yp.getLength=function(){var d=this.getLengths();return d[d.length-1]},yp.getLengths=function(b){if(b||(b=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==b+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var _,J,Y=[],n=this.getPoint(0),r=0;for(Y.push(0),J=1;b>=J;J++)_=this.getPoint(J/b),r+=_.distanceTo(n),Y.push(r),n=_;return this.cacheArcLengths=Y,Y},yp.getUtoTmapping=function(E,P){var k,B=this.getLengths(),l=0,f=B.length;k=P?P:E*B[f-1];for(var c,n=0,R=f-1;R>=n;)if(l=b(n+(R-n)/2),c=B[l]-k,0>c)n=l+1;else{if(!(c>0)){R=l;break}R=l-1}if(l=R,B[l]==k){var i=l/(f-1);return i}var x=B[l],z=B[l+1],d=z-x,t=(k-x)/d,i=(l+t)/(f-1);return i},yp.getTangent=function(N){var Q=1e-4,s=N-Q,m=N+Q;0>s&&(s=0),m>1&&(m=1);var U=this.getPoint(s),P=this.getPoint(m),_=P.clone().sub(U);return _.normalize()},yp.getTangentAt=function(C){var n=this.getUtoTmapping(C);return this.getTangent(n)},ij.create=function(B,S){return B.prototype=ui(ij.prototype),B.prototype.getPoint=S,B};var Wi=function(){this.curves=[],this.autoClose=!1},Eb=Wi.prototype=ui(yp);Eb.add=function(P){this.curves.push(P)},Eb.closePath=function(){var p=this.curves[0].getPoint(0),P=this.curves[this.curves.length-1].getPoint(1);p.equals(P)||this.curves.push(new Gd(P,p))},Eb.getPoint=function(L){for(var l,t,$=L*this.getLength(),X=this.getCurveLengths(),q=0;q<X.length;){if(X[q]>=$){l=X[q]-$,t=this.curves[q];var u=1-l/t.getLength();return t.getPointAt(u)}q++}return null},Eb.getLength=function(){var D=this.getCurveLengths();return D[D.length-1]},Eb.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var C,z=[],x=0,_=this.curves.length;for(C=0;_>C;C++)x+=this.curves[C].getLength(),z.push(x);return this.cacheLengths=z,z},Eb.getTransformedPoints=function(J){return this.getPoints(J)},Eb.getBoundingBox=function(){var S,H,d,z,P,Y,w=this.getPoints();S=H=Number.NEGATIVE_INFINITY,z=P=Number.POSITIVE_INFINITY;var e,O,C,o,l=w[0]instanceof Qo;for(o=l?new Qo:new $o,O=0,C=w.length;C>O;O++)e=w[O],e.x>S&&(S=e.x),e.x<z&&(z=e.x),e.y>H&&(H=e.y),e.y<P&&(P=e.y),l&&(e.z>d&&(d=e.z),e.z<Y&&(Y=e.z)),o.add(e);var $={minX:z,minY:P,maxX:S,maxY:H};return l&&($.maxZ=d,$.minZ=Y),$};var Cj=function(z){Wi.call(this),this.actions=[],z&&this.fromPoints(z)},kb=Cj.prototype=ui(Wi.prototype),Nd="moveTo",_p="lineTo",wi="quadraticCurveTo",Ck="bezierCurveTo",rg="arc",Lo="ellipse";kb.fromPoints=function(M){this.moveTo(M[0].x,M[0].y);for(var u=1,y=M.length;y>u;u++)this.lineTo(M[u].x,M[u].y)},kb.moveTo=function(){var L=Array.prototype.slice.call(arguments);this.actions.push({action:Nd,args:L})},kb.lineTo=function(o,j){var e=Array.prototype.slice.call(arguments),U=this.actions[this.actions.length-1].args,A=U[U.length-2],h=U[U.length-1],b=new Gd(new $o(A,h),new $o(o,j));this.curves.push(b),this.actions.push({action:_p,args:e})},kb.quadraticCurveTo=function(n,C,d,x){var G=Array.prototype.slice.call(arguments),M=this.actions[this.actions.length-1].args,D=M[M.length-2],v=M[M.length-1],Y=new oh(new $o(D,v),new $o(n,C),new $o(d,x));this.curves.push(Y),this.actions.push({action:wi,args:G})},kb.bezierCurveTo=function(O,l,d,a,y,N){var m=Array.prototype.slice.call(arguments),k=this.actions[this.actions.length-1].args,u=k[k.length-2],K=k[k.length-1],B=new vn(new $o(u,K),new $o(O,l),new $o(d,a),new $o(y,N));this.curves.push(B),this.actions.push({action:Ck,args:m})},kb.arc=function(J,M,C,T,W,R){var k=this.actions[this.actions.length-1].args,_=k[k.length-2],g=k[k.length-1];this.absarc(J+_,M+g,C,T,W,R)},kb.absarc=function(I,N,q,g,S,C){this.absellipse(I,N,q,q,g,S,C)},kb.ellipse=function(Q,V,r,e,c,D,O){var o=this.actions[this.actions.length-1].args,I=o[o.length-2],E=o[o.length-1];this.absellipse(Q+I,V+E,r,e,c,D,O)},kb.absellipse=function(C,r,m,P,x,N,Q){var L=Array.prototype.slice.call(arguments),n=new Bp(C,r,m,P,x,N,Q);this.curves.push(n);var i=n.getPoint(1);L.push(i.x),L.push(i.y),this.actions.push({action:Lo,args:L})},kb.getSpacedPoints=function(h){h||(h=40);for(var O=[],w=0;h>w;w++)O.push(this.getPoint(w/h));return O},kb.getPoints=function(h,k){h=h||12;var B,M,o,R,P,e,j,V,x,F,W,N,l,J,d,K,Z,c,O=[];for(B=0,M=this.actions.length;M>B;B++)switch(o=this.actions[B],R=o.action,P=o.args,R){case Nd:O.push(new $o(P[0],P[1]));break;case _p:O.push(new $o(P[0],P[1]));break;case wi:for(e=P[2],j=P[3],F=P[0],W=P[1],O.length>0?(J=O[O.length-1],N=J.x,l=J.y):(J=this.actions[B-1].args,N=J[J.length-2],l=J[J.length-1]),d=1;h>=d;d++)K=d/h,Z=$p.b2(K,N,F,e),c=$p.b2(K,l,W,j),O.push(new $o(Z,c));
break;case Ck:for(e=P[4],j=P[5],F=P[0],W=P[1],V=P[2],x=P[3],O.length>0?(J=O[O.length-1],N=J.x,l=J.y):(J=this.actions[B-1].args,N=J[J.length-2],l=J[J.length-1]),d=1;h>=d;d++)K=d/h,Z=$p.b3(K,N,F,V,e),c=$p.b3(K,l,W,x,j),O.push(new $o(Z,c));break;case rg:var v,C=P[0],i=P[1],p=P[2],g=P[3],S=P[4],$=!!P[5],H=S-g,z=2*h;for(d=1;z>=d;d++)K=d/z,$||(K=1-K),v=g+K*H,Z=C+p*D(v),c=i+p*w(v),O.push(new $o(Z,c));break;case Lo:var v,C=P[0],i=P[1],Y=P[2],f=P[3],g=P[4],S=P[5],$=!!P[6],H=S-g,z=2*h;for(d=1;z>=d;d++)K=d/z,$||(K=1-K),v=g+K*H,Z=C+Y*D(v),c=i+f*w(v),O.push(new $o(Z,c))}var u,T,U=a["shape3d.point.epsilon"],G=!1;for(M=O.length,B=0,M=O.length;M>B;B++)u=O[B],T=B===M-1?O[0]:O[B+1],u&&T&&r(u.x-T.x)<U&&r(u.y-T.y)<U&&(G=!0,O[B]=null);if(G){var E=[];for(B=0;M>B;B++)O[B]&&E.push(O[B]);O=E}return k&&O.push(O[0]),O},kb.toShapes=function(a,y){function Z(k){var C,s,A,u,N,o=[],U=new Cj;for(C=0,s=k.length;s>C;C++)A=k[C],N=A.args,u=A.action,u==Nd&&0!=U.actions.length&&(o.push(U),U=new Cj),U[u].apply(U,N);return 0!=U.actions.length&&o.push(U),o}function X(y){for(var Q=[],d=0,t=y.length;t>d;d++){var Z=y[d],g=new Kc;g.actions=Z.actions,g.curves=Z.curves,Q.push(g)}return Q}function A(G,C){for(var U=1e-10,p=C.length,M=!1,X=p-1,K=0;p>K;X=K++){var v=C[X],I=C[K],m=I.x-v.x,S=I.y-v.y;if(r(S)>U){if(0>S&&(v=C[K],m=-m,I=C[X],S=-S),G.y<v.y||G.y>I.y)continue;if(G.y==v.y){if(G.x==v.x)return!0}else{var O=S*(G.x-v.x)-m*(G.y-v.y);if(0==O)return!0;if(0>O)continue;M=!M}}else{if(G.y!=v.y)continue;if(I.x<=G.x&&G.x<=v.x||v.x<=G.x&&G.x<=I.x)return!0}}return M}var I=Z(this.actions);if(0==I.length)return[];if(y===!0)return X(I);var D,n,O,F=[];if(1==I.length)return n=I[0],O=new Kc,O.actions=n.actions,O.curves=n.curves,F.push(O),F;var t=!$p.isClockWise(I[0].getPoints());t=a?!t:t;var E,m=[],s=[],H=[],C=0;s[C]=$,H[C]=[];var M,V;for(M=0,V=I.length;V>M;M++)n=I[M],E=n.getPoints(),D=$p.isClockWise(E),D=a?!D:D,D?(!t&&s[C]&&C++,s[C]={s:new Kc,p:E},s[C].s.actions=n.actions,s[C].s.curves=n.curves,t&&C++,H[C]=[]):H[C].push({h:n,p:E[0]});if(!s[0])return X(I);if(s.length>1){for(var U=!1,q=[],o=0,u=s.length;u>o;o++)m[o]=[];for(var o=0,u=s.length;u>o;o++){s[o];for(var g=H[o],d=0;d<g.length;d++){for(var B=g[d],k=!0,N=0;N<s.length;N++)A(B.p,s[N].p)&&(o!=N&&q.push({froms:o,tos:N,hole:d}),k?(k=!1,m[N].push(B)):U=!0);k&&m[o].push(B)}}q.length>0&&(U||(H=m))}var G,h,L;for(M=0,V=s.length;V>M;M++)for(O=s[M].s,F.push(O),G=H[M],h=0,L=G.length;L>h;h++)O.holes.push(G[h].h);return F};var Kc=function(){Cj.apply(this,arguments),this.holes=[]},zk=Kc.prototype=ui(kb);zk.getPointsHoles=function(X){var S,h=this.holes.length,Q=[];for(S=0;h>S;S++)Q[S]=this.holes[S].getTransformedPoints(X);return Q},zk.extractAllPoints=function(r){return{shape:this.getTransformedPoints(r),holes:this.getPointsHoles(r)}},zk.extractPoints=function(C){return this.extractAllPoints(C)};var $p={triangulateShape:function(b,j){function v(c,x,F){return c.x!=x.x?c.x<x.x?c.x<=F.x&&F.x<=x.x:x.x<=F.x&&F.x<=c.x:c.y<x.y?c.y<=F.y&&F.y<=x.y:x.y<=F.y&&F.y<=c.y}function M(q,R,i,g,N){var y=1e-10,C=R.x-q.x,S=R.y-q.y,T=g.x-i.x,P=g.y-i.y,X=q.x-i.x,s=q.y-i.y,L=S*T-C*P,b=S*X-C*s;if(r(L)>y){var Q;if(L>0){if(0>b||b>L)return[];if(Q=P*X-T*s,0>Q||Q>L)return[]}else{if(b>0||L>b)return[];if(Q=P*X-T*s,Q>0||L>Q)return[]}if(0==Q)return!N||0!=b&&b!=L?[q]:[];if(Q==L)return!N||0!=b&&b!=L?[R]:[];if(0==b)return[i];if(b==L)return[g];var n=Q/L;return[{x:q.x+n*C,y:q.y+n*S}]}if(0!=b||P*X!=T*s)return[];var H=0==C&&0==S,W=0==T&&0==P;if(H&&W)return q.x!=i.x||q.y!=i.y?[]:[q];if(H)return v(i,g,q)?[q]:[];if(W)return v(q,R,i)?[i]:[];var a,G,x,u,K,V,l,E;return 0!=C?(q.x<R.x?(a=q,x=q.x,G=R,u=R.x):(a=R,x=R.x,G=q,u=q.x),i.x<g.x?(K=i,l=i.x,V=g,E=g.x):(K=g,l=g.x,V=i,E=i.x)):(q.y<R.y?(a=q,x=q.y,G=R,u=R.y):(a=R,x=R.y,G=q,u=q.y),i.y<g.y?(K=i,l=i.y,V=g,E=g.y):(K=g,l=g.y,V=i,E=i.y)),l>=x?l>u?[]:u==l?N?[]:[K]:E>=u?[K,G]:[K,V]:x>E?[]:x==E?N?[]:[a]:E>=u?[a,G]:[a,V]}function V(c,t,J,n){var o=1e-10,$=t.x-c.x,E=t.y-c.y,j=J.x-c.x,F=J.y-c.y,u=n.x-c.x,Y=n.y-c.y,v=$*F-E*j,M=$*Y-E*u;if(r(v)>o){var a=u*F-Y*j;return v>0?M>=0&&a>=0:M>=0||a>=0}return M>0}function w(k,p){function W(r,N){var j=K.length-1,w=r-1;0>w&&(w=j);var H=r+1;H>j&&(H=0);var h=V(K[r],K[w],K[H],E[N]);if(!h)return!1;var g=E.length-1,G=N-1;0>G&&(G=g);var M=N+1;return M>g&&(M=0),h=V(E[N],E[G],E[M],K[r]),h?!0:!1}function Q(p,U){var T,o,Q;for(T=0;T<K.length;T++)if(o=T+1,o%=K.length,Q=M(p,U,K[T],K[o],!0),Q.length>0)return!0;return!1}function w(j,w){var u,m,S,f,G;for(u=0;u<e.length;u++)for(m=p[e[u]],S=0;S<m.length;S++)if(f=S+1,f%=m.length,G=M(j,w,m[S],m[f],!0),G.length>0)return!0;return!1}for(var E,m,s,i,H,l,f,g,U,S,G,K=k.concat(),e=[],C=[],D=0,u=p.length;u>D;D++)e.push(D);for(var h=0,z=2*e.length;e.length>0&&(z--,!(0>z));)for(s=h;s<K.length;s++){i=K[s],m=-1;for(var D=0;D<e.length;D++)if(l=e[D],f=i.x+":"+i.y+":"+l,C[f]===$){E=p[l];for(var N=0;N<E.length;N++)if(H=E[N],W(s,N)&&!Q(i,H)&&!w(i,H)){m=N,e.splice(D,1),g=K.slice(0,s+1),U=K.slice(s),S=E.slice(m),G=E.slice(0,m+1),K=g.concat(S).concat(G).concat(U),h=s;break}if(m>=0)break;C[f]=!0}if(m>=0)break}return K}for(var c,A,e,J,h,Z,D={},t=b.concat(),z=0,u=j.length;u>z;z++)Array.prototype.push.apply(t,j[z]);for(c=0,A=t.length;A>c;c++)h=t[c].x+":"+t[c].y,D[h]!==$,D[h]=c;var n=w(b,j),U=_o.Triangulate(n,!1);for(c=0,A=U.length;A>c;c++)for(J=U[c],e=0;3>e;e++)h=J[e].x+":"+J[e].y,Z=D[h],Z!==$&&(J[e]=Z);return U.concat()},isClockWise:function(Y){return _o.Triangulate.area(Y)<0},b2p0:function(O,l){var K=1-O;return K*K*l},b2p1:function(e,l){return 2*(1-e)*e*l},b2p2:function(K,d){return K*K*d},b2:function(O,d,j,x){return this.b2p0(O,d)+this.b2p1(O,j)+this.b2p2(O,x)},b3p0:function(q,w){var X=1-q;return X*X*X*w},b3p1:function(O,e){var N=1-O;return 3*N*N*O*e},b3p2:function(x,O){var L=1-x;return 3*L*x*x*O},b3p3:function(c,p){return c*c*c*p},b3:function(U,X,N,I,A){return this.b3p0(U,X)+this.b3p1(U,N)+this.b3p2(U,I)+this.b3p3(U,A)}},_o={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var q=e.keys(this.faces);return q.length?q[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(t){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(K){var X=K.familyName.toLowerCase(),z=this;return z.faces[X]=z.faces[X]||{},z.faces[X][K.cssFontWeight]=z.faces[X][K.cssFontWeight]||{},z.faces[X][K.cssFontWeight][K.cssFontStyle]=K,K},drawText:function(E){var O,M=this.getFace(),w=this.size/M.resolution,b=0,f=String(E).split(""),s=f.length,D=[];for(O=0;s>O;O++){var F=new Cj,_=this.extractGlyphPoints(f[O],M,w,b,F);_&&(b+=_.offset*this.spacing,D.push(_.path))}var t=b/2;return{paths:D,offset:t}},extractGlyphPoints:function(z,n,l,P,k){var o,Q,p,V,v,u,R,b,K,e,G,A,N,W,t,q,J,j,s,y=[],L=n.glyphs[z]||n.glyphs["?"];if(L){if(L.o)for(V=L._cachedOutline||(L._cachedOutline=L.o.split(" ")),u=V.length,R=l,b=l,o=0;u>o;)switch(v=V[o++]){case"m":K=V[o++]*R+P,e=V[o++]*b,k.moveTo(K,e);break;case"l":K=V[o++]*R+P,e=V[o++]*b,k.lineTo(K,e);break;case"q":if(G=V[o++]*R+P,A=V[o++]*b,t=V[o++]*R+P,q=V[o++]*b,k.quadraticCurveTo(t,q,G,A),s=y[y.length-1])for(N=s.x,W=s.y,Q=1,p=this.divisions;p>=Q;Q++){var B=Q/p;$p.b2(B,N,t,G),$p.b2(B,W,q,A)}break;case"b":if(G=V[o++]*R+P,A=V[o++]*b,t=V[o++]*R+P,q=V[o++]*b,J=V[o++]*R+P,j=V[o++]*b,k.bezierCurveTo(t,q,J,j,G,A),s=y[y.length-1])for(N=s.x,W=s.y,Q=1,p=this.divisions;p>=Q;Q++){var B=Q/p;$p.b3(B,N,t,J,G),$p.b3(B,W,q,j,A)}}return{offset:L.ha*l,path:k}}}};_o.generateShapes=function(S,l){l=l||{};var L=l.font;if(L===$&&(L=_o.getDefaultFont(),!L))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var d=l.size!==$?l.size:1,Q=l.curveSegments!==$?l.curveSegments:4,W=l.spacing!==$?l.spacing:1,Y=l.weight!==$?l.weight:"normal",Z=l.style!==$?l.style:"normal";_o.size=d,_o.divisions=Q,_o.face=L,_o.weight=Y,_o.style=Z,_o.spacing=W;for(var v=_o.drawText(S),e=v.paths,c=[],B=0,m=e.length;m>B;B++)Array.prototype.push.apply(c,e[B].toShapes());return c},function(o){var L=1e-10,Y=function(F,l){var L=F.length;if(3>L)return null;var B,u,z,m=[],p=[],s=[];if(I(F)>0)for(u=0;L>u;u++)p[u]=u;else for(u=0;L>u;u++)p[u]=L-1-u;var o=L,M=2*o;for(u=o-1;o>2;){if(M--<=0)return l?s:m;if(B=u,B>=o&&(B=0),u=B+1,u>=o&&(u=0),z=u+1,z>=o&&(z=0),j(F,B,u,z,o,p)){var V,T,e,O,r;for(V=p[B],T=p[u],e=p[z],m.push([F[V],F[T],F[e]]),s.push([p[B],p[u],p[z]]),O=u,r=u+1;o>r;O++,r++)p[O]=p[r];o--,M=2*o}}return l?s:m},I=function(H){for(var x=H.length,s=0,k=x-1,X=0;x>X;k=X++)s+=H[k].x*H[X].y-H[X].x*H[k].y;return.5*s},j=function(W,s,w,$,o,k){var H,X,x,d,i,C,Q,b,M;if(X=W[k[s]].x,x=W[k[s]].y,d=W[k[w]].x,i=W[k[w]].y,C=W[k[$]].x,Q=W[k[$]].y,L>(d-X)*(Q-x)-(i-x)*(C-X))return!1;var v,q,c,h,F,Y,O,Z,n,K,l,S,j,R,I;for(v=C-d,q=Q-i,c=X-C,h=x-Q,F=d-X,Y=i-x,H=0;o>H;H++)if(b=W[k[H]].x,M=W[k[H]].y,!(b===X&&M===x||b===d&&M===i||b===C&&M===Q)&&(O=b-X,Z=M-x,n=b-d,K=M-i,l=b-C,S=M-Q,I=v*K-q*n,j=F*Z-Y*O,R=c*S-h*l,I>=-L&&R>=-L&&j>=-L))return!1;return!0};return o.Triangulate=Y,o.Triangulate.area=I,o}(_o),n._typeface_js={faces:_o.faces,loadFace:_o.loadFace};var Vb=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},ko=Vb.prototype={constructor:Vb,computeFaceNormals:function(){for(var $=new Qo,Y=new Qo,R=0,E=this.faces.length;E>R;R++){var x=this.faces[R],h=this.vertices[x.a],J=this.vertices[x.b],r=this.vertices[x.c];$.subVectors(r,J),Y.subVectors(h,J),$.cross(Y),$.normalize(),x.normal.copy($)}},computeVertexNormals:function(K){var g,C,F,T,R,b;for(b=new Array(this.vertices.length),g=0,C=this.vertices.length;C>g;g++)b[g]=new Qo;if(K){var n,e,U,h=new Qo,j=new Qo;for(F=0,T=this.faces.length;T>F;F++)R=this.faces[F],n=this.vertices[R.a],e=this.vertices[R.b],U=this.vertices[R.c],h.subVectors(U,e),j.subVectors(n,e),h.cross(j),b[R.a].add(h),b[R.b].add(h),b[R.c].add(h)}else for(F=0,T=this.faces.length;T>F;F++)R=this.faces[F],b[R.a].add(R.normal),b[R.b].add(R.normal),b[R.c].add(R.normal);for(g=0,C=this.vertices.length;C>g;g++)b[g].normalize();for(F=0,T=this.faces.length;T>F;F++)R=this.faces[F],R.vertexNormals[0]=b[R.a].clone(),R.vertexNormals[1]=b[R.b].clone(),R.vertexNormals[2]=b[R.c].clone()},mergeVertices:function(){var P,H,a,S,j,u,Q,y,Y={},B=[],C=[],l=4,z=v(10,l);for(a=0,S=this.vertices.length;S>a;a++)P=this.vertices[a],H=k(P.x*z)+"_"+k(P.y*z)+"_"+k(P.z*z),Y[H]===$?(Y[H]=a,B.push(this.vertices[a]),C[a]=B.length-1):C[a]=C[Y[H]];var K=[];for(a=0,S=this.faces.length;S>a;a++){j=this.faces[a],j.a=C[j.a],j.b=C[j.b],j.c=C[j.c],u=[j.a,j.b,j.c];for(var E=0;3>E;E++)if(u[E]==u[(E+1)%3]){K.push(a);break}}for(a=K.length-1;a>=0;a--){var F=K[a];for(this.faces.splice(F,1),Q=0,y=this.faceVertexUvs.length;y>Q;Q++)this.faceVertexUvs[Q].splice(F,1)}var D=this.vertices.length-B.length;return this.vertices=B,D}},Bp=function(s,x,h,A,D,P,e){this.aX=s,this.aY=x,this.xRadius=h,this.yRadius=A,this.aStartAngle=D,this.aEndAngle=P,this.aClockwise=e};Bp.prototype=ui(yp),Bp.prototype.getPoint=function(A){var P,Q=this.aEndAngle-this.aStartAngle;0>Q&&(Q+=J),Q>J&&(Q-=J),P=this.aClockwise===!0?this.aEndAngle+(1-A)*(J-Q):this.aStartAngle+A*Q;var Y=this.aX+this.xRadius*D(P),N=this.aY+this.yRadius*w(P);return new $o(Y,N)};var Gd=function(D,j){this.v1=D,this.v2=j},Li=Gd.prototype=ui(yp);Li.getPoint=function(t){var B=this.v2.clone().sub(this.v1);return B.multiplyScalar(t).add(this.v1),B},Li.getPointAt=function(f){return this.getPoint(f)},Li.getTangent=function(){var _=this.v2.clone().sub(this.v1);return _.normalize()};var oh=function(K,b,P){this.v0=K,this.v1=b,this.v2=P};oh.prototype=ui(yp),oh.prototype.getPoint=function(U){var g,o;return g=$p.b2(U,this.v0.x,this.v1.x,this.v2.x),o=$p.b2(U,this.v0.y,this.v1.y,this.v2.y),new $o(g,o)};var vn=function(u,q,o,O){this.v0=u,this.v1=q,this.v2=o,this.v3=O};vn.prototype=ui(yp),vn.prototype.getPoint=function(u){var w,J;return w=$p.b3(u,this.v0.x,this.v1.x,this.v2.x,this.v3.x),J=$p.b3(u,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new $o(w,J)},ij.create(function(H,i){this.v1=H,this.v2=i},function(U){var w=new Qo;return w.subVectors(this.v2,this.v1),w.multiplyScalar(U),w.add(this.v1),w});var Lr=ij.create(function(A,x,D){this.v0=A,this.v1=x,this.v2=D},function(n){var o,T,F;return o=$p.b2(n,this.v0.x,this.v1.x,this.v2.x),T=$p.b2(n,this.v0.y,this.v1.y,this.v2.y),F=$p.b2(n,this.v0.z,this.v1.z,this.v2.z),new Qo(o,T,F)}),Wm=ij.create(function(h,W,y,P){this.v0=h,this.v1=W,this.v2=y,this.v3=P},function(L){var S,x,D;return S=$p.b3(L,this.v0.x,this.v1.x,this.v2.x,this.v3.x),x=$p.b3(L,this.v0.y,this.v1.y,this.v2.y,this.v3.y),D=$p.b3(L,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Qo(S,x,D)}),lm=function(p,o,r,z,K,Y,f,n){Vb.call(this),z=z!==$?z:.5,K=K!==$?K:.5,n=n!==$?n:1,p=p||8,Y=Y||0,f=f||J;var T,C,S=1,Z=n/2,x=[],h=[],u=this.vertices,X=this.faces,L=this.faceVertexUvs;for(C=0;S>=C;C++){var m=[],v=[],B=C/S,i=B*(K-z)+z;for(T=0;p>=T;T++){var q=T/p,U=new Qo,c=-(q*f+Y);U.z=i*w(c),U.y=-B*n+Z,U.x=i*D(c),u.push(U),m.push(u.length-1),v.push(new $o(q,B))}x.push(m),h.push(v)}var H,R,k=(K-z)/n;for(T=0;p>T;T++)for(0!==z?(H=u[x[0][T]].clone(),R=u[x[0][T+1]].clone()):(H=u[x[1][T]].clone(),R=u[x[1][T+1]].clone()),H.setY(j(H.x*H.x+H.z*H.z)*k).normalize(),R.setY(j(R.x*R.x+R.z*R.z)*k).normalize(),C=0;S>C;C++){var V=x[C][T],E=x[C+1][T],Q=x[C+1][T+1],M=x[C][T+1],F=H.clone(),O=H.clone(),N=R.clone(),t=R.clone(),e=h[C][T].clone(),P=h[C+1][T].clone(),y=h[C+1][T+1].clone(),A=h[C][T+1].clone();X.push(new we(V,E,M,[F,O,t])),L[0].push([e,P,A]),X.push(new we(E,Q,M,[O.clone(),N,t.clone()])),L[0].push([P.clone(),y,A.clone()])}if(o&&z>0)for(this.vertices.push(new Qo(0,Z,0)),T=0;p>T;T++){var V=x[0][T],E=x[0][T+1],Q=this.vertices.length-1,F=new Qo(0,1,0),O=new Qo(0,1,0),N=new Qo(0,1,0),e=h[0][T].clone(),P=h[0][T+1].clone(),y=new $o(P.x,0);X.push(new we(V,E,Q,[F,O,N],null,1));var W=T/p*J,b=D(W),_=w(W),d=(T+1)/p*J,I=D(d),l=w(d);L[0].push([new $o(.5+.5*b,.5+.5*_),new $o(.5+.5*I,.5+.5*l),new $o(.5,.5)])}if(r&&K>0)for(this.vertices.push(new Qo(0,-Z,0)),T=0;p>T;T++){var V=x[C][T+1],E=x[C][T],Q=u.length-1,F=new Qo(0,-1,0),O=new Qo(0,-1,0),N=new Qo(0,-1,0),e=h[C][T+1].clone(),P=h[C][T].clone();X.push(new we(V,E,Q,[F,O,N],null,2));var W=T/p*J,b=D(W),_=w(W),d=(T+1)/p*J,I=D(d),l=w(d);L[0].push([new $o(.5+.5*I,.5-.5*l),new $o(.5+.5*b,.5-.5*_),new $o(.5,.5)])}};lm.prototype=ui(ko);var af=function(h,M,_,z,C,l,F){Vb.call(this),F=F||.5,h=h||16,M=M||16,_=(_!==$?_:0)-Z,z=z!==$?z:J,C=C!==$?C:0,l=l!==$?l:Z;var b,P,B=[],u=[],d=this.vertices,Q=this.faces,p=this.faceVertexUvs;for(P=0;M>=P;P++){var R=[],m=[];for(b=0;h>=b;b++){var O=b/h,U=P/M,y=new Qo;y.x=-F*D(_+O*z)*w(C+U*l),y.y=F*D(C+U*l),y.z=F*w(_+O*z)*w(C+U*l),d.push(y),R.push(d.length-1),m.push(new $o(O,U))}B.push(R),u.push(m)}for(P=0;M>P;P++)for(b=0;h>b;b++){var I=B[P][b+1],Y=B[P][b],V=B[P+1][b],c=B[P+1][b+1],L=d[I].clone().normalize(),W=d[Y].clone().normalize(),K=d[V].clone().normalize(),f=d[c].clone().normalize(),n=u[P][b+1].clone(),o=u[P][b].clone(),t=u[P+1][b].clone(),A=u[P+1][b+1].clone();r(d[I].y)===F?(n.x=(n.x+o.x)/2,Q.push(new we(I,V,c,[L,K,f])),p[0].push([n,t,A])):r(d[V].y)===F?(t.x=(t.x+A.x)/2,Q.push(new we(I,Y,V,[L,W,K])),p[0].push([n,o,t])):(Q.push(new we(I,Y,c,[L,W,f])),p[0].push([n,o,A]),Q.push(new we(Y,V,c,[W.clone(),K,f.clone()])),p[0].push([o.clone(),t,A.clone()]))}};af.prototype=ui(ko);var Xg=function(N,k,X,R,Q,T){Vb.call(this),N=N||.33,k=k||.17,R=R||8,X=X||6,Q=Q||0,T=T||J;for(var m=new Qo,l=[],K=[],c=0;R>=c;c++)for(var x=c/R*J+Z,t=0;X>=t;t++){var U=t/X*T+Q;m.x=N*D(U),m.z=-N*w(U);var q=new Qo,h=N+k*D(x);q.x=h*D(U),q.z=-h*w(U),q.y=k*w(x),this.vertices.push(q),l.push(new $o(t/X,1-c/R)),K.push(q.clone().sub(m).normalize())}for(var c=1;R>=c;c++)for(var t=1;X>=t;t++){var d=(X+1)*c+t-1,A=(X+1)*(c-1)+t-1,G=(X+1)*(c-1)+t,r=(X+1)*c+t,C=new we(d,A,r,[K[d].clone(),K[A].clone(),K[r].clone()]);this.faces.push(C),this.faceVertexUvs[0].push([l[d].clone(),l[A].clone(),l[r].clone()]),C=new we(A,G,r,[K[A].clone(),K[G].clone(),K[r].clone()]),this.faces.push(C),this.faceVertexUvs[0].push([l[A].clone(),l[G].clone(),l[r].clone()])}this.computeFaceNormals()};Xg.prototype=ui(ko);var Sb=function(p,w,D){return p?(Vb.call(this),p=p instanceof Array?p:[p],this.addShapeList(p,w),w.convertYZ!==!1&&bq(this,D),this.computeFaceNormals(),void 0):(p=[],void 0)},Lk=Sb.prototype=ui(Vb.prototype);Lk.addShapeList=function(e,L){for(var C=e.length,p=0;C>p;p++){var Q=e[p];this.addShape(Q,L)}},Lk.addShape=function(P,m){function n(){if(m.bottom)for(var n=0;S>n;n++)M=U[n],o(M[2],M[1],M[0],!0);if(m.top)for(n=0;S>n;n++)M=U[n],o(M[0]+g*u,M[1]+g*u,M[2]+g*u,!1)}function a(){var P=0;for(s(T,P),P+=T.length,B=0,D=R.length;D>B;B++)f=R[B],s(f,P),P+=f.length}function s(E,X){for(var a,Z,q=E.length;--q>=0;){a=q,Z=q-1,0>Z&&(Z=E.length-1);var i=0,S=u;for(i=0;S>i;i++){var V=g*i,h=g*(i+1),x=X+a+V,O=X+Z+V,s=X+Z+h,J=X+a+h;K(x,O,s,J,E,i,S,a,Z)}}}function v(v,a,E){Z.vertices.push(new Qo(v,a,E))}function o(f,B,n,Q){f+=W,B+=W,n+=W,Z.faces.push(new we(f,B,n,null,null,Q?2:1));var X=Q?r.generateBottomUV(Z,P,m,f,B,n):r.generateTopUV(Z,P,m,f,B,n);Z.faceVertexUvs[0].push(X)}function K(Q,y,z,H,C,G,w,A,$){Q+=W,y+=W,z+=W,H+=W,Z.faces.push(new we(Q,y,H)),Z.faces.push(new we(y,z,H));var b=r.generateSideWallUV(Z,P,C,m,Q,y,z,H,G,w,A,$);Z.faceVertexUvs[0].push([b[0],b[1],b[3]]),Z.faceVertexUvs[0].push([b[1],b[2],b[3]])}var e,c,l,j,z,C=m.amount,X=m.curveSegments||Bj,u=m.steps||1,q=m.extrudePath,V=!1,r=new ti(m.repeatUVLength);q&&(e=q.getSpacedPoints(u),V=!0,c=m.frames!==$?m.frames:new Tk.FrenetFrames(q,u,!1),l=new Qo,j=new Qo,z=new Qo);var f,B,D,Z=this,W=this.vertices.length,H=P.extractPoints(X),O=H.shape,R=H.holes,E=!$p.isClockWise(O);if(E){for(O=O.reverse(),B=0,D=R.length;D>B;B++)f=R[B],$p.isClockWise(f)&&(R[B]=f.reverse());E=!1}var U=$p.triangulateShape(O,R),T=O;for(B=0,D=R.length;D>B;B++)f=R[B],O=O.concat(f);for(var I,M,g=O.length,S=U.length,w=0;g>w;w++)I=O[w],V?(j.copy(c.normals[0]).multiplyScalar(I.x),l.copy(c.binormals[0]).multiplyScalar(I.y),z.copy(e[0]).add(j).add(l),v(z.x,z.y,z.z)):v(I.x,I.y,0);var p;for(p=1;u>=p;p++)for(w=0;g>w;w++)I=O[w],V?(j.copy(c.normals[p]).multiplyScalar(I.x),l.copy(c.binormals[p]).multiplyScalar(I.y),z.copy(e[p]).add(j).add(l),v(z.x,z.y,z.z)):v(I.x,I.y,C/u*p);n(),a()};var Tk=function(G,y,d,O,X){function g(V,P,R){return U.vertices.push(new Qo(V,P,R))-1}Vb.call(this),y=y||64,d=d||1,O=O||8,X=X||!1;var A,Q,h,v,m,p,k,x,W,o,a,L,f,t,Y,R,I,r,Z,u,C=[],U=this,M=y+1,F=new Qo,b=new Tk.FrenetFrames(G,y,X),s=b.tangents,q=b.normals,j=b.binormals;for(this.tangents=s,this.normals=q,this.binormals=j,W=0;M>W;W++)for(C[W]=[],v=W/(M-1),x=G.getPointAt(v),A=s[W],Q=q[W],h=j[W],o=0;O>o;o++)m=o/O*J,p=-d*D(m),k=d*w(m),F.copy(x),F.x+=p*Q.x+k*h.x,F.y+=p*Q.y+k*h.y,F.z+=p*Q.z+k*h.z,C[W][o]=g(F.x,F.y,F.z);for(W=0;y>W;W++)for(o=0;O>o;o++)a=X?(W+1)%y:W+1,L=(o+1)%O,f=C[W][o],t=C[a][o],Y=C[a][L],R=C[W][L],I=new $o(W/y,o/O),r=new $o((W+1)/y,o/O),Z=new $o((W+1)/y,(o+1)/O),u=new $o(W/y,(o+1)/O),this.faces.push(new we(f,t,R)),this.faceVertexUvs[0].push([I,r,u]),this.faces.push(new we(t,Y,R)),this.faceVertexUvs[0].push([r.clone(),Z,u.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Tk.prototype=ui(ko),Tk.FrenetFrames=function(n,F,o){function f(){p[0]=new Qo,O[0]=new Qo,c=Number.MAX_VALUE,w=r(s[0].x),y=r(s[0].y),I=r(s[0].z),c>=w&&(c=w,U.set(1,0,0)),c>=y&&(c=y,U.set(0,1,0)),c>=I&&U.set(0,0,1),z.crossVectors(s[0],U).normalize(),p[0].crossVectors(s[0],z),O[0].crossVectors(s[0],p[0])}var $,c,w,y,I,i,d,U=new Qo,s=[],p=[],O=[],z=new Qo,T=new hb,g=F+1,l=1e-4;for(this.tangents=s,this.normals=p,this.binormals=O,i=0;g>i;i++)d=i/(g-1),s[i]=n.getTangentAt(d),s[i].normalize();for(f(),i=1;g>i;i++)p[i]=p[i-1].clone(),O[i]=O[i-1].clone(),z.crossVectors(s[i-1],s[i]),z.length()>l&&(z.normalize(),$=q(Sk(s[i-1].dot(s[i]),-1,1)),p[i].applyMatrix4(T.makeRotationAxis(z,$))),O[i].crossVectors(s[i],p[i]);if(o)for($=q(Sk(p[0].dot(p[g-1]),-1,1)),$/=g-1,s[0].dot(z.crossVectors(p[0],p[g-1]))>0&&($=-$),i=1;g>i;i++)p[i].applyMatrix4(T.makeRotationAxis(s[i],$*i)),O[i].crossVectors(s[i],p[i])};var Gm=function(Z,Q,O,N){Vb.call(this),Q=Q||18,O=O||0,N=N==V?J:N;for(var R=1/(Z.length-1),E=1/Q,p=0,c=Q;c>=p;p++)for(var b=O+p*E*N,P=D(b),o=w(b),W=0,_=Z.length;_>W;W++){var k=Z[W],l=new Qo;l.x=P*k.x-o*k.y,l.y=o*k.x+P*k.y,l.z=k.z,this.vertices.push(l)}for(var T=Z.length,p=0,c=Q;c>p;p++)for(var W=0,_=Z.length-1;_>W;W++){var z=W+T*p,I=z,t=z+T,P=z+1+T,C=z+1,n=p*E,j=W*R,Y=n+E,i=j+R;this.faces.push(new we(I,C,t)),this.faceVertexUvs[0].push([new $o(n,j),new $o(n,i),new $o(Y,j)]),this.faces.push(new we(t,C,P)),this.faceVertexUvs[0].push([new $o(Y,j),new $o(n,i),new $o(Y,i)])}this.mergeVertices(),bq(this),this.computeFaceNormals(),this.computeVertexNormals()};Gm.prototype=ui(ko);var Mm=function(W,K){K=K||{};var v=_o.generateShapes(W,K);K.amount=K.amount!==$?K.amount:.5,K.convertYZ=!1,K.fill!==!1&&(K.bottom=!0,K.top=!0),Sb.call(this,v,K)};Mm.prototype=ui(Lk);var zo=C.Node=function(){Le(zo,this)},lg={X:Hi,Y:Ok,Z:Vd},Hd={X:0,Y:1,Z:2},gd={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Fl="xzy",si=function(G,g,B){if(g){var i=g[0],s=g[1],I=g[2];"xzy"===B?(Ok(G,s),Vd(G,I),Hi(G,i)):"xyz"===B?(Vd(G,I),Ok(G,s),Hi(G,i)):"yxz"===B?(Vd(G,I),Hi(G,i),Ok(G,s)):"yzx"===B?(Hi(G,i),Vd(G,I),Ok(G,s)):"zxy"===B?(Ok(G,s),Hi(G,i),Vd(G,I)):"zyx"===B?(Hi(G,i),Ok(G,s),Vd(G,I)):(Ok(G,s),Vd(G,I),Hi(G,i))}};Yb("Node",Tr,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Fl,_64O:0,_rotationX:0,_53O:0,_host:V,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Hm},_22Q:function(){return Mc},getX:function(){return this.p().x},setX:function(k){this.p(k,this.p().y)},getY:function(){return this.p().y},setY:function(C){this.p(this.p().x,C)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(g){this.setAnchor(g,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(g){this.setAnchor(this.getAnchor().x,g)},getScaleX:function(){return this.getScale().x},setScaleX:function(e){this.setScale(e,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(O){this.setScale(this.getScale().x,O)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(q){var x=(new of).setFromQuaternion(q,of.ReverseOrder(this.getRotationMode()));return this.r3(x.x,x.y,x.z)},getQuaternion:function(){var u=new of,z=new of,m=new fh;return function(x){return x||(x=new fh),this.getEuler(u),u.equals(z)?x.copy(m):x.copy(m.setFromEuler(z.copy(u)))}}(),getEuler:function(r){var a=this.r3();return r||(r=new of),r.set(a[0],a[1],a[2],of.ReverseOrder(this.getRotationMode()))},setEuler:function($){return $=$.clone().reorder(of.ReverseOrder(this.getRotationMode())),this.r3($.x,$.y,$.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(u,k){rq(u,Gl(V,V,this.r3(),this.getRotationMode())),this.translate3d(u[0]*k,u[1]*k,u[2]*k)},translateFront:function(T){this.translate3dBy([0,0,1],T)},translateBack:function(j){this.translate3dBy([0,0,-1],j)},translateLeft:function(o){this.translate3dBy([-1,0,0],o)},translateRight:function(r){this.translate3dBy([1,0,0],r)},translateTop:function(F){this.translate3dBy([0,1,0],F)},translateBottom:function(X){this.translate3dBy([0,-1,0],X)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(U,A,Y){1===arguments.length&&(A=U[1],Y=U[2],U=U[0]),this.p(U,Y),this.setElevation(A)},translate3d:function(z,e,L){1===arguments.length&&(e=z[1],L=z[2],z=z[0]),this.translate(z,L),this.setElevation(this._54O+e)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(e,S,n){1===arguments.length&&(S=e[1],n=e[2],e=e[0]),this.setSize(e,n),this.setTall(S)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function($,d,X){1===arguments.length&&(d=$[1],X=$[2],$=$[0]),this.setRotationX($),this.setRotation(-d),this.setRotationZ(X)},setRotationY:function(b){this.setRotation(-b)},getRotationY:function(){return-this._64O},lookAtDirection:function(S,V){V=V||Ah;var z=this,$=Lf(S);V===Ah?(z.r3([-x(S[1]/$),-I(S[2],S[0])+d,0]),z.setRotationMode("xzy")):V===ci?(z.r3(0,-I(S[2],S[0]),x(S[1]/$)),z.setRotationMode("zyx")):V===ar?(z.r3(0,-I(S[2],S[0])+Z,-x(S[1]/$)),z.setRotationMode("zyx")):V===hp?(z.r3([-x(S[1]/$)+d,-I(S[2],S[0])+d,0]),z.setRotationMode("xzy")):V===Tl&&(z.r3([-x(S[1]/$)-d,-I(S[2],S[0])+d,0]),z.setRotationMode("xzy")),V===vi&&(z.r3([-x(S[1]/$)+Z,-I(S[2],S[0])+d,Z]),z.setRotationMode("zxy"))},lookAt:function(T,W){return this.lookAtDirection(Fq(T,this.p3()),W)},lookAtX:function(){var w=new Qe,u=new Qe,j=new Qe,l=new hb,K=new hb,r=new of;return function(g,E){var F=Uf(this);if(l.fromArray(F),j.copy(this.p3()),w.copy(g).sub(j),!(w.lengthSq()<1e-6)){w.normalize(),E===Ah?u.set(0,0,1):E===vi?u.set(0,0,-1):E===ar?u.set(-1,0,0):E===ci?u.set(1,0,0):E===hp?u.set(0,1,0):E===Tl&&u.set(0,-1,0),u.applyMatrix4(l).sub(j).normalize();var O=Math.acos(w.dot(u));if(O){var d=w.clone().cross(u);d.lengthSq()<1e-6&&(E===hp||E===Tl?d.set(0,0,1).applyMatrix4(l).sub(j):d.set(0,1,0).applyMatrix4(l).sub(j)),d.normalize(),r.set(this.r3(),this.getRotationMode(),!0),l.makeRotationFromEuler(r),K.makeRotationAxis(d,-O),r.setFromRotationMatrix(K.multiply(l)),this.r3([r.x,r.y,r.z])}}}}(),getHost:function(){return this._host},setHost:function(x){var s=this;if(s!==x&&s._host!==x){var i=s._host;i&&i._removeAttach(s),s._host=x,s._host&&s._host._addAttach(s),s.fp("host",i,x),s.onHostChanged(i,x)}},getAttaches:function(){return this._69O},_addAttach:function(F){var w=this;w._69O||(w._69O=new le),w._69O.add(F),w.fp("attaches",V,F)},_removeAttach:function(J){var q=this;q._69O.remove(J),q._69O.isEmpty()&&delete q._69O,q.fp("attaches",J,V)},getImage:function(){if(this._pendingCheckImageJSON){var x=B.getImage(this._image);x&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof mo&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(c){var R=this,O=R._image,S=R.getWidth(),I=R.getHeight();R._image=c,R.fp("image",O,c)&&(null!=c&&(on(c)||Zq(c)&&/\.json$/i.test(c))&&(this._pendingCheckImageJSON=!0),R.fp(ed,S,R.getWidth()),R.fp(Gk,I,R.getHeight()))},getElevation:function(){return this._54O},setElevation:function(c){var M=this;if(!M._50O){M._50O=1;var H=M._54O;M._54O=c,M.fp(Wd,H,c),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(a){var J=this;if(!J._49O){J._49O=1;var F=J._64O;J._64O=a,J.fp(Xc,F,a),delete J._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(R){var t=this;if(!t._51O){t._51O=1;var g=t._rotationX;t._rotationX=R,t.fp("rotationX",g,R),delete t._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(Y){var V=this;if(!V._52O){V._52O=1;var l=V._53O;V._53O=Y,V.fp("rotationZ",l,Y),delete V._52O}},getPosition:function(){return this._position},setPosition:function(J,m){var w=this;if(!w._50I){w._50I=1;var H;if(H=2===arguments.length?{x:J,y:m}:J,H.x!==w._position.x||H.y!==w._position.y){var $=w._position;w._position=H,w.fp(Ii,$,H)}delete w._50I}},translate:function(Z,W){var T=this._position;this.p(T.x+Z,T.y+W)},getWidth:function(){var u=this;if(u._width>=0)return u._width;var N=u.getStyle("shape3d");if(N){var v=Ij(N);if(v&&v.rawS3)return v.rawS3[0];if("billboard"===N||"plane"===N){var I=Cc(u.getStyle("shape3d.image"));return I?Fe(I,u):20}}var I=Cc(u._image);return I?Fe(I,u):20},setWidth:function(v){var f=this,g=f._width;f._width=v,f.fp(ed,g,v)},getHeight:function(){var w=this;if(w._height>=0)return w._height;var z=w.getStyle("shape3d");if(z){var X=Ij(z);if(X&&X.rawS3)return X.rawS3[2];if("plane"===z){var $=Cc(w.getStyle("shape3d.image"));return $?Dm($,w):20}if("billboard"===z)return 2}var $=Cc(w._image);return $?Dm($,w):20},setHeight:function(B){var o=this,O=o._height;o._height=B,o.fp(Gk,O,B)},getTall:function(){var o=this;if(o._tall>=0)return o._tall;var t=o.getStyle("shape3d");if(t){var w=Ij(t);if(w&&w.rawS3)return w.rawS3[1];if("billboard"===t){var W=Cc(o.getStyle("shape3d.image"));return W?Dm(W,o):20}if("plane"===t)return 2}return 20},setTall:function(p){var S=this,R=S._tall;S._tall=p,S.fp("tall",R,p)},setSize:function(u,T){var W=this;2===arguments.length?(W.setWidth(u),W.setHeight(T)):(W.setWidth(u.width),W.setHeight(u.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(H,q,w,Z,b){var l=this,B=l.getAnchor(),f=l.getScale();arguments.length<=2&&(b=q,q=H.y,w=H.width,Z=H.height,H=H.x);var y=b&&f.x<0?1-B.x:B.x,m=b&&f.y<0?1-B.y:B.y;l.p(H+w*y,q+Z*m),b&&(w/=Math.abs(f.x),Z/=Math.abs(f.y)),l.setWidth(w),l.setHeight(Z)},getMatrix:function(){var r=this,E=r._64O,k=r._position,L=r.getScale();return new qf(E,k.x,k.y,L.x,L.y)},getMatrix4:function(){var f=new Qe,s=new fh,o=new Qe;return function(u){return this.getQuaternion(s),f.copy(this.p3()),o.copy(this.getFinalScale3d()),u||(u=new hb),u.compose(f,s,o)}}(),getAnchorRect:function(){var L=this,p=L.getWidth(),X=L.getHeight(),k=L.getAnchor();return{x:-p*k.x,y:-X*k.y,width:p,height:X}},toLocal:function(z){return this.getMatrix().tfi(z)},toGlobal:function(v){return this.getMatrix().tf(v)},getAttachPosition:function(){var E=new qf;return function(k,z,j,D){j=j||0,D=D||0;var s=this,N=s.getAnchor(),n=s._64O,b=s._position,u=s.getScale();return E.setFromTransform(n,b.x,b.y).tf({x:j+u.x*s.getWidth()*(k-N.x),y:D+u.y*s.getHeight()*(z-N.y)})}}(),isInRect:function($){$=this.toLocal($);var J=this.getWidth(),M=this.getHeight();return $.x+=J*this.getAnchorX(),$.y+=M*this.getAnchorY(),!($.x<0||$.y<0||$.x>J||$.y>M)},getRect:function(){var Z=this,$=Z.getWidth(),k=Z.getHeight(),H=Z.getAnchor(),l={x:-$*H.x,y:-k*H.y,width:$,height:k},c=Z.getMatrix();return l=lq([c.tf(l.x,l.y),c.tf(l.x+l.width,l.y),c.tf(l.x+l.width,l.y+l.height),c.tf(l.x,l.y+l.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var d=this,j=d.getAnchor(),R=d._anchorElevation;return{x:j.x,y:R,z:j.y}},setAnchorElevation:function(l){var g=this,b=g._anchorElevation;return b!==l?(g._anchorElevation=l,g.fp("anchorElevation",b,l),!0):!1},setAnchor3d:function(f,s,r,T){var B,d=this;"number"==typeof f?B={x:f,y:s,z:r}:(B=f.length?{x:f[0],y:f[1],z:f[2]}:f,T=s);var o=d.getDataModel();o&&o.beginTransaction();var V=d.getAnchor3d(),X=d.setAnchor(B.x,B.z);if(d.setAnchorElevation(B.y)&&(X=!0),X&&T&&!ei){d.getAnchor3d();var D=Uf(d),x=rq([B.x-V.x,B.y-V.y,B.z-V.z],D);d.p3(x)}return o&&o.endTransaction(),X},getAnchor:function(){var Q=this;if(Q.hasOwnProperty("_anchor"))return Q._anchor;var C=Cc(Q._image);return C&&C.anchorX!==$?{x:C.anchorX,y:C.anchorY}:Q._anchor},setAnchor:function(s,L,A){var F,B=this;"number"==typeof s?F={x:s,y:L}:(F=s.length?{x:s[0],y:s[1]}:s,A=L);var Y=B.getAnchor();if(Y.x!==F.x||Y.y!==F.y){var X=B.getDataModel();if(X&&X.beginTransaction(),B._anchor=F,B.fp("anchor",Y,F),A&&!ei){var h=B.getPosition(),V=B.getSize(),l=B.getRotation(),p=B.getScale(),W=-V.width*(Y.x-F.x)*p.x,u=-V.height*(Y.y-F.y)*p.y,G=w(l),R=D(l);B.setPosition(h.x+R*W-G*u,h.y+G*W+R*u)}return X&&X.endTransaction(),!0}return!1},getLocalQuaternion:function(P){var Y=this,R=Y.getHost();if(!R)return Y.getQuaternion();var Q=R.getQuaternion(),F=Y.getQuaternion();return P||(P=new fh),P.copy(Q).inverse().multiply(F)},setLocalQuaternion:function(B){var P=this,W=P.getHost();if(!W)return P.setQuaternion(B);var N=W.getQuaternion();P.setQuaternion(N.clone().multiply(B))},getLocalPosition3d:function(l){var h=this;l||(l=new Qe),l.copy(h.p3());var Z=h.getHost();if(!Z)return l;var H=Z.getMatrix4();return l.applyMatrix4(H.getInverse(H))},setLocalPosition3d:function(d){var c=this,v=c.getHost();if(!v)return d.x!==$?c.p3(d.x,d.y,d.z):c.p3(d),void 0;
var Y=v.getMatrix4(),s=new Qe(d);s.applyMatrix4(Y),c.p3(s.x,s.y,s.z)},getScale:function(){return this._scale},setScale:function(p,f){var a,P=this;a=2===arguments.length?{x:p,y:f}:p;var y=P.getScale();(y.x!==a.x||y.y!==a.y)&&(P._scale=a,P.fp("scale",y,a))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var W=this,V=W._scaleTall,p=W.getScale();return[p.x,V,p.y]},getFinalScale3d:function(){var L=this,N=L.s3(),n=L._dynamicScale3d,U=L.getScale3d();return N&&(U[0]*=N[0],U[1]*=N[1],U[2]*=N[2]),n&&(U[0]*=n[0],U[1]*=n[1],U[2]*=n[2]),U},getFinalRotation3d:function(){var z=this;return z._dynamicRotation||z.r3()},setScaleTall:function(w){var $=this,u=$._scaleTall;u!==w&&($._scaleTall=w,$.fp("scaleTall",u,w))},setScale3d:function(G,e,d){var C,v=this;C="number"==typeof G?{x:G,y:e,z:d}:G.length?{x:G[0],y:G[1],z:G[2]}:G,v.setScaleTall(C.y),v.setScale(C.x,C.z)},getCorners:function(i,e){i==V&&(i=0),e==V&&(e=i);var y=this,J=y.getAnchor(),R=y.getWidth(),o=y.getHeight(),u=-R*J.x-i,O=-o*J.y-e,Q=R+2*i,H=o+2*e,M=y.getMatrix();return[M.tf(u,O),M.tf(u,O+H),M.tf(u+Q,O+H),M.tf(u+Q,O)]},getEditControlPoints:function(H,l,f){l==V&&(l=0),f==V&&(f=l);var P=this,i=P.getAnchor(),I=P.getWidth(),_=P.getHeight(),p=-I*i.x-l,B=-_*i.y-f,F=I+2*l,b=_+2*f;if(H)return[{x:p,y:B},{x:p,y:0},{x:p,y:B+b},{x:0,y:B+b},{x:p+F,y:B+b},{x:p+F,y:0},{x:p+F,y:B},{x:0,y:B}];var q=P.getMatrix();return[q.tf(p,B),q.tf(p,0),q.tf(p,B+b),q.tf(0,B+b),q.tf(p+F,B+b),q.tf(p+F,0),q.tf(p+F,B),q.tf(0,B)]},rotateAt:function(x,f,m){var M=this,W=M._position,L=M._64O,F=new qf(L,W.x,W.y).tf(x,f),O=j(x*x+f*f),G=I(W.y-F.y,W.x-F.x)+m;M.setRotation(L+m),M.p(F.x+O*D(G),F.y+O*w(G))},onParentChanged:function(){zo.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var K={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(X){K[X]=!0}),function(a){var H=this;zo.superClass.onPropertyChanged.call(H,a),K[a.property]&&!H._layoutUpdating&&H.updateLayoutParameters(null,a.property),H._69O&&H._69O.each(function(N){N.handleHostPropertyChange(a)}),H._49I&&H._49I.each(function(M){M.fp("agentChange",!0,!1)}),"a:layout"===a.property.substring(0,8)&&this.updateAttach()}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(R){this.updateAttach(R)},onStyleChanged:function(n){zo.superClass.onStyleChanged.apply(this,arguments),$f[n]&&this.updateAttach()},updateAttach:function(m){var Y=this;return ei?(Y.updateLayoutParameters(),void 0):(Y._51I||(Y._51I=1,Y._71O(m),delete Y._51I),void 0)},_71O:function(v){var G,e,s,E,p,f,S,m,_=this,j=_._host,A=v?v.property:V,N=v?v.oldValue:V,i=v?v.newValue:V;if(j instanceof zo&&(S=Cc(j.getImage()),S&&S.layoutAttach&&(m=S.layoutAttach)),v&&!rc[A]&&"a:layout"!==A.substring(0,8)||!m||m(j,this))if(j instanceof C.Grid){if(A===Wd)_.setElevation(_._54O+i-N);else if(!v||ip[A]){if(G=_.s("attach.row.index"),e=_.s("attach.column.index"),s=j.getCellRect(G,e),!s)return;E=_.s("attach.row.span"),p=_.s("attach.column.span"),(1!==E||1!==p)&&(s=Co(s,j.getCellRect(G+E-1,e+p-1))),ab(s,_,"attach.padding",1),_.setRect(s)}}else if(j instanceof Hc&&(f=_.s("attach.index"))>=0&&(!v||co[A])){var g=_.s("attach.thickness"),Y=j.getScale(),o=Math.max(Y.x,Y.y);g>0&&_.setHeight(j.getThickness()*g*o);var q=_.s("attach.offset"),u=j.getPoints(),B=u.size();if(B>f){var R=j.getPointsMatrix2d(),k=u.get(f),F=B===f+1?u.get(0):u.get(f+1);k=R.apply(k),F=R.apply(F);var K=[F.x-k.x,F.y-k.y],x=Lf(K);if(x){_.s("attach.offset.relative")&&(q*=x),_.s("attach.offset.opposite")&&(q=x-q);var r={x:k.x+K[0]/x*q,y:k.y+K[1]/x*q},d=_.s("attach.gap");d&&(_.s("attach.gap.relative")&&(d*=j.getThickness()*o),r=dc(V,r,F,d)),_.p(r),_.setRotation(I(K[1],K[0]))}}}else v&&(A===Ii?_.translate(i.x-N.x,i.y-N.y):A===Wd?_.setElevation(_._54O+i-N):Ej[A]?_._11Q(j,A,i-N):("anchor"===A||"width"===A||"height"===A||"scale"===A)&&_.layout(j))},_11Q:function(){var o=new C.Math.Euler,X=C.Math.Euler.ReverseOrder,Q=new C.Math.Vector2,N=new C.Math.Vector2;return function(e,i,O){var D=this,u=e.p3(),S=e.r3(),q=D.p3(),g=D.r3();if(i===Xc&&(i="rotationY",O=-O),(i===Xc||"rotationY"===i)&&0===g[0]&&0===g[2]&&0===S[0]&&0===S[2]&&0===q[1]&&0===u[1])return D.setRotation(-g[1]-O),Q.set(q[0],q[2]).rotateAround(N.set(u[0],u[2]),-O),D.p(Q.x,Q.y),void 0;var P=gd[e.getRotationMode()],j=P[0],H=P[1],p=P[2],r=lg[j],M=lg[H],G=lg[p],Z=no();i===Xc+j?(G(Z,S[Hd[p]]),M(Z,S[Hd[H]]),r(Z,O),M(Z,-S[Hd[H]]),G(Z,-S[Hd[p]])):i===Xc+H?(G(Z,S[Hd[p]]),M(Z,O),G(Z,-S[Hd[p]])):i===Xc+p&&G(Z,O);var n=Fq(q,u);rq(n,Z),D.p3(u[0]+n[0],u[1]+n[1],u[2]+n[2]);var V=D.getRotationMode();si(Z,D.r3(),V),o.setFromRotationMatrix(Z,X(V)),D.r3([o.x,o.y,o.z])}}(),isHostOn:function(T){var e=this;if(e._host&&T&&T._69O)for(var c={},D=e._host;D&&D!==e&&!c[D._id];){if(D===T)return!0;c[D._id]=D,D=D._host}return!1},isLoopedHostOn:function(M){return this.isHostOn(M)&&M.isHostOn(this)},getScaledSize:function(){var H=this.getSize(),J=this.getScale();return H.width*=Math.abs(J.x),H.height*=Math.abs(J.y),H},layout:function(O){if(O=O||this.getHost()){var e=this,o=e.s("layout.h")||"center",j=e.s("layout.v")||"center";if("center"!==o||"center"!==j){var U=new C.Math.Vector2,F=O.getPosition(),K=O.getAnchor(),h=O.getScaledSize();e.getPosition();var P,I,E,n,x,R=1,X=1;switch(e._layoutUpdating=!0,o){case"left":U.setX(e._layoutHValue-K.x*h.width);break;case"right":U.setX((1-K.x)*h.width-e._layoutHValue);break;case"leftright":P=h.width-e._layoutHValue[2],E=e.getRotation()-O.getRotation(),n=Math.abs(Math.sin(E)),x=Math.abs(Math.cos(E)),R+=x*P/e._layoutHValue[3],X+=n*P/e._layoutHValue[4],U.setX(e._layoutHValue[1]+(e._layoutHValue[5]-K.x)*h.width);break;case"center":U.setX((.5-K.x)*h.width-e._layoutHValue);break;case"scale":E=e.getRotation()-O.getRotation(),n=Math.abs(Math.sin(E)),x=Math.abs(Math.cos(E)),U.setX((.5-K.x)*h.width-e._layoutHValue[1]*h.width/e._layoutHValue[0]),I=h.width/e._layoutHValue[2]-1,R+=x*I,X+=n*I}switch(j){case"top":U.setY(e._layoutVValue-K.y*h.height);break;case"bottom":U.setY((1-K.y)*h.height-e._layoutVValue);break;case"topbottom":E||(E=e.getRotation()-O.getRotation(),n=Math.abs(Math.sin(E)),x=Math.abs(Math.cos(E))),P=h.height-e._layoutVValue[2],R+=n*P/e._layoutVValue[3],X+=x*P/e._layoutVValue[4],U.setY(e._layoutVValue[1]+(e._layoutVValue[5]-K.y)*h.height);break;case"center":U.setY((.5-K.y)*h.height-e._layoutVValue);break;case"scale":E||(E=e.getRotation()-O.getRotation(),n=Math.abs(Math.sin(E)),x=Math.abs(Math.cos(E))),U.setY((.5-K.y)*h.height-e._layoutVValue[1]*h.height/e._layoutVValue[0]),I=h.height/e._layoutVValue[2]-1,R+=n*I,X+=x*I}if("leftright"===o||"scale"===o||"topbottom"===j||"scale"===j){var l=this.getScale(),V=Math.abs(l.x),q=Math.abs(l.y);"leftright"===o||"scale"===o?e.setSize(e._layoutHValue[3]*R/V,e._layoutHValue[4]*X/q):e.setSize(e._layoutVValue[3]*R/V,e._layoutVValue[4]*X/q)}U.rotateAround(null,O.getRotation()),this.setPosition(U.x+F.x,U.y+F.y),e._layoutUpdating=$}}},updateLayoutParameters:function($,A){if($=$||this.getHost()){var u=this,p=u.s("layout.h"),c=u.s("layout.v");if(p||c){var V,W,n,j,l,z,s=new C.Math.Vector2,P=$.getPosition(),i=$.getAnchor(),t=$.getScaledSize(),e=u.getPosition(),a=u.getScaledSize();switch(s.set(e.x-P.x,e.y-P.y),s.rotateAround(null,-$.getRotation()),p){case"left":u._layoutHValue=s.x+i.x*t.width;break;case"right":u._layoutHValue=-s.x+(1-i.x)*t.width;break;case"center":u._layoutHValue=-s.x+(.5-i.x)*t.width;break;case"leftright":case"scale":"scale"===p?V=-s.x+(.5-i.x)*t.width:(W=u.getAnchor(),n=u.getRotation()-$.getRotation(),j=Math.cos(n),l=Math.sin(n),z=-Math.min(-W.x*j+W.y*l,-W.x*j-(1-W.y)*l,(1-W.x)*j+W.y*l,(1-W.x)*j-(1-W.y)*l),V=s.x-(z-i.x)*t.width),"position"===A&&"object"==typeof u._layoutHValue?(u._layoutHValue[0]=t.width,u._layoutHValue[1]=V):u._layoutHValue=[t.width,V,t.width,a.width,a.height,z]}switch(c){case"top":u._layoutVValue=s.y+i.y*t.height;break;case"bottom":u._layoutVValue=-s.y+(1-i.y)*t.height;break;case"center":u._layoutVValue=-s.y+(.5-i.y)*t.height;break;case"topbottom":case"scale":"scale"===c?V=-s.y+(.5-i.y)*t.height:(n||(W=u.getAnchor(),n=u.getRotation()-$.getRotation(),j=Math.cos(n),l=Math.sin(n)),z=-Math.min(-W.x*l-W.y*j,-W.x*l+(1-W.y)*j,(1-W.x)*l-W.y*j,(1-W.x)*l+(1-W.y)*j),V=s.y-(z-i.y)*t.height),"position"===A&&"object"==typeof u._layoutVValue?(u._layoutVValue[0]=t.height,u._layoutVValue[1]=V):u._layoutVValue=[t.height,V,t.height,a.width,a.height,z]}}}},getSerializableProperties:function(){var m=zo.superClass.getSerializableProperties.call(this);return Ki(m,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),m}});var Vj=C.Edge=function(n,I){var o=this;Le(Vj,o),o.setSource(n),o.setTarget(I)};Yb("Edge",Tr,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return lo},_22Q:function(){return Ds},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(E){if(E===this)return!1;if(Zb(E))return!0;for(var F,m,n,S,e,y=[this],Z=-1,b=0;b>Z;)if(Z++,F=y[Z],m=F._44I)for(m=m.getArray(),S=0,e=m.length;e>S;S++)if(n=m[S],hf(n)&&!(y.indexOf(n)>=0)){if(n===E)return!1;y.push(n),b++}return!0},setSource:function(b){var R=this;if(R._source!==b&&R.canSetSourceTarget(b)){var x=R._source;R._source=b,x&&x._16I(R),b&&b._2I(R),R._7I(),R.fp("source",x,b)}},setTarget:function(b){var n=this;if(n._target!==b&&n.canSetSourceTarget(b)){var K=n._target;n._target=b,K&&K._18I(n),b&&b._4I(n),n._7I(),n.fp("target",K,b)}},isLooped:function(){var v=this;return v._source===v._target&&Zb(v._source)&&Zb(v._target)},onPropertyChanged:function(){var Y=this;Y._49I&&Y._49I.each(function(h){h.fp("agentChange",!0,!1)})},_7I:function(){var G,z=this,e=_l(z);z._40I!==e&&(G=this._40I,G&&G._15I(z),z._40I=e,e&&e._1I(z),z.fp("sourceAgent",G,e),wf(G,z._41I),wf(e,z._41I));var y=jq(z);z._41I!==y&&(G=z._41I,G&&G._17I(z),z._41I=y,y&&y._3I(z),z.fp("targetAgent",G,y),wf(G,z._40I),wf(y,z._40I))},_22I:function(o){this._52I=o,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var y=this;return y._52I&&y._52I.get(0)!==y&&!y.getStyle(xg)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var f=this,I=f._52I;return I&&!f.getStyle(xg)&&I.size()>1&&f===I.get(0)},toggle:function(){this.beginTransaction();var N=this._52I,q=!this.s(xg);N&&N.size()>1&&(N.each(function(o){o.s(xg,q)}),N.getSiblings().each(function(T){T!==N&&T.each(function(R){R.fp("edgeGroup",V,T)})})),this.endTransaction()},setStyle:function(h,a){(h===go||"edge.segments"===h)&&(a=Ni(a)),Vj.superClass.setStyle.call(this,h,a)},onStyleChanged:function(Y){Vj.superClass.onStyleChanged.apply(this,arguments),Ff[Y]&&wf(this._41I,this._40I)},getSerializableProperties:function(){var A=Vj.superClass.getSerializableProperties.call(this);return Ki(A,{source:1,target:1}),A}});var Mg=C.Group=function(){Le(Mg,this)};Yb("Group",zo,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Yj},onChildAdded:function(){Mg.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Mg.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var L=this;if(!L._54I&&!ei){var $=L.getChildrenRect();$&&(L._53I=1,L.p(Dn(L.s("group.position"),$,L.getSize())),delete L._53I)}},getChildrenRect:function(){var T,v=this;return v.eachChild(function(H){Zb(H)&&(T=Co(T,v.getChildRect(H)))}),T},getChildRect:function(G){var w;return Zb(G)&&G.s(ze)&&(Bs(G)&&G.isExpanded()&&G.eachChild(function(P){w=Co(w,G.getChildRect(P))}),!w&&G.getRect&&(w=G.getRect())),w},setPosition:function(s,I){var F=this;if(!F._54I){var G;G=2===arguments.length?{x:s,y:I}:s,ei||F._53I||(F._54I=1,lh(F._children,G.x-F._position.x,G.y-F._position.y),delete F._54I),Mg.superClass.setPosition.call(this,G)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(G){var Q=this;if(Q._57O!==G){var k=Q._57O;Q._57O=G,Q.fp("expanded",k,Q._57O),Q._fireInvalidateDeep(),Q._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(v){Bs(v)?v._fireInvalidateDeep():v.iv()})},_8I:function(){Mg.superClass._8I.call(this),this.eachChild(function($){Zb($)&&$._8I()})},onStyleChanged:function(K){Mg.superClass.onStyleChanged.apply(this,arguments),"group.position"===K&&this._81I()},getSerializableProperties:function(){var J=Mg.superClass.getSerializableProperties.call(this);return J.expanded=1,J}});var Zm=C.Block=function(){Le(Zm,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};Yb("Block",zo,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Gp},_22Q:function(){return Ek},onChildAdded:function(){Zm.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Zm.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function O(Z,B,y){L.fromArray(Uf(B));var _=B.getAnchor3d();Z.push((new Qe).set(0-_.x,0-_.y,0-_.z).applyMatrix4(L).applyMatrix4(y)),Z.push((new Qe).set(0-_.x,0-_.y,1-_.z).applyMatrix4(L).applyMatrix4(y)),Z.push((new Qe).set(0-_.x,1-_.y,0-_.z).applyMatrix4(L).applyMatrix4(y)),Z.push((new Qe).set(0-_.x,1-_.y,1-_.z).applyMatrix4(L).applyMatrix4(y)),Z.push((new Qe).set(1-_.x,0-_.y,0-_.z).applyMatrix4(L).applyMatrix4(y)),Z.push((new Qe).set(1-_.x,0-_.y,1-_.z).applyMatrix4(L).applyMatrix4(y)),Z.push((new Qe).set(1-_.x,1-_.y,0-_.z).applyMatrix4(L).applyMatrix4(y)),Z.push((new Qe).set(1-_.x,1-_.y,1-_.z).applyMatrix4(L).applyMatrix4(y))}function n(E,Z){var t=(new hb).makeRotationFromEuler(this.getEuler()).setPosition((new Qe).fromArray(this.p3()));t.getInverse(t),E.forEach(function(Q){Zb(Q)&&O(Z,Q,t)})}var L=new hb;return function(o,y){if(o instanceof zo&&(o=[o]),!o||0===o.length)return V;var y=[];n.call(this,o,y);var k=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];return y.forEach(function(I){k[0]=Math.min(I.x,k[0]),k[1]=Math.min(I.y,k[1]),k[2]=Math.min(I.z,k[2]),c[0]=Math.max(I.x,c[0]),c[1]=Math.max(I.y,c[1]),c[2]=Math.max(I.z,c[2])}),{min:k,max:c}}}(),updateFromChildren:function(){var m=this;if(!ei&&!m._updatingToChildren&&m._syncSize&&0!==m.size()&&!m._freezeSyncFromChildren){var C=this._getBoundingBox(m.toChildren(Zb));if(C){m._updatingFromChildren=1;var T=(new Qe).fromArray(this.getScale3d()),e=(new Qe).fromArray(C.min),n=(new Qe).fromArray(C.max),j=B.blockMinSize,F=new Qe,$=n.clone().sub(e);0===$.x&&F.setX(.5),0===$.y&&F.setY(.5),0===$.z&&F.setZ(.5);var H=this._width==V||-1===this._width,X=new Qe(this.getAnchor3d());if(H||this._anchorChanged||!this.s("keepPosition")){var l=X.clone().multiply($).add(e).applyEuler(this.getEuler()).add((new Qe).fromArray(this.p3()));this.p3([l.x,l.y,l.z])}else{var U=T.clone().multiply((new Qe).fromArray(this.s3())),K=$.clone();0===K.x&&K.setX(j),0===K.y&&K.setY(j),0===K.z&&K.setZ(j);var J=X.clone().multiply(U),I=J.clone().multiplyScalar(-1).sub(e).divide(K).add(J.divide(K)).add(F);this.setAnchor3d(I.x,I.y,I.z)}var t=new Qe(1,1,1).divide(T).multiply($);this.s3(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z)),delete m._updatingFromChildren}}},setPosition:function(x,D){var z=this;if(!z._updatingToChildren){var Z;Z=2===arguments.length?{x:x,y:D}:x,ei||z._updatingFromChildren||(z._updatingToChildren=1,lh(z._children,Z.x-z._position.x,Z.y-z._position.y),delete z._updatingToChildren),Zm.superClass.setPosition.call(this,Z)}},setSize3d:function(){this.beginTransaction(),Zm.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(v){var T=this;if(!T._updatingToChildren){this.beginTransaction(),v=g(v,B.blockMinSize);var K=T.getTall();if(v!==K&&Zm.superClass.setTall.call(T,v),!ei&&!T._updatingFromChildren){T._updatingToChildren=1;var X=v/K;T._adjustChildTallOrScale(X,"size"),delete T._updatingToChildren,T.updateFromChildren()}this.endTransaction()}},setWidth:function(V){return this.setSize(V,this.getHeight())},setHeight:function(H){return this.setSize(this.getWidth(),H)},setSize:function(x,W){var h=B.blockMinSize;x=g(x,h),W=g(W,h);var P=this;if(!P._updatingToChildren){2!==arguments.length&&(W=x.height,x=x.width),this.beginTransaction();var D=P.getWidth(),X=P.getHeight();if(x!==D&&Zm.superClass.setWidth.call(P,x),W!==X&&Zm.superClass.setHeight.call(P,W),!ei&&!P._updatingFromChildren){P._updatingToChildren=1;var U=x/D,_=W/X;P._adjustChildScaleOrSize(U,_,"size"),delete P._updatingToChildren,P.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function($,A,P){var t=this;if(t._syncSize){var z=t.getPosition(),h=t.getRotation();t.getScale(),t.eachChild(function(o){if(Zb(o)){var W=o.getPosition(),k=o.getRotation(),l=o.getWidth(),b=o.getHeight(),m=o.getScale(),f=m.x*l,E=m.y*b;if(0!==f&&0!==E){var B=new qf(k,W.x,W.y,f,E);B.translate(-z.x,-z.y),B.rotate(-h),k=I(B.b*Math.sign(f),B.a*Math.sign(f)),B.scale($,A);var s,O,y,K=D(k);if(Math.abs(K)<.001?(s=w(k),O=B.b/s,y=-B.c/s):(O=B.a/K,y=B.d/K),"scale"===P)o.setScale(O/l,y/b);else if("size"===P){var d=O/m.x,V=y/m.y;o.setScale(wp(O)*Math.abs(m.x),wp(y)*Math.abs(m.y)),o instanceof C.Shape?(o.setWidthForce(Math.max(Math.abs(d),1e-5)),o.setHeightForce(Math.max(Math.abs(V),1e-5))):o.setSize(Math.max(.01,Math.abs(d)),Math.max(.01,Math.abs(V)))}B.rotate(h),B.translate(z.x,z.y),o.setPosition(B.tx,B.ty)}}})}},_calcChangeFactor:function(Z,v,J,O){var o,Y,u,m;return o=r(Z),Y=r(J),u=o>Y?o/Y:Y/o,o=r(v),Y=r(O),m=o>Y?o/Y:Y/o,g(u,m)},setElevation:function(n){var w=this;if(!w._updatingToChildren){var L=w.getElevation(),B=n-L;0!==B&&(ei||w._updatingFromChildren||(w._updatingToChildren=1,lh(w._children,0,B,0),delete w._updatingToChildren),Zm.superClass.setElevation.apply(w,arguments))}},setScaleTall:function(C){var U=this;if(!U._updatingToChildren){var $=U.getScaleTall();if(r(C)<.01&&(C=.01*(wp(C)||wp($))),Zm.superClass.setScaleTall.call(U,C),!ei&&!U._updatingFromChildren){U._updatingToChildren=1;var i=C/$;U._adjustChildTallOrScale(i,"size"),delete U._updatingToChildren,this.updateFromChildren()}}},_adjustChildTallOrScale:function(j,q){var i=this;if(i._syncSize){var w=i.getElevation();i.eachChild(function(K){if(Zb(K))if("size"===q){var D=K.getTall();0>j&&K.setScaleTall(-1*K.getScaleTall()),K.setTall(Math.max(.01,Math.abs(D*j))),K.setElevation(w+(K.getElevation()-w)*j)}else{var h=K.getScaleTall();K.setScaleTall(h*j)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var a=Zm.superClass.setAnchor3d.apply(this,arguments);return a&&!ei&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),a}},setAnchor:function(){var K=this;if(!K._updatingToChildren){var c=K.getAnchor(),p=Zm.superClass.setAnchor.apply(K,arguments);if(ei||K._updatingFromChildren||!K._syncSize)return p;K._updatingToChildren=1;var C=K.getAnchor();K.getPosition();var l=K.getSize(),Z=K.getScale(),E=K.getRotation(),I=-l.width*Z.x*(c.x-C.x),h=-l.height*Z.y*(c.y-C.y),s=w(E),G=D(E),d=G*I-s*h,O=s*I+G*h;return K.eachChild(function(q){if(Zb(q)){var V=q.getPosition();q.setPosition(V.x-d,V.y-O)}}),delete K._updatingToChildren,p}},setAnchorElevation:function(){var B=this;if(!B._updatingToChildren){var I=B.getAnchorElevation(),U=Zm.superClass.setAnchorElevation.apply(B,arguments);if(ei||B._updatingFromChildren||!B._syncSize)return U;B._updatingToChildren=1;var d=B.getAnchorElevation(),V=B.getTall(),a=B.getScaleTall(),K=-V*a*(I-d);return B.eachChild(function(B){if(Zb(B)){var H=B.getElevation();B.setElevation(H-K)}}),delete B._updatingToChildren,U}},setRotation:function(E){this._updateChildrenRotation3d("rotation",E)},setRotationX:function(J){this._updateChildrenRotation3d("rotationX",J)},setRotationZ:function(h){this._updateChildrenRotation3d("rotationZ",h)},_updateChildrenRotation3d:function(B,R){var l=this;if(!l._updatingToChildren){var O=l[Bb(B)]();if(Zm.superClass[Bi(B)].call(l,R),!ei&&!l._updatingFromChildren){l._updatingToChildren=1;var T=R-O;l.eachChild(function(u){Zb(u)&&u._11Q(l,B,T)}),delete l._updatingToChildren}}},setScale:function(b,z){var N=this;if(!N._updatingToChildren){null==z&&(z=b.y,b=b.x);var _=N.getScale();if(r(b)<.01&&(b=.01*(wp(b)||wp(_.x))),r(z)<.01&&(z=.01*(wp(z)||wp(_.y))),Zm.superClass.setScale.call(N,b,z),!ei&&!N._updatingFromChildren){N._updatingToChildren=1;var t=b/_.x,y=z/_.y;N._adjustChildScaleOrSize(t,y,"size"),delete N._updatingToChildren,N.updateFromChildren()}}},onPropertyChanged:function(w){Zm.superClass.onPropertyChanged.call(this,w),"s:3d.visible"===w.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(k){(k.s("batch")||k.s("wf.geometry")||k.s("wf.visible"))&&k.iv(),k instanceof Zm&&k._invalidateChildrenBatch()})},getSerializableProperties:function(){var m=Zm.superClass.getSerializableProperties.call(this);return m.clickThroughEnabled=1,m.syncSize=1,m}});var Mj=C.Grid=function(){Le(C.Grid,this)};Yb("Grid",zo,{IRotatable:!1,_icon:"grid_icon",_image:V,getUIClass:function(){return We},setRotation:function(){},getCellRect:function(b,M){var $=this,d=$.s("grid.row.count"),v=$.s("grid.column.count");if(0>=d||0>=v||0>b||b>=d||0>M||M>=v)return V;var r,Z,n,o=$.getRect(),S=$.s("grid.row.percents"),p=$.s("grid.column.percents");if(ab(o,$,"grid.border",-1),S&&S._as&&(S=S._as),p&&p._as&&(p=p._as),S&&S.length===d){for(n=0,r=0;b>r;r++)n+=o.height*S[r];o.y+=n,o.height=o.height*S[b]}else o.height=o.height/d,o.y+=o.height*b;if(p&&p.length===v){for(Z=0,r=0;M>r;r++)Z+=o.width*p[r];o.x+=Z,o.width=o.width*p[M]}else o.width=o.width/v,o.x+=o.width*M;return Pm(o,-$.s("grid.gap")),o}});var Ec=C.Text=function(){Le(Ec,this),this.setSize(100,50),this.s("text","TEXT")};Yb("Text",zo,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Xi},setWidth:function(c){c||(c=.001),Ec.superClass.setWidth.call(this,c)},setHeight:function(C){C||(C=.001),Ec.superClass.setHeight.call(this,C)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Kb("__text__",{width:{value:100,isSafeFunc:!0,func:function(N){return N?N._width:100}},height:{value:50,isSafeFunc:!0,func:function(F){return F?F._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradientPack:{func:"style@text.gradient.pack"}}]});var Hc=C.Shape=function(){Le(Hc,this),this._59O=new le};Hc.__de__=zf,Yb("Shape",zo,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return bk},_22Q:function(){return Es},getLength:function(f){return Xr(ds(this._59O,this._58O,f,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var L=this._58O;return L?new le(L._as.slice(0)):L},setSegments:function(B){var w=this._58O;B=B?Xj(B)?new le(B.slice(0)):new le(B._as.slice(0)):null,(w&&B&&w._as.join(",")!==B._as.join(",")||w!==B)&&(this._58O=B,this.fp("segments",w,B))},getPoints:function(){return this._59O},toPoints:function(){var T=this._59O;return new le(T._as.slice(0))},getPointsMatrix2d:function(){var b=this,A=new Pl.Matrix2d,S=b.getPosition(),I=b.getScale(),x=b.getRotation();return A.translate(-S.x,-S.y).scale(I.x,I.y).rotate(x).translate(S.x,S.y),A},getPointsMatrix3d:function(){return function(){var t=this,B=new Pl.Matrix4,Y=B.getElements(),r=t.p3();rm(Y,r),si(Y,t.getFinalRotation3d(),t.getRotationMode());var _=t.getScale3d(),h=t._dynamicScale3d;return h&&(_[0]*=h[0],_[1]*=h[1],_[2]*=h[2]),Ye(Y,_),rm(Y,Pj(r)),B}}(),setPoints:function(I,k){var Q=this,K=Q._59O;I=I?Xj(I)?new le(I.slice(0)):new le(I._as.slice(0)):new le;var h,P,X,W,f,l;k&&(h=Q.getPosition(),l=new qf(Q.getRotation(),0,0,Q.getScale().x,Q.getScale().y)),(K&&I&&K._as.join(",")!==I._as.join(",")||K!==I)&&(Q._59O=I,Q.fs(),Q.fp("points",K,I)),k&&(P=Q.getPosition(),X=P.x-h.x,W=P.y-h.y,f=l.tf(X,W),Q.setPosition(P.x-X+f.x,P.y-W+f.y))},addPoint:function(N,f,d){var l=this.toPoints();l.add(N,f),this.setPoints(l,d)},setPoint:function(Z,F,_){var j=this.toPoints();j.set(Z,F),this.setPoints(j,_)},removePointAt:function($){var J=this.toPoints();J.removeAt($),this.setPoints(J)},setWidthForce:function(L){var x=this;if(!x._55I&&!ei&&x.getWidth()){x._55I=1;var m=x._position.x,p=L/x.getWidth(),P=x.toPoints(),j=new le;1!==p&&(P.each(function(x){j.add({x:(x.x-m)*p+m,y:x.y,e:x.e})}),x.setPoints(j),pc(x,[p,0,0,1,m*(1-p),0]),x.fs()),delete x._55I}Hc.superClass.setWidth.call(x,L)},setWidth:function(q){return this.setWidthForce(zr>q?zr:q)},setHeightForce:function(T){var z=this;if(!z._55I&&!ei&&z.getHeight()){z._55I=1;var p=z._position.y,F=T/z.getHeight(),$=z.toPoints(),g=new le;1!==F&&($.each(function(x){g.add({x:x.x,y:(x.y-p)*F+p,e:x.e})}),z.setPoints(g),pc(z,[1,0,0,F,0,p*(1-F)]),z.fs()),delete z._55I}Hc.superClass.setHeight.call(z,T)},setHeight:function(Y){return this.setHeightForce(zr>Y?zr:Y)},setAnchorElevation:function(s){var m=this;m._55I=!0;var h=m._updatingAnchor3d,Z=!ei&&!h;if(Z){var y,H=s,d=m.getAnchorElevation(),k=m.getTall();y=k*(d-H),0!==y&&m.shiftPointsElevation(y)}var O=Hc.superClass.setAnchorElevation.apply(m,arguments);return h||delete m._55I,O},getShapeElevation:function(){var k=this,y=k._54O;return y-(k.getTall()||0)*(k._anchorElevation-.5)},setAnchor3d:function(p,Y,c,u){var m,I=this;"number"==typeof p?m={x:p,y:Y,z:c}:(m=p.length?{x:p[0],y:p[1],z:p[2]}:p,u=Y),I._55I=!0,I._updatingAnchor3d=!0;var h=I.getDataModel();if(h&&h.beginTransaction(),!ei){var i=I.getAnchor3d(),Z=I.getSize(),M=I.getTall(),K=Z.width*(i.x-m.x),k=Z.height*(i.z-m.z),O=M*(i.y-m.y);u||I.shiftPoints(K,k,O);var s=I.p3()}var W=Hc.superClass.setAnchor3d.apply(I,arguments);if(!ei&&u){var d=I.p3();I.shiftPoints(d[0]-s[0]+K,d[2]-s[2]+k,d[1]-s[1]+O)}return h&&h.endTransaction(),delete I._updatingAnchor3d,delete I._55I,W},setAnchor:function(Y,M,q){var H=this;H._55I=!0;var r=H._updatingAnchor3d,l=!ei&&!r;if(l){var W,u,p;"number"==typeof Y?p={x:Y,y:M}:(p=Y.length?{x:Y[0],y:Y[1]}:Y,q=M);var j=H.getAnchor(),m=H.getSize();W=m.width*(j.x-p.x),u=m.height*(j.y-p.y),q||H.shiftPoints(W,u);var L=H.getPosition()}var R=Hc.superClass.setAnchor.apply(H,arguments);if(l){var I=H.getPosition();q&&H.shiftPoints(I.x-L.x+W,I.y-L.y+u)}return r||delete H._55I,R},shiftPoints:function(B,o,r){if(B||o||r){var s=this,I=s.getElevation()||0,T=s.toPoints(),D=new le;T.each(function(R){var M=R.e;r&&(M=(M==V?I:M)+r),D.add({x:R.x+B,y:R.y+o,e:M})}),s.setPoints(D),s.fs()}},shiftPointsElevation:function(b){return this.shiftPoints(0,0,b)},setPosition:function(d,h){var u,U=this;if(!U._28Q){if(U._28Q=1,!U._55I&&!ei){u=2===arguments.length?{x:d,y:h}:d;var X=u.x-U._position.x,W=u.y-U._position.y;if(0===X&&0===W)return delete U._28Q,void 0;U._55I=1,U.shiftPoints(X,W),pc(U,[1,0,0,1,X,W]),delete U._55I}Hc.superClass.setPosition.apply(U,arguments),delete U._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var b=this;if(2!==b._59O.size())return!1;var x=b._58O;return x?2===x.size()&&1===x.get(0)&&2===x.get(1)?!0:!1:!0},fireShapeChange:function(){var T=this;if(!T._55I&&!ei){var e=lq(T._59O);e&&(T._55I=1,T.setRect(e),delete T._55I)}T.fp(Po,!1,!0)},getSerializableProperties:function(){var A=Hc.superClass.getSerializableProperties.call(this);return A.segments=1,A.points=1,A.thickness=1,A.closePath=1,A}});var _c=C.Points=function(){Le(_c,this)};Yb("Points",zo,{_22Q:function(){return Hs},setPoints:function(T){this.points=T,this._pointsDirty=!0,this.fp("points",V,this.points)},setPoint:function(Y,s){this.points||(this.points=[]),this.points[3*Y]=s[0],this.points[3*Y+1]=s[1],this.points[3*Y+2]=s[2],this._pointsDirty=!0,this.fp("points",V,this.points)},setPointsColor:function(r){this.colors=r,this._colorsDirty=!0,this.fp("colors",V,this.colors)},setPointColor:function(j,P){this.colors||(this.colors=[]),P?(P=xs(P),this.colors[3*j]=P[0],this.colors[3*j+1]=P[1],this.colors[3*j+2]=P[2]):(this.colors[3*j]=$,this.colors[3*j+1]=$,this.colors[3*j+2]=$),this._colorsDirty=!0,this.fp("colors",V,this.colors)},setPointsSize:function(o){this.sizes=o,this._sizesDirty=!0,this.fp("sizes",V,this.sizes)},setPointSize:function(I,f){this.sizes||(this.sizes=[]),this.sizes[I]=f?f:$,this._sizesDirty=!0,this.fp("sizes",V,this.sizes)},getPointInfo:function(C){var u=3*C,h=this.points;if(!h||h[u]===$||h[u+1]===$||h[u+2]===$)return null;var O=[h[u],h[u+1],h[u+2]],U=this.mat||Uf(this),n=[O[0],O[1],O[2]];rq(n,U);var x=this.colors;return{size:this.sizes&&this.size[C]||this.s("points.size"),color:x&&x[u]?[x[u],x[u+1],x[u+2]]:this.s("points.color"),local:O,world:n}},getSerializableProperties:function(){var E=_c.superClass.getSerializableProperties.call(this);return E.points=1,E.colors=1,E.sizes=1,E}});var Vg=C.Polyline=function(){Le(Vg,this),this.s({"shape.background":null,"shape.border.width":2})};Yb("Polyline",Hc,{_icon:"polyline_icon",_22Q:function(){return Is},getUIClass:function(){return ri},setClosePath:function(){},setTall:function(c){var y=this,v=y.getDataModel();if(v&&v.beginTransaction(),!y._55I&&!y._24Q&&!ei&&y.getTall()){y._24Q=1;var e=y._54O,$=c/y.getTall();if(1!==$){var I=y.toPoints(),t=new le;I.each(function(y){t.add({x:y.x,y:y.y,e:y.e==V?y.e:(y.e-e)*$+e})}),y.setPoints(t),y.fs()}delete y._24Q}Vg.superClass.setTall.call(y,c),v&&v.endTransaction()},setElevation:function(g){var u=this,p=u.getDataModel();if(p&&p.beginTransaction(),!u._55I&&!u._24Q&&!ei){u._24Q=1;var S=g-u._54O;0!==S&&u.shiftPointsElevation(S),delete u._24Q}Vg.superClass.setElevation.apply(u,arguments),p&&p.endTransaction()},fireShapeChange:function(){var m=this,N=m._59O;if(!m._55I&&!m._24Q&&!ei){var B=N.size();if(B){var R=1,l=N.get(0),v=m._54O;l.e==V&&(l.e=v);for(var r=l.e,I=0;B>R;R++){l=N.get(R),l.e==V&&(l.e=v);var C=s(r,l.e),f=g(r+I,l.e);r=C,I=f-C}m._24Q=1,m.setTall(I),m.setElevation(r+I*m._anchorElevation),delete m._24Q}}Vg.superClass.fireShapeChange.apply(m,arguments)}});var Jk=C.SubGraph=function(){Le(Jk,this)};Yb("SubGraph",zo,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Jk.superClass._8I.call(this),this.eachChild(function(B){Zb(B)&&B._8I()})}}),B.loadingRefGraph=0;var mo=C.RefGraph=function(){Le(mo,this)};Yb("RefGraph",Zm,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(x){var s=this._ref;this._ref=x,this.fp("ref",s,x),this.updateRef()},_21I:function(){mo.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var n=this;if(B.loadingRefGraph++,n.clearChildrenFromDataModel(),B.loadingRefGraph--,n._ref&&n._dataModel){n._xhrLoadHandler&&(n._xhrLoadHandler.cancel=!0);var r=ei,W=n._xhrLoadHandler=function(b){if(b&&n._dataModel){B.loadingRefGraph++;var Z=n._pendingUpdateInfo={needToRestore:r};r&&(Z.p3=n.p3(),Z.s3=n.s3(),Z.r3=n.r3(),Z.anchor3d=n.getAnchor3d(),Z.scale3d=n.getScale3d()),n.r3(0,0,0),n.setScale3d(1,1,1),n.setAnchor3d(.5,.5,.5),n.p3(0,0,0);var _=B.parse(b),p=n._dataModel.deserialize(_,n,{justDatas:!0});p.each(function(h){h._refGraph=n}),n.checkPendingUpdateInfo(),B.loadingRefGraph--,B.handleRefGraphLoaded(n,p,_)}};W.xhrLoadCalled=!1,B.load(n._ref,function(S){W.cancel||(W.xhrLoadCalled?W(S):aq(function(){W(S)}))}),W.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var h=this,c=h._pendingUpdateInfo;if(!c)return h.onPendingUpdated&&(B.loadingRefGraph++,h.onPendingUpdated(),B.loadingRefGraph--),void 0;var Q=!0;this.eachChild(function(J){(J._pendingCheckImageJSON||J._pendingUpdateInfo)&&(Q=!1)}),Q&&(B.loadingRefGraph++,h._pendingUpdateInfo=null,h.updateFromChildren(),c.needToRestore&&(h.setAnchor3d(c.anchor3d),h.setScale3d(c.scale3d),h.r3(c.r3),h.p3(c.p3)),this.getParent()instanceof mo&&this.getParent().checkPendingUpdateInfo(),h.onPendingUpdated&&h.onPendingUpdated(),B.loadingRefGraph--)
},getSerializableProperties:function(){var v=mo.superClass.getSerializableProperties.call(this);return v.ref=1,v}}),C.EdgeGroup=function(D,X){this._70O=D,this._siblings=X;for(var y,v,F=0,u=D.size(),_=a[xg];u>F;F++)if(y=D.get(F).getStyle(xg,!1),y!=V){_=y;break}_==V&&(_=!0);var C=B.edgeGroupAgentFunc;for(C&&(v=C(D),v&&v!==D.get(0)&&(D.remove(v),D.add(v,0))),F=0;u>F;F++)D.get(F).s(xg,_)},Yb("EdgeGroup",e,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(i){return this._70O.get(i)},indexOf:function(N){return this._70O.indexOf(N)},each:function(W,J){this._70O.each(W,J)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(q,t){this._siblings.each(function(g){g._70O.each(q,t)})}});var Yr=function(F,J,T){var g=Jl[F]={type:F,action:J};if(T)for(var a in T)g[a]=T[a]};Ki(B,{setConnectAction:Yr,getConnectAction:function(e,j){if(!j){if(!e)return null;j=e.getCurrentConnectActionType()}return Jl[j]},doConnectAction:function(A,d,G,K){K=K||A.getCurrentConnectActionType();var p=Jl[K];if(!p)return!1;var f=p.action;return f?(d instanceof Cl.Group?A.sm().getSelection().each(function(l){f.call(null,A,l,G)}):f.call(null,A,d,G),!0):!1},doDeleteConnectionAction:function(p,q,E){E=E||p.getCurrentConnectActionType();var I=Jl[E];if(!I||!I.delete)return!1;var U=I.delete.action;return U?(q instanceof Cl.Group?p.sm().getSelection().each(function(y){U.call(null,p,y)}):U.call(null,p,q),!0):!1}});var eg=C.JSONSerializer=function(j,R){this.dm=this._dataModel=j,this._hierarchical=B.forceHierarchicalSerialization?!0:R==V?j.isHierarchicalRendering():R};Yb("JSONSerializer",e,{ms_ac:["hierarchical"],serialize:function(O){return B.stringify(this.toJSON(),O)},toJSON:function(){var Q=this,S=Q.dm,M=S.getRoots(),b=Q.json={v:B.getVersion(),p:{},a:{},d:[]},l=S.getSerializableAttrs();S.getInit()&&(b.init=S.getInit()),S.getName()&&(b.p.name=S.getName()),S.getBackground()&&(b.p.background=S.getBackground()),S.getLayers()&&(b.p.layers=S.getLayers()),S.getEnvmap()&&(b.p.envmap=S.getEnvmap()),S.isCubicEnvmap()&&(b.p.cubicEnvmap=S.isCubicEnvmap()),b.p.autoAdjustIndex=S.isAutoAdjustIndex(),b.p.hierarchicalRendering=S.isHierarchicalRendering();for(var e in l){var z=S.a(e);z!==$&&Q[Si](e,z,b.a)}return bs(b.a)&&delete b.a,Q._hierarchical?M.each(Q.serializeData,this):S.each(function(X){Q.serializeData(X)}),S.fireSerializeEvent({type:"serialize",json:b}),S.getPostProcessingData()&&(b.p.postProcessingData=S.getPostProcessingData()),b},isSerializable:function(){return!0},getProperties:function(K){return K.getSerializableProperties()},getStyles:function(o){return o.getSerializableStyles()},getAttrs:function(o){return o.getSerializableAttrs()},serializeData:function(N){var u=this;if(u.isSerializable(N)&&!N._refGraph){var I,s,H,d,$=Zh(N.getClassName())||N.getClass(),G=new $,W={c:N.getClassName(),i:N.getId(),p:{},s:{},a:{}};u.json.d.push(W),I=u.getProperties(N);for(s in I)if(/^_/.test(s)){if(H=N[s],!("_width"!==s&&"_height"!==s||H!=V&&-1!==H)){var K;((N.s("layout.h")||N.s("layout.v"))&&N.getHost()||N instanceof C.Node&&(K=N.getParent())&&K instanceof C.Block||N.s("fullscreen"))&&(H=N[s]="_width"===s?N.getWidth():N.getHeight())}H!==G[s]&&u[Si](s.substr(1),H,W.p)}else d=Bb(s),N[d]&&(H=N[d](),H!==G[d]()&&u[Si](s,H,W.p));I=u.getStyles(N);for(s in I)H=N.s(s),H!==G.s(s)&&u[Si](s,H,W.s);I=u.getAttrs(N);for(s in I)H=N.a(s),H!==G.a(s)&&u[Si](s,H,W.a);bs(W.p)&&delete W.p,bs(W.s)&&delete W.s,bs(W.a)&&delete W.a}u._hierarchical&&N.getChildren().each(u.serializeData,u)},serializeValue:function(p,E,Z){Lq(E)?E={__a:E._as}:E instanceof Tr?E={__i:E.getId()}:E instanceof jo&&(E={__dm:E.serialize(0)}),Z[p]=E},deserialize:function(x,b,o){var r=this;return Zq(x)&&/.json$/.test(x)?(B.xhrLoad(x,function(f){r.deserializeImpl(f,b,o)}),void 0):r.deserializeImpl(x,b,o)},deserializeImpl:function(d,J,E){var L=this,D=L.dm;D.setDeserializing(!0),E=hm(E)?{setId:E}:mj(E)?{finishFunc:E}:E||{},d=L.json=Zq(d)?B.parse(d):d,!E.justDatas&&d.a&&d.a.onPreDeserialize&&!E.disableOnPreDeserialize&&d.a.onPreDeserialize(d,D,E.view),D.beginTransaction(),ei++,L._82I={};var l=new le,Z=new le,K=0,$=d.d.length;if(E.justDatas||(!E.disableInit&&mj(d.init)&&d.init(D),D.setInit(d.init)),!E.justDatas){for(var _ in d.a)D.a(_,L[kg](d.a[_]));for(var o in d.p)D[Bi(o)](d.p[o])}for(;$>K;K++){var x=d.d[K],m=Zh(x.c),u=new m,h=x.i;E.setId&&h!=V&&(u._id=h),L._82I[h]=u,l.add(u),Z.add(x)}for(K=0;$>K;K++)L.deserializeData(l.get(K),Z.get(K));return l.each(function(S){J&&!S.getParent()&&S.setParent(J),D.add(S)}),E.__innerHandler__&&E.__innerHandler__(d,D,E.view,l),D.fireSerializeEvent({type:"deserialize",json:d}),ei--,D.endTransaction(),!E.justDatas&&d.a&&d.a.onPostDeserialize&&!E.disableOnPostDeserialize&&d.a.onPostDeserialize(d,D,E.view,l),E.finishFunc&&E.finishFunc(d,D,E.view,l),D.setDeserializing(!1),l},deserializeData:function(J,p){for(var A in p.p)J[Bi(A)](this[kg](p.p[A]));for(A in p.s)J.s(A,this[kg](p.s[A]));for(A in p.a)J.a(A,this[kg](p.a[A]))},deserializeValue:function(K){if(on(K)){var U=K.__i;if(U!=V)return this._82I[U];if(U=K.__dm,U!=V){var Z=new C.DataModel;return Z.deserialize(U),Z}if(U=K.__a,Xj(U))return new le(U)}return K}}),Ki(jo,{serialize:function(s,w){return new eg(this,w).serialize(s)},toJSON:function(B){return new eg(this,B).toJSON()},deserialize:function(Y,J,C){return new eg(this).deserialize(Y,J,C)}});var Gf=C.OverlappingBox=function(F){this.gv=F,this.boxes={}};Yb("OverlappingBox",e,{clear:function(){var p,l,g=this.boxes;for(p in g)l=g[p],l.length=0},isOverlapping:function(k,L){var Q,f,s=this,l=s.boxes,y=l[k];y?(Q=y.rects,f=y.length):y=l[k]={rects:Q=[],length:f=0};var C,j,L;for(C=0;f>C;C++)if(j=Q[C],j.x<L.x+L.w&&j.x+j.w>L.x&&j.y<L.y+L.h&&j.h+j.y>L.y)return!0;return Q.length<=f?(Q.push(L),y.length++):Q[y.length++]=L,!1}}),Ki(B,{fetch:function(B,m){var u="GET",X=!1,s=null,l="";m&&(u=m.method||"GET",X=m.sync,l=m.url,s=m.data||null),B.open(u,l,!X),m.responseType?B.responseType=m.responseType:m.overrideMimeType&&B.overrideMimeType&&B.overrideMimeType(m.overrideMimeType),B.send(s)},convertImageSrc:function(j,r){r&&"function"==typeof r||(r=function(){}),r(j)}});var zh=C.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Yb("Request",e,{_responseType:null,_overrideMimeType:"text/plain",send:function(a){var s=this._xhr,K=this.onload,S=this.onerror;this.getResponseType()?a.responseType=this.getResponseType():this.getOverrideMimeType()&&(a.overrideMimeType=this.getOverrideMimeType()),s.onload=K,s.onerror=S,B.fetch(s,a)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(f){this._responseType=f},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(H){this._overrideMimeType=H},getResponseText:function(){var P=this._xhr;return P.response||P.responseText}}),Gj.GraphView=function(u){var p=this;p._24I={},p._34I=new le,p._25I={},p._56I={},p._view=mk(1,p),p._canvas=ob(p._view),p.dm(u?u:new jo),this._coreInteractor=new No(this),p.setEditable(!1),p.setScrollBarVisible(B.graphViewScrollBarVisible),p._initView()},jm("GraphView",e,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Pd,gq,Fd,nc,"resettable","editInteractor",nj,"zoomable","pannable","rectSelectable","autoScrollZone",bj,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:B.graphViewZoomable,_resettable:B.graphViewResettable,_pannable:B.graphViewPannable,_rectSelectable:B.graphViewRectSelectable,_autoScrollZone:B.graphViewAutoScrollZone,_rectSelectBackground:B.graphViewRectSelectBackground,_rectSelectBorderColor:B.graphViewRectSelectBorderColor,_editPointSize:B.graphViewEditPointSize,_editPointBorderColor:B.graphViewEditPointBorderColor,_editPointBackground:B.graphViewEditPointBackground,_scrollBarColor:kk,_scrollBarSize:Qb,_autoHideScrollBar:Sr,_autoMakeVisible:cp,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(b){this._dataModel.setLayers(b)},setEditable:function(a){var p=this,d=p.__interactorMap__;if(!d){var z=Gj.XEditInteractor;d=p.__interactorMap__={scrollBar:new Lp(p),select:new yg(p),edit:z?new z(p):new eo(p),text:new np(p),move:new nf(p),"default":new Df(p),touch:new Qh(p,{editable:!1})}}a?(p._uieditable=!0,p.setInteractors([d.scrollBar,d.select,d.edit,d.text,d.move,d.default,d.touch])):(p._uieditable=!1,p.setInteractors([d.scrollBar,d.select,d.move,d.default,d.touch]))},getCanvas:function(){return this._canvas},_33I:function(n){var L=n.getUIClass();return L?new L(this,n):V},getDataUI:function(k){var l=this,H=l._25I[k._id];return H===$&&(H=l._33I(k),l._25I[k._id]=H),H},getNodeRect:function(f){return B.getNodeRect(this,f)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(b){var U=this.getDataUI(b);return U?(U._79o(),U._78o):null},getEdgeSourcePosition:function(D){var A=this,G=A.getDataUI(D),l=G.s,Z=G._data._40I;return Ie(A,Z,l("edge.source.position"),l("edge.source.offset.x"),l("edge.source.offset.y"),l("edge.source.anchor.x"),l("edge.source.anchor.y"))},getEdgeTargetPosition:function(c){var H=this,z=H.getDataUI(c),v=z.s,F=z._data._41I;return Ie(H,F,v("edge.target.position"),v("edge.target.offset.x"),v("edge.target.offset.y"),v("edge.target.anchor.x"),v("edge.target.anchor.y"))},invalidateAll:function(T){var p=this;if(T){for(var t in p._25I){var O=p._25I[t];O&&O.dispose()}p._25I={},p._56I={},p._24I={},p._34I.clear(),p.redraw()}else p.dm().each(function(W){p.invalidateData(W)})},invalidateSelection:function(){var y=this;y.sm().each(function(v){y.invalidateData(v)})},invalidateData:function(H){var m=this;m._24I[H._id]=H,m._21Q(H),m.iv()},_21Q:function(S){var y=this,R=y._24I;if(hf(S)&&cl[S.s(mf)]){var u=S.getSourceAgent();u&&u.getAgentEdges().each(function(g){R[g._id]=g}),u=S.getTargetAgent(),u&&u.getAgentEdges().each(function(X){R[X._id]=X}),y.iv()}},redraw:function(J){var s=this;s._32I||(J?s._34I.add(J):(s._32I=1,s._34I.clear()),s.iv())},each:function(Z,O){var I,A,o,w=0,g=this.getLayers(),K=this._dataModel,V=K._datas._as,r=V.length;if(g){for(var f=g.length;f>w;w++)if(o=g[w],on(o)&&(o=o.name),K.isHierarchicalRendering()){var L=function(T){return T._layer===o?O?Z.call(O,T):Z(T):void 0};if(this._dataModel.eachByHierarchical(L)===!1)return}else for(var t=0;r>t;t++)if(I=V[t],I._layer===o&&(A=O?Z.call(O,I):Z(I),A===!1))return}else if(K.isHierarchicalRendering())this._dataModel.eachByHierarchical(Z,null,O);else for(;r>w;w++)if(I=V[w],A=O?Z.call(O,I):Z(I),A===!1)return},reverseEach:function(r,_){var g,E,J,v,N=this._dataModel,M=N._layers,h=N._datas._as,Q=h.length;if(M){for(g=M.length-1;g>=0;g--)if(v=M[g],on(v)&&(v=v.name),N.isHierarchicalRendering()){var V=function(M){return M._layer===v?_?r.call(_,M):r(M):void 0};if(N.reverseEachByHierarchical(V)===!1)return}else for(var T=Q-1;T>=0;T--)if(E=h[T],E._layer===v&&(J=_?r.call(_,E):r(E),J===!1))return}else if(N.isHierarchicalRendering())N.reverseEachByHierarchical(r,null,_);else for(g=Q-1;g>=0;g--)if(E=h[g],J=_?r.call(_,E):r(E),J===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var X=this,s=X._84I;if(!s){var h=this.dm().a("width"),b=this.dm().a("height");h>0&&b>0?X._84I={x:0,y:0,width:h,height:b}:(X.each(function(O){X.isVisible(O)&&(s=Co(s,X.getDataUIBounds(O)))}),X._84I=s?s:Hp)}return X._84I},getScrollRect:function(){return Co(this.getContentRect(),this._29I)},makeCenter:function(a,X,M){var Z=this;if(!Z.getWidth()||!Z.getHeight())return M||aq(Z.makeCenter,Z,[a,X,!0],500),void 0;Z.makeVisible(a),Z.validate();var B=Z.getDataUIBounds(a);if(B){var i=Z.getWidth(),n=Z.getHeight(),q=B.x+B.width/2,_=B.y+B.height/2,O=-q*Z._zoom+i/2,f=-_*Z._zoom+n/2;Z.setTranslate(O,f,X)}},fitData:function(l,G,Y,U,x){var X=this;if(!X.getWidth()||!X.getHeight())return x||aq(X.fitData,X,[l,G,Y,U,!0],500),void 0;var o=function(){X.makeVisible(l),X.validate();var H=X.getDataUIBounds(l);H&&(H=Xn(H),Pm(H,Y==V?20:Y),X.fitRect(H,G,U))};G?B.callWhenLoaded(o):o()},fitContent:function(p,t,i,U){var J=this;if(!J.getWidth()||!J.getHeight())return U||aq(J.fitContent,J,[p,t,i,!0],500),void 0;var O=function(){J.validate();var S=Xn(J.getContentRect());Pm(S,t==V?20:t),J.fitRect(S,p,i)};p?B.callWhenLoaded(O):O()},fitRect:function(H,o,i){var Y=this,A=Y.getWidth(),J=Y.getHeight(),w=H.x+H.width/2,F=H.y+H.height/2,h=s(A/H.width,J/H.height),T=Y._zoom,R=-w*T+A/2,Z=-F*T+J/2;0===h||isNaN(h)||(i&&(h=s(1,h)),o?(Y._65I&&(delete Y._65I.finishFunc,Y._65I.stop(!0)),Y._14o&&Y._14o.stop(!0),Y.setTranslate(R,Z,{finishFunc:function(){Y.setZoom(h,o)}})):(Y.setTranslate(R,Z),Y.setZoom(h)))},fitSelection:function(y,S,o){var M=this,f=M.sm(),L=null;f.size()&&(f.each(function(n){L=Co(M.getDataUIBounds(n),L)}),y&&Pm(L,y),M.fitRect(L,S,o))},toCanvas:function(w,E,q){E=E||this._zoom,this.validateImpl();var U=this,t=U.getContentRect();q&&Pm(t,q),t.width||(t.width=10),t.height||(t.height=10);var x=ob(),D=t.x*E,F=t.y*E,b=Math.ceil(t.width*E),B=Math.ceil(t.height*E);Yl(x,b,B,1);var d=ye(x);return w=w||this._dataModel.getBackground(),w&&Wq(d,0,0,b,B,w),Sg(d,-D,-F),d.scale(E,E),U._42(d),d.restore(),x},toDataURL:function(s,$,g,l){return this.toCanvas(s,g,l).toDataURL($||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(I,K){var f=this,s=f.dm().getBackground();if(s){var m=f.dm().a("width"),n=f.dm().a("height");m>0&&n>0&&Wq(I,0,0,m,n,s)}var r=f.__htmlOrderList,F=[],h=f._forcedLayoutHTML;if(f._93db(I,K),f.each(function(Q){var M=f.getDataUI(Q);if(M){var R=f._56I[Q._id],y=M._htmlView;if(R){var U=M._79o();if(y=M._htmlView,C.HtmlNode&&Q instanceof C.HtmlNode)M._42(I);else{var n=f.getViewRect(),d=y&&y.layoutHTML;!K||vs(K,U)?(d&&(y.layoutHTML(),M.__outerLayout&&delete M.__outerLayout),M._42(I)):vs(n,U)||!d||M.__outerLayout&&!h||(y.layoutHTML(),M.__outerLayout=!0)}}y&&(F.push(y),y.getView&&(y=y.getView()),y.style.display=R?"block":ef)}}),r&&F.length>0){var b=!1;if(r.length!==F.length)b=!0;else for(var B=0;B<F.length;B++)if(F[B]!==r[B]){b=!0;break}b&&(F.forEach(function(z){z.autoAdjustIndex!==!1&&f.appendHTML(z,!0)}),this.__htmlOrderList=F)}else this.__htmlOrderList=F;f._92db(I,K)},validateImpl:function(){this.tryUpdateRootData();var Z,H,d,c,m,E=this,R=E.tx(),I=E.ty(),f=E._zoom,O=E._canvas,x=this.getWidth(),Q=this.getHeight(),S=E._29I,e={x:-R/f,y:-I/f,width:x/f,height:Q/f},w={},a=E._34I,N=E._24I,J=E._32I,$=E._23I;E._24I={},(x!==O.clientWidth||Q!==O.clientHeight)&&(Yl(O,x,Q),J=1,E._forcedLayoutHTML=1),J||Rh(e,S)||(J=1,E._forcedLayoutHTML=1),E._29I=e,E.each(function(b){H=b._id;var s=w[H]=E.isVisible(b);s!==E._56I[H]&&(N[H]=b,d=E.getDataUI(N[H]),d&&d._84o(s),E._84o(b,s))},E);for(H in N)d=E.getDataUI(N[H]),d&&(!J&&E._56I[H]&&(m=d._79o(),m&&a.add(m)),d.invalidate()),E._83I=1;if(E._56I=w,!J)for(H in N)w[H]&&(d=E.getDataUI(N[H]),d&&(m=d._79o(),m&&a.add(m)));if(J?c=e:(a.each(function(O){vs(e,O)&&(c=Co(c,O))}),c&&(Pm(c,g(1,1/f)),c.x=b(c.x*f)/f,c.y=b(c.y*f)/f,c.width=L(c.width*f)/f,c.height=L(c.height*f)/f,c=Am(e,c))),E._74O=c,c&&0!==c.width&&0!==c.height){Z=ye(O);var u=c.x,K=c.y,Y=c.width,X=c.height;u=Math.floor((u*f+R)*Me),K=Math.floor((K*f+I)*Me),Y=Math.ceil(Y*f*Me)+1,X=Math.ceil(X*f*Me)+1,J||(c.x=(u/Me-R)/f,c.y=(K/Me-I)/f,c.width=Y/Me/f,c.height=X/Me/f),Z.beginPath(),Z.rect(u,K,Y,X),Z.clip(),Z.clearRect(u,K,Y,X),Dd(Z,R,I,f),E._42(Z,c),Z.restore(),delete E._74O}if(a.clear(),delete E._32I,delete E._forcedLayoutHTML,$&&x>0&&Q>0){var d=E.getDataUI($);if(d){var m=d._79o(),M=E._29I,B=M.x,F=M.y,p=M.width,A=M.height,f=E._zoom;m&&!vs(m,M)&&(m.x+m.width<B&&E.tx(-m.x*f),m.x>B+p&&E.tx(-(m.x+m.width-p)*f),m.y+m.height<F&&E.ty(-m.y*f),m.y>F+A&&E.ty(-(m.y+m.height-A)*f))}delete E._23I}E._83I&&(delete E._83I,delete E._84I),E._98O(),E.countFrame(),bs(E._24I)||aq(E.iv,E)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var J,l=this.getFullscreenDatas();for(var q in l)J=l[q],this.scaleRootData(J);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(D){var I=D.s("fullscreen");if("uniform"===I||"fill"===I){D.getRotation()&&D.setRotation(0);var z=D.s("fullscreen.gap")||0,J=this.getWidth(),L=this.getHeight();if(J&&L){var W,Q,i,w=J-2*z,F=L-2*z,a=D.getAnchor(),B=D.getScaledSize(),R=B.width,y=B.height,O=D.s("fullscreen.lock");if(O)return"uniform"===I?w/F>R/y?(W=F/y,R=y*w/F):(W=w/R,y=R*F/w):"v"===O?(W=F/y,R=w/W,D.getWidth()!==R&&D.setWidth(R)):(W=w/R,y=F/W,D.getHeight()!==y&&D.setHeight(y)),this.setZoom(W),Q=z-(D.getX()-a.x*R)*W,i=z-(D.getY()-a.y*y)*W,Q!==this.tx()&&this.tx(Q),i!==this.ty()&&this.ty(i),void 0;Q=this.tx(),i=this.ty(),W=this._zoom;var X={x:(-Q+z)/W,y:(-i+z)/W,width:w/W,height:F/W};if("uniform"===I){var s=R/y,n=Math.min(X.width,X.height*s),$=n/s;X.x+=.5*(X.width-n),X.y+=.5*(X.height-$),X.width=n,X.height=$}w=X.width/D.getScaleX(),F=X.height/D.getScaleY(),(D.getWidth()!=w||D.getHeight()!==F)&&D.setSize(w,F);var P=X.x+a.x*X.width,Y=X.y+a.y*X.height,H=D.getPosition();(P!==H.x||Y!==H.y)&&D.setPosition(P,Y)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(q){var n=this;q!==n.isScrollBarVisible()&&(q?(os(n._view,n._79O=Rn()),os(n._79O,n._27I=Rn()),os(n._79O,n._28I=Rn())):(zg(n._79O),delete n._79O,delete n._27I,delete n._28I),n.fp("scrollBarVisible",!q,q))},getDebugTip:function(){return""},showScrollBar:function(){var r=this;r._79O&&(r._85I||(fo(function(){r._86I()},Ui),r.iv()),r._85I=new Date)},_86I:function(){var s=this;if(s._85I){var L=new Date,d=L.getTime();d-s._85I.getTime()>=Ui?(delete s._85I,s.iv()):fo(function(){s._86I()},Ui)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var E=this,I=this._27I,Y=this._28I;if(E._79O){if(E._autoHideScrollBar&&!E._85I)return I.style.visibility=bo,Y.style.visibility=bo,void 0;var v=E.getScrollBarColor(),T=E._zoom,F=E.getScrollBarSize(),e=E.getViewRect(),G=E.getScrollRect(),C=e.height*T,Q=G.height*T,f=e.width*T-F-2,J=C*((e.y-G.y)*T/Q),s=C*(C/Q),A=I.style;Q-.5>C?(Dk>s&&(J=J+s/2-Dk/2,0>J&&(J=0),J+Dk>C&&(J=C-Dk),s=Dk),$m(I,f,J,F,s),A.visibility=rr,A.background=v,A.borderRadius=F/2+Tn):A.visibility=bo;var N=e.width*T,m=G.width*T,J=e.height*T-F-2,f=N*((e.x-G.x)*T/m),u=N*(N/m),A=Y.style;m-.5>N?(Dk>u&&(f=f+u/2-Dk/2,0>f&&(f=0),f+Dk>N&&(f=N-Dk),u=Dk),$m(Y,f,J,u,F),A.visibility=rr,A.background=v,A.borderRadius=F/2+Tn):A.visibility=bo}},setDataModel:function(R){var O=this,T=O._dataModel,W=O._selectionModel;T!==R&&(T&&(T.ump(O.handleDataModelPropertyChange,O),T.umm(O.handleDataModelChange,O),T.umd(O.handleDataPropertyChange,O),T.removeIndexChangeListener(O._75O,O),T.removeHierarchyChangeListener(O.handleHierarchyChange,O),W||T.sm().ums(O.handleSelectionChange,O)),O._dataModel=R,R.mp(O.handleDataModelPropertyChange,O),R.mm(O.handleDataModelChange,O),R.md(O.handleDataPropertyChange,O),R.addIndexChangeListener(O._75O,O),R.addHierarchyChangeListener(O.handleHierarchyChange,O),W?W._21I(R):R.sm().ms(O.handleSelectionChange,O),O.invalidateAll(!0),O.fp(dq,T,R),O.updateBackground())},getLayersInfo:function(){if(this._layersInfo===$){var K=this.getLayers();K?(this._layersInfo={},K.forEach(function(f){var J=on(f)?f.name:f;this._layersInfo[J]=f},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(_,D,F){var a,h,Y=this,R=Y.getDataUI(_),k=Nn(R),O=Nq(D,function(D){return Cg(k,100*D)},100,.001),u=Cg(k,100*O);if(!F){var g=qb(R),H=new kp(u.x,u.y),i=49/(Y._zoom*Y._zoom);for(a=0,h=g.length;h>a;a++)if(H.distanceToSquared(g[a])<i)return{index:a,point:g[a],distance:Math.sqrt((g[a].x-D.x)*(g[a].x-D.x)+(g[a].y-D.y)*(g[a].y-D.y))}}return{percent:O,point:u,distance:Math.sqrt((u.x-D.x)*(u.x-D.x)+(u.y-D.y)*(u.y-D.y))}},calculateAttachPoint:function(){var T=new kp,p=new kp,B=new kp;return function(K,_){var V=this.getAttachPoints(K);if(!V||!V.length)return null;B.set(_.x,_.y);for(var Q,I,h,i,G,f=1/0,s=0,X=V.length;X>s;s++)h=V[s],p.x=h.x,p.y=h.y,T.x=h.offsetX||0,T.y=h.offsetY||0,i=Ie(this,K,0,T.x,T.y,p.x,p.y),I=B.distanceToSquared(i),f>I&&(Q=s,f=I,G=i);f=Math.sqrt(f);var w=this.getAttachStyle(K);if("close"===w){var d=K.s("attach.close.threshold")/this._zoom;if(f>d)return null}return{index:Q,distance:f,info:V[Q],point:G}}}(),getAttachPoints:function(F){var Q=F.s("attach.points");if(Q)return Q;var $=Cc(F._image);return $?Th($.attachPoints,F,this)||null:void 0},getAttachStyle:function(S){var G=S.s("attach.style");if(G)return G;var K=Cc(S._image);return K?Th(K.attachStyle,S,this)||"close":void 0},updateLayers:function(){this._layersInfo=$,this.invalidateSelection(),this.redraw()},updateBackground:function(){var Q=this.dm().a("width"),C=this.dm().a("height");this._canvas.style.background=Q>0&&C>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(B){if("background"===B.property){var S=this._canvas.style.background,l=B.newValue||"";this.updateBackground(),this.fp("canvasBackground",S,l),this.redraw()}else"a:width"===B.property||"a:height"===B.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===B.property?this.updateLayers():"hierarchicalRendering"===B.property&&this.redraw()},handleDataPropertyChange:function(G){this.dm().isHierarchicalRendering()&&"parent"===G.property&&G.data.hasChildren()&&this.redraw(),this.invalidateData(G.data)},onPropertyChanged:function(P){var v=this,D=P.property;if(v.redraw(),"zoom"===D){var M=v.sm().getSelection();M.size()&&M.each(function(l){l.invalidate()})}else"dataModel"===D&&(v._83I=1);uq[D]?v.showScrollBar():D===nj&&v.onCurrentSubGraphChanged(P)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function($){var k=this,Y=$.kind,F=$.data;if(k._83I=1,"add"===Y)k.invalidateData(F),hf(F)&&F.getEdgeGroup()&&F.getEdgeGroup().eachSiblingEdge(k.invalidateData,k);else if(Y===nr){k._21Q(F);var i=F._id,h=k._25I[i];if(h){if(k._56I[i]){var c=h._79o();c&&k.redraw(c)}h.dispose(),delete k._25I[i],delete k._24I[i],delete k._56I[i]}F===k._currentSubGraph&&k.setCurrentSubGraph(V)}else Y===ac&&(k.invalidateAll(!0),k.setCurrentSubGraph(V))},_75O:function(_){this.invalidateData(_.data)},handleHierarchyChange:function(k){this.dm().isHierarchicalRendering()&&k.data.hasChildren()&&this.redraw(),this.invalidateData(k.data)},adjustIndex:function(u){var y=this;if(y.isVisible(u)){y.dm().beginTransaction();for(var h=u;h._parent&&y.isVisible(h._parent);)h=h._parent;h&&h!==u&&y._dataModel.adjustIndex(h),y._dataModel.adjustIndex(u),y.dm().endTransaction()}},getImage:function(Y){return Y.getImage?Y.getImage():$},getSelectWidth:function(c){var i=Cc(this.getImage(c));return i&&Th(i.disableSelectedBorder,c,this)?0:c.s("select.width")},getSelectColor:function(z){return z.s("select.color")},isSelectable:function(k,Q){if(this.isSelected(k))return!0;if(!Q&&k.getParent()instanceof Zm&&this.isSelectable(k.getParent(),!0)&&k.getParent().isSyncSize())return!1;var x=this.getLayersInfo();if(x){var C=x[k._layer];if(C&&C.selectable===!1)return!1}return k.s("2d.selectable")&&this.sm().isSelectable(k)},isMovable:function(D){var f=this;if(hf(D)&&D.getStyle(mf)!==Jd)return!1;var E=this.getLayersInfo();if(E){var H=E[D._layer];if(H&&H.movable===!1)return!1}return D.s("2d.movable")?f._movableFunc?f._movableFunc(D):!0:!1},isEditable:function(S){var I=this;if(C._uiSerializing)return I._uieditable;if(!I._editInteractor||!I.isSelected(S))return!1;if(Bs(S)){var d=I.getDataUI(S);if(!d||d._88I)return!1}if(hf(S)&&S.getStyle(mf)!==Jd)return!1;var e=this.getLayersInfo();if(e){var $=e[S._layer];if($&&$.editable===!1)return!1}return S.s("2d.editable")?I._editableFunc?I._editableFunc(S):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(M){return Zb(M)&&0!==M.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(M):!0},isRectEditable:function(t){return this._rectEditableFunc?this._rectEditableFunc(t):!0},isAnchorEditable:function(y){return this._anchorEditableFunc?this._anchorEditableFunc(y):!0},isRotationEditable:function(R){return R.setRotation&&R.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(R):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(G){var E=G.getAnchor(),H=G.getScale(),N=this._zoom,a=Up(G.getRotation(),0,-G.getHeight()*H.y*E.y-(H.y<0?-1:1)*(gp?32:16)/N),n=G.p();return a.x+=n.x,a.y+=n.y,a},getLogicalPoint:function(V){var U=this;return Kf(V,U._canvas,U.tx(),U.ty(),U._zoom,U._zoom)},getScreenPoint:function(e,u){var O,Q=this;return"object"==typeof e?e.x!==$?(O=e.x,u=e.y):(O=e[0],u=e[1]):O=e,eb(O,u,Q._canvas,Q.tx(),Q.ty(),Q._zoom,Q._zoom)},getSelectedDataAt:function(c){var o=this;return this.getDataAt(c,function(p){return o.isSelected(p)})},getDataInfoAt:function(o,X,p){var S,F=this.lp(o),u=this.getDataAt(F,X,p);if(u){var y=this.getDataUI(u);S={data:u,ui:y,point:F};var Q=y._38o;if(Q){var N=Q.icons;for(var v in N){var B=N[v],l=Q.rects[v];if(l)for(var E=Th(B.names,u,this),f=E?E.length:0,t=l.rotation,T=f-1;T>=0;T--){var d=E[T],n=l[T];if(lc(n,F,t))return S.part="icons",S.name=v,S.icon=d,S.rect=n,S.index=T,S.rotation=t,S}}}if(this.isNoteVisible(u)){if(y.note2Info&&lc(y.note2Info.clickRect,F,V,y.note2Info.scale))return S.part="note2",S;if(y.noteInfo&&lc(y.noteInfo.clickRect,F,V,y.noteInfo.scale))return S.part="note",S}if(this.isLabelVisible(u)){if(y.label2Info&&lc(y.label2Info.rect,F,y.label2Info.rotation,y.label2Info.scale))return S.part="label2",S;if(y.labelInfo&&lc(y.labelInfo.rect,F,y.labelInfo.rotation,y.labelInfo.scale))return S.part="label",S}if(u.isInRect&&u.isInRect(F))return S.part="body",S}return S},getDataAt:function(p,_,t){p.target&&(p=this.lp(p));var J,v=this._zoom;return this.reverseEach(function(f){return(_?_(f):this.isSelectable(f))&&this.rectIntersects(f,Aj(p.x,p.y,t,v))?(J=f,!1):void 0},this),J},getIconInfoAt:function(l,b){var x=this;if(l.target&&(l=x.lp(l)),b||(b=x.getDataAt(l)),b){var f=x.getDataUI(b);if(f&&f._38o){var r,Q=f._38o,_=new le;for(r in Q.icons)_.add(r);for(var u=_.size()-1;u>=0;u--){r=_.get(u);for(var p=Q.rects[r],a=p.rotation,e=p.length-1;e>=0;e--){var z=p[e],J=z.width,t=z.height,G={x:l.x-z.x-J/2,y:l.y-z.y-t/2};a!=V&&(G=Up(-a,G.x,G.y));var z={x:-J/2,y:-t/2,width:J,height:t};if(lc(z,G))return{key:r,index:e,name:Q.icons[r].names[e],rect:p[e],point:l,rotation:a,relativeRect:z,relativePoint:G,data:b}}}}}return V},getDatasInRect:function(D,l,A){A===$&&(A=1);var o=this,e=new le;return o.reverseEach(function(i){A&&!o.isSelectable(i)||(l?o.rectIntersects(i,D):o.rectContains(i,D))&&e.add(i)}),e},moveSelection:function(k,R){var _=this;_.dm().beginTransaction(),lh(_.sm().toSelection(_.isMovable,_),k,R),_.dm().endTransaction()},moveDatas:function(C,i,b){var B=this;B.dm().beginTransaction(),C instanceof le||(C=new le(C)),lh(C,i,b),B.dm().endTransaction()},getDataUIBounds:function(E){var D=this.getDataUI(E);return D?D._79o():V},drawData:function(K,W,R){var q=this.getDataUI(W);if(q){var v=q._79o();(!R||vs(R,v))&&(q._42(K),W instanceof C.Block&&W.eachChild(function(d){this.isVisible(d)&&this.drawData(K,d,R)},this))}},getBoundsForGroup:function(F){return F.s(ze)?this.getDataUIBounds(F):V},isPixelPerfect:function(e){return e.s("pixelPerfect")},rectIntersects:function(h,k){this.validate();var M=V;if(this._56I[h._id]){var b=this._25I[h._id];if(b){var n=b._79o();if(hs(k,n))M=!0;else if((k=Am(k,n))&&(b.rectIntersects&&(M=b.rectIntersects(k)),M==V)){if(!this.isPixelPerfect(h))return!0;var W=k.x,$=k.y,r=k.width,e=k.height,Z=this._zoom,J=B.hitMaxArea,D=r*e*Z*Z;if(D>J){var E=Math.sqrt(J/D);Z*=E}r*=Z,e*=Z,2>r&&(r=2),2>e&&(e=2),W*=Z,$*=Z;var C=oe(r,e);Sg(C,-W,-$),C.scale(Z,Z),this._drawForChecking=!0,this.drawData(C,h,k),this._drawForChecking=!1;try{for(var K=0,R=C.getImageData(0,0,r,e).data;K<R.length;K+=4)if(0!==R[K+3]){M=!0;break}C.restore()}catch(t){Zf=V,M=!1}}}}return M?!0:!1},rectContains:function(K,g){if(this._56I[K._id]){var N=this._25I[K._id];if(N)return hs(g,N._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(M){if(!B.isInput(M.target)){var q=this,N=q._focusData,y=N&&q._25I[N._id],Q=0,p=q._dataModel._datas;if(!(N&&N._enabled&&N._editable&&y&&y.onKeyDown&&y.onKeyDown(M)===!0))if(9===M.keyCode&&(N&&(Q=p.indexOf(N),Fk(M)?-1===--Q&&(Q=0):++Q===p.size()&&(Q=0)),q._focusData=N=p.get(Q),q.sm().setSelection(N)),$g(M)?q.selectAll():uo(M)&&q.isResettable()&&q.reset(),q.sm().isEmpty()){if(q._editing)return;var u=q.tx(),x=q.ty(),w=!1,k=Fk()?100:10;Yg(M)&&(u-=k,w=!0),Xe(M)&&(x-=k,w=!0),hq(M)&&(u+=k,w=!0),Xh(M)&&(x+=k,w=!0),w&&q.setTranslate(u,x)}else{Ab(M)&&q.handleDelete(M);var z=Fk()?10:1;Yg(M)&&(q.moveSelection(-z,0),q.fi({kind:"moveLeft"})),Xe(M)&&(q.moveSelection(0,-z),q.fi({kind:"moveUp"})),hq(M)&&(q.moveSelection(z,0),q.fi({kind:"moveRight"})),Xh(M)&&(q.moveSelection(0,z),q.fi({kind:"moveDown"}))}}},handleScroll:function(n,L){if(qk(n),this.isZoomable()){if(!this.getEditInteractor()){var t=this.getDataAt(n);if(t){var G=Cc(this.getImage(t));if(G&&Th(G.scrollable,t,this))return}}var $=this.lp(n);L>0?this.scrollZoomIn($):0>L&&this.scrollZoomOut($)}},handlePinch:function(D,y,X){this.isZoomable()&&(Math.abs(y-X)<B.pinchZoomThreshold||(y>X?this.pinchZoomIn(D):this.pinchZoomOut(D)))},checkDoubleClickOnNote:function(f,E){var e=this,r=e.lp(f),V=e.getDataUI(E),H=V.note2Info;return H&&E.s("note2.toggleable")&&lc(H.clickRect,r)?(E.s(Ne,!E.s(Ne)),e.fi({kind:"toggleNote2",event:f,data:E}),!0):(H=V.noteInfo,H&&E.s("note.toggleable")&&lc(H.clickRect,r)?(E.s(Zo,!E.s(Zo)),e.fi({kind:"toggleNote",event:f,data:E}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(p,O){var q=this,v=q.getAutoScrollZone(),T=v/q.getZoom(),y=v/4,A=q._29I,t=q.lp(p),I={x:q.tx(),y:q.ty()};return t&&v>0&&A&&(t.x-A.x<T?q.translate(y,0):A.x+A.width-t.x<T&&q.translate(-y,0),t.y-A.y<T?q.translate(0,y):A.y+A.height-t.y<T&&q.translate(0,-y)),I.x=q.tx()-I.x,I.y=q.ty()-I.y,O&&(O.x+=I.x,O.y+=I.y),I},getMoveMode:function(l,v){var A=v.s("2d.move.mode");return A?A:vm["88"]?"x":vm["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(f,g,I){var E=this;return"currentSubGraph"===g?{__i:f.getId()}:I.serializeProperty(f,g,E)},deserializeProperty:function(d,G,u){var r=this;if("currentSubGraph"===G){var g=r.dm(),z=g.__idMap;return z[d.__i]}return u.deserializeProperty(d,G,r)},setDefaultCursor:function(S,v){this._defaultCursor=S,v!==!1&&this.setCursor(S)},setCursor:function(r){"default"===r&&(r=this._defaultCursor||r);var g=this.getView().style;g.cursor=r,g.cursor="-webkit-"+r,g.cursor="-moz-"+r},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(X){return X===V||B.getConnectAction(null,X)?(this._currentActionType=X,this.redraw(),!0):!1},getEditStyle:function(p){var H=this.getEditInteractor();return H?H.getStyle(p):$},setEditStyle:function(s,H,r){var y=this.getEditInteractor();return y?(y.setStyle(s,H,r),!0):!1},isConnectActionVisible:function(q){var f=B.getConnectAction(this);if(!f)return!1;var P=f.visible;return mj(P)&&(P=P(this,q)),P},isInteractive:function(W){if(this._drawForChecking)return!1;var b=Cc(this.getImage(W));
return b&&Th(b.interactive,W,this)?!0:W.s("interactive")},appendHTML:function(K,Q){var M=this.getView();if(!(Q||K&&K.parentNode!==M))return!1;var Y=K.getView&&K.getView();if(!Q&&Y&&Y.parentNode===M)return!1;(K.getView||K.isSelfViewEvent)&&(K=K.getView());var T=this.getEditInteractor();return T&&T._canvas?M.insertBefore(K,T._canvas):this.isScrollBarVisible()?M.insertBefore(K,this.getView().lastChild):os(M,K),!0},_layoutHTMLImpl:function(j,n,p){if(arguments.length>1){var $,m=this,L=m._zoom;if(n.getView&&($=n,n=n.getView()),n.style.position="absolute",p){var X=j.getRect();$m($||n,m.tx()+X.x*L,m.ty()+X.y*L,X.width*L,X.height*L)}else{var i=new Ge,X=j.getAnchorRect(),R=j.getPosition(),b=j.getScale(),O=n.style;$m($||n,X),i.appendTranslate(m.tx(),m.ty()),i.appendScale(L,L),i.append(new Ge(j.getRotation(),R.x,R.y,b.x,b.y)),ks(O,"transform","matrix("+i.a.toFixed(5)+", "+i.b.toFixed(5)+", "+i.c.toFixed(5)+",\n    "+i.d.toFixed(5)+", "+i.tx.toFixed(5)+", "+i.ty.toFixed(5)+")"),ks(O,"transformOrigin",(-X.x).toFixed(5)+"px "+(-X.y).toFixed(5)+"px"),n.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(O){return O instanceof Ec?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(v){var Y="state",G=v.s(Y);if(G)return G;var W=Cc(v._image);return W?Th(W[Y],v,this)||null:void 0},getShape:function(W){return W.getStyle(Po)}}),e.defineProperties(Gj.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(n){this._layoutHTML=n}}});var yl=function(G,m){var Z=this;Z.gv=G,Z.s=function(J){return m.getStyle(J)},Z._data=m,Z._87I=new le};ym(yl,e,{_6I:V,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var i=this,G=i.gv.isSelected(i._data);return!G||i.isShadowed()?0:i.gv.getSelectWidth(i._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(p){var $=this._data,c=this.gv.getBodyColor($);return c?c:p?$.getStyle(p):V},_2Q:function(b){return this.s(b)},_1Q:function(N,o,F,P){var S=this.s,W=S("2d.gray"),j=S(o+".dash.color");if(W&&(j=B.toGrayColor(j)),N.strokeStyle=j,N.lineWidth=F,N.stroke(),S(o+".dash.3d")){var k=S(o+".dash.3d.color");Ph(N,j,W?B.toGrayColor(k):k,F,this.gv._zoom,S(o+".dash.3d.accuracy"))}Ze(N,P)},invalidate:function(){this._6I=V},_79o:function(){var D=this;if(!D._6I){var c=D._data,J=D.gv;D.labelInfo=D.label2Info=D.noteInfo=D.note2Info=D._38o=V,D._87I.clear(),D.interactiveInfo=J.isInteractive(c)?{}:V,D._3O(),D._55O=J.isEditable(c)?{_42O:J.isRectEditable(c),_43O:J.isPointEditable(c),_56O:J.isRotationEditable(c)}:V,D._6I=D._81o()}return D._6I},_3O:function(){},getPosition:function(){return Hp},_68o:function(r,j){r&&this._87I.add(po(r,j))},_81o:function(){var A=this,p=A.s;A._24O(rj,"getLabel"),A._24O(_d,"getLabel2"),A._26O(Bq,"getNote"),A._26O(ho,"getNote2"),A._15O(),A._55O&&A._48O();var I;if(A._87I.each(function(H){I=Co(I,H)}),I){var c=A.isShadowed(),U=p("shadow2"),o=Xn(I);U?(o.x+=p("shadow2.offset.x"),o.y+=p("shadow2.offset.y"),Pm(o,p("shadow2.blur"))):c&&(o.x+=p("shadow.offset.x"),o.y+=p("shadow.offset.y"),Pm(o,p("shadow.blur"))),I=Co(I,o)}return A._87I.clear(),I},_42:function(n){var v=this,L=v._data,Q=v.gv,U=v.s,Z=U("opacity"),K=this.isShadowed(),p=U("shadow2");if(K||p){var q=n.shadowOffsetX,x=n.shadowOffsetY,H=n.shadowBlur,$=n.shadowColor,j=Q.getZoom()*B.devicePixelRatio,G=K?"shadow":"shadow2";n.shadowOffsetX=U(G+".offset.x")*j,n.shadowOffsetY=U(G+".offset.y")*j,n.shadowBlur=U(G+".blur")*j,n.shadowColor=K?v.getSelectColor():U(G+".color")}if(Z!=V){var k=n.globalAlpha;n.globalAlpha=Z}v._80o(n),Q.isLabelVisible(L)&&((!Q._drawForChecking||U("label.selectable"))&&Er(n,v.labelInfo),(!Q._drawForChecking||U("label2.selectable"))&&Er(n,v.label2Info)),Q.isNoteVisible(L)&&(ik(n,v.noteInfo),ik(n,v.note2Info)),v._99O(n),Z!=V&&(n.globalAlpha=k),(K||p)&&(n.shadowOffsetX=q,n.shadowOffsetY=x,n.shadowBlur=H,n.shadowColor=$)},_80o:function(){},_47O:function(){},_24O:function(R,X){var r=this,d=r._data,l=r.gv,g=r.s,O=l[X](d);if(O!=V){var v=g(R+".scale"),p=g(R+".max"),c=g(R+".position"),x=r[R+"Info"]={label:O,scale:v,color:l[X+"Color"](d),font:g(R+".font"),opacity:g(R+".opacity"),align:g(R+".align"),rotation:r.getRotation(g(R+".rotation"),!1,c),background:l[X+"Background"](d)},C=zn(x,O);p>0&&p<C.width&&(x.labelWidth=C.width,C.width=p),1!==v&&(C.width*=v,C.height*=v);var t=r.getPosition(c,g(R+".offset.x"),g(R+".offset.y"),C,g(R+".position.fixed"));if(C.x=t.x-C.width/2,C.y=t.y-C.height/2,r._68o(x.rect=C,x.rotation),1!==v){var S=C.width/v,s=C.height/v;x.rect={x:t.x-S/2,y:t.y-s/2,width:S,height:s}}}},_26O:function(D,A){var G=this,m=G.gv,e=G._data,w=G.s,H=m[A](e);if(H!=V){var t,c,J=w(D+".scale"),X=G[D+"Info"]={note:H,scale:J,data:e,view:m,expanded:w(D+".expanded"),font:w(D+".font"),color:w(D+".color"),opacity:w(D+".opacity"),align:w(D+".align"),icon:w(D+".icon"),backgroundImage:w(D+".backgroundImage"),borderWidth:w(D+".border.width"),borderColor:w(D+".border.color"),background:m[A+"Background"](e)},T=G.getPosition(w(D+".position"),w(D+".offset.x"),w(D+".offset.y")),j=T.x,Q=T.y;if(X.expanded){var C,W=w(D+".max"),o=w(D+".backgroundImage");o?(o=Cc(o),C={width:Fe(o,e),height:Dm(o,e)}):C=zn(X,H),C.width+=6,C.height+=2,W>0&&W<C.width&&(X.labelWidth=C.width,C.width=W),t=C.width,c=C.height+8,X.clickRect={x:j-t*J/2,y:Q-c*J,width:t*J,height:c*J*C.height/c}}else{var i=w(D+".icon");i?(i=Cc(i),t=Fe(i,e),c=Dm(i,e)):(t=12,c=18),X.clickRect={x:j-t*J/2,y:Q-c*J,width:t*J,height:c*J}}X.rect={x:j-t/2,y:Q-c*J/2-c/2,width:t,height:c};var K=L(X.borderWidth/2)*J;G._68o({x:j-t*J/2-K,y:Q-c*J-K,width:t*J+2*K,height:c*J+2*K})}},_48O:function(){},_99O:function(t){var i=this,l=i._38o;if(l){var J=i.gv,W=i._data,n=l.icons,C=i.interactiveInfo;C&&(C._38o={});for(var T in n){var a=n[T],q=l.rects[T];if(q){C&&(C._38o[T]=[]);var L=Th(a.opacity,W,J),j=Th(a.names,W,J),N=j?j.length:0,M=q.rotation;if(L!=V){var v=t.globalAlpha;t.globalAlpha*=L}for(var R=0;N>R;R++){var H=j[R],Y=Cc(H),O=q[R];if(M){var s=O.x+O.width/2,K=O.y+O.height/2;t.save(),Sg(t,s,K),Nh(t,M),Sg(t,-s,-K)}C&&C._38o[T].push(t.interactiveInfo={compInfos:[],matrix:M?new Ge(M,s,K).appendTranslate(-s,-K):new Ge}),kr(t,Y,Th(a.stretch,W,J),O.x,O.y,O.width,O.height,i._data,i.gv),t.interactiveInfo=V,M&&t.restore()}L!=V&&(t.globalAlpha=v)}}}}});var Hm=function(Y,Q){Le(Hm,this,[Y,Q])};ym(Hm,yl,{_checkEmptyRect:!0,_40O:function(B,c){var l=this,U=l.s,d=B.rect;(B.borderColor=l.gv.getBorderColor(l._data))&&(B.borderType=U("border.type"),B.borderWidth=U("border.width"),B.borderPadding=U("border.padding"),c=g(c,B.borderPadding+B.borderWidth/2));var e=l._data.getScale(),j=g(1,g(r(e.x),r(e.y)));if(B.selectWidth=l.getSelectWidth()){var C=l.gv._zoom;B.selectType=U("select.type"),B._97o=l.getSelectColor(),B.selectPadding=U("select.padding"),c=g(c,(B.selectPadding+B.selectWidth/2/C)/j)}c>0&&(c*=j,d=Xn(d),Pm(d,c)),l._68o(d)},_39O:function(L,S){var $,H=this,W=S.rect;if(S.borderWidth>0&&($=S.borderPadding,L.strokeStyle=S.borderColor,L.lineWidth=S.borderWidth,qp(L,S.borderType,{x:W.x-$,y:W.y-$,width:W.width+2*$,height:W.height+2*$}),L.stroke()),S.selectWidth>0){var _=H.gv._zoom;if($=S.selectPadding,L.strokeStyle=S._97o,L.lineWidth=S.selectWidth/_,S.rotation!=V){L.save(),L.translate(S.position.x,S.position.y),L.rotate(S.rotation);var q=H._data,z=q.getWidth(),U=q.getHeight(),t=S.scale,r=S.anchor;W={x:t.x*-z*r.x,y:t.y*-U*r.y,width:t.x*z,height:t.y*U}}qp(L,S.selectType,{x:W.x-$,y:W.y-$,width:W.width+2*$,height:W.height+2*$}),S.rotation!=V&&L.restore(),L.stroke()}},dispose:function(){var J=this,U=J._htmlView;Hm.superClass._3O.call(J),U&&(U.onHTMLRemoved&&U.onHTMLRemoved(),zg(U))},_3O:function(){var K=this,x=K.s,e=K._data,Q=K.gv,z=Q.getShape(e),h=K.getBodyColor(),L=x("shape.border.color"),l=K._83o=z?{shape:z,_53o:K.getBodyColor("shape.background"),_27Q:Cc(x("shape.repeat.image"),h),shapeGradientPack:x("shape.gradient.pack"),_54o:x("shape.border.width"),_55o:L,shapeBorderRepeatImage:Cc(x("shape.border.repeat.image"),L),_56o:x("shape.border.3d"),_57o:x("shape.border.3d.color"),_58o:x("shape.border.3d.accuracy"),shapeGradient:x("shape.gradient"),_59o:x("shape.gradient.color"),_60o:x("shape.border.pattern"),_61o:x("shape.border.cap"),_62o:x("shape.border.join"),shapeForeground:x("shape.foreground"),bodyColor:h,gray:x("2d.gray")}:{img:Cc(Q.getImage(e),h),bodyColor:h,gray:x("2d.gray"),stretch:x("image.stretch")};if(O&&!m);else{var p,P=l.img;P&&P.renderHTML?(K._htmlInfo&&K._htmlInfo.img!==P&&(K._htmlInfo=V),K._htmlInfo||(K._htmlInfo={img:P,cache:{}}),p=P.renderHTML(e,Q,K._htmlInfo.cache)):K._htmlInfo=V,K._htmlView&&K._htmlView!==p&&(K._htmlView.onHTMLRemoved&&K._htmlView.onHTMLRemoved(),zg(K._htmlView.getView?K._htmlView.getView():K._htmlView)),(K._htmlView=p)&&Q.appendHTML(p)&&(p.onHTMLAddedSync&&p.onHTMLAddedSync(),p.onHTMLAdded&&aq(p.onHTMLAdded)),l.rect=e.getRect(),l.position=e.p(),l.scale=e.getScale(),l.anchor=e.getAnchor(),l.rotation=e.getRotation(),z===Rq&&(l._63o=x("shape.depth"));var I=0;if(z)I=Pb(V,l._54o/2,l._62o),K.s("shape.dash")&&(I=g(I,(K.s("shape.dash.width")||l._54o)/2));else if(P&&P.boundExtend)if(I=Th(P.boundExtend,e,Q),P.boundExtendAbsolute){var W=e.getScale();I/=Q._zoom*g(1,g(r(W.x),r(W.y)))}else if(!Th(P.fitSize,e,Q)){var T=Th(P.width,e,Q),c=Th(P.height,e,Q);I*=g(e.getWidth()/T,e.getHeight()/c)}K._40O(l,I);var k=oo(e,Q.isSelected(e)),Y=x("clip.percentage");if(1>Y&&(0>Y&&(Y=0),l.clipRect=hc(e.getAnchorRect(),x("clip.direction"),Y,k)),z){var o=x("shape.fill.clip.percentage");1>o&&(0>o&&(o=0),l.shapeClipRect=hc(e.getAnchorRect(),x("shape.fill.clip.direction"),o,k));var J=x("shape.foreground.clip.percentage");1>J&&(0>J&&(J=0),l.shapeForegroundClipRect=hc(e.getAnchorRect(),x("shape.foreground.clip.direction"),J,k))}}},getPosition:function(d,s,i,Q){var J=Dn(d,this._83o.rect,Q);return J.x+=s,J.y+=i,J},_80o:function(f){var a=this,k=a.s,e=a.gv,W=a._data,t=a._83o,h=t.rect,N=t.position,c=t.rotation,x=t.anchor,L=t.scale,U=t.shape,H=t.clipRect;if(!a._checkEmptyRect||h.width>0&&h.height>0){var b=W.getSize();if(b.x=-b.width*x.x,b.y=-b.height*x.y,f.save(),Sg(f,N.x,N.y),Nh(f,c),wk(f,L.x,L.y),H&&(f.beginPath(),f.rect(H.x,H.y,H.width,H.height),f.clip()),e._drawForChecking&&t.img&&Th(t.img.pixelPerfect,W,e)===!1)Wq(f,b.x,b.y,b.width,b.height,"#888888");else if(a.freeDraw)a.freeDraw(f,b,t);else if(U){var _,A,J,M,Q=t._60o,m=Kg(f,Q),q=t._27Q,C=t._54o,n=t.shapeGradientPack,T=t.gray,R=f.lineJoin,D=f.lineCap,K=function(P){return T?B.toGrayColor(P):P};"roundRect"===U?_=k("shape.corner.radius"):"polygon"===U?_=k("shape.polygon.side"):"arc"===U&&(_=k("shape.arc.from"),A=k("shape.arc.to"),J=k("shape.arc.close"),M=k("shape.arc.oval")),f.lineJoin=t._62o,f.lineCap=t._61o;var u=K(t._53o);if(u||q||n){var P=t.shapeClipRect;P&&(f.save(),f.beginPath(),f.rect(P.x,P.y,P.width,P.height),f.clip()),qp(f,U,b,_,A,J,M),n?bl(f,n,function(k){return to(k,t.bodyColor)}):q?_k(f,q,K(t.bodyColor),null,W,e):lb(f,u,t.shapeGradient,K(t._59o),b),f.fill(),n&&f.restore(),P&&f.restore(),f!==m&&qp(m,U,b,_,A,J,M)}else qp(m,U,b,_,A,J,M);var d=t.shapeForeground;if(d){f.save();var X=t.shapeForegroundClipRect;X&&(f.beginPath(),f.rect(X.x,X.y,X.width,X.height),f.clip()),qp(f,U,b,_,A,J,M),lb(f,d,k("shape.foreground.gradient"),K(k("shape.foreground.gradient.color")),b),f.fill(),f.restore()}if(C>0){var I=k("shape.border.width.absolute");I&&(f.save(),f.setTransform(1,0,0,1,0,0)),f.lineWidth=C;var E=K(t._55o);t.shapeBorderRepeatImage?$d(f,t.shapeBorderRepeatImage,E,null,W,e):f.strokeStyle=E,f.stroke(),I&&f.restore(),t._56o&&Ph(f,E,K(t._57o),C,e._zoom,t._58o)}if(Ze(f,Q),k("shape.dash")){var F=k("shape.dash.width")||C;if(F>0){Q=k("shape.dash.pattern");var m=Kg(f,Q,a._2Q("shape.dash.offset"));m!==f&&qp(m,U,b,_,A,J,M),a._1Q(f,"shape",F,Q)}}Kl(f,u,t._63o,b),f.lineJoin=R,f.lineCap=D}else{var j=a.interactiveInfo;j&&(f.interactiveInfo=j.bodyInfo={compInfos:[],matrix:new Ge(c,N.x,N.y,L.x,L.y)}),t.gray&&(f.compGray=!0);var s=t.img;s&&s.cacheRule!=V&&(s=Gn(f,s,t.stretch,b.width,b.height,W,e,t.bodyColor)),kr(f,s,t.stretch,b.x,b.y,b.width,b.height,W,e,t.bodyColor),f.compGray=!1,f.interactiveInfo=V}f.restore()}a._39O(f,t)},_48O:function(){},_47O:function(){}});var lo=function(M,s){Le(lo,this,[M,s])},Jq=function(U,Z,E,c){var q=Lf(U,Z);return E=c?s(E,q):sg(E,q),q?E/=q:E=0,{x:U.x+(Z.x-U.x)*E,y:U.y+(Z.y-U.y)*E}};ym(lo,yl,{_3O:function(){var T,s=this,q=s._data,t=s.gv,f=s.s,C=f(mf),o=q.isLooped(),A=f("edge.width"),R=s.getBodyColor("edge.color"),K=f("edge.center"),G=f("edge.offset"),X=t.getBorderColor(q),b=X?f("border.width"):0,u=s.getSelectWidth(),z=q._40I,e=q._41I,J=s._78o=z&&e?{looped:o,type:C,width:A,center:K,color:R,repeatImage:Cc(f("edge.repeat.image"),R),borderColor:X,borderWidth:b,_97o:u?s.getSelectColor():V,selectWidth:u,pattern:f("edge.pattern"),cap:f("edge.cap"),join:f("edge.join"),is3d:f("edge.3d"),_67o:f("edge.3d.color"),_66o:f("edge.3d.accuracy"),gray:f("2d.gray")}:V;if(J){var Q=B.getEdgeType(C);if(Q){var p=Q(q,Pg(s,t,q,o,C),t,s._19Q);p.points&&p.points.size()>1?(J.edgeTypeInfo=p,T=lq(J.edgeTypeInfo.points)):p[cg]&&p.rect&&(J.edgeTypeInfo=p,T=p.rect)}else{var P=f("edge.source.anchor.x"),W=f("edge.source.anchor.y"),Y=f("edge.target.anchor.x"),v=f("edge.target.anchor.y"),H=db(t,q,"source"),m=db(t,q,"target");if(C===Jd){var j=J.points=f(go)||io,i=j.size();J.segments=f("edge.segments");var h=P!==$||W!==$||hf(z),d=Y!==$||v!==$||hf(e);if(!K)if(G)h||(H=Jq(H,i?j.get(0):m,G,i)),d||(m=Jq(m,i?j.get(i-1):H,G,i));else{var L;h||(L=Ag(H,i?j.get(0):m,Ak(t,z)),L&&(H={x:L[0],y:L[1]})),d||(L=Ag(i?j.get(i-1):H,m,Ak(t,e)),L&&(m={x:L[0],y:L[1]}))}T=Co(lq(J.points),lq(H,m))}else{var y=Pg(s,t,q,o,C);if(s._19Q||(y=-y),o)H=Xn(H),H.x=t.getNodeRect(z).x,J.radius=y,T={x:H.x-y,y:H.y-y,width:2*y,height:2*y};else{var M=Lf(H,m),D=sg(G,M),r={x:D,y:y},F={x:M-D,y:y},l=I(m.y-H.y,m.x-H.x),O=J.mat=new qf(l);if(J.orienAngle=l,J.angle=m.x<H.x?l+Z:l,J.rect={x:r.x,y:r.y,width:F.x-r.x,height:0},J.origin=H,r=O.tf(r),r.x+=H.x,r.y+=H.y,F=O.tf(F),F.x+=H.x,F.y+=H.y,K){var S={x:M,y:0};S=O.tf(S),S.x+=H.x,S.y+=H.y,T=lq([H,r,F,S]),J.c1=H,J.c2=S}else T=lq(r,F);H=r,m=F}}J.sourcePoint=H,J.targetPoint=m,q._lastSourcePoint=H,q._lastTargetPoint=m}var N=0;f("edge.dash")&&(N=f("edge.dash.width")||A);var E="square"===J.cap?.71:.5;Pb(T,g(N*E,A*E+b+u),J.join),s._68o(T)}},getRotation:function(H,M,e){H=H||0;var B=this._78o;if(B){var C,m=B.angle,Q=B.points,v=B.edgeTypeInfo;if(m!=V)return M?B.orienAngle+H:m+H;if(v&&v[cg])return v.getRotation?v.getRotation(this,H,M,e):0;if(v&&v.points){var Z=v.points;return C=Z.size(),ej[e]?C&&0===C%2?Gb(Z.get(C/2-1),Z.get(C/2),M,H):H:Fp[e]?Gb(Z.get(0),Z.get(1),M,H):Gb(Z.get(C-2),Z.get(C-1),M,H)}if(Q)return C=Q.size(),ej[e]?C&&0===C%2?Gb(Q.get(C/2-1),Q.get(C/2),M,H):H:Fp[e]?Gb(B.sourcePoint,C?Q.get(0):B.targetPoint,M,H):Gb(C?Q.get(C-1):B.sourcePoint,B.targetPoint,M,H)}return H},getPosition:function(C,q,t,V,D){var d=this._78o;if(d){var j,z=d.type,B=d.points,I=d.edgeTypeInfo,F=d.sourcePoint,H=d.targetPoint;if(!z)return d.looped?{x:F.x-d.radius+q,y:F.y+t}:(D&&F&&H&&(F.x>H.x||F.x===H.x&&F.y>H.y)&&(C=Xf[C],t=-t),j=Dn(C,d.rect,V),j.x+=q,j.y+=t,j=d.mat.tf(j),j.x+=d.origin.x,j.y+=d.origin.y,j);if(I&&I[cg])return I.getPosition?I.getPosition(this,C,q,t,V,D):{x:(F.x+H.x)/2,y:(F.y+H.y)/2};if(B){var j,p=B.size();if(ej[C]){if(p){var M=p%2;if(0===M)return di(B.get(p/2-1),B.get(p/2),C,q,t,V,D);j=B.get((p-M)/2)}else j={x:(F.x+H.x)/2,y:(F.y+H.y)/2};return j=Dn(C,{x:j.x,y:j.y,width:0,height:0},V),j.x+=q,j.y+=t,j}return Fp[C]?di(F,p?B.get(0):H,C,q,t,V,D):di(p?B.get(p-1):F,H,C,q,t,V,D)}if(I){var K=I.points,p=K.size();if(ej[C]){var M=p%2;return 0===M?di(K.get(p/2-1),K.get(p/2),C,q,t,V,D):(j=K.get((p-M)/2),j=Dn(C,{x:j.x,y:j.y,width:0,height:0},V),j.x+=q,j.y+=t,j)}return Fp[C]?di(K.get(0),K.get(1),C,q,t,V,D):di(K.get(p-2),K.get(p-1),C,q,t,V,D)}}return Hp},_42:function(l){this._78o&&lo.superClass._42.call(this,l)},drawPath:function(A,n){A.beginPath();var Y=n.type,M=n.points,I=n.segments,p=n.edgeTypeInfo;if(!Y||M){var e=n.sourcePoint,N=e.x,q=e.y,K=n.targetPoint,l=K.x,s=K.y;if(Y)if(I){var W=new le({x:N,y:q});W.addAll(M),W.add({x:l,y:s}),gh(A,W,I)}else A.moveTo(N,q),M.each(function(i){A.lineTo(i.x,i.y)}),A.lineTo(l,s);else n.looped?A.arc(N,q,n.radius,0,J,!0):n.center?(A.moveTo(n.c1.x,n.c1.y),A.lineTo(N,q),A.lineTo(l,s),A.lineTo(n.c2.x,n.c2.y)):(A.moveTo(N,q),A.lineTo(l,s))}else p&&(p.points?gh(A,p.points,p.segments):p[cg]&&p[cg](A,p))},_80o:function(q){var T=this,y=T.s,K=T._78o,W=K.width,Z=K.selectWidth,c=K.borderWidth,n=K.repeatImage,C=q.lineJoin,V=q.lineCap,i=K.gray,Y=K.pattern;q.lineJoin=K.join,q.lineCap=K.cap,T.drawPath(Kg(q,Y),K);var w=y("edge.width.absolute");w&&(q.save(),q.setTransform(1,0,0,1,0,0)),Z&&(q.strokeStyle=K._97o,q.lineWidth=W+2*(c+Z),q.stroke()),c&&(q.strokeStyle=i?B.toGrayColor(K.borderColor):K.borderColor,q.lineWidth=W+2*c,q.stroke());var S=i?B.toGrayColor(K.color):K.color;if(n?$d(q,n,S,null,T._data,T.gv):q.strokeStyle=S,q.lineWidth=W,q.stroke(),K.is3d){var X=i?B.toGrayColor(K._67o):K._67o;Ph(q,S,X,W,T.gv._zoom,K._66o)}if(Ze(q,Y),y("edge.dash")){Y=y("edge.dash.pattern");var s=Kg(q,Y,T._2Q("edge.dash.offset"));s!==q&&T.drawPath(s,K),T._1Q(q,"edge",y("edge.dash.width")||W,Y)}w&&q.restore(),q.lineJoin=C,q.lineCap=V},_48O:function(){},_47O:function(){}});var Yj=function(V,j){Le(Yj,this,[V,j])};ym(Yj,Hm,{_3O:function(){var G,m,d=this,g=d.s,t=d._data,Q=d.gv;if(d._88I=V,t.isExpanded()&&t.eachChild(function(Y){if(Zb(Y)){var X=Q.getBoundsForGroup(Y);X&&(m||(m=[]),m.push(X),G=Co(G,X))}}),G){var s=Q.getLabel(t),a=g("group.type"),J=g("group.border.width")||0,F=g("group.border.width.absolute"),z=J/2;F&&(J/=Q._zoom),G=_g(a,m,G),ab(G,t,"group.padding",1),Pm(G,J);var u=d._88I={type:a,rect:G,_64o:G};if(!a&&s!=V){var y,C=d.labelInfo={label:s,color:g("group.title.color"),font:g("group.title.font"),align:g("group.title.align")},P=zn(C,s),l=P.width+J,x=P.height+J,H=g("group.title.align"),q=g("group.title.orientation");if(q===hp||q===Tl?(G.height+=J,l>G.width&&(G.width=l)):(q===ar||q===ci)&&(G.width+=J,l>G.height&&(G.height=l)),y=H===ar?G.x:H===ci?G.x+G.width-l:G.x+G.width/2-l/2,q===Tl)u.titleRect={x:G.x,y:G.y+G.height,width:G.width,height:x},u.rect={x:G.x,y:G.y,width:G.width,height:G.height+x},C.rect={x:y,y:G.y+G.height,width:l,height:x};else if(q===ar){var Y=u.titleRect={x:G.x-x,y:G.y,width:x,height:G.height};u.rect={x:G.x-x,y:G.y,width:G.width+x,height:G.height},C.rect={x:Y.x+x/2-G.height/2,y:Y.y+G.height/2-x/2,width:G.height,height:x},C.rotation=-Math.PI/2}else if(q===ci){var Y=u.titleRect={x:G.x+G.width,y:G.y,width:x,height:G.height};u.rect={x:G.x,y:G.y,width:G.width+x,height:G.height},C.rect={x:Y.x+x/2-G.height/2,y:Y.y+G.height/2-x/2,width:G.height,height:x},C.rotation=Math.PI/2}else u.titleRect={x:G.x,y:G.y-x,width:G.width,height:x},u.rect={x:G.x,y:G.y-x,width:G.width,height:G.height+x},C.rect={x:y,y:G.y-x-z,width:l,height:x+J}}d._40O(u,g("group.border.width")/2)}else Yj.superClass._3O.call(d)},getPosition:function(p,V,z,J){var f=this._88I;if(f){var M=Dn(p,f.rect,J);return M.x+=V,M.y+=z,M}return Yj.superClass.getPosition.apply(this,arguments)},_24O:function(C,U){var d=this._88I;(!d||d.type||"label2"===C)&&Yj.superClass._24O.call(this,C,U)},_80o:function(Z){var K=this,H=K._88I;if(H){var J=K._data,s=K.s,O=K.gv,o=H.type,q=H.rect,F=H._64o,p=H.titleRect,C=K.getBodyColor(),n=Cc(s("group.image"),C),Q=s("group.image.stretch"),X=K.getBodyColor("group.background"),u=Cc(s("group.repeat.image"),C),r=s("group.gradient.pack"),L=s("group.gradient"),I=s("group.gradient.color"),B=s("group.border.width"),V=s("group.border.color"),c=s("group.border.pattern"),w=s("group.title.orientation"),N=s("group.depth"),R=s("group.border.radius"),j=s("group.border.join"),d=s("group.border.cap"),e=s("group.border.width.absolute");e&&(B/=O._zoom);var g=V,y=s("group.border.repeat.image");if(y&&(y=Cc(y,V))&&(g=Mn(Z,y,V,null,J,O)),o){var W=Z.lineJoin,G=Z.lineCap;if(Z.lineJoin=j,Z.lineCap=d,n){if(Z.save(),qp(Z,o,q,R),Z.clip(),kr(Z,n,Q,q.x,q.y,q.width,q.height,J,O,C),Z.restore(),B>0){var U=Kg(Z,c);qp(U,o,q,R),Z.lineWidth=B,Z.strokeStyle=g,Z.stroke(),Ze(Z,c)}}else{var U=Kg(Z,c);X||u||r?(qp(Z,o,q,R),r?bl(Z,r,function(U){return to(U,C)}):u?_k(Z,u,C,null,J,O):lb(Z,X,L,I,q),Z.fill(),r&&Z.restore(),Z!==U&&qp(U,o,q,R)):qp(U,o,q,R),B>0&&(Z.lineWidth=B,Z.strokeStyle=g,Z.stroke()),Ze(Z,c),o===Rq&&Kl(Z,X,N,q)}Z.lineJoin=W,Z.lineCap=G}else{var P=s("group.title.background");if((!R||0>R)&&(R=0),n)kr(Z,n,Q,F.x,F.y,F.width,F.height,J,O,K.getBodyColor());else if(X||u)if(u?_k(Z,u,C,null,J,O):lb(Z,X,L,I,F),0===B)qp(Z,Rq,F),Z.fill(),Kl(Z,X,N,F);else{switch(Z.beginPath(),w){case Tl:xm(Z,F.x,F.y,F.width,F.height,R,R,0,0);break;case ar:xm(Z,F.x,F.y,F.width,F.height,0,R,0,R);break;case ci:xm(Z,F.x,F.y,F.width,F.height,R,0,R,0);break;case hp:xm(Z,F.x,F.y,F.width,F.height,0,0,R,R)}Z.fill()}if(p&&P)if(0===B)Wq(Z,p.x,p.y,p.width,p.height,P),Kl(Z,P,N,p);else{switch(Z.beginPath(),Z.fillStyle=P,w){case Tl:xm(Z,p.x,p.y,p.width,p.height,0,0,R,R);break;case ar:xm(Z,p.x,p.y,p.width,p.height,R,0,R,0);break;case ci:xm(Z,p.x,p.y,p.width,p.height,0,R,0,R);break;case hp:xm(Z,p.x,p.y,p.width,p.height,R,R,0,0)}Z.fill()}if(B>0){var U=Kg(Z,c);if(qp(U,"roundRect",q,R),Z.save(),Z.lineWidth=B,Z.strokeStyle=g,Z.lineJoin=j,Z.lineCap=d,Z.closePath(),Z.stroke(),p&&s("group.splitLine")){var S=p.x,A=p.y,Y=p.width,x=p.height;Z.beginPath(),w===Tl?(Z.moveTo(S,A),Z.lineTo(S+Y,A)):w===ar?(Z.moveTo(S+Y,A),Z.lineTo(S+Y,A+x)):w===ci?(Z.moveTo(S,A),Z.lineTo(S,A+x)):(Z.moveTo(S,A+x),Z.lineTo(S+Y,A+x))}Z.stroke(),Z.restore(),Ze(U,c)}}K._39O(Z,H)}else Yj.superClass._80o.call(K,Z)}});var Gp=function(n,N){Le(Gp,this,[n,N])};ym(Gp,Hm,{_80o:function(M){this._39O(M,this._83o)}});var bk=function(V,F){Le(bk,this,[V,F])};ym(bk,Hm,{_3O:function(){var E=this,k=E._data,H=E.s,l=E.gv,s=k.getPoints(),D=l.getBorderColor(k),Z=D?H("border.width"):0,L=E.getSelectWidth(),n=H("shape.border.width"),x=k.getRect(),i=k.getAnchorRect(),P=l.getBodyColor(k),o=H("shape.border.color"),M=E._99o=s.isEmpty()?V:{rect:x,rotation:k.getRotation(),fillRule:H("shape.fill.rule"),scale:k.getScale(),position:k.p(),points:s,segments:k.getSegments(),bodyColor:P,borderColor:D,borderWidth:Z,_94o:H("shape.border.3d"),_95o:H("shape.border.3d.color"),_96o:H("shape.border.3d.accuracy"),_97o:L?E.getSelectColor():V,selectWidth:L,_53o:H("shape.background"),_27Q:Cc(H("shape.repeat.image"),P),shapeGradientPack:H("shape.gradient.pack"),_54o:n,_55o:o,shapeBorderRepeatImage:Cc(H("shape.border.repeat.image"),o),shapeGradient:H("shape.gradient"),_59o:H("shape.gradient.color"),_60o:H("shape.border.pattern"),_61o:H("shape.border.cap"),_62o:H("shape.border.join"),shapeForeground:H("shape.foreground"),gray:H("2d.gray")};if(M){i.x+=M.position.x,i.y+=M.position.y,M.gradientRect=i;var G=k.getScale(),v=g(1,g(r(G.x),r(G.y)));H("shape.dash")&&H("shape.dash.width")>n&&(n=H("shape.dash.width"));var p,C=H("shape.border.width.absolute");p=C?(n+Z+L)/E.gv._zoom/v:n*("square"===M._61o?.71:.5)+Z+L/E.gv._zoom/v,p&&(p*=v,x=Xn(x),Pb(x,p,M._62o)),E._68o(x);var X=oo(k,l.isSelected(k)),A=H("clip.percentage");1>A&&(0>A&&(A=0),M.clipRect=hc(k.getAnchorRect(),H("clip.direction"),A,X));var t=H("shape.fill.clip.percentage");1>t&&(0>t&&(t=0),M.shapeClipRect=hc(k.getAnchorRect(),H("shape.fill.clip.direction"),t,X));var u=H("shape.foreground.clip.percentage");1>u&&(0>u&&(u=0),M.shapeForegroundClipRect=hc(k.getAnchorRect(),H("shape.foreground.clip.direction"),u,X))}},getPosition:function(y,G,L,q){var w=this._99o;if(w){var $=Dn(y,w.rect,q);return $.x+=G,$.y+=L,$}return Hp},_42:function(H){this._99o&&bk.superClass._42.call(this,H)},_80o:function(O){var F,C=this,X=C.s,k=C._99o,z=k.position,K=k.scale,V=k.rotation,v=k.borderWidth,Q=k.selectWidth/C.gv._zoom,J=k._27Q,x=k.shapeGradientPack,d=k._54o,q=k.clipRect,o=k.shapeClipRect,H=k.points,S=k.segments,s=C._data.isClosePath(),t=k.fillRule,c=k.gray,g=function(Y){return c?B.toGrayColor(Y):Y},Y=g(k._53o),P=Y||J||x;O.save(),Sg(O,z.x,z.y),Nh(O,V),wk(O,K.x,K.y),q&&(O.beginPath(),O.rect(q.x,q.y,q.width,q.height),O.clip()),P&&o&&(O.save(),O.beginPath(),O.rect(o.x,o.y,o.width,o.height),O.clip()),Sg(O,-z.x,-z.y);var i=k._60o,L=Kg(O,i),f=O.lineJoin,G=O.lineCap;O.lineJoin=k._62o,O.lineCap=k._61o;var j=g(k.bodyColor);P?(gh(O,H,S,s),x?bl(O,x,function(O){return to(O,k.bodyColor)}):J?_k(O,J,j,null,C._data,C.gv):(F=j?j:Y,lb(O,F,k.shapeGradient,g(k._59o),k.gradientRect)),O.fill(t),x&&O.restore(),o&&(O.restore(),Sg(O,-z.x,-z.y)),L!==O&&gh(L,H,S,s)):gh(L,H,S,s);var Z=k.shapeForeground;if(Z){O.save();var T=k.shapeForegroundClipRect;T&&(Sg(O,z.x,z.y),O.beginPath(),O.rect(T.x,T.y,T.width,T.height),O.clip(),Sg(O,-z.x,-z.y)),gh(O,H,S,s),lb(O,Z,X("shape.foreground.gradient"),g(X("shape.foreground.gradient.color")),k.gradientRect),O.fill(t),O.restore()}var W=X("shape.border.width.absolute");if(W&&(O.save(),O.setTransform(1,0,0,1,0,0)),Q&&(O.strokeStyle=k._97o,O.lineWidth=d+2*(v+Q),O.stroke()),v&&(O.strokeStyle=g(k.borderColor),O.lineWidth=d+2*v,O.stroke()),d&&(F=g(k._55o),k.shapeBorderRepeatImage?$d(O,k.shapeBorderRepeatImage,F,null,C._data,C.gv):(!Y&&j&&(F=j),O.strokeStyle=F),O.lineWidth=d,O.stroke(),k._94o&&Ph(O,F,g(k._95o),d,C.gv._zoom,k._96o)),Ze(O,i),X("shape.dash")){var I=X("shape.dash.width")||d;if(I>0){i=X("shape.dash.pattern");var L=Kg(O,i,C._2Q("shape.dash.offset"));L!==O&&gh(L,H,S,s),C._1Q(O,"shape",I,i)}}W&&O.restore(),O.lineJoin=f,O.lineCap=G,O.restore()},_48O:function(){},_47O:function(){}});var ri=function(r,Y){Le(ri,this,[r,Y])};ym(ri,bk,{getRotation:function(o,g,K){o=o||0;var x=this._data.getPoints(),p=x.size();return p>1?ej[K]?p&&0===p%2?Gb(x.get(p/2-1),x.get(p/2),g,o):o:Fp[K]?Gb(x.get(0),x.get(1),g,o):Gb(x.get(p-2),x.get(p-1),g,o):o},getPosition:function(w,s,e,t,y){var M=this._data.getPoints(),L=M.size();if(L>1){if(ej[w]){var K=L%2;if(0===K)return di(M.get(L/2-1),M.get(L/2),w,s,e,t,y);var W=M.get((L-K)/2),v={x:W.x,y:W.y,width:0,height:0};return W=Dn(w,v,t),W.x+=s,W.y+=e,W}return Fp[w]?di(M.get(0),M.get(1),w,s,e,t,y):di(M.get(L-2),M.get(L-1),w,s,e,t,y)}return Hp}});var We=function(H,P){Le(We,this,[H,P])};ym(We,Hm,{_3O:function(){var R=this;We.superClass._3O.call(R);var n=R.s,k=R._83o;R._82o=k.img||k.shape?V:{background:R.getBodyColor("grid.background"),depth:n("grid.depth"),rect:k.rect,_88o:n("grid.cell.depth"),cellBorderColor:n("grid.cell.border.color"),_89o:n("grid.row.count"),_90o:n("grid.column.count"),block:n("grid.block"),_91o:n("grid.block.color"),_92o:n("grid.block.padding"),_93o:n("grid.block.width")}},_80o:function(U){var m=this,u=m._82o;if(!u)return We.superClass._80o.call(m,U),void 0;var b,l,$=m._data,E=u.background,_=u.rect,M=u.block,T=u._91o,O=u._92o,k=u._93o,H=u._88o,a=u.cellBorderColor,F=u._89o,i=u._90o;if(E)if(Wq(U,_.x,_.y,_.width,_.height,E),Kl(U,E,u.depth,_),H)for(b=0;F>b;b++)for(l=0;i>l;l++)_=$.getCellRect(b,l),_&&Kl(U,E,H,_);else if(a){for(U.beginPath(),b=0;F>b;b++)for(l=0;i>l;l++)_=$.getCellRect(b,l),_&&U.rect(_.x,_.y,_.width,_.height);U.strokeStyle=a,U.lineWidth=1,U.stroke()}if("h"===M)for(b=0;F>b;b++)_=Co($.getCellRect(b,0),$.getCellRect(b,i-1)),Pm(_,O),hk(U,T,_.x,_.y,_.width,_.height,k);else if("v"===M)for(l=0;i>l;l++)_=Co($.getCellRect(0,l),$.getCellRect(F-1,l)),Pm(_,O),hk(U,T,_.x,_.y,_.width,_.height,k);m._39O(U,m._83o)}});var Xi=function($,i){Le(Xi,this,[$,i])};ym(Xi,Hm,{_checkEmptyRect:!1,_81o:function(){var N=this._data,H=Xi.superClass._81o.call(this),b=N.s("text");if(b!=V){var R,a,A=N.s("text.font"),h=N.s("text.align"),D=N.s("text.vAlign"),i=ts(A,b),T=i.width,M=i.height,d=N.getAnchor(),c=N.getWidth(),J=N.getHeight();"left"===h?R=-c*d.x:"center"===h?R=-c*d.x+(c-T)/2:"right"===h&&(R=c*(1-d.x)-i.width),"top"===D?a=-J*d.y:"middle"===D?a=-J*d.y+(J-M)/2:"bottom"===D&&(a=J*(1-d.y)-i.height);var m,w=N.getMatrix();if(m=lq([w.tf(R,a),w.tf(R+T,a),w.tf(R+T,a+M),w.tf(R,a+M)]),H=Co(H,m),H&&N.s("text.shadow")){var k=Xn(H);k.x+=N.s("text.shadow.offset.x"),k.y+=N.s("text.shadow.offset.y"),Pm(k,N.s("text.shadow.blur")),H=Co(H,k)}}return H}});var rk=Gj.Interactor=function(w){this.gv=this._graphView=w};jm("Interactor",e,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(C){this.gv.fi(C)},setCursor:function(j){gp||this.gv.setCursor(j)},startDragging:function(o){var q=this;q._lastClientPoint=kd(o),q._lastLogicalPoint=q.gv.lp(o),Lj(q,o)},clearDragging:function(){var A=this;A._lastClientPoint=A._lastLogicalPoint=A._logicalPoint=V},autoScroll:function(J){return this.gv.autoScroll(J,this._lastClientPoint)}});var So=V,td=function(g){So.handleWindowTouchMove(g)},mi=function(W){So.handleWindowTouchEnd(W),Y(n,yi,td),Y(n,fn,mi),So=V},fs=function($){So.handleWindowMouseMove($)},Gq=function(s){So.handleWindowMouseUp(s),Y(n,Oq,fs),Y(n,Ce,Gq),So=V},Sq=function(t,b){if(t!==So){var O=jk(b);So?O?So.handleWindowTouchEnd(b):So.handleWindowMouseUp(b):O?(A(n,yi,td),A(n,fn,mi)):(A(n,Oq,fs),A(n,Ce,Gq)),So=t}},No=function(Q){var w=this;w.gv=Q,w._is2d=Q instanceof Gj.GraphView,w._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",sn,"wheel"].forEach(function(s){w.addListener(s)}),w.initImageResource()};ym(No,rk,{enableVR:function(P){var B=this;if(!!B._vrEnable!==P)if(B._vrEnable=P,P)B.gv.vr.mp(B.onVRControllerChange,B);else if(B.gv.vr.ump(B.onVRControllerChange,B),B._vrRayPolyline){var f=B.gv.dm();f.remove(B._vrRayPolyline),f.remove(B._vrRayHitPoint),B._vrRayPolyline=$,B._vrRayHitPoint=$}},onVRControllerChange:function(Z){var S=this,p=Z.property,m=Z.newValue,u=S.gv.vr.getController(m.id),H=u.getRay();H&&("gamepad.button.trigger"===p?"down"===m._62O?S.handle_mousedown(H):So&&Gq(H):"gamepad.pose"===p&&(S.handle_mousemove(H),So&&S.handleWindowMouseMove(H)))},drawVRRay:function(A,I,Q){var R,M=this,i=M.gv,m=M._vrRayPolyline,G=!1;if(m)R=M._vrRayHitPoint;else{var N=i.dm();M._vrRayPolyline=m=new C.Polyline,M._vrRayHitPoint=R=new C.Node,R.s({shape3d:"billboard","shape3d.transparent":!0,"texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),R.setAnchor3d(.5,.5,.499);var B=.2/i.vr.measureOflength;R.s3(B,B,B),m.s("intersect",!1),R.s("intersect",!1),N.add(m),N.add(R),G=!0}if(I){var j=Q.world,k=Q.worldNormal,o=j.x,T=j.y,F=j.z;m.s("shape.border.color","red"),m.setPoints([{x:A.origin.x,y:A.origin.z,e:A.origin.y},{x:o,y:F,e:T}]),R.s("3d.visible",!0),R.p3(o,T,F),R.lookAtDirection([k.x,k.y,k.z],"front")}else{m.s("shape.border.color","blue");var e=new C.Math.Vector3;e.copy(A.direction).setLength(1e3/M.gv.vr.measureOflength).add(A.origin),m.setPoints([{x:A.origin.x,y:A.origin.z,e:A.origin.y},{x:e.x,y:e.z,e:e.y}]),R.s("3d.visible",!1)}i.fi({kind:"vrRayIntersect",ray:A,data:I,intersect:Q,polyline:m,hitNode:R,begin:G})},setPreventEventDefault:function(y,h){var r=this,f=r._eventListeners[y];f?f._prevent=h:r._eventListeners[y]=f={_removal:$,_prevent:h}},removeListener:function(U){var n=this,X=n._eventListeners[U];X&&X._removal&&(X._removal(),X._removal=$)},addListener:function(E){var f=this,R=f._eventListeners[E];if(R||(f._eventListeners[E]=R={_removal:$,_prevent:!0}),!R||!R._removal){var M=function(T){R._prevent&&B.preventDefault(T),f.disabled||("wheel"===E?Zd(f,T):f["handle_"+E](T))};A(f.gv.getView(),E,M),R._removal=function(){Y(f.gv.getView(),E,M)}}},handleWindowTouchMove:function(X){this.handleWindowMouseMove(X)},handleWindowMouseMove:function(X){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",X):(this.handleDownInfo("onBeginDrag",X),this.isDragging=!0))},handleWindowTouchEnd:function(j){this.handleWindowMouseUp(j)},handleWindowMouseUp:function(n){if(this.isDragging&&(this.handleDownInfo("onEndDrag",n),this.isDragging=!1),this.downInfo){var H=this.handle("onUp",n);if(H&&H.data===this.downInfo.data){this.handleMissingUp(n);var p=this,f=2===n.button?"onContextMenu":"onClick";if(!p._dbclickTimer)return p._dbclickTimer=fo(function(){delete p._dbclickTimer,p.handleClick(n,f,H),this.downInfo=V},B.clickDelay),void 0;
dh(p._dbclickTimer),delete p._dbclickTimer,f="onDoubleClick",p.handleClick(n,f,H)}else this.handleDownInfo("onUp",n);this.downInfo=V,this.downComps=V}},handle_mouseleave:function(F){var Y=this,h=Y.gv,t=Y.currentInfo?Y.currentInfo.data:V;if(t){t.s("onLeave")&&t.s("onLeave")(F,t,h),Y.fire("data","onLeave",F,t);var e=Y.currentInfo?Y.currentInfo.hits:V;if(e)for(var c in e)Y.handleLeave(F,c);Y.currentInfo=V}},handle_mousewheel:function(r){r.scrollDelta=r.wheelDelta/40,this.handle("onScroll",r)},handle_DOMMouseScroll:function(V){V.scrollDelta=2===V.axis?-V.detail:0,this.handle("onScroll",V)},handle_touchstart:function(g){this.handle_mousedown(g)},handle_touchmove:function(T){this.handle("onMove",T)},handle_mousedown:function(D){this.isDragging&&(this.handleDownInfo("onEndDrag",D),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",D),this.downInfo&&Sq(this,D)},handle_mousemove:function(F){var H=this,v=H.gv;if(H._hoverTimer&&(dh(H._hoverTimer),delete H._hoverTimer),!v._panning&&!v._moving){var p,U,r,G=H.handle("onMove",F),l=this.currentInfo?this.currentInfo.data:V,e=this.currentInfo?this.currentInfo.hits:V;if(G&&(U=G.data,r=G.hits,H._hoverTimer=fo(function(){dh(H._hoverTimer),delete H._hoverTimer,H.handle("onHover",F,G)},v.getHoverDelay()||B.hoverDelay)),U!==l){if(l&&(l.s("onLeave")&&l.s("onLeave")(F,l,v),this.fire("data","onLeave",F,l)),U&&(U.s("onEnter")&&U.s("onEnter")(F,U,v),this.fire("data","onEnter",F,U)),e)for(p in e)this.handleLeave(F,p);if(r)for(p in r){var u=r[p],y=U._interactPrefix=u.prefix,g=y&&U.a(y+"onEnter")||u.target.onEnter;g&&g.call(u.target,F,U,v,u.point,u.width,u.height),this.fire(u.type,"onEnter",u.event,u.data,u.image,u.comp,u.point,u),U._interactPrefix=null}}else{if(e)for(p in e)r&&r[p]||this.handleLeave(F,p);if(r)for(p in r)if(!e||!e[p]){var u=r[p],y=U._interactPrefix=u.prefix,g=y&&U.a(y+"onEnter")||u.target.onEnter;g&&g.call(u.target,F,U,v,u.point,u.width,u.height),this.fire(u.type,"onEnter",u.event,u.data,u.image,u.comp,u.point,u),U._interactPrefix=null}}this.currentInfo=G}},handle:function(a,L,j){var p,N=this,i=N.gv;if(N._is2d){if(j=j||i.getDataInfoAt(L),!j||!i.isInteractive(j.data))return;if(p=j.ui.interactiveInfo){var t,e=j.data;if(e.s(a)&&e.s(a)(L,e,i),this.fire("data",a,L,e),"body"===j.part&&p.bodyInfo)t="body",j.hits=this.handleImage(t,i.getImage(e),a,L,e,j.point,p.bodyInfo);else if("icons"===j.part&&p._38o){var T=p._38o[j.name];T&&T[j.index]&&(t="icons|"+j.name+"|"+j.index,j.hits=this.handleImage(t,j.icon,a,L,e,j.point,T[j.index]))}}return j}var e,d;if(!j)if(L&&L instanceof C.Math.Ray){var w=i.vr.intersectWorld(L);if(e=w.data,d=w.intersect,N.drawVRRay(L,e,d),!e)return;var D=i.getData3dUI(e);if(p=D.interactiveInfo,!p)return;j={data:e,part:d.part,ui:D}}else{if(j=i.getDataInfoAt(L),!j)return;j&&(j={data:j.data,part:j.part})}if(i.isInteractive(j.data)){if(!d){e=j.data;var D=i.getData3dUI(e);if(j.ui=D,p=D.interactiveInfo,!p)return j;if(d=i.intersectObject(L,e),!d)return}e.s(a)&&e.s(a)(L,e,i),this.fire("data",a,L,e);var O,k=d.part;return"body"!==k&&(O=e.s(k+".image")||e.s("shape3d."+k+".image")),O||(O=e.s("all.image")||e.s("shape3d.image")),O?(p="object"==typeof O?p[O.uuid]:p[O],p&&p.bodyInfo?(j.part="body",j.interactiveInfo=p,j.point=this._convertUVToPoint(d.uv,p),j.image=O,j.hits=this.handleImage("body",O,a,L,e,j.point,p.bodyInfo),j):j):j}},_handleLeaveOrMissing:function(R,P,n){var X="leave"===R?this.currentInfo:this.downInfo;if(X){var f=X.interactiveInfo||X.ui.interactiveInfo;if(f){var i,c,h=X.data;if(this._is2d){if(c=this.gv.lp(P),"body"===X.part&&f.bodyInfo)i="body","leave"===R?this.handleLeaveImage(n,i,this.gv.getImage(h),P,h,c,f.bodyInfo):this.handleMissingUpImage(i,this.gv.getImage(h),P,h,c,f.bodyInfo);else if("icons"===X.part&&f._38o){var g=f._38o[X.name];g&&g[X.index]&&(i="icons|"+X.name+"|"+X.index,"leave"===R?this.handleLeaveImage(n,i,X.icon,P,h,c,g[X.index]):this.handleMissingUpImage(i,X.icon,P,h,c,g[X.index]))}}else{if(!f.bodyInfo)return;var $=this.gv.intersectObject(P,h);c=$&&$.uv?this._convertUVToPoint($.uv,f):{x:1/0,y:1/0},"leave"===R?this.handleLeaveImage(n,"body",X.image,P,h,c,f.bodyInfo):this.handleMissingUpImage("body",X.image,P,h,c,f.bodyInfo)}}}},handleClick:function(N,M,T){var q=this,Y=this.downInfo;if(Y&&T){var h,g=T.interactiveInfo||T.ui.interactiveInfo,F=T.data,f=this.gv;if(F.s(M)&&F.s(M)(N,F,f),q.fire("data",M,N,F),g)if(this._is2d){if(Y.part===T.part){var J=f.lp(N);"body"===T.part&&g.bodyInfo&&(h="body",this.handleClickImage(h,f.getImage(F),M,N,F,J,g.bodyInfo,T))}}else{if(!g.bodyInfo)return;var c=f.intersectObject(N,F);if(!c)return;J=this._convertUVToPoint(c.uv,g),this.handleClickImage("body",Y.image,M,N,F,J,g.bodyInfo,T)}}},handleDownInfo:function(K,t){if(this.downInfo){var s=this.downInfo,z=this.gv,_=s.interactiveInfo||s.ui.interactiveInfo;if(_){var X,c=s.data;if(c.s(K)&&c.s(K)(t,c,z),this.fire("data",K,t,c),this._is2d){var o=z.lp(t);if("body"===s.part&&_.bodyInfo)X="body",this.handleDownInfoImage(X,z.getImage(c),K,t,c,o,_.bodyInfo);else if("icons"===s.part&&_._38o){var P=_._38o[s.name];P&&P[s.index]&&(X="icons|"+s.name+"|"+s.index,this.handleDownInfoImage(X,s.icon,K,t,c,o,P[s.index]))}}else{if(!_.bodyInfo)return;var h=z.intersectObject(t,c);if(!h)return;o=this._convertUVToPoint(h.uv,_),this.handleDownInfoImage("body",s.image,K,t,c,o,_.bodyInfo)}}}},fire:function(n,J,Z,b,P,c,j,R){this.gv.fi({kind:J,type:n,event:Z,data:b,image:P,comp:c,view:this.gv,point:j,width:R?R.width:$,height:R?R.height:$})},handleImage:function(D,e,Z,x,n,f,R){var E={};if(e&&(e=Cc(e))){var w=this.gv,C=R.rect,d=this.convertPoint(f,R);d.inRect&&(e[Z]&&e[Z](x,n,w,d,C.width,C.height),this.fire("image",Z,x,n,e,$,d,C),E[D+"|image"]={target:e,type:"image",image:e,data:n,event:x,point:d,width:C.width,height:C.height});for(var J,k=R.compInfos,O=e,c=k.length-1;c>=0;c--){var H=k[c],p=H.comp;if(d=this.convertPoint(f,H,O,p,w,n),d.inRect){C=H.rect;var N=n._interactPrefix=H.prefix,t=N&&n.a(N+Z)||p[Z];if(t&&(J=t.call(p,x,n,w,d,C.width,C.height)),this.fire("comp",Z,x,n,e,p,d,C),J!==!0&&(e=C.image)&&(e[Z]&&(J=e[Z](x,n,w,d,C.width,C.height)),this.fire("image",Z,x,n,e,$,d,C)),n._interactPrefix=null,E[D+"|"+c]={target:p,type:"comp",comp:p,image:e,data:n,event:x,point:d,width:C.width,height:C.height,prefix:N},this.downComps&&this.downComps.push(p),e&&(E[D+"|"+c+"|image"]={target:e,type:"image",image:e,data:n,event:x,point:d,width:C.width,height:C.height,prefix:N}),J===!0)break}}}return E},handleLeave:function(U,G){return this._handleLeaveOrMissing("leave",U,G)},handleMissingUp:function(h){return this._handleLeaveOrMissing("missing",h)},handleLeaveImage:function(W,n,g,d,l,j,h){if(g&&(g=Cc(g))){var t=this.gv,N=h.rect,k=this.convertPoint(j,h);W===n+"|image"&&(g.onLeave&&g.onLeave(d,l,t,k,N.width,N.height),this.fire("image","onLeave",d,l,g,$,k,N));for(var m,I=h.compInfos,e=g,G=I.length-1;G>=0;G--){var r=I[G],Q=r.comp;k=this.convertPoint(j,r,e,Q,t,l),N=r.rect;var o=l._interactPrefix=r.prefix;if(W===n+"|"+G){var M=o&&l.a(o+"onLeave")||Q.onLeave;M&&(m=M.call(Q,d,l,t,k,N.width,N.height)),this.fire("comp","onLeave",d,l,g,Q,k,N)}if(m!==!0&&(g=N.image)&&W===n+"|"+G+"|image"&&(g.onLeave&&(m=g.onLeave(d,l,t,k,N.width,N.height)),this.fire("image","onLeave",d,l,g,$,k,N)),l._interactPrefix=null,m===!0)break}}},handleMissingUpImage:function(x,y,n,k,V,X){var D="onUp",z=this.downInfo.hits;if(z&&y&&(y=Cc(y))){var R=this.gv,L=X.rect,l=this.convertPoint(V,X);!l.inRect&&z[x+"|image"]&&(y[D]&&y[D](n,k,R,l,L.width,L.height),this.fire("image",D,n,k,y,$,l,L));for(var h,O=X.compInfos,N=y,c=O.length-1;c>=0;c--){var p=O[c],t=p.comp;if(l=this.convertPoint(V,p,N,t,R,k),!l.inRect){L=p.rect;var G=k._interactPrefix=p.prefix;if(z[x+"|"+c]){var o=G&&k.a(G+D)||t[D];o&&(h=o.call(t,n,k,R,l,L.width,L.height)),this.fire("comp",D,n,k,y,t,l,L)}if(h!==!0&&(y=L.image)&&z[x+"|"+c+"|image"]&&(y[D]&&(h=y[D](n,k,R,l,L.width,L.height)),this.fire("image",D,n,k,y,$,l,L)),k._interactPrefix=null,h===!0)break}}}},handleDownInfoImage:function(e,U,y,W,u,w,I){var C=this.downInfo.hits;if(C&&U&&(U=Cc(U))){var i=this.gv,D=I.rect,S=this.convertPoint(w,I);C[e+"|image"]&&(U[y]&&U[y](W,u,i,S,D.width,D.height),this.fire("image",y,W,u,U,$,S,D));for(var V,E=I.compInfos,X=U,Q=E.length-1;Q>=0;Q--){var B=E[Q],F=B.comp;S=this.convertPoint(w,B,X,F,i,u),D=B.rect;var a=u._interactPrefix=B.prefix,t=["onDrag","onEndDrag"].indexOf(y)>=0;if(!t&&C[e+"|"+Q]||t&&this.downComps&&this.downComps.indexOf(F)>=0){var z=a&&u.a(a+y)||F[y];z&&(V=z.call(F,W,u,i,S,D.width,D.height)),this.fire("comp",y,W,u,U,F,S,D)}if(V!==!0&&(U=D.image)&&C[e+"|"+Q+"|image"]&&(U[y]&&(V=U[y](W,u,i,S,D.width,D.height)),this.fire("image",y,W,u,U,$,S,D)),u._interactPrefix=null,V===!0)break}}},handleClickImage:function(x,g,r,Y,I,l,O,P){var j=this.downInfo.hits,Z=P.hits;if(j&&g&&(g=Cc(g))){var m=this.gv,R=O.rect,L=this.convertPoint(l,O);j[x+"|image"]&&(g[r]&&g[r](Y,I,m,L,R.width,R.height),this.fire("image",r,Y,I,g,$,L,R));for(var Q,t=O.compInfos,e=g,f=t.length-1;f>=0;f--){var k=t[f],K=k.comp;L=this.convertPoint(l,k,e,K,m,I),R=k.rect;var C=I._interactPrefix=k.prefix;if(j[x+"|"+f]&&Z[x+"|"+f]){var w=C&&I.a(C+r)||K[r];w&&(Q=w.call(K,Y,I,m,L,R.width,R.height)),this.fire("comp",r,Y,I,g,K,L,R)}if(Q!==!0&&(g=R.image)&&j[x+"|"+f+"|image"]&&(g[r]&&(Q=g[r](Y,I,m,L,R.width,R.height)),this.fire("image",r,Y,I,g,$,L,R)),I._interactPrefix=null,Q===!0)break}}},initImageResource:function(){B.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(n,t){if(!n)return{x:1/0,y:1/0};var o=t.bodyInfo.rect,D=n.clone(),m=n.multiply({x:o.width,y:o.height});return m.local=D,m},convertPoint:function(v,o,F,R,S,Q){var T=o.rect,A=o.matrix.applyInverse(v).sub(T),G=A.x>=0&&A.y>=0&&A.x<=T.width&&A.y<=T.height;if(!G)return A;if(R&&Th(R.pixelPerfect,Q,S)){var T,p=1;this._is2d?(p=S.getZoom(),T=Aj(v.x,v.y,$,p)):T=Aj(v.x,v.y);var E=!1,C=T.x,t=T.y,j=T.width,I=T.height,H=B.hitMaxArea,c=j*I*p*p;if(c>H){var K=Math.sqrt(H/c);p*=K}j*=p,I*=p,2>j&&(j=2),2>I&&(I=2),C*=p,t*=p;var q=oe(j,I),d=new Ge(0,-C,-t,p,p);d.append(o.matrix),S._drawForChecking=!0,R.transform=d,o.refRect&&o.refRect.fitSize&&(R.refRect=o.refRect);var i=F.comps;F.comps=[R],em(q,F,0,0,j,I,Q,self),F.comps=i,delete R.refRect,delete R.transform,S._drawForChecking=!1;try{for(var Z=0,D=q.getImageData(0,0,j,I).data;Z<D.length;Z+=4)if(0!==D[Z+3]){E=!0;break}q.restore()}catch(m){Zf=V,E=!1}A.inRect=E}else A.inRect=!0;return A}});var Df=Gj.DefaultInteractor=function(d){Le(Df,this,[d])};jm("DefaultInteractor",rk,{handle_mousedown:function(z){qk(z);var s=this,B=s.gv,j=B.getDataAt(z);if(B.setFocus(z)&&!B._editing&&!B._scrolling){Kr(z)?B.handleDoubleClick(z,j):B.handleClick(z,j);var P=Bk(z);!uo()&&!P&&j&&(B.isMovable(j)||B._39Q(j))||!B.isPannable()||!gl(z)&&!P||kj(z)||(s._tx=B.tx(),s._ty=B.ty(),s.startDragging(z))}},handleWindowMouseUp:function(Q){var A=this,o=A.gv;o._panning&&(delete o._panning,o.onPanEnded(),A.fi({kind:"endPan",event:Q})),delete A._tx,delete A._ty,A.clearDragging()},handle_mousemove:function(N){var A=this,I=A.gv;A._hoverTimer&&(dh(A._hoverTimer),delete A._hoverTimer),A._hoverTimer=fo(function(){A.fi({kind:"hover",event:N}),dh(A._hoverTimer),delete A._hoverTimer},I.getHoverDelay()||B.hoverDelay)},handle_touchmove:function(X){this.handle_mousemove(X)},handleWindowMouseMove:function(J){var L=this,w=L.gv;L.fi({kind:w._panning?"betweenPan":"beginPan",event:J}),w._panning=1;var X=xr(w,J,L._lastClientPoint);w.setTranslate(L._tx+X.x,L._ty+X.y)},handle_mousewheel:function(z){this.gv.handleScroll(z,z.wheelDelta)},handle_DOMMouseScroll:function(z){2===z.axis&&this.gv.handleScroll(z,-z.detail)},handle_keydown:function(w){this.gv.handleKeyDown(w)}});var yg=Gj.SelectInteractor=function(L){Le(yg,this,[L])};jm("SelectInteractor",rk,{_42:function(){var F=this,h=F.gv,R=h.getZoom(),C=F.mark,P=F.div;P||(P=F.div=Rn(),os(F.getView(),P));var Z={};Z.x=C.x*R+h.tx(),Z.y=C.y*R+h.ty(),Z.width=C.width*R,Z.height=C.height*R,$m(P,Z),this.intersects()?(P.style.border="",P.style.background=h.getRectSelectBackground()):(P.style.background="",P.style.border="1px solid "+h.getRectSelectBorderColor())},handle_mousedown:function(d){var x=this,l=x.gv;if(x._57I=V,x.pendingClickThrough=V,!(l._editing||l._scrolling||uo()||Bk(d))){var b=l.getDataAt(d),G=l.sm();b?kj(d)?G.co(b)?G.rs(b):G.as(b):G.co(b)?b instanceof Zm&&b.isClickThroughEnabled()&&gl(d)&&(x.pendingClickThrough=kd(d)):G.ss(b):kj(d)||!l.isPannable()?gl(d)&&(kj(d)||G.cs(),l.isRectSelectable()&&(x.startDragging(d),l._77O=1)):gl(d)&&(x._57I=kd(d))}},handle_mouseup:function(l){var v=this,q=v.gv,z=v._57I;if(z&&(Lf(z,kd(l))<=1&&q.sm().cs(),v._57I=V),v.pendingClickThrough){if(Lf(v.pendingClickThrough,kd(l))<=1){var k=q.getDataAt(l);if(k instanceof Zm&&k.isClickThroughEnabled()){var P=q.getDataAt(l,function(I){var s=I.getParent()===k&&q.isSelectable(I,!0);return s});P&&(l.clickThrough=!0,q.sm().ss(P))}}v.pendingClickThrough=V}},handleWindowMouseUp:function(i){this.clear(i)},handleWindowMouseMove:function(W){var v=this,k=v.gv;v._logicalPoint=k.lp(W),v.mark?(v.fi({kind:"betweenRectSelect",event:W}),k.isPannable()&&v.autoScroll(W),v.redraw()):v.fi({kind:"beginRectSelect",event:W}),v.mark=lq(v._lastLogicalPoint,v._logicalPoint),v.redraw()},intersects:function(){var l=this,G=l._lastLogicalPoint,u=l._logicalPoint;return G.x>u.x||G.y>u.y},clear:function(H){var f=this,R=f.gv,r=f.mark;if(f._57I=V,f.pendingClickThrough=V,f._lastLogicalPoint){if(r){if(0!==r.width&&0!==r.height){var k=R.getDatasInRect(r,f.intersects());if(!k.isEmpty()){var J=R.sm(),W=J.toSelection();k.each(function(N){J.co(N)?W.remove(N):W.add(N)}),J.ss(W)}}zg(f.div),delete f.div,delete f.mark,f.redraw(),f.fi({kind:"endRectSelect",event:H}),R.onRectSelectEnded()}f.clearDragging(),delete R._77O}},redraw:function(){var W=this;W._draw||(W._draw=1,fo(function(){W.mark&&W._42(),delete W._draw},16))}});var nf=Gj.MoveInteractor=function(Z){Le(nf,this,[Z])};jm("MoveInteractor",rk,{handle_mousedown:function(v){var y=this,x=y.gv;if(gl(v)&&!x._editing&&!x._scrolling&&!uo()){var z=x.getSelectedDataAt(v);!z||x._39Q(z)&&!x.isMovable(z)?x._focusData=V:(y._data=z,x.handleMouseDown&&x.handleMouseDown(v,z),y.startDragging(v),x.isMovable(z)&&(x._moving=1))}},handleWindowMouseUp:function(p){var J=this,j=J.gv;j.handleMouseUp&&j.handleMouseUp(p,J._data),J.clear(p)},handleWindowMouseMove:function(j){var J=this,I=J._data,a=J.gv;if((!a._93O||!a._93O(j,I))&&a._moving){J._logicalPoint||J.fi({kind:"prepareMove",event:j});var F=J._logicalPoint?"betweenMove":"beginMove",n={kind:F,event:j},Y=J._logicalPoint=a.lp(j);"beginMove"!==F||J._alreadyBeginTransaction||(J._alreadyBeginTransaction=!0,a.getDataModel().beginTransaction());var c=J._calcShift(F,j),w=c.x,z=c.y,B=J.gv.getMoveMode(j,I);B&&("x"===B?z=0:"y"===B?w=0:"xy"!==B&&(w=z=0)),a.moveSelection(w,z),J._lastLogicalPoint=Y,J.autoScroll(j),J.fi(n)}},_calcShift:function(){var q=this,F=q._logicalPoint,k=q._lastLogicalPoint,y=F.x-k.x,i=F.y-k.y;return{x:y,y:i}},clear:function(b){var C=this,i=C.gv;C._lastLogicalPoint&&(C._lastLogicalPoint=C._data=i._moving=V,C._logicalPoint&&(C.fi({kind:"endMove",event:b}),i.onMoveEnded()),C.clearDragging()),C._alreadyBeginTransaction&&(C._alreadyBeginTransaction=!1,i.getDataModel().endTransaction())}});var np=Gj.TextEditInteractor=function(H){Le(np,this,[H]),this.init()};jm("TextEditInteractor",rk,{init:function(){var w=this,k=this.input=i.createElement("input"),u=k.style;k.text="text",u.border="1px solid #d8d8d8",u.position="absolute",u.padding="2px 3px",u.outline="none",u.marginLeft="-90px",u.marginTop="-16px",u.backgroundColor="rgba(255,255,255, 0.9)",u.fontSize="14px",u.width="180px",u.height="32px",u.boxShadow="0 0 13px rgba(16,142,233, 0.5)",u.textAlign="center",u.boxSizing="border-box",A(k,"keyup",function(T){Gr(T)&&w.endTextEdit()}),A(k,"focus",function(){k.select()});var p=this.textarea=i.createElement("textarea"),x=this.wrap=i.createElement("div");x.appendChild(p),u=p.style,u.margin=0,u.padding="4px",u.overflow="hidden",u.boxSizing="border-box",u.position="absolute",u.outline="none",u.backgroundColor="transparent",u.resize="none",u.textAlign="center",u.fontSize="14px",u.border="none",u.borderWidth=0,u.width="100%",u.top="50%",u=x.style,u.boxSizing="border-box",u.margin=0,u.padding=0,u.position="absolute",u.boxShadow="0 0 13px rgba(16,142,233, 0.5)",u.border="1px solid #d8d8d8",u.backgroundColor="rgba(255,255,255, 0.9)",u.width="180px",u.marginLeft="-90px",A(p,"keydown",function(k){return(Fk()||kj())&&Gr(k)?(w.endTextEdit(),void 0):(w.calculateTextareaHeight(String.fromCharCode(k.keyCode)),void 0)}),A(p,"focus",function(){p.select()});var j=function(t){t.stopPropagation()};A(k,"mousedown",j),A(k,"touchstart",j),A(p,"mousedown",j),A(p,"touchstart",j),w.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],w.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",w.handleWindowClick=function(L){var g=w._editingDOM;if(g){var c=g.getBoundingClientRect(),h=kd(L);lc(c,h)||w.endTextEdit()}}},handle_mousedown:function(v){var p=this,D=p.gv;if(Kr(v)&&!D._editing){var d=D.getDataAt(v);if(d){var g=D.getTextEditInfo(d);g&&(this._editInfo=g,this._editTarget=d,D._editing=!0,g.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var O=this,Z=O.gv,Q=O._editTarget,P=O.getTargetValue(),D=O.textarea,i=O.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===P||P===$)&&(P=""),D.value=P,O._editingDOM=D,Z.getView().appendChild(i),this.layoutHTML(i,Q),this.calculateTextareaHeight(),fo(function(){D.focus(),A(n,"mousedown",O.handleWindowClick),A(n,"touchstart",O.handleWindowClick)},10)},handleTextEdit:function(){var G=this,v=G.gv,S=G._editTarget,Z=G.getTargetValue(),Q=G.input;(null===Z||Z===$)&&(Z=""),Q.value=Z,G._editingDOM=Q,v.getView().appendChild(Q),this.layoutHTML(Q,S),fo(function(){Q.focus(),A(n,"mousedown",G.handleWindowClick),A(n,"touchstart",G.handleWindowClick)},10)},layoutHTML:function(f,Y){var T=this.gv,i=T.getZoom();if(Y instanceof C.Node){var p=Y.getRect();f.style.left=(p.x+p.width/2)*i+T.tx()+"px",f.style.top=(p.y+p.height/2)*i+T.ty()+"px"}else if(Y instanceof C.Edge){var X=T.getDataUI(Y),p=X._6I;f.style.left=(p.x+p.width/2)*i+T.tx()+"px",f.style.top=(p.y+p.height/2)*i+T.ty()+"px"}},endTextEdit:function(){var C=this,I=C._editInfo.isMultiline?C.wrap:C.input,r=C._editInfo.isMultiline?C.textarea:C.input;C.setTargetValue(r.value),C.gv.getView().removeChild(I),C.gv._editing=!1,delete C._editingDOM,Y(n,"mousedown",C.handlelick),Y(n,"touchstart",C.handleWindowClick)},setTargetValue:function(w){var T=this,F=T._editTarget,U=T._editInfo,L=U.accessType,O=U.name;if(O&&L||(L="p",O="name"),"p"===L){var l=C.Default.setter(O);F[l](w)}else"a"===L?F.a(O,w):F.s(O,w)},getTargetValue:function(){var T=this,s=T._editTarget,z=T._editInfo,f=z.accessType,K=z.name;if(K&&f||(f="p",K="name"),"p"===f){var Y=C.Default.getter(K);return s[Y]()}return"a"===f?s.a(K):s.s(K)},createHiddenTextarea:function(){this.hiddenTextarea=i.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(K,$){if($&&this.computedStyleCache)return this.computedStyleCache;var V=this,M=n.getComputedStyle(K),S=M.getPropertyValue("box-sizing")||M.getPropertyValue("-moz-box-sizing")||M.getPropertyValue("-webkit-box-sizing"),Y=parseFloat(M.getPropertyValue("padding-bottom"))+parseFloat(M.getPropertyValue("padding-top")),B=parseFloat(M.getPropertyValue("border-bottom-width"))+parseFloat(M.getPropertyValue("border-top-width")),Z=V.SIZING_STYLE.map(function(W){return W+":"+M.getPropertyValue(W)}).join(";"),f={sizingStyle:Z,paddingSize:Y,borderSize:B,boxSizing:S};return $&&(this.computedStyleCache=f),f},calculateTextareaHeight:function(g){g=g||"";var Y=this,I=Y.textarea,U=Y.hiddenTextarea,P=Y.wrap,c=32,T=Y.calculateHTMLStyle(I,!1),E=T.paddingSize,L=T.borderSize,A=T.boxSizing,G=T.sizingStyle;U.setAttribute("style",G+";"+Y.HIDDEN_TEXTAREA_STYLE),U.value=I.value+g;var $=U.scrollHeight;"border-box"===A?$+=L:"content-box"===A&&($-=E),I.style.height=$+"px",I.style.marginTop=0-.5*$+"px",P.style.height=Math.max($,c)+"px",P.style.marginTop=$*-.5+"px"}});var Lp=Gj.ScrollBarInteractor=function(j){Le(Lp,this,[j])};jm("ScrollBarInteractor",rk,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(p){var E=this.gv.getViewRect();return this._41o()&&(E.x+E.width-this.gv.lp(p).x)*this.gv.getZoom()<oc},isH:function(D){var _=this.gv.getViewRect();return this._40o()&&(_.y+_.height-this.gv.lp(D).y)*this.gv.getZoom()<oc},handle_mousemove:function(M){this.handle_touchmove(M)},handle_touchmove:function(m){if(!mr&&gl(m)&&this.gv.isScrollBarVisible()){var P=this,U=P.isV(m),z=P.isH(m);(U||z)&&P.gv.showScrollBar(),P.gv._scrolling=U||z}},handleWindowMouseUp:function(y){this.handleWindowTouchEnd(y)},handleWindowTouchEnd:function(O){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=V,this.fi({kind:"endScroll",event:O})},handle_mousedown:function(S){this.handle_touchstart(S)},handle_touchstart:function(h){var y=this;if(y.gv.setFocus(h),qk(h),y.handle_touchmove(h),!(Bg(h)>1)&&y.gv._scrolling&&y.gv.isScrollBarVisible()){y._cp=kd(h),y._tx=y.gv.tx(),y._ty=y.gv.ty();var t=y.isV(h);y._state=t?"vScroll":"hScroll",Lj(y,h),y.fi({kind:"beginScroll",event:h})}},handleWindowMouseMove:function(O){this.handleWindowTouchMove(O)},handleWindowTouchMove:function(z){var j=kd(z),R=this.gv.getViewRect(),o=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-j.y)*o.height/R.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-j.x)*o.width/R.width),this.fi({kind:"betweenScroll",event:z})}});var Qh=Gj.TouchInteractor=function(K,w){w=w||{},w.selectable===$&&(w.selectable=!0),w.movable===$&&(w.movable=!0),w.pannable===$&&(w.pannable=!0),w.pinchable===$&&(w.pinchable=!0),w.editable===$&&(w.editable=!0),this.params=w,Le(Qh,this,[K])};jm("TouchInteractor",rk,{ms_edit:1,setUp:function(){var t=this;Qh.superClass.setUp.call(t),gp&&t.params.editable&&t.gv.setEditInteractor(t)},tearDown:function(){var T=this;Qh.superClass.tearDown.call(T),gp&&T.params.editable&&T.gv.setEditInteractor(V)},clear:function(T){var l=this,d=l.gv;d._moving&&(l.fi({kind:"endMove",event:T}),delete d._moving,d.onMoveEnded(),d.dm().endTransaction()),d._panning&&(l.fi({kind:"endPan",event:T}),delete d._panning,d.onPanEnded()),d._pinching&&(l.fi({kind:"endPinch",event:T}),delete d._pinching,d.onPinchEnded()),d._editing&&(l._46O(T),l._77I=l._node=l._edge=l._shape=l._rect=l._89I=l._index=d._editing=V),l.pendingClickThrough=l._moving=l._panning=l._pinching=l._editing=l._57I=l._data=l._beginHistory=V,l.clearDragging()},handle_touchstart:function(g){var u=this;if(!u.gv._editing){qk(g),u._57I=V,u.pendingClickThrough=V;var I=u.params,d=u.gv,i=d.sm(),m=d.getDataAt(g),X=Bg(g);if(1===X){if(Kr(g))return d.handleDoubleClick(g,m),void 0;d.handleClick(g,m),m&&(d.handleMouseDown&&d.handleMouseDown(g,m),u._data=m),I.selectable||(m=V),m&&(i.co(m)?m instanceof Zm&&m.isClickThroughEnabled()&&(u.pendingClickThrough=kd(g)):i.ss(m),I.editable&&d.isEditable(m)&&u._79I(g,m,!0)?(u._editing=1,u.startDragging(g)):I.movable&&d.isMovable(m)&&(u._moving=1,u.startDragging(g))),m&&d.isMovable(m)||(u._57I=kd(g),I.pannable&&d.isPannable()&&(u._panning=1,u.startDragging(g),u._translate={x:d.tx(),y:d.ty()}))}else if(I.pinchable&&2===X){if(m&&d._39Q(m))return;u._pinching=1,u.startDragging(g);var o=d.getView(),U=d.getZoom(),L=o.getBoundingClientRect(),M=g.touches[0],h=g.touches[1],r={x:(M.clientX+h.clientX)/2-L.left,y:(M.clientY+h.clientY)/2-L.top};r.x-=d.tx(),r.y-=d.ty(),r.x/=U,r.y/=U,u._p=r,u._d=eq(g)}}},handle_touchend:function(v){var G=this,j=G.gv,y=G._57I,K=G._data;if(y&&(Lf(y,kd(v))<=1&&!j.getDataAt(v)&&j.sm().cs(),G._57I=V),K&&j.handleMouseUp&&j.handleMouseUp(v,K),G.pendingClickThrough){if(Lf(G.pendingClickThrough,kd(v))<=1){var K=j.getDataAt(v);if(K instanceof Zm&&K.isClickThroughEnabled()){var W=j.getDataAt(v,function(f){var c=f.getParent()===K&&j.isSelectable(f,!0);return c});W&&(v.clickThrough=!0,j.sm().ss(W))}}G.pendingClickThrough=V}},handleWindowTouchEnd:function(w){this.clear(w)},handleWindowTouchMove:function(F){var Y=this,M=Y.gv,U=Bg(F);if(1===U){var s=kd(F),z=xr(M,s,Y._lastClientPoint),j=Lf({x:0,y:0},z);if(Y._editing&&(Y._beginHistory||(Y._beginHistory=1,M.dm().beginTransaction()),M._editing=1,Y._78I(F)),Y._moving){if(!M._moving&&j<B.touchMoveThreshold)return;Y._beginHistory||(Y._beginHistory=1,M.dm().beginTransaction()),Y.handleMove(F)}else if(Y._panning){if(!M._panning&&j<B.touchMoveThreshold)return;M.setTranslate(Y._translate.x+z.x,Y._translate.y+z.y),Y.fi({kind:M._panning?"betweenPan":"beginPan",event:F}),M._panning=1}}else if(2===U&&Y._pinching){var u=eq(F);M.handlePinch(Y._p,u,Y._d),Y._d=u,Y.fi({kind:M._pinching?"betweenPinch":"beginPinch",event:F}),M._pinching=1}},handleMove:function(V){var v=this,Q=v.gv,S=Q.lp(V);Q._93O&&Q._93O(V,v._data)||(Q.moveSelection(S.x-v._lastLogicalPoint.x,S.y-v._lastLogicalPoint.y),v._lastLogicalPoint=S,v.autoScroll(V),v.fi({kind:Q._moving?"betweenMove":"beginMove",event:V}),Q._moving=1)}});var C=n.ht,Cl=C.graph._editor={Math:C.Math,Guide:{}};Cl.getStyle=function(S){var g,j=Cl.StyleMap;return j&&(g=j[S],g!==$)?g:Cl.DefaultStyleMap[S]},Cl.setStyle=function(_,l){var f=Cl.StyleMap;f||(f=Cl.StyleMap={}),f[_]=l},Cl.inEdit=function(c){return c._inXEdit===!0},Cl.startEdit=function(i){i._inXEdit=!0,Cl.Inject.doInject(i)},Cl._46O=function(f){f._inXEdit=!1,Cl.Inject.undoInject(f)},Cl.toScreenPosition=function(Q,O){var v=Q.tx(),h=Q.ty(),F=Q._zoom;return new Cl.Math.Vector2(O.x*F+v,O.y*F+h)},Cl.checkHit=function($,P,M){return $.distanceTo(P)<M?!0:!1},Cl.toWorldPosition=function(z,N){var q=z.tx(),S=z.ty(),J=z._zoom;return{x:(N.x-q)/J,y:(N.y-S)/J}},Cl.setAntialias=function(X,k){for(var t,D=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],x=0,O=D.length;O>x&&(t=D[x],!(t in X));x++);X[t],X[t]=k},Cl.getTargetCornersOnScreen=function(I,J){if(!J)return null;var L,b=[];if(Bd(J,I)){var q=Ak(I,J);L=[{x:q.x,y:q.y},{x:q.x+q.width,y:q.y},{x:q.x+q.width,y:q.y+q.height},{x:q.x,y:q.y+q.height}]}else{if(!J.getCorners)return null;L=J.getCorners()}return L.forEach(function(t){var v=Cl.toScreenPosition(I,t);b.push(v.x,v.y)}),b},Cl.log=function(){};var ng=Cl.Inject={_modules:[]};ng.registAsModule=function(P,v){var x={},a={};for(var e in P){var q=v.prototype[e];x[e]=q}P.getBackup=function(q){return x[q]},P.getBackups=function(){return x},a.doInject=function(){for(var x in P)"getBackup"!==x&&(v.prototype[x]=P[x])},a.undoInject=function(){for(var n in P)"getBackup"!==n&&(v.prototype[n]=x[n])},ng._modules.push(a)},ng.doInject=function(n){for(var K,t=ng._modules,i=0,R=t.length;R>i;i++)K=t[i],K.doInject(n)},ng.undoInject=function(N){for(var K,r=ng._modules,X=0,v=r.length;v>X;X++)K=r[X],K.undoInject(N)};var rk=C.graph.EditInteractor=function(f){var k=this,T=i.createElement("canvas");T.className="editCanvas",T.style.position="absolute",k._styleMap={},k._canvas=T,k._context=T.getContext("2d"),rk.superClass.constructor.call(k,f),this._editDetail=!1,Cl.setAntialias(k._context,!1),k._subModules=[new Cl.Anchor(k),new Cl.RotateX(k),new Cl.MoveDummy(k),new Cl.Rect(k),new Cl.Curve(k),new Cl.MoveHelper(k)],k._gridGuide=new Cl.Guide.Grid(k),k._rectGuide=new Cl.Guide.Rect(k),k._hoverGuide=new Cl.Guide.Hover(k)},eo=rk;C.Default.def(rk,C.graph.Interactor,{ms_edit:1,ms_fire:1}),e.defineProperties(rk.prototype,{editDetail:{get:function(){var s=!!this._editDetail;return s},set:function(i){var o=this,P=o._editDetail;P!==i&&(o._editDetail=i,o.gv._editing=i,o.fp("editDetail",P,i),o.fp("pointsEditingMode",P,i),o.fi({kind:i?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(t){(!this._editDetail||t)&&(this.gv._editing=t,t||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(H){this._editing=H,this.gvEditing=H}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(q){var M=this;M.editDetail!==q&&(q?M._tryEnterEditDetailMode():M._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var J=this._gridEnabled;if(!J)return!1;var P=this.gv;return P?!0:!0},set:function(A){A!==this._gridEnabled&&(this._gridEnabled=A,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(A){A!==this._agEnabled&&(this._agEnabled=A,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),rk.prototype.getSubModule=function(j){var W,s,I,l=this._subModules;for(s=0,I=l.length;I>s;s++)if(W=l[s],W.catalog===j)return W},rk.prototype.invokeSubModule=function(I,S){for(var K,b,G,y=this,Z=y._subModules,A=Array.prototype.slice.call(arguments,2),C=0,H=Z.length;H>C;C++)if(K=Z[C],b=K[I],b&&(G=b.apply(K,A),G!=$&&S))return K},rk.prototype.invokeSubModuleInverse=function(m,y){var B=this,I=B._subModules;if(I)for(var q,Z,z,d=Array.prototype.slice.call(arguments,2),Q=I.length-1;Q>=0;Q--)if(q=I[Q],Z=q[m],Z&&(z=Z.apply(q,d),z!=$&&y))return q},rk.prototype.setUp=function(){Cl.log("setUp");var w=this,d=w.gv,S=d.getView(),U=w._canvas;rk.superClass.setUp.call(w),d.setEditInteractor(w),d._79O?S.insertBefore(U,d._79O):S.appendChild(U),Cl.startEdit(d),w.invokeSubModule("setUp"),d.dm().mm(w._onDataModelChanged,w),d.dm().md(w._onDataPropertyChanged,w)},rk.prototype.tearDown=function(){Cl.log("tearDown");var j=this,t=j.gv,C=t.getView();j._resetCustomCursorStyle(),rk.superClass.tearDown.call(j),t.dm().umm(j._onDataModelChanged,j),t.dm().umd(j._onDataPropertyChanged,j),t.setEditInteractor(null),C.removeChild(j._canvas),j._drawTimer&&(dh(j._drawTimer),j._drawTimer=null),Cl._46O(t),j.invokeSubModule("tearDown")},rk.prototype._onDataModelChanged=function(U){var L=this;("clear"===U.kind||"remove"===U.kind&&L.editDetail&&U.data===L.getSubModule("Curve").target)&&(L.editDetail=!1,L._42())},rk.prototype._onDataPropertyChanged=function(y){var W=this;if(W.editDetail){var j=W.getSubModule("Curve"),w=y.data;w===j.target&&(w._writing||j._handleDataChanged(y))}},rk.prototype.clear=function(){Cl.log("clear")},rk.prototype.redraw=function(){this._42()},rk.prototype._42=function(){var J=this;J._drawTimer||(J._drawTimer=fo(function(){J._drawTimer=null,J.drawImpl()},0))},rk.prototype.drawImpl=function(){var i;for(i in{_42:!0})break;return function(){var H=this,f=H._canvas,v=H.gv,X=v.getWidth(),S=v.getHeight(),_=H._context,U=C.Default.getInternal(),$=B.devicePixelRatio;(f.width!==X||f.height!==S)&&U.setCanvas(f,X,S,$),_.clearRect(0,0,f.width,f.height);var p=H._getValidSelection();_.save(),_.scale($,$),H._gridGuide._42(),H.invokeSubModuleInverse(i,!1,_,v,p),H._rectGuide._42(),H._hoverGuide._42(),_.restore()}}(),rk.prototype._getValidSelection=function(){var J=this,q=J.gv,P=q.sm().getSelection(),b=[];return P.each(function(D){q.isVisible(D)&&q.isEditable(D)&&b.push(D)}),b},rk.prototype.handle_touchmove=function(O){return this.handle_mousemove(O)},rk.prototype.handle_mousemove=function(Y){if(!C.Default.isDragging()){var F=this;
if((F.editDetail||!uo()&&!Bk(Y))&&!F.gv._externalEditing)if(F.gvEditing=!1,F._checkEdit(Y))F.gvEditing=!0;else{if(!F.getStyle("hoverGuideVisible"))return;F.hoverData=F.gv.getDataAt(Y),F._42()}}},rk.prototype.handle_touchstart=function(d){return this.handle_mousedown(d)},rk.prototype.handle_mousedown=function(a){qk(a);var R=this;if((R.editDetail||!uo()&&!Bk(a))&&!R.gv._externalEditing){if(Kr(a)&&!a.clickThrough){if(R.editDetail){if(R._tryQuitEditDetailMode(a))return}else if(R._tryEnterEditDetailMode())return;R.gv.dm().beginTransaction();var w=R.invokeSubModule("handleDoubleClick",!0,a);if(R.gv.dm().endTransaction(),w)return}var E=R._checkEdit(a);E&&(R._downPosition=R._getLogicalPoint(a),R.gv.dm().beginTransaction(),E.startEdit(R,a),R.editing=!0)}},rk.prototype._checkEdit=function(B){var E=this,u=E.gv,e=E._getLogicalPoint(B),D=E.invokeSubModule("check",!0,u,B,e)||null;return E._editMod=D,D},rk.prototype.handleWindowTouchMove=function(P){return this.handleWindowMouseMove(P)},rk.prototype.handleWindowMouseMove=function(p){var C=this,O=C._downPosition;if(O){var I=C._getLogicalPoint(p);if(I.distanceTo(O)<C.getStyle("moveSensitivity"))return;delete C._downPosition}var U=C._editMod;U&&U.handleEdit(C.gv,p)},rk.prototype._getLogicalPoint=function(k){var K=this,J=C.Default.getLogicalPoint(k,K._canvas);return new Cl.Math.Vector2(J)},rk.prototype.handleWindowTouchEnd=function(l){return this.handleWindowMouseUp(l)},rk.prototype.handleWindowMouseUp=function(){var $;for($ in{_46O:!0})break;return function(N){var i=this;i.editing=!1,i.setCursor("default"),i.invokeSubModule($,!1,N),i._42(),i.gv.dm().endTransaction()}}(),rk.prototype.handle_mousewheel=function(k){var B=this;qk(k),B.invokeSubModule("preHandleScroll",!0)||B.gv.handleScroll(k,k.wheelDelta)},rk.prototype.handleDelete=function(){var i=this;if(!i.editDetail){i.gv.dm().beginTransaction();var Z=i.invokeSubModule("handleNormalStateDelete",!0);return i.gv.dm().endTransaction(),Z||i.gv.removeSelection(),void 0}i.gv.dm().beginTransaction(),i.invokeSubModule("handleDelete",!0),i.gv.dm().endTransaction(),i._42()},rk.prototype.handle_keydown=function(z){var D=this;if((z.metaKey||z.ctrlKey)&&D._42(),uo(z)&&!D.editing)return D.gvEditing=!1,D.setCursor("default"),D._42(),void 0;var i=Gr(z);return D.editDetail?((i||$b(z))&&(D.editDetail=!1,D._42()),D.gv.dm().beginTransaction(),D.invokeSubModule("handle_keydown",!0,z),D.gv.dm().endTransaction(),void 0):(D.gv.dm().beginTransaction(),D.invokeSubModule("handleNormalStateKeyDown",!0,z),D.gv.dm().endTransaction(),i&&D._tryEnterEditDetailMode(),void 0)},rk.prototype.handle_keyup=function(q){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,q),this.gv.dm().endTransaction()},rk.prototype._tryEnterEditDetailMode=function(){var s=this;return!s.editDetail&&s.invokeSubModule("canEnterEditDetailMode",!0)&&1===s._getValidSelection().length?(s.editDetail=!0,s._42(),!0):void 0},rk.prototype._tryQuitEditDetailMode=function(j){var X=this;return X.editDetail?!j||X.invokeSubModule("canQuitEditDetailMode",!0,j)?(X.editDetail=!1,X._42(),!0):!1:!1},rk.prototype.setStyle=function(c,N,_){var D=this;_?Cl.setStyle(c,N):D._styleMap[c]=N,"baseColor"===c&&(Jc=N),D.fp("styleChanged",null,{key:c,value:N,base:_}),D._42()},rk.prototype.getStyle=function(S){var C=this,o=C._styleMap[S];return o!==$?o:Cl.getStyle(S)},rk.prototype.setCursor=function(O){this._resetCustomCursorStyle(),C.graph.EditInteractor.superClass.setCursor.call(this,O)},rk.prototype._drawHostGuide=function(O){var K=this,i=K._context,T=K.gv;Cl.Icons.DrawIcon(K,i,Cl.Icons.NodeHoverGuide,O.corners);var c=O.host;if(c){var D=T.getAttachPoints(c);if(D&&D.length)for(var A=0,j=D.length;j>A;A++){var m=D[A],s=Ie(T,c,0,m.offsetX||0,m.offsetY||0,m.x,m.y);s=Cl.toScreenPosition(T,s),s.isAttach=O.attach===A,Cl.Icons.DrawIcon(K,i,Cl.Icons.AttachPoint,s)}}},rk.prototype._resetCustomCursorStyle=function(){var u=this;if(u._customStyle){var r=this.gv.getView();r.classList&&r.classList.remove&&r.classList.remove(u._customStyle),u._customStyle=null}},rk.prototype._setRotateCursor=function(z){var n=this,K=n._cursorFactory;K||(K=n._cursorFactory=new Cl.CursorFactory(n));var x=K.getRotateCursor(z),t=n.gv.getView();n._resetCustomCursorStyle(),n._customStyle=x,t.classList&&t.classList.add&&t.classList.add(x)};var Ai=Cl.Group=function(D){var f=this;f._entities=D,f._64O=0,f._position={x:0,y:0},f._scale={x:1,y:1},f._anchor={x:.5,y:.5},f._anchor2={x:.5,y:.5}};Ai.prototype={},Ai.prototype.constructor=Ai;var fi=null;Ai.findOrCreateGroup=function(S){if(fi&&fi.checkIsMe(S))return fi;var F=new Cl.Group(S);return F.getKeyOb()?(fi=F,F):void 0},Ai.prototype.checkIsMe=function(p){var S=this._entities;if(S.length!==p.length)return!1;var L,l={},K=p.length;for(L=0;K>L;L++)l[p[L]._id]=!0;for(L=0;K>L;L++)if(!l[S[L]._id])return!1;return!0},Ai.prototype.getRotation=function(){return this._64O},Ai.prototype.getPosition=function(){return this._position},Ai.prototype.getAnchor=function(){return this._anchor},Ai.prototype.getWidth=function(){return this._width},Ai.prototype.getScale=function(){return this._scale},Ai.prototype.getSize=function(){return{width:this._width,height:this._height}},Ai.prototype.getHeight=function(){return this._height},Ai.prototype.getKeyOb=function(){for(var l=this._entities,A=l.length-1;A>=0;A--){var E=l[A];if(this.isNode(E))return E}},Ai.prototype.getAnchor2=function(){var j=this,u=j.rotateCenter;if(u)return u;var b=j.getKeyOb();if(!b)return j._anchor;var f=j._anchor2,T=b.getMatrix();return T.tf({x:b.getWidth()*(f.x-b.getAnchor().x),y:b.getHeight()*(f.y-b.getAnchor().y)})},Ai.prototype.setAnchor2=function(O,H){var b=this,j=b.getKeyOb();if(j){var p,T=j.getMatrix();p="number"==typeof O?{x:O,y:H}:O;var l=T.tfi(p);b._anchor2={x:j.getAnchor().x+l.x/j.getWidth(),y:j.getAnchor().y+l.y/j.getHeight()}}},Ai.prototype.setRotation=function(){},Ai.prototype.beginRotate=function(h){this.rotateCenter=h.pos,this.rotateMode=h.groupRotateMode},Ai.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Ai.prototype.addRotation=function(w,q,F){return"batch"===q?this._addRotationInBatchMode(w,F):"block"===q?this._addRotationInBlockMode(w,F):void 0},Ai.prototype._addRotationInBlockMode=function(U,J){var m=this,W=m.rotateCenter||m.getPosition();m._entities.forEach(function(Q){if(m.isNode(Q)&&(!J||J(Q))){var S=Q.getMatrix();S.translate(-W.x,-W.y),S.rotate(U),S.translate(W.x,W.y);var t=Math.sign(Q.getScale().x);Q.setRotation(I(S.b*t,S.a*t)),Q.setPosition(S.tx,S.ty)}})},Ai.prototype._addRotationInBatchMode=function(z,R){var h=this,s=h._anchor2;h._entities.forEach(function(q){if(h.isNode(q)&&(!R||R(q))){var P=q.getAnchor(),U=q.getMatrix(),G=U.tf({x:q.getWidth()*(s.x-P.x),y:q.getHeight()*(s.y-P.y)}),F=new Cl.Math.Matrix2d;F.set(U.a,U.b,U.c,U.d,U.tx,U.ty),F.translate(-G.x,-G.y),F.rotate(z),F.translate(G.x,G.y);var n=Math.sign(q.getScale().x);q.setRotation(I(F.b*n,F.a*n)),q.setPosition(F.tx,F.ty)}})},Ai.prototype.setPosition=function(Q){var E,O,T,v,N=this,w=N._position,l=Q.x-w.x,J=Q.y-w.y,X=N._entities;for(O=0,T=X.length;T>O;O++)E=X[O],Zb(E)&&(v=E.getPosition(),E.setPosition(v.x+l,v.y+J));N._position=Q},Ai.prototype.setScale=function(l,z){var X=this,G=l/X._scale.x,k=z/X._scale.y;X._adjustChildScaleOrSize(G,k,"size"),X._scale={x:l,y:z}},Ai.prototype.getRect=function(){var A=this,k=A._position,_=A._width,B=A._height;return{x:k.x-_/2,y:k.y-B/2,width:_,height:B}},Ai.prototype.setSize=function(p,v){var H=this,p=Math.max(1,p),v=Math.max(1,v),m=p/H._width,B=v/H._height;H._adjustChildScaleOrSize(m,B,"size"),H._width=p,H._height=v},Ai.prototype._adjustChildScaleOrSize=function(C,w,D){var n,F,E,G,d,V,i,A,k,M,l,h,s,e,O=this,W=O._position,Q=O._entities,z=new Cl.Math.Matrix2d;for(F=0,E=Q.length;E>F;F++)if(n=Q[F],O.isNode(n)){if(G=n.getPosition(),d=n.getRotation(),V=n.getWidth(),i=n.getHeight(),A=n.getScale(),l=A.x*V,h=A.y*i,z.identity().scale(l,h).rotate(d).translate(G.x,G.y).translate(-W.x,-W.y).rotate(-O._64O),d=I(z.b*Math.sign(l),z.a*Math.sign(l)),z.scale(C,w),k=Math.cos(d),M=Math.sin(d),Math.abs(k)<.001?(s=z.b/M,e=-z.c/M):(s=z.a/k,e=z.d/k),"scale"===D)n.setScale(s/V,e/i);else if("size"===D){var Y=s/A.x,X=e/A.y;n.setScale(wp(s)*Math.abs(A.x),wp(e)*Math.abs(A.y)),n.setSize(Math.max(.1,Math.abs(Y)),Math.max(.1,Math.abs(X)))}z.rotate(O._64O).translate(W.x,W.y),n.setPosition(z.tx,z.ty)}},Ai.prototype.getMatrix=function(){var y=this,R=y._position,O=C.Default.getInternal(),b=y._scale;return new O.Mat(y._64O,R.x,R.y,b.x,b.y)},Ai.prototype.toGlobal=function(t){return this.getMatrix().tf(t)},Ai.prototype.getCorners=function(){var u=this,a=u._width,e=u._height,v=u._anchor,j=-a*v.x,p=-e*v.y,$=u.getMatrix();return[$.tf(j,p),$.tf(j,p+e),$.tf(j+a,p+e),$.tf(j+a,p)]},Ai.prototype.calcInfo=function(){var C,v,Z,y,d,p,q=this,X=[],U=q._entities,N=q._64O;for(y=0,d=U.length;d>y;y++)p=U[y],q.isNode(p)&&p.getCorners&&X.push.apply(X,p.getCorners());if(X.length){var K=Math.cos(-N),k=Math.sin(-N),P=1/0,h=-1/0,s=1/0,O=-1/0;for(y=0,d=X.length;d>y;y++)Z=X[y],C=Z.x,v=Z.y,Z.x=K*C-k*v,Z.y=k*C+K*v,P=Math.min(P,Z.x),h=Math.max(h,Z.x),s=Math.min(s,Z.y),O=Math.max(O,Z.y);q._width=(h-P)/q._scale.x,q._height=(O-s)/q._scale.y,K=Math.cos(N),k=Math.sin(N);var f=q._anchor;C=P+(h-P)*f.x,v=s+(O-s)*f.y,q._position={x:K*C-k*v,y:k*C+K*v}}},Ai.prototype.isNode=function(Z){return Zb(Z)?Bd(Z)?Z.size()?!1:!0:!0:!1},Ai.prototype._42=function(W,m,o){var d,z,k,r,f,V,s,F,i=this,c=i._entities,_=i.rotateMode;for("batch"===_&&(F=i.getKeyOb()),d=0,z=c.length;z>d;d++)k=c[d],i.isNode(k)&&(V=k.getRect(),r=Cl.toScreenPosition(o,{x:V.x,y:V.y}),f=Cl.toScreenPosition(o,{x:V.x+V.width,y:V.y+V.height}),s={min:r,max:f},k===F&&(s.isKeyOb=!0),Cl.Icons.DrawIcon(W,m,Cl.Icons.GroupSubEntityRect,s))};var tk=Cl.CurveActiving=function(L,K){this._curve=L,this._interactor=L._interactor,this.silent=!0;for(var s in K)this[s]=K[s];delete this.silent};tk.prototype={},tk.prototype.constructor=tk,e.defineProperties(tk.prototype,{point:{get:function(){return this._point},set:function(F){var M=this;M._point=F,M.editingCtrl||M.silent||M._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(k){var u=this;u._pairs=k,u.editingCtrl&&!u.silent&&u._firePointChange()}}}),tk.prototype._firePointChange=function(){var u=this,l=u.getCurrentEditingPoint(),o=u._interactor;if(!l)return o.fi({kind:"selectPoint"}),void 0;var P=this._curve.target;if(P){var g=Cl.getDataMatrix(P).invert(),U=l.e;l=g.apply(Cl.toWorldPosition(o.gv,l)),l.e=U;var G=u._lastFirePoint;G&&Math.abs(l.x-G.x)<1e-5&&Math.abs(l.y-G.y)<1e-5&&(l.e==$&&G.e==$||Math.abs(l.e-G.e)<1e-5)||(u._lastFirePoint=l,o.fi({kind:"selectPoint",x:l.x,y:l.y,e:l.e}))}},tk.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},tk.prototype.getCurrentEditingPoint=function(){var c=this,H=c.editingCtrl;if(H){var A=c.pairs;if(A){var y=A[H.pairId];if(y){var n=y[H.type];if(n)return n}}}return c._point};var jc=Cl.CursorFactory=function(f){var B=this;B._interactor=f,B._rotateCursorStyles={}};jc.prototype={},jc.prototype.constructor=jc,jc.prototype.getRotateCursor=function(w){var K=this;0>w&&(w+=2*Math.PI);var V=K._interactor,$=V.getStyle("rotateCursorSize"),y=V.getStyle("rotateCursorRound"),z=Math.round(180*(w/Math.PI)/y);z*y>=360&&(z=0);var O=K._rotateCursorStyles,Y="htCustomRotateStyle_"+$+"_"+y+"_"+z;return O[Y]||(K._produceRotateCursor(Y,$,y,z),O[Y]=!0),Y},jc.prototype._produceRotateCursor=function(T,g,D,U){var e=this;e._interactor;var J=e._canvas;J||(J=e._canvas=i.createElement("canvas"));var h=B.devicePixelRatio;J.width=J.height=g*h,J.style.width=J.style.height=g+" px";var c=J.getContext("2d");Cl.setAntialias(c,!1),c.scale(h,h);var w,l,$,b,v,p=Math.round(g/2),R=""+p+" "+p+",auto !important;",y=4;w=Math.PI/180*U*D,c.clearRect(0,0,g,g),c.save(),c.scale(g/32,g/32),c.translate(16,15),c.rotate(w+Math.PI/2),c.beginPath(),c.moveTo(-8,0),c.lineTo(-8,y),c.lineTo(-8+y,y),c.moveTo(8,0),c.lineTo(8,y),c.lineTo(8-y,y),c.moveTo(-8,y),c.quadraticCurveTo(0,-6,8,y),c.restore(),c.lineCap="round",c.lineJoin="miter",c.strokeStyle="white",c.lineWidth=4,c.stroke(),c.strokeStyle="black",c.lineWidth=2,c.stroke(),l=JSON.stringify(J.toDataURL()),b="cursor:url("+l+")"+R,1!==h&&($='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+g+'px" height="'+g+'px"><image xlink:href='+l+' width="'+g+'" height="'+g+'"/></svg>',b+="cursor:url(data:image/svg+xml;base64,"+btoa($)+")"+R,b+="cursor:-webkit-image-set(url("+l+")"+h+"x,url("+l+")1x)"+R),v=i.createElement("style"),v.textContent="body."+T+" *, ."+T+"{"+b+"}",i.head.appendChild(v)};var Mj=Cl.Guide.Grid=function(X){var u=this;u._interactor=X,u._alignmentGuideId=0,u._xAlignmentGuide=[],u._yAlignmentGuide=[]};Mj.prototype={},Mj.prototype.constructor=Mj,e.defineProperties(Mj.prototype,{gridBlockSize:{get:function(){var o=this;return o._gridBlockSize||o._interactor.getStyle("gridBlockSize")},set:function(M){this._gridBlockSize=M,this._interactor._42()}},gridThickLinesEvery:{get:function(){var V=this;return V._gridThickLinesEvery||V._interactor.getStyle("gridThickLinesEvery")},set:function(I){this._gridThickLinesEvery=I,this._interactor._42()}},gridEnabled:{get:function(){var G=this,y=G._interactor;return y.gridEnabled&&G.isValidGrid()}}}),Mj.prototype._42=function(){var C=this,f=C._interactor;C.gridEnabled&&C.drawGrid(),f.alignmentGuideEnabled&&C.drawAlignmentGuide()},Mj.prototype.makeMatrix=function(){var n=this,C=n._interactor.getStyle("gridAngle"),z=n._interactor.getStyle("gridRotation"),m=new Cl.Math.Matrix2d,I=Math.sin(C),J=Math.cos(C);return m.set(1,0,J,I,0,0),m.rotate(z),m},Mj.prototype.isValidGrid=function(){var Z=this,H=Math.PI,a=Z._interactor,C=a.gv;if(C._zoom<a.getStyle("gridZoomThreshold"))return!1;var Q=a.getStyle("gridAngle"),p=Math.abs(180*(Q%H/H)),G=1-1e-8;return G>p||p>180-G?!1:!0},Mj.prototype.drawAlignmentGuide=function(){var T=this,$=T._interactor,s=$.gv,w=$._canvas,U=$._context,P=w.width,A=w.height,r=s.tx(),g=s.ty(),G=s._zoom;U.beginPath(),U.strokeStyle=$.getStyle("gridAlignmentGuideColor"),U.lineWidth=1,T._xAlignmentGuide.forEach(function(T){var R=T.p*G+r;U.moveTo(R,0),U.lineTo(R,A)}),T._yAlignmentGuide.forEach(function(c){var F=c.p*G+g;U.moveTo(0,F),U.lineTo(P,F)}),U.stroke()},Mj.prototype.drawGrid=function(){function w(g,f,n,q){var H=Cl.toScreenPosition(E,J.apply({x:g,y:f})),Z=Cl.toScreenPosition(E,J.apply({x:n,y:q}));P.moveTo(H.x,H.y),P.lineTo(Z.x,Z.y)}var F=this,q=F._interactor,W=F.gridBlockSize,k=F.gridThickLinesEvery,Z=q.getStyle("gridThickColor"),e=q.getStyle("gridLightColor"),E=q.gv,n=q._canvas,P=q._context,S=n.width,A=n.height,J=F.makeMatrix(),L=J.applyInverse(Cl.toWorldPosition(E,{x:0,y:0})),B=J.applyInverse(Cl.toWorldPosition(E,{x:S,y:0})),x=J.applyInverse(Cl.toWorldPosition(E,{x:0,y:A})),U=J.applyInverse(Cl.toWorldPosition(E,{x:S,y:A})),H=Math.min(L.x,B.x,x.x,U.x),$=Math.max(L.x,B.x,x.x,U.x),p=Math.min(L.y,B.y,x.y,U.y),Y=Math.max(L.y,B.y,x.y,U.y);S=$-H,A=Y-p;var y=Math.ceil(H/W),G=Math.floor($/W),i=Math.ceil(p/W),s=Math.floor(Y/W);E.tx(),E.ty(),E._zoom;var K,a,v;for(P.save(),P.lineWidth=1,P.beginPath(),P.strokeStyle=Z,v=Math.ceil(y/k)*k;G>=v;v+=k)K=v*W,w(K,p,K,Y);for(v=Math.ceil(i/k)*k;s>=v;v+=k)a=v*W,w(H,a,$,a);for(P.stroke(),P.beginPath(),P.strokeStyle=e,v=y;G>=v;v++)0!==v%k&&(K=v*W,w(K,p,K,Y));for(v=i;s>=v;v++)0!==v%k&&(a=v*W,w(H,a,$,a));P.stroke(),P.restore()},Mj.prototype.getAlignmentGuides=function(){var E=this;return{x:E._xAlignmentGuide,y:E._yAlignmentGuide}},Mj.prototype.addAlignmentGuide=function($,N,f){var l=this,E="x"===$?l._xAlignmentGuide:l._yAlignmentGuide,f=f?f:++l._alignmentGuideId,M={p:N,id:f};if(E.length){var S=l._findClosestAlignmentGuide(M.p,E);S.dis<0?E.splice(S.index+1,0,M):E.splice(S.index,0,M)}else E.push(M);return l._interactor._42(),f},Mj.prototype.findClosest=function(s,n,z){var f=this,p=f._interactor,q=p.gv;z&&(s=Cl.toWorldPosition(q,s));var C,P,H,x=1/0,k=1/0,w=s.x,B=s.y;if(f.gridEnabled){var y=f.gridBlockSize,b=f.makeMatrix(),L=b.applyInverse(s);L=b.apply({x:Math.round(L.x/y)*y,y:Math.round(L.y/y)*y}),x=L.x-w,k=L.y-B,H=!0}if(p.alignmentGuideEnabled&&(C=f._findClosestAlignmentGuide(w,f._xAlignmentGuide).dis,P=f._findClosestAlignmentGuide(B,f._yAlignmentGuide).dis,Math.abs(C)<Math.abs(x)&&(x=C,H=!0),Math.abs(P)<Math.abs(k)&&(k=P,H=!0)),H){H=!1;var e=q._zoom,X=p.getStyle("smartGuideThreshold")/e,Z={};if(Math.abs(x)<X&&"y"!==n&&(Z.x=z?x*e:x,H=!0),Math.abs(k)<X&&"x"!==n&&(Z.y=z?k*e:k,H=!0),H)return Z}},Mj.prototype._findClosestAlignmentGuide=function(D,s){if(!s.length)return{dis:1/0};for(var Y,G=0,I=s.length-1;I-G>1;)Y=Math.floor((G+I)/2),s[Y].p<D?G=Y:I=Y;var X=s[G].p-D,x=s[I].p-D;return Math.abs(X)<=Math.abs(x)?{line:s[G],dis:X,index:G}:{line:s[I],dis:x,index:I}},Mj.prototype.removeAllAlignmentGuide=function(s){var u=this;"y"!==s&&(u._xAlignmentGuide=[]),"x"!==s&&(u._yAlignmentGuide=[]),u._interactor._42()},Mj.prototype.removeAlignmentGuide=function(H){for(var R,z,I,$=this,T=$._xAlignmentGuide,n=0;2>n;n++)for(T=0===n?$._xAlignmentGuide:$._yAlignmentGuide,R=0,z=T.length;z>R;R++)if(I=T[R],I.id===H)return T.splice(R,1),$._interactor._42(),{axis:0===n?"x":"y",position:I.p};return!1},Mj.prototype.adjustAlignmentGuide=function(M,J){var o=this,O=o.removeAlignmentGuide(M);return O?(o.addAlignmentGuide(O.axis,J,M),!0):!1};var Kj=Cl.Guide.Rect=function(x){var G=this;G._interactor=x};Kj.prototype={},Kj.prototype.constructor=Kj,Kj.prototype.gatherRects=function(){var o,A,_,L,h=this,N=h._interactor.gv,n=[],W=[],p={x:n,y:W},Q={},M=N.getDataModel(),m=M.a("width"),j=M.a("height");m&&j&&(o=0,A=0,_=m,L=j,n.push({node:M,type:0,p:o},{node:M,type:1,p:o+_/2},{node:M,type:2,p:o+_}),W.push({node:M,type:0,p:A},{node:M,type:1,p:A+L/2},{node:M,type:2,p:A+L}),Q[M._id||0]={x:o,y:A,width:_,height:L}),M.each(function(Y){if(Zb(Y)&&!N.isSelected(Y)&&N.isVisible(Y)&&N.isValidGuideLineSource(Y)){var v=!1;if(N.sm().getSelection().each(function(H){v||(Y.isHostOn(H)?v=!0:Y.isDescendantOf(H)&&(v=!0))}),!v){var y=Y.getRect();o=y.x,A=y.y,_=y.width,L=y.height,n.push({node:Y,type:0,p:o},{node:Y,type:1,p:o+_/2},{node:Y,type:2,p:o+_}),W.push({node:Y,type:0,p:A},{node:Y,type:1,p:A+L/2},{node:Y,type:2,p:A+L}),Q[Y._id]=y}}}),n.sort(function(U,d){return U.p-d.p}),W.sort(function(P,M){return P.p-M.p}),h._grid=p,h._87I=Q},Kj.prototype.gatherLines=function(H,P,M){var E,l,N,u,V,A,c,Y,F,f,w,m,e=this,y=[e.findClosest({x:H.x,y:H.y},P),e.findClosest({x:H.x+H.w/2,y:H.y+H.h/2},P),e.findClosest({x:H.x+H.w,y:H.y+H.h},P)],S={},s=e._87I;M=M||255;var D,q;for(e._guideLine=[],E=0;2>E;E++)for(S={},0===E?(u="y",Y=H.x,F=Y+H.w):(u="x",Y=H.y,F=Y+H.h),l=0;3>l;l++)V=y[l],V&&isFinite(V[u])&&(D=1<<3*E+l,M&D&&(A=V[u+"Line"],c=A.node,q=c._id||0,S[q]||(S[q]=!0,m=s[q],"y"===u?(f=m.x,w=m.x+m.width):(f=m.y,w=m.y+m.height),N=A.p,e._guideLine.push({type:u,a:Y,b:F,c:f,d:w,p:N,center:1===A.type}))))},Kj.prototype._binarySearchClosest=function(H,N){if(!N.length)return{dis:1/0};for(var c,i=0,q=N.length-1;q-i>1;)c=Math.floor((i+q)/2),N[c].p<H?i=c:q=c;var e=N[i].p-H,_=N[q].p-H;return Math.abs(e)<=Math.abs(_)?{line:N[i],dis:e}:{line:N[q],dis:_}},Kj.prototype.findClosest=function(c,Q,x){var E=this,v=E._interactor,Y=v.gv,m=E._grid;x&&(c=Cl.toWorldPosition(Y,c));var O,S=E._binarySearchClosest(c.x,m.x),N=E._binarySearchClosest(c.y,m.y),B=S.dis,i=N.dis,l=Y._zoom,F=v.getStyle("smartGuideThreshold")/l,g={};return Math.abs(B)<F&&"y"!==Q&&(g.x=x?B*l:B,g.xLine=S.line,O=!0),Math.abs(i)<F&&"x"!==Q&&(g.y=x?i*l:i,g.yLine=N.line,O=!0),O?g:void 0},Kj.prototype._42=function(){var O=this,w=O._guideLine;if(w&&!C.Default.isCtrlDown()){var N=O._interactor;if(N.getStyle("guideLineVisible")){var g,F,t,f,M,V,E,I,B,y,W,p,Z,q,d,o,H,Y=N.gv,D=N._context,h=Y.tx(),r=Y.ty(),K=Y._zoom,Q=N.getStyle("guideLineTextSpacing");for(g=0,F=w.length;F>g;g++)t=w[g],I=t.type,B=t.p,y=t.a,W=t.b,p=t.c,Z=t.d,q=Math.min(y,p),d=Math.max(W,Z),"x"===I?(f=B*K+h,M=q*K+r,V=f,E=d*K+r):(f=q*K+h,M=B*K+r,V=d*K+h,E=M),Cl.Icons.DrawIcon(N,D,Cl.Icons.MoveLineGuide,{rect:[f,M,V,E],center:t.center}),Z>=y&&W>=p||(q=y>Z?Z:W,d=y>Z?y:p,H=d-q,"x"===I?(t.center2center||(f-=Q,V=f),M=q*K+r,E=d*K+r,o=Cl.Icons.MoveLineGuideDistanceV):"y"===I&&(t.center2center||(M-=Q,E=M),f=q*K+h,V=d*K+h,o=Cl.Icons.MoveLineGuideDistanceH),Cl.Icons.DrawIcon(N,D,o,{x0:f,y0:M,x1:V,y1:E,dis:H}))}}},Kj.prototype.clear=function(){this._guideLine=null};var Xp=Cl.Guide.Hover=function(T){var P=this;P._interactor=T};Xp.prototype={},Xp.prototype.constructor=Xp,e.defineProperties(Xp.prototype,{}),Xp.prototype._42=function(){var e=this._interactor;if(e.getStyle("hoverGuideVisible")&&!e.gvEditing){var C=e.hoverData,S=e.gv;if(!Zb(C)||S.isSelected(C))return e.hoverData=null,void 0;var I=Ak(S,C),x=Cl.toScreenPosition(S,{x:I.x,y:I.y}),B=Cl.toScreenPosition(S,{x:I.x+I.width,y:I.y+I.height});Cl.Icons.DrawIcon(e,e._context,Cl.Icons.HoverDataRect,{min:x,max:B,color:e.getStyle("hoverGuideColor")||e.getStyle("baseColor")})}},Cl.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Bh=Cl.Icons={},nq=1e4,yr=null,Jc=Cl.DefaultStyleMap.baseColor,Fg="rgb(183,232,135)",tc="rgb(255,204,153)",In=6;C.Default.setImage("Icons.RectPoint",{width:In,height:In,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Jc}},rect:[0,0,In,In]}]}),Bh.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var o=Bh.GroupSubEntityRect.data;if(!o)return[];var F=o.min,n=o.max;return[F.x,F.y,F.x,n.y,n.x,n.y,n.x,F.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Bh.GroupSubEntityRect.data.isKeyOb?Jc:Jc}}}]};var id=4;Bh.HoverDataRect={comps:[{type:"shape",points:{func:function(){var M=Bh.HoverDataRect.data;if(!M)return[];var p=M.min,n=M.max,W=id;return p.x-=W,p.y-=W,n.x+=W,n.y+=W,[p.x,p.y,p.x,n.y,n.x,n.y,n.x,p.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Bh.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},Bh.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Bh.Line.data.P1.x,Bh.Line.data.P1.y],In,In]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Bh.Line.data.P2.x,Bh.Line.data.P2.y],In,In]}}}]},Bh.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Bh.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Bh.Rect={comps:[{type:"shape",points:{func:function(){var u=Bh.Rect.data;if(!u)return[];var w=u.LT,g=u.LB,Z=u.RB,J=u.RT;return[w.x,w.y,g.x,g.y,Z.x,Z.y,J.x,J.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Jc}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Bh.Rect.data.rotation}},rect:{func:function(){return[[Bh.Rect.data.LT.x,Bh.Rect.data.LT.y],In,In]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Bh.Rect.data.rotation}},rect:{func:function(){return[[Bh.Rect.data.LB.x,Bh.Rect.data.LB.y],In,In]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Bh.Rect.data.rotation}},rect:{func:function(){return[[Bh.Rect.data.RB.x,Bh.Rect.data.RB.y],In,In]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Bh.Rect.data.rotation}},rect:{func:function(){return[[Bh.Rect.data.RT.x,Bh.Rect.data.RT.y],In,In]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Bh.Rect.data.rotation}},visible:{func:function(){return Bh.Rect.data.L?!0:!1}},rect:{func:function(){return[[Bh.Rect.data.L.x,Bh.Rect.data.L.y],In,In]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Bh.Rect.data.rotation}},visible:{func:function(){return Bh.Rect.data.R?!0:!1}},rect:{func:function(){return[[Bh.Rect.data.R.x,Bh.Rect.data.R.y],In,In]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Bh.Rect.data.rotation}},visible:{func:function(){return Bh.Rect.data.T?!0:!1}},rect:{func:function(){return[[Bh.Rect.data.T.x,Bh.Rect.data.T.y],In,In]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Bh.Rect.data.rotation}},visible:{func:function(){return Bh.Rect.data.B?!0:!1}},rect:{func:function(){return[[Bh.Rect.data.B.x,Bh.Rect.data.B.y],In,In]}}}]};var _h=16;C.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return Jc}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return Jc}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Bh.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Bh.Anchor.data.POS.x,Bh.Anchor.data.POS.y],_h,_h]}}}]},Bh.TipShiftX=12,Bh.TipShiftY=12;var Cp=[8,28];Bh.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Bh.TipHelper.data.helperPos.x,Bh.TipHelper.data.helperPos.y,Cp[0]*Bh.TipHelper.data.size,Cp[1]]}},background:{func:function(){return yr.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Bh.TipHelper.data.text}},rect:{func:function(){return[Bh.TipHelper.data.helperPos.x,Bh.TipHelper.data.helperPos.y,Cp[0]*Bh.TipHelper.data.size,Cp[1]]}},color:{func:function(){return yr.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var vr=7;Bh.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Bh.ShapePoint.data.dynamicVisible}},rect:{func:function(){var V=Bh.ShapePoint.data.point,q=Bh.ShapePoint.data.size||vr;return[V,q+10,q+10]}},background:{func:function(){var P=Date.now(),u=Bh.ShapePoint.data.dynamicPeriod||1500,w=Math.sin(P%u/u*Math.PI);return"rgba(27,124,22,"+.5*w+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var n=Bh.ShapePoint.data.point,q=Bh.ShapePoint.data.size||vr;return[n,q,q]}},background:{func:function(){var n=Bh.ShapePoint.data.isEnd;return n?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Bh.ShapePoint.data.color||Jc}}},{type:"rect",visible:{func:function(){return!!Bh.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return Jc}},rect:{func:function(){var R=5;return[Bh.ShapePoint.data.point,R,R]}}}]},Bh.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Bh.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Bh.ShapeBgCurve.data.P}},segments:{func:function(){return Bh.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var C=Date.now(),E=Bh.ShapeBgCurve.data.dynamicPeriod||1500,k=Math.sin(C%E/E*Math.PI);return"rgba(27,124,22,"+.3*k+")"}}},{type:"shape",points:{func:function(){return Bh.ShapeBgCurve.data.P}},segments:{func:function(){return Bh.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Bh.ShapeBgCurve.data.color||Jc}}}]};var Sd=8;Bh.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var c=Bh.ShapeHighlighPoint.data;return[[c.x,c.y],Sd,Sd]}},background:{func:function(){return yr.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var mb=10;Bh.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var J=Bh.ShapeHighlighRealPoint.data;return[[J.x,J.y],mb,mb]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return Jc}}}]};var ib=8;Bh.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var d=Bh.ShapeHighlighCtrlPoint.data,L=d.x,v=d.y,n=ib/2;return[L-n,v-n,L-n,v+n,L+n,v+n,L+n,v-n]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return yr.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return yr.getStyle("shapeCtrlPointBorderColor")||Jc}}}]};var Qr=3;Bh.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Bh.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Qr,borderColor:{func:function(){return yr.getStyle("curveHighlightColor")}}}]},Bh.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Bh.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Bh.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Bh.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Bh.MoveLineGuide.data.center?Fg:tc}}}]};var Ib=5;Bh.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var h=Bh.MoveLineGuideDistanceH.data,P=h.x0,n=h.y0;return[P,n-Ib,P,n+Ib]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:tc},{type:"shape",points:{func:function(){var Y=Bh.MoveLineGuideDistanceH.data,U=Y.x1,a=Y.y1;return[U,a-Ib,U,a+Ib]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:tc},{type:"text",text:{func:function(){return Math.round(Bh.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var $=Bh.MoveLineGuideDistanceH.data;return[[($.x0+$.x1)/2,$.y0-10],20,20]}},color:tc,font:"12px Arial",align:"center"}]},Bh.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var h=Bh.MoveLineGuideDistanceV.data,O=h.x0,j=h.y0;return[O-Ib,j,O+Ib,j]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:tc},{type:"shape",points:{func:function(){var o=Bh.MoveLineGuideDistanceV.data,u=o.x1,A=o.y1;return[u-Ib,A,u+Ib,A]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:tc},{type:"text",text:{func:function(){return Math.round(Bh.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var D=Bh.MoveLineGuideDistanceV.data;return[[D.x0-10,(D.y0+D.y1)/2],20,20]}},color:tc,font:"12px Arial",align:"center"}]},C.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Bh.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var f=Bh.EdgeElevationGuide.data,Q=f.x,C=f.y,y=yr.getStyle("curveElevationIntersectSize"),X=yr.getStyle("curveElevationGuideShift");return Q+=X[0],C+=X[1],[Q-y,C-y,2*y,2*y]}}}]},C.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),C.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Bh.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Bh.ConnectGuide.data.rotation
}},rect:{func:function(){var c=Bh.ConnectGuide.data.connect;c.x,c.y;var J=yr.getStyle("connectGuideIntersectSize");return[[c.x,c.y],2*J,2*J]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var S=Bh.ConnectGuide.data.cursorPos||Bh.ConnectGuide.data.connect,X=yr.getStyle("connectGuideIntersectSize");return[[S.x,S.y],2*X-2,2*X-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var e=Bh.ConnectGuide.data.connect,p=Bh.ConnectGuide.data.cursorPos||e;return[e.x,e.y,e.x+.5*(p.x-e.x),e.y,p.x+.5*(e.x-p.x),p.y,p.x,p.y]}}}]},C.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),C.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Bh.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var U=Bh.ConnectGuideGarbage.data.hover;return U?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var r=Bh.ConnectGuideGarbage.data,i=yr.getStyle("connectGuideGarbageIntersectsize");return r.hover&&(i+=5),[[r.x,r.y],2*i,2*i]}}}]};var zc=6;Bh.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Bh.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var D=Bh.ShapeActivingCtrl.data;return[D.point.x,D.point.y,D.c1.x,D.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Jc}}},{type:"shape",visible:{func:function(){return Bh.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var u=Bh.ShapeActivingCtrl.data;return[u.point.x,u.point.y,u.c2.x,u.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Jc}}},{type:"shape",visible:{func:function(){return Bh.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var k=Bh.ShapeActivingCtrl.data.c1,l=k.x,g=k.y,n=zc/2;return"c1"===Bh.ShapeActivingCtrl.data.hl&&(n+=.5),[l-n,g-n,l-n,g+n,l+n,g+n,l+n,g-n]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return yr.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Bh.ShapeActivingCtrl.data.hl?yr.getStyle("shapeCtrlPointHighlightBorder")||Jc:yr.getStyle("shapeCtrlPointBorderColor")||Jc}}},{type:"shape",visible:{func:function(){return Bh.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var u=Bh.ShapeActivingCtrl.data.c2,S=u.x,Y=u.y,F=zc/2;return"c2"===Bh.ShapeActivingCtrl.data.hl&&(F+=.5),[S-F,Y-F,S-F,Y+F,S+F,Y+F,S+F,Y-F]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return yr.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Bh.ShapeActivingCtrl.data.hl?yr.getStyle("shapeCtrlPointHighlightBorder")||Jc:yr.getStyle("shapeCtrlPointBorderColor")||Jc}}}]},Bh.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Jc}},rect:{func:function(){return[[Bh.RoundPoint.data.x,Bh.RoundPoint.data.y],In,In]}}}]},Bh.AttachPoint={comps:[{type:"rect",background:{func:function(){return Bh.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return Jc}},rect:{func:function(){var j=Bh.AttachPoint.data.isAttach?In+4:In;return[[Bh.AttachPoint.data.x,Bh.AttachPoint.data.y],j,j]}}}]},Bh.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Bh.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Bh.SimpleRect.data.color||Jc}},rect:{func:function(){var J=Bh.SimpleRect.data;return[J.x,J.y,J.width,J.height]}}}]},C.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Bh.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var q=Bh.MoveDummy.data;return[[q.pos.x,q.pos.y],2*q.size,2*q.size]}}}]},Cl.Icons.DrawIcon=function(c,J,K,Q){K.width=K.height=nq,K.data=Q,yr=c,C.Default.drawImage(J,K,0,0,nq,nq)},Cl.Icons.MapPoints=function(V,r){for(var G=0,L=V.length;L>G;G++)V[G]/=r},Cl.roundTo=function(U,e,C){var O=Math.abs(U%e);return C>O||C>e-O?e*Math.round(U/e):U},Cl.toFixed=function(z){return Math.round(100*z)/100},Cl.getDataMatrix=function(H){if(H instanceof C.Shape){var z=new C.Math.Matrix2d,Z=H.getPosition();return z.translate(-Z.x,-Z.y).scale(H.getScale().x,H.getScale().y).rotate(H.getRotation()).translate(Z.x,Z.y),z}return H.getMatrix?H.getMatrix():new C.Math.Matrix2d};var Bo=Cl.Math.Curve=function(){this._curves=[]};Bo.prototype={},Bo.prototype.constructor=Bo,Bo.prototype.createFromHtShape=function(M,t,B){t instanceof C.List&&(t=t.toArray());var z,f,s,Y,R,U,l,J=this,P=null,n=null,S=0,r=Cl.Math.Vector2,y=Cl.Math.CubicBezier,d=function(H){return new r(M[H],M[H+1],B?B[H/2]:$)};for(f=0,s=t.length;s>f;f++){switch(Y=t[f],R=null,Y){case 1:n=d(S),P=n,S+=2;break;case 2:z=d(S),S+=2,R=new y(n,n.clone(),z.clone(),z),n=z;break;case 3:U=d(S),z=d(S+2),S+=4,R=new y(n,U.clone().sub(n).multiplyScalar(2/3).add(n),U.clone().sub(z).multiplyScalar(2/3).add(z),z),n=z;break;case 4:U=d(S),l=d(S+2),z=d(S+4),S+=6,R=new y(n,U,l,z),n=z;break;case 5:if(!P)break;R=new y(n,n.clone(),P.clone(),P),n=null,P=null}R&&(R._index=J._curves.length,J._curves.push(R))}},Bo.prototype.checkPoint=function(S,C){var v,m,M,e,Q,t=this,k=t._curves;for(v=0,m=k.length;m>v;v++)if(e=k[v],Q=e.intersectRect(S,C,C),Q.length)return M=0,Q.forEach(function(x){M+=x.t}),M/=Q.length,S=e.getPointAt(M),S.t=M,{bezier:e,intersection:S}},Bo.prototype.insertKnot=function(U,e){var s=U.insertKnot(e),O=this,L=O._curves;L.splice(U._index,1,s[0],s[1])},Bo.prototype._isCloseEnough=function(B,W){return Math.abs(B.x-W.x)<1e-6&&Math.abs(B.y-W.y)<1e-6},Bo.prototype._isSamePoint=function(G,y){return G===y},Bo.prototype.moveRealPoint=function(M,c){var V=this,L=V._curves,N=c.clone().sub(M);L.forEach(function(n){var L=n._p1;n._p2,n._p3;var P=n._p4;V._isSamePoint(L,M)&&(n._p2.add(N),n._p1=c),V._isSamePoint(P,M)&&(n._p3.add(N),n._p4=c)})},Bo.prototype.moveCtrlDueToRealPointMovement=function(T,o){var c=this,Z=c._curves,q=function(j){j.add(o),j.e&&o.e&&(j.e+=o.e)};Z.forEach(function(E){var s=E._p1;E._p2,E._p3;var e=E._p4;c._isSamePoint(s,T)&&q(E._p2),c._isSamePoint(e,T)&&q(E._p3)})},Bo.prototype.moveCtrlPoint=function(I,L,V){var u=I[V];if(u){u.e!==$&&(L.e=u.e);var P=this,_=P._curves;L.clone().sub(u),_.forEach(function(A){var Q;"c2"===V?Q="_p2":"c1"===V&&(Q="_p3"),P._isSamePoint(A[Q],u)&&(A[Q]=L)}),I[V]=L}},Bo.prototype.deleteRealPoint=function(y,m){var R,H,J,Q,Z,b,x,t=this,k=t._curves,n={},j=[],h=Cl.Math.CubicBezier;for(H=0,J=k.length;J>H;H++)R=k[H],Q=R._p1,Z=R._p2,b=R._p3,x=R._p4,(n[H]||!t._isSamePoint(Q,y))&&(t._isSamePoint(x,y)?J>H+1&&t._isSamePoint(k[H+1]._p1,y)&&(m||j.push(new h(Q,Z,k[H+1]._p3,k[H+1]._p4))):j.push(R));t._curves=j},Bo.prototype.findPairs=function(b,Y){var O,e,F,G,a,i,A,q,z=this,l=z._curves,g={},W=[];for(e=0,F=l.length;F>e;e++)O=l[e],G=O._p1,a=O._p2,i=O._p3,A=O._p4,!g[e]&&z._isSamePoint(G,b)&&(Y?W.push({point:G,r2:A}):W.push({point:G,c2:a})),z._isSamePoint(A,b)&&(q=Y?{point:A,r1:G}:{point:A,c1:i},F>e+1&&z._isSamePoint(l[e+1]._p1,b)&&(Y?q.r2=l[e+1]._p4:q.c2=l[e+1]._p2,g[e+1]=!0),W.push(q));return W},Bo.prototype.toHtShape=function(){var j=this,l=j._curves,h=[],z=[],Y={x:1/0,y:1/0};return l.forEach(function($){var n=$._p1,k=$._p2,J=$._p3,C=$._p4;return j._isCloseEnough(n,Y)||(h.push(1),z.push(n.clone())),Y=C,j._isCloseEnough(n,k)&&j._isCloseEnough(J,C)?(h.push(2),z.push(C.clone()),void 0):(h.push(4),z.push(k.clone(),J.clone(),C.clone()),void 0)}),{segments:h,points:z}};var um=Cl.Math.CubicBezier=function(l,U,c,z){var t=this;t._id=Cl.Math.CubicBezier._globalId++,t._p1=l,t._p2=U,t._p3=c,t._p4=z};um._globalId=1,um.prototype={},um.prototype.constructor=um,um.prototype.toString=function(){return this._id},um.prototype.intersectRect=function(_,C,e){var L=C/2,w=e/2,P=_.x,g=_.y,J=Cl.Math.Vector2,l=new J(-L+P,-w+g),t=new J(L+P,w+g),p=new J(t.x,l.y),W=new J(l.x,t.y),s=this,m=s.intersectLine(l,p),N=s.intersectLine(p,t),I=s.intersectLine(t,W),r=s.intersectLine(W,l),K=m.concat(N).concat(I).concat(r);return K},um.prototype.intersectLine=function(Z,V){var f,l,R,m,b,d,t,F,X,O,H,I,W,L=this,g=Z.clone().min(V),h=Z.clone().max(V);m=L._p1,b=L._p2,d=L._p3,t=L._p4,f=m.clone().multiplyScalar(-1),l=b.clone().multiplyScalar(3),R=d.clone().multiplyScalar(-3),H=f.add(l).add(R).add(t),f=m.clone().multiplyScalar(3),l=b.clone().multiplyScalar(-6),R=d.clone().multiplyScalar(3),O=f.add(l).add(R),f=m.clone().multiplyScalar(-3),l=b.clone().multiplyScalar(3),X=f.add(l),F=m.clone(),W=new Cl.Math.Vector2(Z.y-V.y,V.x-Z.x),I=Z.x*V.y-V.x*Z.y;for(var T=L.getRoots(W.dot(H),W.dot(O),W.dot(X),W.dot(F)+I),q=new Array,A=0,s=T.length;s>A;A++){var p=T[A];if(!(0>p||p>1)){var N=L.getPointAt(p);N.t=p,Z.x==V.x?g.y<=N.y&&N.y<=h.y&&q.push(N):Z.y==V.y?g.x<=N.x&&N.x<=h.x&&q.push(N):N.x>=g.x&&N.y>=g.y&&N.x<=h.x&&N.y<=h.y&&q.push(N)}}return q},um.prototype.solveTForPoint=function(F){var I,p,Q,P,l=this;I=l._p1.x-F.x,p=l._p2.x-F.x,Q=l._p3.x-F.x,P=l._p4.x-F.x;for(var i=l.getRoots(P-3*Q+3*p-I,3*Q-6*p+3*I,3*p-3*I,I),q=$,m=1/0,v=0,J=i.length;J>v;v++){var M=i[v];if(!(0>M||M>1)){var a=l.getPointAt(M);a.t=M;var k=Math.abs(a.y-F.y);m>k&&(m=k,q=a)}}return q},um.prototype.getPointAt=function(d){var H=this,I=H._p1,k=H._p2,O=H._p3,j=H._p4,r=I.clone().lerp(k,d),c=k.clone().lerp(O,d),L=O.clone().lerp(j,d),M=r.lerp(c,d),K=c.lerp(L,d);return M.lerp(K,d)},um.prototype.getPointByPercentage=function(F){var h=this.length*F,a=this._cacheLength,I=a.length;if(0===h)return a[0].point;if(F>=1)return a[I-1].point;for(var i=0;I>i;i++){var G=a[i];if(!(G.len<h)){var O=a[i-1];return G.point.clone().sub(O.point).setLength(h-O.len).add(O.point)}}},um.prototype.getTByPercentage=function(C){var s=this.length*C,m=this._cacheLength,n=m.length;if(0===s||0>=C)return m[0].t;if(C>=1)return m[n-1].t;for(var U=0;n>U;U++){var x=m[U];if(!(x.len<s)){var h=m[U-1];return(s-h.len)/(x.len-h.len)*(x.t-h.t)+h.t}}},um.prototype.getRoots=function(x,I,P,O){var d,v,N,W,b,w=new Array;if(Math.abs(x)<1e-6){var d=I,v=P/d,N=O/d,W=v*v-4*N;if(W>0){var b=Math.sqrt(W);w.push(.5*(-v+b)),w.push(.5*(-v-b))}else 0==W&&w.push(.5*-v)}I/=x,P/=x,O/=x,d=(3*P-I*I)/3,v=(2*I*I*I-9*P*I+27*O)/27;var Z=I/3,y=v*v/4+d*d*d/27,Q=v/2;if(Math.abs(y)<=1e-6&&(y=0),y>0){var K,f,b=Math.sqrt(y);K=-Q+b,f=K>=0?Math.pow(K,1/3):-Math.pow(-K,1/3),K=-Q-b,K>=0?f+=Math.pow(K,1/3):f-=Math.pow(-K,1/3),w.push(f-Z)}else if(0>y){var T=Math.sqrt(-d/3),p=Math.atan2(Math.sqrt(-y),-Q)/3,J=Math.cos(p),i=Math.sin(p),n=Math.sqrt(3);w.push(2*T*J-Z),w.push(-T*(J+n*i)-Z),w.push(-T*(J-n*i)-Z)}else{var K;K=Q>=0?-Math.pow(Q,1/3):Math.pow(-Q,1/3),w.push(2*K-Z),w.push(-K-Z)}return w},um.prototype._70I=function(){var p=this;return p._p1.distanceToSquared(p._p2)<1e-10&&p._p3.distanceToSquared(p._p4)<1e-10},um.prototype.insertKnot=function(D){var l=this,C=l._p1,k=l._p2,Y=l._p3,q=l._p4,F=C.clone().lerp(k,D),y=k.clone().lerp(Y,D),O=Y.clone().lerp(q,D),T=F.clone().lerp(y,D),z=y.clone().lerp(O,D),Q=T.clone().lerp(z,D);return l._70I()?(C.clone().lerp(q,D),[new Cl.Math.CubicBezier(C,C.clone(),Q.clone(),Q),new Cl.Math.CubicBezier(Q,Q.clone(),q.clone(),q)]):[new Cl.Math.CubicBezier(C,F,T,Q),new Cl.Math.CubicBezier(Q,z,O,q)]},e.defineProperties(um.prototype,{length:{get:function(){var i=this._cacheLength;if(!i){i=this._cacheLength=[];for(var D=this._p1,n=0,t=0;1>=n;){var d=this.getPointAt(n+=.001);t+=d.clone().sub(D).length(),D=d,i.push({len:t,t:n,point:d.clone()})}}return i[i.length-1].len}},p1:{get:function(){return this._p1},set:function(l){this._p1=l,this._cacheLength=$}},p2:{get:function(){return this._p2},set:function(U){this._p2=U,this._cacheLength=$}},p3:{get:function(){return this._p3},set:function(B){this._p3=B,this._cacheLength=$}},p4:{get:function(){return this._p4},set:function(U){this._p4=U,this._cacheLength=$}}});var lo=C.Default.getInternal().ui().EdgeUI,Do={_47O:function(S){var l=this,P=Do.getBackups()._47O;Cl.inEdit(l.gv)||P.call(l,S)}};Cl.Inject.registAsModule(Do,lo);var Hm=C.Default.getInternal().ui().NodeUI,Hq={_47O:function(l){var s=this,X=Hq.getBackups()._47O;Cl.inEdit(s.gv)||X.call(s,l)},getSelectWidth:function(){var K=this,e=K.gv,f=K._data;if(e.isEditable(f)&&Cl.inEdit(e))return 0;var P=Hq.getBackup("getSelectWidth");return P.call(K)}};Cl.Inject.registAsModule(Hq,Hm);var Ep=C.graph.GraphView,Be={_editPointSize:function(){var j=C.Default.isTouchable,U=Cl.getStyle("pointSize");return U[j?0:1]}(),isPointEditable:function(J){var R=this;if(Cl.inEdit(R))return R._pointEditableFunc?R._pointEditableFunc(J):!0;var N=Be.getBackup("isPointEditable");N.call(R,J)},isEditable:function(h){var q,g=this,l=Be.getBackup("isEditable");if(q=h instanceof Cl.Group?!0:l.call(g,h),!Cl.inEdit(g))return q;if(!(h instanceof C.Edge))return q;if(!h.s("2d.editable"))return!1;var Y=g.getEditableFunc();return Y?Y(h):!0},_42:function(b,t){var u=this,n=Be.getBackups()._42;if(n.call(u,b,t),Cl.inEdit(u)){var M=u.getEditInteractor();M.drawImpl()}}};Cl.Inject.registAsModule(Be,Ep);var bk=C.Default.getInternal().ui().ShapeUI,Mp={_47O:function(m){var f=this,R=Mp.getBackups()._47O;Cl.inEdit(f.gv)||R.call(f,m)}};Cl.Inject.registAsModule(Mp,bk);var Df=C.graph.DefaultInteractor,Cn={handle_mousewheel:function(G){var R=this,v=Cn.getBackup("handle_mousewheel");Cl.inEdit(R.gv)||v.call(R,G)}};Cl.Inject.registAsModule(Cn,Df);var nf=C.graph.MoveInteractor,gn={_calcShift:function(J,P){var g=this,a=gn.getBackup("_calcShift"),x=g.gv;if(!Cl.inEdit(x))return a.call(g,J,P);var E=x.getEditInteractor(),A=E.getSubModule("Move").calcShift(J,P,g);return A||a.call(g,J,P)},clear:function(Z){var h=this,M=gn.getBackup("clear");M.call(h,Z);var z=h.gv;if(Cl.inEdit(z)){var j=z.getEditInteractor();j.getSubModule("Move").clear(Z)}}};Cl.Inject.registAsModule(gn,nf);var Kj=Cl.Rect=function(v){this.catalog="Rect",this._interactor=v};Kj.prototype={},Kj.prototype.constructor=Kj,Kj.prototype.gatherInfo=function(I,$){var _=this;if(1===$.length){var v=$[0];return v instanceof C.Shape&&v._70I()?_.gatherLine(I,v):Bd(v,I)?!1:_.gatherSingleTarget(I,v)}return $.length>1?_.gatherMultiTargets(I,$):!1},Kj.prototype.gatherSingleTarget=function(l,t){if(t.getCorners){var C,u=this,_=u.info;u.target=t,C=u.screenInfo={};var n=t.getCorners();_.LT=new Cl.Math.Vector2(n[0]),_.LB=new Cl.Math.Vector2(n[1]),_.RB=new Cl.Math.Vector2(n[2]),_.RT=new Cl.Math.Vector2(n[3]),_.T=_.LT.clone().add(_.RT).divideScalar(2),_.B=_.LB.clone().add(_.RB).divideScalar(2),_.L=_.LT.clone().add(_.LB).divideScalar(2),_.R=_.RT.clone().add(_.RB).divideScalar(2);for(var K in _)C[K]=Cl.toScreenPosition(l,_[K]);var v=u._interactor,d=v.getStyle("checkSize"),z=function(W,X,_){var i=X.clone().sub(W).setLength(-d),Z=_.clone().sub(W).setLength(-d),S=i.add(Z).add(W);return S};return C.rotLT=z(C.LT,C.RT,C.LB),C.rotLB=z(C.LB,C.LT,C.RB),C.rotRB=z(C.RB,C.LB,C.RT),C.rotRT=z(C.RT,C.LT,C.RB),C.rotT=C.rotLT.clone().add(C.rotRT).divideScalar(2),C.rotB=C.rotLB.clone().add(C.rotRB).divideScalar(2),C.rotL=C.rotLT.clone().add(C.rotLB).divideScalar(2),C.rotR=C.rotRT.clone().add(C.rotRB).divideScalar(2),C.rotation=t.getRotation(),u.gatherConnectInfo(),!0}},Kj.prototype.gatherConnectInfo=function(){var i=this,o=i.target,v=i._interactor,g=i.screenInfo,q=v.gv;if(q.isConnectActionVisible(o)&&v.getStyle("connectGuideVisible")){var B;o.s&&(B=o.s("connectGuideShift")),B||(B=v.getStyle("connectGuideShift"));var P=o.getAnchor(),Z=o.getSize(),_=o.toGlobal({x:Z.width*(B[0]-P.x),y:Z.height*(B[1]-P.y)});_=Cl.toScreenPosition(q,_),g.P1?_.add(g.P2.clone().sub(g.P1).setLength(B[2])):(_.add(g.RT.clone().sub(g.LT).setLength(B[2])),_.add(g.LB.clone().sub(g.LT).setLength(B[3]))),g.connect=_}},Kj.prototype.gatherMultiTargets=function(K,z){var o=Cl.Group.findOrCreateGroup(z);if(!o)return!1;var f=this;return f.editing&&"rotate"!==f.editing.mode||o.calcInfo(),f.gatherSingleTarget(K,o)},Kj.prototype.gatherLine=function(x,g){this.target=g;var H=this.screenInfo={},u=g.getPoints(),i=Cl.getDataMatrix(g);return H.P1=Cl.toScreenPosition(x,i.apply(u.get(0))),H.P2=Cl.toScreenPosition(x,i.apply(u.get(1))),this.gatherConnectInfo(),!0},Kj.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Kj.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Kj.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Kj.prototype.check=function(D,H,c){if(C.Default.isLeftButton(H)){var R=this;if(R.editing=null,R.tipInfo=null,R.screenInfo){var X=R.target,O=D.isEditable(X),u=R.screenInfo;if(O&&u.connect){var W=R._checkConnect(c);if(W)return W}if(u.P1)return R._checkLine(c);var z,w,o,E=null,$=R._interactor,T=$.getStyle("checkSize");if(O&&D.isRectEditable(X))for(w=0;w<Cl.Rect.ResizeKeys.length;w++)if(o=Cl.Rect.ResizeKeys[w],Cl.checkHit(c,u[o],T)){E=o,z="resize";break}if(!E&&O&&D.isRotationEditable(X)&&!$.getStyle("rotateAsClock")){var y=$.getStyle("rotateCheckSize");for(w=0;w<Cl.Rect.RotateKeys.length;w++)if(o=Cl.Rect.RotateKeys[w],Cl.checkHit(c,u[o],y)){E=o,z="rotate";break}}if(!E)return $.setCursor("default"),void 0;if("rotate"===z){var p,k=D.lp(H);if(X instanceof Cl.Group){var B=$.getStyle("groupRotateModeKey");"string"==typeof B&&(B=[B]);for(var S=!1,x=0,i=B.length;i>x;x++)if(H[B[x]]){S=!0;break}var N=$.getStyle("groupRotateModeDefault");p=S?"batch"===N?"block":"batch":N}var M="batch"===p?X.getAnchor2():X.getPosition(),Q=Math.atan2(k.y-M.y,k.x-M.x);$._setRotateCursor(Q),R.editing={mode:z,key:E,pos:M,flipY:X.getScale().y<0,rotation:X.getRotation(),hitRot:Q},p&&(R.editing.groupRotateMode=p)}else{var J=Cl.Rect.ResizeKeys.indexOf(E),h=Cl.Rect.ResizeDirection[J],b=Math.cos(X.getRotation()),r=Math.sin(X.getRotation()),G=h.x*Math.sign(X.getScale().x),s=h.y*Math.sign(X.getScale().y),n=Math.atan2(-r*G-b*s,b*G-r*s),L=(Math.round(n/(Math.PI/4))+8)%8,f=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][L];this._interactor.setCursor(f);var F=X.getWidth(),K=X.getHeight(),q=X.getAnchor();R.editing={mode:z,key:E,rect:{x:-F*q.x,y:-K*q.y,width:F,height:K},anchor:q,matrix:X.getMatrix()}}return E}}},Kj.prototype._checkLine=function(O){var o=this;o.screenInfo;var L,x=o._interactor.getStyle("checkSize");if(Cl.checkHit(O,o.screenInfo.P1,x))L="P1";else{if(!Cl.checkHit(O,o.screenInfo.P2,x))return this._interactor.setCursor("default"),void 0;L="P2"}return o.editing={mode:"line",key:L},L},Kj.prototype._checkConnect=function(T){var R=this,_=R.screenInfo,A=R._interactor,u=A.getStyle("connectGuideIntersectSize"),I=_.connect,x=T.x,z=I.x;if(z>x&&u>z-x&&Math.abs(I.y-T.y)<u||x>=z&&Cl.checkHit(T,I,u)){var h="connect",f=B.getConnectAction(A.gv);if(R.editing={mode:h},f&&f.delete)if(R.target instanceof Cl.Group){var c=!0;A.gv.sm().getSelection().each(function(V){f.delete.visible.call(null,A.gv,V)||(c=!1)}),R.editing.hasDeleteAction=c}else f.delete.visible.call(null,A.gv,R.target)&&(R.editing.hasDeleteAction=!0);return A.setCursor("default"),h}},Kj.prototype._fireEditEvent=function(z,H){var Z=this._interactor,s=this.editing;if(s){var W=s.mode;W="rotate"===W?"Rotation":"connect"===W?"Connection":"resize"===W?"Rect":W[0].toUpperCase()+W.slice(1),Z.fi({kind:z+"Edit"+W,event:H})}},Kj.prototype.startEdit=function(b,i){b.startDragging(i);var L=this;L._interactor.fi({kind:"prepareEdit",event:i});var H=L.editing,U=L.target;if(H){if(L._fireEditEvent("begin",i),"rotate"===H.mode)return H.groupRotateMode&&U.beginRotate(H),void 0;if("connect"!==H.mode)("line"===H.mode||U&&0===U.getRotation())&&(L._inSmartGuide=!0,L._interactor.rectGuide.gatherRects());else if(H.hasDeleteAction){var $=b.gv,D=L._interactor.getStyle("connectGuideGarbageShift");H.garbageInfo={x:$.getWidth()*D[0]+D[2],y:$.getHeight()*D[1]+D[3],size:L._interactor.getStyle("connectGuideGarbageIntersectsize")},b._42()}}},Kj.prototype._46O=function(u){var F,b,A=this,o=A.editing,p=A.target;if(o){if("connect"===o.mode&&!o.canceled&&!o.deleted)try{o.garbageInfo&&o.garbageInfo.hover?B.doDeleteConnectionAction(A._interactor.gv,p):B.doConnectAction(A._interactor.gv,p,o.target)}catch(Z){console.error(Z)}b=o.freezeFlag,F=A.editing.groupRotateMode,A._fireEditEvent("end",u),A.editing=null}A.tipInfo=null,A._inSmartGuide&&(A._interactor.rectGuide.clear(),A._inSmartGuide=!1),F&&p&&p.endRotate(),p instanceof C.Block&&(b===$?delete p._freezeSyncFromChildren:p._freezeSyncFromChildren=b,p.updateFromChildren())},Kj.prototype.handleNormalStateDelete=function(){var H=this,P=H.editing;if(P&&"connect"===P.mode&&!P.canceled&&!P.deleted){if(P.garbageInfo){try{B.doDeleteConnectionAction(H._interactor.gv,H.target)}catch(y){console.error(y)}P.garbageInfo=null}return P.cursorPos=null,P.targetCorners=null,P.deleted=!0,H._interactor._42(),!0}},Kj.prototype.handleNormalStateKeyDown=function(B){var J=this,u=J.editing;return!u||"connect"!==u.mode||u.canceled||u.deleted?void 0:C.Default.isEsc(B)?(u.cursorPos=null,u.targetCorners=null,u.canceled=!0,J._interactor._42(),!0):void 0},Kj.prototype.handleEdit=function(Z,s){var z=this,_=z.editing;if(_){var R,b,n,B,H,f=z.target,M=_.key,$=_.mode,t=Z.lp(s),c=z._interactor;if("connect"===$){if(_.canceled)return;if(_.deleted)return;_.cursorPos=c._getLogicalPoint(s);var q=_.garbageInfo;return q&&Cl.checkHit(_.cursorPos,q,q.size)?(q.hover=!0,_.target=null,_.targetCorners=null):(q&&(q.hover=!1),_.target=Z.getDataAt(t,function(q){return Z.isSelectable(q)?Zb(q)?!0:!1:!1})||null,_.targetCorners=Cl.getTargetCornersOnScreen(Z,_.target)),c._42(),void 0}if("rotate"===$){var k,u,Q=_.pos,J=Math.atan2(t.y-Q.y,t.x-Q.x);if(_.groupRotateMode?u=J-_.hitRot:(k=J-_.hitRot,u=_.rotation+k),u%=2*Math.PI,0>u&&(u+=2*Math.PI),!C.Default.isCtrlDown(s)){var r,A;Fk(s)?(r=c.getStyle("shiftRotateRound"),A=r/2):(r=c.getStyle("rotateRound"),A=c.getStyle("rotateSensitivity")),u=Cl.roundTo(u,r,A)}_.groupRotateMode?(k=u-(_.lastRotation||0),0!==k&&(f.addRotation(k,_.groupRotateMode,function(g){return Z.isRotationEditable(g)}),_.lastRotation=u)):f.setRotation(u),c._setRotateCursor(J),u>Math.PI&&(u-=2*Math.PI);var y=180*(u/Math.PI);y=y.toFixed(2),R=""+y+""}else if("resize"===$){var g=_.rect;n=g.x,B=g.y;var p,Y=g.width,I=g.height,V=_.anchor,m=_.matrix,S=f.s&&f.s("keepAspectRatio")||c.getStyle("keepAspectRatio");Fk(s)&&(S=!S);var a=z._unionPointMode1,T=z._unionPointMode2;if(z._inSmartGuide&&!C.Default.isCtrlDown(s)&&!S){var O;"L"===M||"R"===M?O="x":("T"===M||"B"===M)&&(O="y"),z._adsorbedToClosest(t,O),H=!0}p=m.tfi(t);var N;"LT"===M?(g=a(p,{x:n+Y,y:B+I},Y,I,S),N=9):"T"===M?(g=T({x:n,y:p.y},{x:n+Y,y:B+I},Y,I,S,"v"),N=1):"RT"===M?(g=a(p,{x:n,y:B+I},Y,I,S),N=33):"L"===M?(g=T({x:p.x,y:B},{x:n+Y,y:B+I},Y,I,S,"h"),N=8):"R"===M?(g=T({x:n,y:B},{x:p.x,y:B+I},Y,I,S,"h"),N=32):"LB"===M?(g=a(p,{x:n+Y,y:B},Y,I,S),N=12):"B"===M?(g=T({x:n,y:B},{x:n+Y,y:p.y},Y,I,S,"v"),N=4):"RB"===M&&(g=a(p,{x:n,y:B},Y,I,S),N=36);var K=m.tf(g.x+g.width*V.x,g.y+g.height*V.y);f instanceof C.Block&&(_.hasOwnProperty("freezeFlag")||(_.freezeFlag=f._freezeSyncFromChildren,f._freezeSyncFromChildren=!0)),f.setPosition(K),f.setSize(g.width,g.height),H&&(b=f.getRect(),c.rectGuide.gatherLines({node:f,x:b.x,y:b.y,w:b.width,h:b.height},O,N)),R=""+Math.round(g.width)+" * "+Math.round(g.height)}else if("line"===$){if(Fk(s)){var e=f.getPoints(),E="P1"===M?e.get(1):e.get(0),G={x:t.x-E.x,y:t.y-E.y},P=c.getStyle("shiftLineRotateRound"),l=z._shiftDirList;if(!l||z._shiftRotateRound!==P){z._shiftRotateRound=P,z._shiftDirList=l=[];for(var F=0;F<Math.PI;F+=P)l.push({x:w(F),y:D(F)})}for(var X,x=0,U=0,o=l.length;o>U;U++){var h=l[U],v=h.x*G.x+h.y*G.y;Math.abs(v)>Math.abs(x)&&(x=v,X=h)}t={x:E.x+X.x*x,y:E.y+X.y*x},c.rectGuide.clear()}else z._inSmartGuide&&!C.Default.isCtrlDown(s)&&(z._adsorbedToClosest(t),H=!0);var i=Cl.getDataMatrix(f).applyInverse(t);f.setPoint("P1"===M?0:1,i,!0);var j=f.getPoints(),W=j.get(0),L=j.get(1);n=W.x-L.x,B=W.y-L.y,R=" "+Math.round(Math.sqrt(n*n+B*B))+" ",H&&(b=f.getRect(),c.rectGuide.gatherLines({node:f,x:b.x,y:b.y,w:b.width,h:b.height}))}if(R){var d=C.Default.getLogicalPoint(s,c._canvas);d.x+=Cl.Icons.TipShiftX,d.y+=Cl.Icons.TipShiftY,z.tipInfo={helperPos:d,text:R,size:R.length}}z._fireEditEvent("between",s)}},Kj.prototype._unionPointMode1=function(M,Q,Z,D,i){if(i&&Z&&D){var e=M.x-Q.x,c=M.y-Q.y;Math.abs(e*D)<Math.abs(c*Z)?(c=Math.sign(c)*Math.abs(e*D/Z),M.y=Q.y+c):(e=Math.sign(e)*Math.abs(c*Z/D),M.x=Q.x+e)}return C.Default.unionPoint(M,Q)},Kj.prototype._unionPointMode2=function(e,$,r,d,G,c){var H=C.Default.unionPoint(e,$);if(G&&r&&d){var p;"v"===c?(p=H.x+H.width/2,H.width=r*H.height/d,H.x=p-H.width/2):(p=H.y+H.height/2,H.height=d*H.width/r,H.y=p-H.height/2)}return H},Kj.prototype._adsorbedToClosest=function(_,p){var X=this,Q=X._interactor,q=Q.rectGuide.findClosest(_,p),w=Q.gridGuide.findClosest(_,p),v=1/0,n=1/0;q&&(isFinite(q.x)&&(v=q.x),isFinite(q.y)&&(n=q.y)),w&&(isFinite(w.x)&&Math.abs(w.x)<Math.abs(v)&&(v=w.x),isFinite(w.y)&&Math.abs(w.y)<Math.abs(n)&&(n=w.y)),isFinite(v)&&(_.x+=v),isFinite(n)&&(_.y+=n)},Kj.prototype._42=function(z,T,f){var U=this;U.info={},U.screenInfo=null;var n=U._interactor;if(!n.editDetail&&U.gatherInfo(T,f)){var k=U.editing,D=k?k.groupRotateMode:null,d=U.screenInfo;if("block"!==D){if(d.P1?Cl.Icons.DrawIcon(n,z,Cl.Icons.Line,d):Cl.Icons.DrawIcon(n,z,Cl.Icons.Rect,d),d.connect&&(Cl.Icons.DrawIcon(n,z,Cl.Icons.ConnectGuide,{rotation:d.rotation,connect:d.connect,cursorPos:k?k.cursorPos:null}),k)){if(k.targetCorners){for(var A={x:1/0,y:1/0},x={x:-1/0,y:-1/0},M=0,G=k.targetCorners.length;G>M;M+=2)A.x=Math.min(A.x,k.targetCorners[M]),x.x=Math.max(x.x,k.targetCorners[M]),A.y=Math.min(A.y,k.targetCorners[M+1]),x.y=Math.max(x.y,k.targetCorners[M+1]);Cl.Icons.DrawIcon(n,z,Cl.Icons.HoverDataRect,{min:A,max:x,color:n.getStyle("hoverGuideColor")||n.getStyle("baseColor")})}k.garbageInfo&&Cl.Icons.DrawIcon(n,z,Cl.Icons.ConnectGuideGarbage,k.garbageInfo)}n.getStyle("rotateTipVisible")&&U.tipInfo&&Cl.Icons.DrawIcon(n,z,Cl.Icons.TipHelper,U.tipInfo)}U.target instanceof Cl.Group&&U.target._42(n,z,T)}};var pb=Cl.Anchor=function(R){this.catalog="Anchor",this._interactor=R};pb.prototype={},pb.prototype.constructor=pb,pb.prototype.gatherInfo=function(S,_){var p=this;if(1===_.length){var q=_[0];if(!q.getAnchor)return;if(q instanceof C.Shape&&q._70I())return;if(Bd(q,S))return;return p.gatherSingleTarget(S,_[0])}return _.length>1?p.gatherMultiTargets(S,_):!1},pb.prototype.gatherSingleTarget=function(A,R){var I=this;return I.info.POS=R.getPosition(),I.screenInfo.POS=Cl.toScreenPosition(A,I.info.POS),I.target=R,!0},pb.prototype.gatherMultiTargets=function(A,T){var l=this,g=Cl.Group.findOrCreateGroup(T);return g?(l.screenInfo.POS=Cl.toScreenPosition(A,g.getAnchor2()),l.target=g,!0):!1},pb.prototype.isVisible=function(){var F=this,S=F._interactor;if(S.getStyle("anchorVisible")===!1)return!1;var K=F.target;if(K){if(this.editing)return!0;var p=K.getAnchor(),J=S.getStyle("anchorOutsideVisibleThreshold");if(p.x<-J||p.x>1+J||p.y<-J||p.y>1+J)return!0;var d=K.getSize(),M=K.getScale(),n=Math.min(Math.abs(d.width*M.x),Math.abs(d.height*M.y));if(n*S.gv._zoom<S.getStyle("anchorHideThreshold"))return!1}return!0},pb.prototype.check=function(m,k,c){if(C.Default.isLeftButton(k)){var t=this,x=t._interactor;if(t.isVisible()&&x.getStyle("anchorMovable")!==!1){t.editing=null,t.tipInfo=null;var l=t.target;if(l&&m.isAnchorEditable(l)&&m.isEditable(l)){var J;if(t.screenInfo&&(J=t.screenInfo.POS)&&Cl.checkHit(c,new Cl.Math.Vector2(J),x.getStyle("checkSize"))){if(l instanceof Cl.Group)return t.editing={},!0;var f=l.getWidth(),s=l.getHeight(),I=l.getAnchor();return t.editing={rect:{x:-f*I.x,y:-s*I.y,width:f,height:s},anchor:I,matrix:l.getMatrix()},!0}}}}},pb.prototype.startEdit=function(E,b){E.startDragging(b),E.fi({kind:"beginEditAnchor",event:b})},pb.prototype._46O=function(v){var X=this;X.editing&&(X.editing=null,X._interactor.fi({kind:"endEditAnchor",event:v})),X.tipInfo=null
},pb.prototype.handleEdit=function(l,a){var j=this,$=j.target;if($){var W=j.editing;if(W){var p=l.lp(a),k=j._interactor;if($ instanceof Cl.Group)return $.setAnchor2(p),k._42(),void 0;var h=W.matrix,N=h.tfi(p),X=W.rect,R=(N.x-X.x)/X.width,T=(N.y-X.y)/X.height;if(!C.Default.isCtrlDown(a)){var d=k.getStyle("anchorRound"),K=k.getStyle("anchorSensitivity");R=Cl.roundTo(R,d,K),T=Cl.roundTo(T,d,K)}$.setAnchor(R,T,!0);var f=C.Default.getLogicalPoint(a,k._canvas);f.x+=Cl.Icons.TipShiftX,f.y+=Cl.Icons.TipShiftY;var Z=""+R.toFixed(2)+", "+T.toFixed(2);j.tipInfo={helperPos:f,text:Z,size:Z.length},k.fi({kind:"betweenEditAnchor",event:a})}}},pb.prototype._42=function(a,W,M){var F=this;F.info={},F.screenInfo={};var D=F._interactor;D.editDetail||F.gatherInfo(W,M)&&F.isVisible()&&(Cl.Icons.DrawIcon(D,a,Cl.Icons.Anchor,F.screenInfo),F.tipInfo&&Cl.Icons.DrawIcon(D,a,Cl.Icons.TipHelper,F.tipInfo))};var Pe=Cl.MoveDummy=function(g){this.catalog="MoveDummy",this._interactor=g};Pe.prototype={},Pe.prototype.constructor=Pe,Pe.prototype.gatherInfo=function(){var X=this,q=this._interactor.getSubModule("Rect");if(q){var u=q.screenInfo;if(u){var c=X._interactor,z=X.getMovableTarget(q.target);if(z){var g=c.getStyle("moveDummyThreshold");if(g!==!1){var n=u.LT||u.P1,N=u.RT||u.P2,p=u.LB||n;if(n){var r=u.P1,h=Math.min(n.distanceTo(p),n.distanceTo(N));if(!(g!==!0&&h>g)){var F=c.getStyle("moveDummyPosition"),t=N.clone().sub(n),P=p.clone().sub(n),O=F[2],$=F[3];if(r){var d=c.getStyle("moveDummyLineExtraShift");d&&(O+=d[0],$+=d[1])}var G=n.clone().add(t.clone().multiplyScalar(F[0])).add(t.setLength(O)).add(P.clone().multiplyScalar(F[1])).add(P.setLength($));return X.screenInfo.pos=G,X.screenInfo.size=c.getStyle("moveDummySensitivity"),!0}}}}}}},Pe.prototype.getMovableTarget=function(I){var B=this._interactor.gv;if(Zb(I)){if(B.isMovable(I))return I}else if(I instanceof Cl.Group)for(var n=I._entities,o=n.length-1;o>=0;o--){var W=n[o];if(Zb(W)&&B.isMovable(W))return W}return null},Pe.prototype.getMoveInteractor=function(){for(var t,R,P,E=this._interactor.gv,v=E.getInteractors(),t=0,R=v.length;R>t;t++)if(P=v.get(t),P instanceof nf)return P},Pe.prototype.startEdit=function(E,q){E.startDragging(q);var h=this.getMoveInteractor();if(h){var H=this.selectedTarget,r=E.gv;r._moving=1,h._data=H,r.handleMouseDown&&r.handleMouseDown(q,H)}},Pe.prototype._46O=function(J){var i=this,C=i.getMoveInteractor();C&&(C.handleWindowMouseUp(J),i.selectedTarget=null)},Pe.prototype.handleEdit=function(f,t){var o=this.getMoveInteractor();o&&o.handleWindowMouseMove(t)},Pe.prototype.check=function(o,E,r){if(this.selectedTarget=null,C.Default.isLeftButton(E)&&!o._scrolling&&!uo()){var d=this;if(d.screenInfo){var I=d.screenInfo.pos;if(I&&!(r.distanceTo(I)>d.screenInfo.size)){var t=d._interactor;return d.selectedTarget=d.getMovableTarget(t.getSubModule("Rect").target),t.setCursor("default"),!0}}}},Pe.prototype._42=function(g,P,j){var k=this;k.screenInfo={};var $=k._interactor;$.editDetail||k.gatherInfo(P,j)&&(!$.editing||k.selectedTarget)&&Cl.Icons.DrawIcon($,g,Cl.Icons.MoveDummy,k.screenInfo)};var ni=Cl.RotateX=function(N){this.catalog="RotateX",this._interactor=N};ni.prototype={},ni.prototype.constructor=ni,ni.prototype.gatherInfo=function(p,e){var U=this;if(1===e.length){var G=e[0];return G instanceof C.Shape&&G._70I()||Bd(G,p)?!1:U.gatherSingleTarget(p,G)}return e.length>1?U.gatherMultiTargets(p,e):!1},ni.prototype.gatherSingleTarget=function(){var y=new C.Math.Vector2,w=new C.Math.Vector2,S=new C.Math.Vector2,E=new C.Math.Vector2,a=function(D,I){var F=D.x-I.x,K=D.y-I.y;return F*F+K*K};return function(C,M){if(M.getCorners){var T=this,t=M.getCorners(),m=15,z=M.getPosition();y.copy(t[0]),S.copy(t[1]),E.copy(t[3]),w.copy(y).add(E).divideScalar(2).add(y.sub(S).setLength(m/C.getZoom()));var x=Math.max(a(z,t[0]),a(z,t[1]),a(z,t[2]),a(z,t[3]));return T.info.POS=w.clone(),T.screenInfo.POS=Cl.toScreenPosition(C,T.info.POS),T.screenInfo.LEN=Math.sqrt(x)*C.getZoom()+m,T.screenInfo.CENTER=Cl.toScreenPosition(C,z),T.target=M,!0}}}(),ni.prototype.gatherMultiTargets=function(j,_){var P=this,W=Cl.Group.findOrCreateGroup(_);if(!W)return!1;var P=this;return P.gatherSingleTarget(j,W)},ni.prototype.isVisible=function(){var H=this._interactor;if(!H.getStyle("rotateAsClock"))return!1;var V=this.target;if(!V)return!0;var g=H.gv;return g.isEditable(V)&&g.isRotationEditable(V)?!0:!1},ni.prototype.check=function(I,U,$){var Z=this,Y=Z._checkImpl(I,U,$);return(Y||Z._clockPainted)&&Z._interactor._42(),Y},ni.prototype._checkImpl=function(z,p,S){if(C.Default.isLeftButton(p)){var g=this;g.editing=null,g.tipInfo=null;var x;if(g.screenInfo&&(x=g.screenInfo.POS)&&g.isVisible()){var h=g._interactor;if(Cl.checkHit(S,x,h.getStyle("checkSize"))){var l=g.target,y=z.lp(p),$=l.getPosition(),f=Math.atan2(y.y-$.y,y.x-$.x);return h._setRotateCursor(f),g.editing={pos:$,rotation:l.getRotation(),hitRot:f,groupRotateMode:"block",screenInfo:{CENTER:g.screenInfo.CENTER,LEN:g.screenInfo.LEN}},!0}}}},ni.prototype.startEdit=function(f,P){f.startDragging(P),f.fi({kind:"beginEditRotation",event:P}),this.target instanceof Cl.Group&&this.target.beginRotate(this.editing)},ni.prototype._46O=function(h){var E=this;E.editing&&(E.editing=null,E._interactor.fi({kind:"endEditRotation",event:h})),E.target instanceof Cl.Group&&E.target.endRotate(),E.tipInfo=null},ni.prototype.handleEdit=function(v,z){var x=this,I=x.editing;if(I){var y,U,i=x.target,M=v.lp(z),e=x._interactor,r=I.pos,q=Math.atan2(M.y-r.y,M.x-r.x),G=i instanceof Cl.Group;if(G?U=q-I.hitRot:(y=q-I.hitRot,U=I.rotation+y),U%=2*Math.PI,0>U&&(U+=2*Math.PI),!C.Default.isCtrlDown(z)){var a,c;Fk(z)?(a=e.getStyle("shiftRotateRound"),c=a/2):(a=e.getStyle("rotateRound"),c=e.getStyle("rotateSensitivity")),U=Cl.roundTo(U,a,c)}G?(y=U-(I.lastRotation||0),0!==y&&(i.addRotation(y,I.groupRotateMode,function(i){return v.isRotationEditable(i)}),I.lastRotation=U)):i.setRotation(U),e._setRotateCursor(q),U>Math.PI&&(U-=2*Math.PI);var O=180*(U/Math.PI),w=""+O.toFixed(2)+"",D=C.Default.getLogicalPoint(z,e._canvas);D.x+=Cl.Icons.TipShiftX,D.y+=Cl.Icons.TipShiftY,x.tipInfo={helperPos:D,text:w,size:w.length},e.fi({kind:"betweenEditRotation",event:z})}},ni.prototype._42=function(h,Y,K){var x=this;x._clockPainted=!1,x.info={},x.screenInfo={};var n=x._interactor;n.editDetail||x.gatherInfo(Y,K)&&x.isVisible()&&(Cl.Icons.DrawIcon(n,h,Cl.Icons.RoundPoint,x.screenInfo.POS),n.getStyle("rotateTipVisible")&&x.tipInfo&&Cl.Icons.DrawIcon(n,h,Cl.Icons.TipHelper,x.tipInfo),x.editing&&x.drawClock(h))},ni.prototype.drawClock=function(n){n.save();var M=this;M._clockPainted=!0;var l=M.editing||{},u=l.screenInfo||M.screenInfo,h=u.LEN,Y=h+8,X=h+18;n.save(),n.translate(u.CENTER.x,u.CENTER.y),n.beginPath(),n.strokeStyle="rgb(150, 150, 150)";for(var k,m,f,J,q,W=0;360>W;W++)k=W*Math.PI/180,0===W%5&&(m=D(k)*h,f=w(k)*h,J=D(k)*Y,q=w(k)*Y,n.moveTo(m,f),n.lineTo(J,q)),0===W%45&&(m=D(k)*h,f=w(k)*h,J=D(k)*X,q=w(k)*X,n.moveTo(m,f),n.lineTo(J,q));n.stroke(),n.rotate(-d);var L=l.lastRotation||M.target.getRotation();n.beginPath(),n.fillStyle="rgba(255, 0, 0, 0.1)",n.strokeStyle="rgb(157, 157, 157)",n.moveTo(0,0),n.arc(0,0,X,0,L,!1),n.fill(),n.beginPath(),n.moveTo(0+X,0),n.arc(0,0,X,0,L,!1),n.stroke(),n.restore()};var Bo=Cl.Curve=function(Z){this.catalog="Curve",this._interactor=Z};Bo.prototype={},Bo.prototype.constructor=Bo,e.defineProperties(Bo.prototype,{activing:{get:function(){return this._activing},set:function(t){var X=this;if(t)X._activing=new Cl.CurveActiving(this,t),X._activing._firePointChange();else{var q=X._activing;q&&q.dispose(),X._activing=null}}}}),Bo.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Bo.prototype.setUp=function(){var d=this,p=d._interactor;p&&p.gv.mp(d._onGraphviewPropertyChanged,d)},Bo.prototype._onGraphviewPropertyChanged=function(z){("zoom"===z.property||"translateX"===z.property||"translateY"===z.property)&&this._handleDataChanged()},Bo.prototype.tearDown=function(){var H=this,s=H._interactor;s&&s.gv.ump(H._onGraphviewPropertyChanged,H)},Bo.prototype.canEnterEditDetailMode=function(){var k=this,d=k._interactor,U=d._getValidSelection();if(1===U.length){var n=U[0],c=n instanceof C.Edge;if(n instanceof C.Shape||c){if(c){var v=n.s("edge.type");if(v&&"points"!==v)return}var p=d.gv;if(p.isPointEditable(n)&&p.isEditable(n))return k.target=n,!0}}},Bo.prototype.canQuitEditDetailMode=function(g){var w=this,e=w._interactor._getLogicalPoint(g);return w._checkEditRealPoint(e)?void 0:w._interactor.gv.getDataAt(g)!==w.target?!0:void 0},Bo.prototype.preHandleScroll=function(){var A=this.editing;return A&&A.inEdit?!0:void 0},Bo.prototype.getCurrentSelectintStatus=function(){var r=this;if(r.activing&&!r.activing.selections){if(r.activing.status!=$)return r.activing.status;var m=function(w){var d=r.activing.status;r.activing.status=w,r._interactor.fp("shapePointStatus",d,w)},A=Cl.Curve.PointType,f=r.activing.point,F=r.activing.pairs;if(!F||1!==F.length)return m(A.Mirrored);var e=F[0],C=e.c1&&e.c1.isNearEnough(f),K=e.c2&&e.c2.isNearEnough(f);if(!e.c1||!e.c2)return C||K?m(A.Straight):m(A.Disconnected);if(C&&K)return m(A.Straight);if(C||K)return m(A.Asymmetric);var U=e.c1.clone().sub(f),s=e.c2.clone().sub(f);return Math.abs(U.x*s.y-U.y*s.x)>1e-5||U.x*s.x>0?m(A.Disconnected):Math.abs(U.length()-s.length())>1e-5?m(A.Asymmetric):m(A.Mirrored)}},Bo.prototype.handle_keydown=function(w){var y=this;if(y._interactor.editDetail){var r=Cl.Curve.PointType;"1"===w.key?y._setCurrentSelectionStatus(r.Straight):"2"===w.key?y._setCurrentSelectionStatus(r.Mirrored):"3"===w.key?y._setCurrentSelectionStatus(r.Disconnected):"4"===w.key&&y._setCurrentSelectionStatus(r.Asymmetric)}},Bo.prototype.setCurrentSelectionStatus=function(S){var I=this,X=I._interactor;if(X){var H=X.gv;H.dm().beginTransaction(),this._setCurrentSelectionStatus(S),H.dm().endTransaction()}},Bo.prototype._setCurrentSelectionStatus=function(x){var w=this,e=w.activing;if(e){var U=w.getCurrentSelectintStatus();if(null!==U&&U!==x){e.status=x;var p=w.activing.point,r=w.activing.pairs;if(r&&1===r.length){var P=r[0],i=w.screenInfo.curve,C=Cl.Curve.PointType,F=w._interactor,G=function(){w._writeToHt(),F.fp("shapePointStatus",U,x),w.check(F.gv,null,new Cl.Math.Vector2(F._lastLogicalPoint))};if(x===C.Straight)return i.moveCtrlPoint(P,p,"c1"),i.moveCtrlPoint(P,p,"c2"),G(),void 0;if(U===C.Straight){var X=i.findPairs(p,!0),Q=X[0],z=Q.r1||p,y=Q.r2||p,H=y.clone().sub(z).multiplyScalar(.25);return i.moveCtrlPoint(P,p.clone().sub(H),"c1"),i.moveCtrlPoint(P,p.clone().add(H),"c2"),G(),void 0}var Z=P.c1,b=P.c2;if(Z&&b){if(x===C.Mirrored)return i.moveCtrlPoint(P,p.clone().multiplyScalar(2).sub(b),"c1"),G(),void 0;if(x===C.Asymmetric&&U===C.Disconnected){var A=Z.clone().sub(p).length(),H=p.clone().sub(b).setLength(A).add(p);return i.moveCtrlPoint(P,H,"c1"),G(),void 0}}e._firePointChange(),F.fp("shapePointStatus",U,x),w.check(F.gv,null,new Cl.Math.Vector2(F._lastLogicalPoint))}}}},Bo.prototype._handleDataChanged=function(){var h="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(A){var M=this;if(M.screenInfo&&M.target){if(A&&h.indexOf(A.property)<0)return;var O=M._interactor;M.gatherSingleTarget(O.gv,M.target,!0),M.check(O.gv,null,new Cl.Math.Vector2(O._lastLogicalPoint)),O._42()}}}(),Bo.prototype.gatherSingleTarget=function(X,J,b){var H,m,h=this;h.screenInfo&&h.screenInfo.curve&&(m=h.screenInfo.curve._curves);var c=h.editing;H=c?h.screenInfo:h.screenInfo={};var z,o,n=J instanceof C.Edge;n?(z=J.s("edge.segments"),o=J.s("edge.points")||new C.List):(z=J._58O,o=J._59O),H.S=z;var M,A=H.P=[],F=Cl.getDataMatrix(J);if(J instanceof C.Polyline||J instanceof C.Edge&&h._interactor.getStyle("edgeElevationEditable"))M=J.getElevation&&J.getElevation()||0,H.E=[];else{var W=!1;o.each(function(x){x.e!==$&&(W=!0)}),W&&(H.E=[])}if(o.each(function(a){H.E&&H.E.push(a.e!=$?a.e:M),a=F.apply(a);var n=Cl.toScreenPosition(X,a);A.push(n.x,n.y)}),n){var B=A.length,v=Cl.toScreenPosition(X,J._lastSourcePoint||(B?{x:A[0],y:A[1]}:{x:0,y:0})),Q=Cl.toScreenPosition(X,J._lastTargetPoint||(B?{x:A[B-2],y:A[B-1]}:{x:0,y:0}));A.splice(0,0,v.x,v.y),A.push(Q.x,Q.y),H.E&&(H.E.splice(0,0,"head"),H.E.push("tail"))}if(!H.S||!H.S.size()){H.S=new C.List,H.S.add(1);for(var f=0;f<A.length/2-1;f++)H.S.add(2)}if((!c||b)&&h.convertToCubicBezier(m),h.activing&&(b||!h.editing||"realPoint"===h.editing.type)){var Y=H.curve.findPairs(h.activing.point);h.activing.pairs=Y}},Bo.prototype._convertToNewPoint=function(m,e,R,r){var Y,H,i;for(Y=0,H=e.length;H>Y;Y++){if(i=e[Y],i._p1.isNearEnough(m)&&(!r||r.indexOf(i._p1)<0))return i._p1;if(i._p4.isNearEnough(m)&&(!r||r.indexOf(i._p4)<0))return i._p4}if(R)for(Y=0,H=Math.min(R.length,H);H>Y;Y++){if(i=R[Y],i._p1===m&&(!r||r.indexOf(e[Y]._p1)<0))return e[Y]._p1;if(i._p4===m&&(!r||r.indexOf(e[Y]._p4)<0))return e[Y]._p4}},Bo.prototype.convertToCubicBezier=function(y){var P,m,N=this,Q=new Cl.Math.Curve,c=N.screenInfo;if(Q.createFromHtShape(c.P,c.S,c.E),c.curve=Q,N.activing){var v=Q._curves;P=N.activing.point,m=N._convertToNewPoint(P,v,y);var n=[];if(m&&(N.activing.point=m,n.push(m)),N.activing.selections){var I=-1,W=N.activing.selections;W.forEach(function(X){I++,m=N._convertToNewPoint(X,v,y,n),m&&(W[I]=m,n.push(m))})}}},Bo.prototype.check=function(L,D,y){if(!D||gl(D)||Bk(D)){var T=this;if(T._interactor.setCursor("default"),T.editing=null,T.highlight=null,T.tipInfo=null,T.edgeEditResult=null,T.screenInfo){if(uo()||D&&Bk(D))return T._interactor._42(),!0;if(T._checkEditCtrlPoint(y))return T._interactor._42(),!0;if(T._checkEditRealPoint(y))return T._interactor._42(),!0;if(T._checkEditElevation(y))return T._interactor._42(),!0;var M=T.screenInfo.curve,n=M.checkPoint(y,T._interactor.getStyle("curveIntersectSize"));if(n){var k=T.highlight={};k.type="insertKnot",k.bezier=n.bezier,k.point=n.intersection}return T._interactor._42(),!0}}},Bo.prototype.getAdjacentBeziers=function(T){var h=this.screenInfo;if(h){var C,q,t,H=h.curve._curves,z=[],V=$;for(C=0,q=H.length;q>C;C++)if(t=H[C],V===$){if(t._p4.isNearEnough(T)){z.push(t),V=C;continue}}else{if(t._p1.isNearEnough(T))return z.push(t),z;if(t._p4.isNearEnough(T)){z[0]=t,V=C;continue}}}},Bo.prototype.roundCorner=function(L){if(this.activing&&this.screenInfo){var j=this.screenInfo.curve,Q=j._curves,k=this.getAdjacentBeziers(this.activing.point),N=k[1],E=N._index;N=N.insertKnot(N.getTByPercentage(L/N.length))[1],Q[E]=N;var c=N.p1,e=k[0],V=e._index;e=e.insertKnot(e.getTByPercentage(1-L/e.length))[0],Q[V]=e;var U=e.p4,i=this.activing.point,P=new Cl.Math.CubicBezier(U,i.clone().sub(U).multiplyScalar(2/3).add(U),i.clone().sub(c).multiplyScalar(2/3).add(c),c);Q.splice(E,0,P),this._writeToHt(),this.activing=null,this._interactor._42()}},Bo.prototype._checkEditRealPoint=function(z){var a,V,m,Y,T,L,D=this,I=D.screenInfo.curve._curves,K=D._interactor.getStyle("curvePointIntersectSize"),Z=1/0;for(K*=K,m=0,Y=I.length;Y>m;m++)a=I[m],T=a._p1,L=z.distanceToSquared(T),Z>L&&(Z=L,V=T),T=a._p4,L=z.distanceToSquared(T),Z>L&&(Z=L,V=T);if(Z>K)return!1;var l=D.highlight={};return l.type="changeRealPoint",l.point=V,D.editing={type:"realPoint",point:V,shiftGuide:{point:V.clone(),dir:"x",limit:0}},D._interactor.setCursor("crosshair"),!0},Bo.prototype._checkEditElevation=function(E){var N=this;if(!N._interactor.getStyle("curveElevationVisible"))return!1;var R=N.target;if(R instanceof C.Edge&&!N._interactor.getStyle("edgeElevationEditable"))return!1;var p=N.activing;if(!p)return!1;var j=p.getCurrentEditingPoint();if(!j)return!1;var m=N._interactor,s=m.getStyle("curveElevationGuideShift"),T=m.getStyle("curveElevationIntersectSize"),U=E.distanceToSquared({x:j.x+s[0],y:j.y+s[1]});if(!(U>T*T)){var g=N.highlight={};g.type="elevation";var M=new Cl.Math.Vector2(E.x,E.y,j.e);return N.editing={type:"elevation",startPoint:M},N._interactor.setCursor("crosshair"),!0}},Bo.prototype._checkEditCtrlPoint=function(B){var K=this;if(K.activing&&!K.activing.selections){var W=K.getCurrentSelectintStatus();if(W!==Cl.Curve.PointType.Straight){var m=K.activing.pairs;if(m){var V=K._interactor.getStyle("curvePointIntersectSize");V*=V;var f,n,x,p,l,s,N,H,e,a=1/0;for(N=0,e=m.length;e>N;N++)for(p=m[N],H=0;2>H;H++)l=0===H?"c1":"c2",p[l]&&(s=B.distanceToSquared(p[l]),a>s&&(a=s,f=p,n=N,x=l));if(a>V)return!1;K.activing.hlpair=f,K.activing.hltype=x;var i=K.highlight={};return i.type="changeCtrlPoint",i.point=f[x],K.editing={type:"ctrlPoint",pair:f,pairId:n,ctrlType:x,direction:f[x].clone().sub(K.activing.point).normalize()},K._interactor.setCursor("crosshair"),!0}}}},Bo.prototype.startEdit=function(O,M){O.startDragging(M);var J=this;J.highlight&&"insertKnot"===J.highlight.type&&(J.insertKnot(),J.gatherSingleTarget(J._interactor.gv,J.target),J.activing=null,J._checkEditRealPoint(J._interactor._getLogicalPoint(M)));var y=J._activing;if(y){var g=J.editing?J.editing.type:null;"ctrlPoint"===g?y.editingCtrl={pairId:J.editing.pairId,type:y.hltype}:"realPoint"===g&&(y.editingCtrl=!1)}var w=J.highlight,H=C.Default.isCtrlDown(M);if(!w||uo()||Bk(M)){var m=J._interactor.gv;if(!m.setFocus(M)||m._scrolling)return;return H?J._multiSelect={startPoint:m.lp(M)}:m.isPannable()&&(gl(M)||Bk(M))&&(J._pan={tx:m.tx(),ty:m.ty()},O.fi({kind:"beginPan",event:M})),void 0}if("changeRealPoint"===w.type){var V,U=J.activing?J.activing.point:null,b=J.activing?J.activing.selections:null;if(H&&J.activing)U===w.point?(b?(J.activing={point:b[0]},b.length>1&&(b.splice(0,1),J.activing.selections=b)):J.activing=null,J.editing=null):b&&(V=b.indexOf(w.point))>=0?(b.length>1?b.splice(V,1):delete J.activing.selections,J.editing=null):b?(b.push(U),J.activing={point:w.point,selections:b}):J.activing={point:w.point,selections:[U]};else if(b)U===w.point||((V=b.indexOf(w.point))>=0?(b.splice(V,1,U),J.activing={point:w.point,selections:b}):J.activing={point:w.point});else{var f;U===w.point&&(f=J.activing.status),J.activing={point:w.point},f&&(J.activing.status=f)}O.fi({kind:"beginEditPoint",event:M})}},Bo.prototype.insertKnot=function(){var J=this,O=J.highlight,w=J.screenInfo.curve;w.insertKnot(O.bezier,O.point.t),J._writeToHt()},Bo.prototype._writeToHt=function(){var z,i,K=this,Y=K.screenInfo.curve,E=Y.toHtShape(),b=E.points,P=[],D=E.segments,A=K._interactor.gv;A.dm().beginTransaction();var I,d,V=K.target,W=V instanceof C.Edge,L=Cl.getDataMatrix(V).invert();d=V instanceof C.Polyline||V instanceof C.Edge&&K._interactor.getStyle("edgeElevationEditable"),d&&(I=V.getElevation&&V.getElevation()||0);for(var n=0,N=b.length;N>n;n++)z=b[n],i=Cl.toWorldPosition(A,z),i=L.apply(i),isFinite(z.e)&&z.e!==I&&(i.e=z.e),P.push(i);if(V._writing=!0,W){V.s("edge.type","points"),V.setStyle("edge.segments",D),V.setStyle("edge.points",P.slice(1,P.length-1)),V.setStyle("edge.source.offset.x",0),V.setStyle("edge.source.offset.y",0),V.setStyle("edge.target.offset.x",0),V.setStyle("edge.target.offset.y",0);var p=K._nextChangeEdgeHost;delete K._nextChangeEdgeHost,p&&("source"===p.type?V.setSource(p.host):V.setTarget(p.host)),K._writeEdgeHostAnchor("source",P[0]),K._writeEdgeHostAnchor("target",P[P.length-1])}else P.length?(V.setSegments(D),V.setPoints(P,!0)):V.removeFromDataModel();A.dm().endTransaction(),delete V._writing},Bo.prototype._writeEdgeHostAnchor=function(D,Q){var I=this,v=I.target,t=I._calcHostAnchor(v,D,Q);t.index!==$?(v.setStyle("edge."+D+".index",t.index),v.setStyle("edge."+D+".percent",$),v.setStyle("edge."+D+".anchor.x",$),v.setStyle("edge."+D+".anchor.y",$)):t.percent!==$?(v.setStyle("edge."+D+".percent",t.percent),v.setStyle("edge."+D+".index",$),v.setStyle("edge."+D+".anchor.x",$),v.setStyle("edge."+D+".anchor.y",$)):(v.s("edge."+D+".anchor.x",t.x),v.s("edge."+D+".anchor.y",t.y),t.offsetX||t.offsetY?(v.s("edge."+D+".offset.x",t.offsetX),v.s("edge."+D+".offset.y",t.offsetY)):(v.s("edge."+D+".offset.x",0),v.s("edge."+D+".offset.y",0)))},Bo.prototype._calcHostAnchor=function(y,W,Y,s){s||(s="source"===W?y.getSource():y.getTarget());var O=this._interactor.gv,t=O.calculateAttachPoint(s,Y);if(t)return t.info;if(hf(s)){var S=O.calculateEdgePosition(s,Y);return S}var K=s.getRotation(),Z=s.getAnchor();Bd(s,O)&&(K=0);var n=s.getScale();if(K||n.x<0||n.y<0){var U=s.getMatrix(),G=U.tfi(Y),p=s.getSize();return{x:G.x/p.width+Z.x,y:G.y/p.height+Z.y}}var k=Ak(O,s),j={x:(Y.x-k.x)/k.width,y:(Y.y-k.y)/k.height};return j},Bo.prototype._handlePanning=function(z){var q=this,S=q._pan;if(S){S.started=!0;var J=q._interactor,L=J.gv,u=J._lastClientPoint,b=kd(z),w=xr(L,b,u);L.setTranslate(S.tx+w.x,S.ty+w.y),q.gatherSingleTarget(J.gv,q.target),J._42(),J.fi({kind:"betweenPan",event:z})}},Bo.prototype.handleEdit=function(K,h){var M=this,i=M.editing;if(M._pan)return M._handlePanning(h),void 0;if(M._multiSelect)return M._multiSelect.endPoint=K.lp(h),M._interactor.redraw(),void 0;if(i){i.inEdit=!0;var z,Q,f,D=M._interactor._getLogicalPoint(h),p=C.Default.isCtrlDown(h),_=C.Default.isShiftDown(h),v=i.type,g=M.activing;if(M._guideInfo=null,"ctrlPoint"===v&&_){var P=M.editing.direction.clone();z=g.point;var F=P.dot(D.clone().sub(z));D=P.setLength(F).add(z)}else if("ctrlPoint"===v||"realPoint"===v){var P;if("realPoint"===v&&_){var c=M.editing.shiftGuide;Q=c.point;var V=Math.abs(D.x-Q.x),s=Math.abs(D.y-Q.y);V>s&&V>c.limit&&"y"===c.dir&&(c.dir="x"),s>V&&s>c.limit&&"x"===c.dir&&(c.dir="y"),P=c.dir,"x"===P?(D.y=Q.y,c.limit=Math.max(c.limit,V)):"y"===P&&(D.x=Q.x,c.limit=Math.max(c.limit,s))}var H=M._isEditEdgeSourceTarget();if(H){var m=M._editEdgeSourceTarget(H,D,p);m&&(M.edgeEditResult=m,f=m.tipText)}else if(!p){var y=M._guidingToEdit(D,P),u="realPoint"===v?M._interactor.gridGuide.findClosest(D,P,!0):null,b=1/0,T=1/0;u&&(u.x&&(b=u.x),u.y&&(T=u.y));var W=!1;y&&(y.xList&&(Math.abs(y.x)<=Math.abs(b)?(W=!0,b=y.x):delete y.xList),y.yList&&(Math.abs(y.y)<=Math.abs(T)?(W=!0,T=y.y):delete y.yList),W&&(M._guideInfo=y)),isFinite(b)&&(D.x+=b),isFinite(T)&&(D.y+=T),W&&(y.v=D)}}var S=M.screenInfo.curve;if("realPoint"===i.type){z=i.point,z.e!==$&&(D.e=z.e),S.moveRealPoint(z,D),i.point=D,M.highlight.point=D;var Y=g.status,j=g.selections;if(M.activing={point:D,status:Y},j){var d=D.clone().sub(z),e=0;j.forEach(function(n){var V=n.clone().add(d);S.moveRealPoint(n,V),j[e++]=V}),M.activing.selections=j}}else if("ctrlPoint"===i.type){var J=g.pairs,N=J[i.pairId];S.moveCtrlPoint(N,D,i.ctrlType);var t=g.status,q=Cl.Curve.PointType;if((t===q.Mirrored||t===q.Asymmetric)&&N.c1&&N.c2){var z=new Cl.Math.Vector2(g.point),I="c1"===i.ctrlType?"c2":"c1";if(t===Cl.Curve.PointType.Mirrored)S.moveCtrlPoint(N,z.clone().multiplyScalar(2).sub(D),I);else if(t===q.Asymmetric){var F=N[I].clone().sub(z).length(),X=z.clone().sub(N[i.ctrlType]).setLength(F).add(z);isNaN(X.x)||S.moveCtrlPoint(N,X,I)}}g._firePointChange()}else if("elevation"===i.type){Q=i.startPoint;var R=Q.e+(Q.y-D.y)/K._zoom;M._setCurrentPointImpl("e",R),g._firePointChange(),f="E: "+Cl.toFixed(R)}var x=C.Default.getLogicalPoint(h,M._interactor._canvas);if(x.x+=Cl.Icons.TipShiftX,x.y+=Cl.Icons.TipShiftY,!f){var Z=Cl.toWorldPosition(K,D);f=""+Cl.toFixed(Z.x)+", "+Cl.toFixed(Z.y)}M.tipInfo={helperPos:x,text:f,size:f.length},M._writeToHt(),M._interactor.fi({kind:"betweenEditPoint",event:h})}},Bo.prototype._setCurrentPointImpl=function(C,p){var S=this,t=S._activing;if(!t)return!1;var c=S.target;if(!c)return!1;var Y=t.getCurrentEditingPoint();if(!Y)return!1;var Q=t.editingCtrl;if(!Q)var L=Y.clone();if("e"===C)Y.e=p;else{var K;if("x"===C||"y"===C){var x=t._lastFirePoint;K="x"===C?{x:p,y:x?x.y:0}:{x:x?x.x:0,y:p}}else"object"==typeof C?(K=C,C.e!==$&&(Y.e=C.e)):(K={x:arguments[0],y:arguments[1]},arguments[2]!==$&&(Y.e=arguments[2]));var D=Cl.getDataMatrix(c);K=Cl.toScreenPosition(S._interactor.gv,D.apply(K)),Y.x=K.x,Y.y=K.y}if(!Q){var b=L.multiplyScalar(-1).add(Y);Y.e&&L.e&&(b.e=Y.e-L.e);var J=S.screenInfo.curve;J.moveCtrlDueToRealPointMovement(Y,b);var v=t.selections;if(v){var E=0;v.forEach(function(O){var W=O.clone().add(b);isFinite(b.e)&&(W.e=(isFinite(O.e)?O.e:c.getElevation()||0)+b.e),J.moveRealPoint(O,W),v[E++]=W}),t.selections=v}}return!0},Bo.prototype.setCurrentPoint=function(o,q){return this._setCurrentPointImpl(o,q)?(this._writeToHt(),!0):!1},Bo.prototype._isEditEdgeSourceTarget=function(){var G=this,j=G.target;if(!(j instanceof C.Edge))return!1;var q=G.editing.point,b=G.screenInfo.curve._curves;return q===b[0]._p1?"source":q===b[b.length-1]._p4?"target":!1},Bo.prototype._editEdgeSourceTarget=function(I,b,u){var h,n=this,X=n.target;if(h="source"===I?X.getSource():X.getTarget()){var q,k=n._interactor.gv,L=Cl.toWorldPosition(k,b),K=n._calcHostAnchor(X,I,L,h);if(q=K.index!==$||K.percent!==$?K.distance*k.getZoom()>n._interactor.getStyle("edgeHostEdgeMaxDistance"):n._interactor.getStyle("edgeHostDetectPerFrame")?!0:K.x<0||K.x>1||K.y<0||K.y>1?!0:!1){var y=k.getDataAt(L,function(x){return k.isSelectable(x)?k.isSourceTargetEditable(X,x,I)?X.canSetSourceTarget(x,I)?!0:!1:!1:!1});if(y){var F=n._calcHostAnchor(X,I,L,y);h=y,n._nextChangeEdgeHost={type:I,host:y},K=F}}var E,j,c;if(u||K.x===$)(K.percent!==$||K.index!==$)&&(j=K.point);else{var D=n._interactor.getStyle("anchorRound"),d=n._interactor.getStyle("anchorSensitivity");E=k.calculateAttachPoint(h,L),E?K=E.info:(K.x=Cl.roundTo(K.x,D,d),K.y=Cl.roundTo(K.y,D,d)),j=Ie(k,h,0,K.offsetX||0,K.offsetY||0,K.x,K.y)}j&&(c=Cl.toScreenPosition(k,j),b.x=c.x,b.y=c.y),n._edgeHostGuideInfo={corners:Cl.getTargetCornersOnScreen(k,h),attach:E?E.index:-1,host:h};var R;return K.percent!==$?R="percent: "+K.percent.toFixed(2):K.index!==$?R="index: "+K.index:(R=""+K.x.toFixed(2)+", "+K.y.toFixed(2),(K.offsetX||K.offsetY)&&(R+=" offset: "+K.offsetX.toFixed(2)+", "+K.offsetY.toFixed(2))),{host:h,anchor:K,tipText:R}}},Bo.prototype._guidingToEdit=function(T,$){var X,Q,D=this;if(X=D.screenInfo.curve){Q=X._curves;var y,u,q,f,d,E,o,A,v=1/0,Z=1/0,z=[];for(D.editing&&"realPoint"===D.editing.type&&(A=D.editing.point),d=0,E=2*Q.length;E>d;d++)o=Q[Math.floor(d/2)][d%2?"_p4":"_p1"],z.indexOf(o)>=0||(z.push(o),A&&A===o||(q=o.x-T.x,f=o.y-T.y,Math.abs(q)<Math.abs(v)?(v=q,y=[o]):q===v&&y.push(o),Math.abs(f)<Math.abs(Z)?(Z=f,u=[o]):f===Z&&u.push(o)));var l=D._interactor.getStyle("smartGuideThreshold");if((Math.abs(v)>l||"y"===$)&&(y=null),(Math.abs(Z)>l||"x"===$)&&(u=null),y||u){var C=!1,w={};if(y&&(C=!0,w.xList=y,w.x=v),u&&(C=!0,w.yList=u,w.y=Z),C)return w}}},Bo.prototype._46O=function(S){var x=this;x.editing&&(x.editing=null,x._interactor.fi({kind:"endEditPoint",event:S})),x._guideInfo=null,x._edgeHostGuideInfo=null,x._pan&&(x._pan=null,x._interactor.fi({kind:"endPan",event:S})),x._multiSelect&&(x._handleMultiSelect(x._multiSelect),x._multiSelect=null),x.tipInfo=null,x.edgeEditResult=null},Bo.prototype._handleMultiSelect=function(x){if(x.startPoint&&x.endPoint){var e,o,H,M,q,O=this,G=O._interactor,b=G.gv,z=Cl.toScreenPosition(b,x.startPoint),c=Cl.toScreenPosition(b,x.endPoint),r=C.Default.unionPoint(z,c),Q=O.screenInfo.curve._curves,P=[],V=function(t){t.x>=r.x&&t.y>=r.y&&t.x<=r.x+r.width&&t.y<=r.y+r.height&&P.indexOf(t)<0&&P.push(t)};for(e=0,o=Q.length;o>e;e++)q=Q[e],V(q._p1),V(q._p4);if(P.length){var u=O.activing||{},B=u.selections||[];for(u.point&&B.push(u.point),e=0,o=B.length;o>e;e++)H=B[e],M=P.indexOf(H),M>=0?P[M]=$:P.push(H);var S=P;for(P=[],e=0,o=S.length;o>e;e++)S[e]&&P.push(S[e]);o=P.length,0===o?O.activing=null:1===o?O.activing={point:P[0]}:(H=P[o-1],O.activing={point:H,selections:P.splice(0,o-1)}),G.redraw()}}},Bo.prototype._canDeletePoint=function(R,M){var H=this.target;if(!(H instanceof C.Edge))return!0;var W=R._curves[0],j=R._curves[R._curves.length-1];return W._p1===M||j._p4===M?!1:!0},Bo.prototype.handleDelete=function(){var T=this;if(T.activing&&T.screenInfo){var G=C.Default.isShiftDown(),f=T.screenInfo.curve;T._canDeletePoint(f,T.activing.point)&&f.deleteRealPoint(T.activing.point,G),T.activing.selections&&T.activing.selections.forEach(function(L){T._canDeletePoint(f,L)&&f.deleteRealPoint(L,G)}),T.activing=null,delete T.editing,delete T.tipInfo,delete T.edgeEditResult,delete T._pan,delete T._multiSelect,T._writeToHt(),T._interactor.fp("deleteShapePoint",!1,!0)}},Bo.prototype.handleDoubleClick=function(W){var $=this,m=$._interactor._getLogicalPoint(W);if($.screenInfo&&$._checkEditRealPoint(m)){var Y=$.getCurrentSelectintStatus(),O=Cl.Curve.PointType;return Y=Y===O.Mirrored?O.Straight:O.Mirrored,$._setCurrentSelectionStatus(Y),$._interactor._42(),!0}},Bo.prototype._drawHighlight=function(w){var i=this,M=i.highlight;if(M){var $=M.bezier,h=i._interactor;$&&Cl.Icons.DrawIcon(h,w,Cl.Icons.ShapeHighlightCurve,[$._p1.x,$._p1.y,$._p2.x,$._p2.y,$._p3.x,$._p3.y,$._p4.x,$._p4.y]);var q=M.point;q&&"insertKnot"===M.type&&Cl.Icons.DrawIcon(h,w,Cl.Icons.ShapeHighlighPoint,q)}},Bo.prototype._drawGuide=function(o){var n=this,y=n._guideInfo;if(y){var D,M,B,x,l=y.v;for(D=0;2>D;D++)if(x=0===D?y.xList:y.yList)for(M=0,B=x.length;B>M;M++)Cl.Icons.DrawIcon(n._interactor,o,Cl.Icons.ShapeGuideLine,[l.x,l.y,x[M].x,x[M].y])}},Bo.prototype._drawCurrentPoint=function(w){var W=this;if(W.activing){var s=W.activing,m=W.getCurrentSelectintStatus(),z=W._interactor;if(m!==Cl.Curve.PointType.Straight){var D=s.pairs;s.hlpair,s.hltype;var G=s.selections,$=s.editingCtrl;if(D&&!G){var F,X,_;for(X=0,_=D.length;_>X;X++)F=D[X],$&&X===$.pairId&&F[$.type]?Cl.Icons.DrawIcon(z,w,Cl.Icons.ShapeActivingCtrl,{point:F.point,c1:F.c1,c2:F.c2,hl:$.type}):Cl.Icons.DrawIcon(z,w,Cl.Icons.ShapeActivingCtrl,F)}}Cl.Icons.DrawIcon(z,w,Cl.Icons.ShapeHighlighRealPoint,W.activing.point),G&&G.forEach(function(e){Cl.Icons.DrawIcon(z,w,Cl.Icons.ShapeHighlighRealPoint,e)})}},Bo.prototype.clear=function(){var R=this;R.editing=null,R._guideInfo=null,R.activing=null,R.highlight=null},Bo.prototype._42=function(d){var L=this;L.info={},L.editing||(L.screenInfo=null);var y=L._interactor;if(!y.editDetail)return L.clear(),void 0;var c=y.gv;if(!L.target||!c.isSelected(L.target)||!c.isVisible(L.target))return y.editDetail=!1,L.clear(),void 0;if(L.gatherSingleTarget(c,L.target),Cl.Icons.DrawIcon(y,d,Cl.Icons.ShapeBgCurve,L.screenInfo),L._interactor.getStyle("curveElevationVisible")&&(L.target instanceof C.Polyline||L.target instanceof C.Edge&&L._interactor.getStyle("edgeElevationEditable"))&&L.activing){var G=L.activing.getCurrentEditingPoint();G&&"string"!=typeof G.e&&Cl.Icons.DrawIcon(y,d,Cl.Icons.EdgeElevationGuide,G)}if(L._drawHighlight(d),L._drawCurrentPoint(d),L._getRealPoint().forEach(function(E){Cl.Icons.DrawIcon(y,d,Cl.Icons.ShapePoint,E)}),L._drawGuide(d),L.tipInfo&&L._interactor.getStyle("curveTipVisible")&&Cl.Icons.DrawIcon(y,d,Cl.Icons.TipHelper,L.tipInfo),L._edgeHostGuideInfo&&y._drawHostGuide(L._edgeHostGuideInfo),L.edgeEditResult&&L._drawEdgeHostHighlight(d,L.edgeEditResult.host,L.edgeEditResult.anchor),L._multiSelect&&L._multiSelect.endPoint){var U=C.Default.unionPoint(Cl.toScreenPosition(c,L._multiSelect.startPoint),Cl.toScreenPosition(c,L._multiSelect.endPoint));U.color=c.getRectSelectBorderColor(),d.save(),d.setTransform(1,0,0,1,0,0);var v=B.devicePixelRatio,t=U.borderWidth=Math.round(v);t/=2,U.x=Math.round(U.x*v)+t,U.y=Math.round(U.y*v)+t,U.width=Math.round(U.width*v),U.height=Math.round(U.height*v),Cl.Icons.DrawIcon(y,d,Cl.Icons.SimpleRect,U),d.restore()}},Bo.prototype._drawEdgeHostHighlight=function(F,d,R){this.drawEdgeHostHighlight(F,d,R),this._interactor.redraw()},Bo.prototype.drawEdgeHostHighlight=function(r,U,p){if(hf(U)){var y,E,a,f,v=this,S=v._interactor,j=S.gv,s=j.getDataUI(U),J=ph(s),d=[];for(a=0,f=J.points.length;f>a;a++)E=Cl.toScreenPosition(j,J.points.get(a)),d.push(E.x,E.y);J.segments&&(y=J.segments.toArray());var Y=S.getStyle("edgeHostHighlighPeriod"),R=S.getStyle("edgeHostEdgeHighlighColor");Cl.Icons.DrawIcon(S,r,Cl.Icons.ShapeBgCurve,{P:d,S:y,color:R,dynamicVisible:p.index===$,dynamicPeriod:Y}),R=S.getStyle("edgeHostPointHighlighColor");var L=qb(s);for(a=0,f=L.length;f>a;a++){var D=L[a],I=Cl.toScreenPosition(j,D);Cl.Icons.DrawIcon(S,r,Cl.Icons.ShapePoint,{point:{x:I.x,y:I.y},color:R,size:12,dynamicVisible:a===p.index,dynamicPeriod:Y})}}},Bo.prototype._getRealPoint=function(){var i,E=this.screenInfo,r=E.P,V=E.S,H=-1,h=[],F=-1,g=V.length;return V.each(function(M){F++;
var P=1;if(3===M)P=2;else if(4===M)P=3;else if(5===M)return;H+=P,i=F+1>=g?!0:1===V.get(F+1)?!0:!1,h.push({point:{x:r[2*H],y:r[2*H+1]},segmentIndex:F,pointIndex:H,isEnd:i})}),h},Bo.prototype.getEditingPointsInfo=function(N){var D=this,J=D.activing;if(!J)return!1;var j=J.point;if(!j)return!1;var w=this._getRealPoint(),x=[{screen:j}];J.selections&&J.selections.forEach(function(p){x.push({screen:p})});var z,M,B=w.length;return x.forEach(function(k){for(z=0;B>z;z++)if(M=w[z],k.screen.isNearEnough(M.point)){k.segmentIndex=M.segmentIndex,k.pointIndex=M.pointIndex,k.point=D.target.getPoints().get(M.pointIndex);break}}),N&&x.sort(function(p,j){return p.segmentIndex-j.segmentIndex}),x};var Yn=Cl.MoveHelper=function(j){var A=this;A.catalog="Move",A._interactor=j};Yn.prototype={},Yn.prototype.constructor=Yn,Yn.prototype.calcShift=function(p,N,O){var c,R,r=this,q=r._interactor.gv,s=q.lp(N);if("beginMove"===p&&r._gatherGridInfo(O._lastLogicalPoint||s),c=r._target){var g=c.downPosition;if(g){var e=r._interactor.getStyle("moveSensitivity")/q._zoom;if(g.distanceTo(s)<e)return{x:0,y:0};delete c.downPosition}var B;R=C.Default.isShiftDown(N),R&&(s=r._dealShiftDown(s),B=c.shiftGuide.dir);var $,G=c.rawPos={x:c.pos.x+s.x-c.lp.x,y:c.pos.y+s.y-c.lp.y};if(C.Default.isCtrlDown(N)){if($=r._calcShiftByAddon(),r._target.node instanceof Cl.Group){var z=r._target.node;z._position.x+=$.x,z._position.y+=$.y}return $}var d=r._interactor.rectGuide;if(c.node instanceof C.Data&&c.node.s("2d.attachable")){var Z=r._calcAttachNodeShift(c.node,G);if(d.clear(),Z)return Z}for(var a,E=c.x+G.x,h=c.y+G.y,W={x:E,y:h},M={x:E+c.w/2,y:h+c.h/2},K={x:E+c.w,y:h+c.h},y=r._interactor.gridGuide,v=[d.findClosest(W,B),d.findClosest(M,B),d.findClosest(K,B),y.findClosest(W,B),y.findClosest(M,B),y.findClosest(K,B)],P=1/0,X=1/0,J=0,A=v.length;A>J;J++)a=v[J],a&&(E=a.x,h=a.y,isFinite(E)&&Math.abs(E)<Math.abs(P)&&(P=E),isFinite(h)&&Math.abs(h)<Math.abs(X)&&(X=h));if(isFinite(P)||(P=0),isFinite(X)||(X=0),$=r._calcShiftByAddon(P,X),r._target.node instanceof Cl.Group){var z=r._target.node;z._position.x+=$.x,z._position.y+=$.y}var Y=c.node;if(!Bd(Y,q)){var H=G.x+P,U=G.y+X;r._interactor.rectGuide.gatherLines({node:Y,x:c.x+H,y:c.y+U,w:c.w,h:c.h},B)}return $}},Yn.prototype._calcShiftByAddon=function(A,v){var I=this._target,J=I.rawPos,W=I.node.getPosition();return A=A||0,v=v||0,{x:J.x-W.x+A,y:J.y-W.y+v}},Yn.prototype._dealShiftDown=function(j){var h=this,n=h._target.shiftGuide,T=h._target.lp,d=Math.abs(j.x-T.x),X=Math.abs(j.y-T.y);d>X&&d>n.limit&&"y"===n.dir&&(n.dir="x"),X>d&&X>n.limit&&"x"===n.dir&&(n.dir="y");var z=n.dir;return"x"===z?(j.y=T.y,n.limit=Math.max(n.limit,d)):"y"===z&&(j.x=T.x,n.limit=Math.max(n.limit,X)),j},Yn.prototype._isAttachableLineShape=function(u){if(!u.getSegments)return!1;var Q=u.getSegments();if(!Q)return!0;Q instanceof C.List&&(Q=Q.getArray());for(var f=1,P=Q.length;P>f;f++)if(2!==Q[f])return!1;return!0},Yn.prototype._calcAttachNodeShift=function(){var Z=new kp,l=new kp,W=new kp,H=new kp;return function(T,c){var d=this._interactor.gv,t=T.getHost(),Q=d.getDataAt(c,function(c){return c.s("2d.hostable")?!0:!1});if(Q&&t!==Q&&T.setHost(Q),!Q)return this._edgeHostGuideInfo=null,T.setHost(null);var Y=this._edgeHostGuideInfo={corners:Cl.getTargetCornersOnScreen(d,Q),host:Q,attach:-1};if(this._isAttachableLineShape(Q)){for(var h,L,K,s,G,u,D=Q.getPoints(),V=D.size(),R=Q.getPointsMatrix2d(),N=1/0,n=0;V>n&&(n!==V-1||Q.isClosePath());n++)0!==n?l.copy(W):R.apply(D.get(n),l),R.apply(n===V-1?D.get(0):D.get(n+1),W),Z.copy(c).sub(l),H.copy(W).sub(l),h=H.length(),H.divideScalar(h),L=Z.dot(H),0>L?L=0:L>h&&(L=h),H.multiplyScalar(L).add(l),K=Z.copy(c).sub(H).lengthSq(),N>K&&(N=K,u=n,s=L,G=h);return Math.sqrt(N)*d.getZoom()>this._interactor.getStyle("attachThreshold")?(T.s({"attach.index":-1}),T.setHost(null),void 0):(T.s("attach.offset.opposite")&&(s=G-s),T.s({"attach.index":u,"attach.offset":T.s("attach.offset.relative")?s/G:s}),{x:0,y:0})}var a=d.calculateAttachPoint(Q,c);if(a){var q=a.point;return Y.attach=a.index,this._calcShiftByAddon(q.x-c.x,q.y-c.y)}}}(),Yn.prototype._gatherGridInfo=function(W){var o,C=this,L=C._interactor,p=L._getValidSelection();if(p.length){if(1===p.length){if(o=p[0],!o.getRect)return C._target=null,void 0}else if(o=Cl.Group.findOrCreateGroup(p),!o)return C._target=null,void 0}else{var p=L.gv.sm().getSelection();if(p.length&&(o=p.get(0),!o.getRect))return C._target=null,void 0}if(o){var V=o.getPosition(),m=o.getRect();C._target={node:o,x:m.x-V.x,y:m.y-V.y,w:m.width,h:m.height,lp:{x:W.x,y:W.y},pos:{x:V.x,y:V.y},shiftGuide:{dir:"x",limit:0},downPosition:new Cl.Math.Vector2(W)},L.rectGuide.gatherRects()}},Yn.prototype.clear=function(){var w=this;w._edgeHostGuideInfo=null,w._interactor.rectGuide.clear(),w._interactor._42()},Yn.prototype._42=function(){var Z=this._edgeHostGuideInfo;Z&&this._interactor._drawHostGuide(Z)};var ah=e.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),mc=function(){function o(t,U){var R=$;return function(){return R||(R=t.getExtension(U)),R}}function v(F,E){E==$&&(E={}),E.version=r&&(F instanceof WebGL2RenderingContext||e.prototype.toString.call(F)===U)?2:1,E.extensions=function(){for(var T={},e=F.getSupportedExtensions(),J=e.length;J--;)T[name]=o(F,e[J]);return T}();for(var T=e.keys(n),I=0,X=T.length;X>I;++I){var d=T[I];E[d]=F.getParameter(n[d])}if(E.version>1){T=e.keys(Q);for(var I=0,X=T.length;X>I;++I){var d=T[I];E[d]=F.getParameter(Q[d])}}return E}var r="undefined"!=typeof WebGL2RenderingContext,U="[object WebGL2RenderingContext]",n={aliasedLineWidthRange:ah.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:ah.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:ah.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:ah.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:ah.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:ah.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:ah.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:ah.MAX_TEXTURE_SIZE,maxVaryingVectors:ah.MAX_VARYING_VECTORS,maxVertexAttribs:ah.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:ah.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:ah.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:ah.MAX_VIEWPORT_DIMS},Q={max3DTextureSize:ah.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:ah.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:ah.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:ah.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:ah.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:ah.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:ah.MAX_DRAW_BUFFERS,maxElementIndex:ah.MAX_ELEMENT_INDEX,maxElementsIndices:ah.MAX_ELEMENTS_INDICES,maxElementsVertices:ah.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:ah.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:ah.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:ah.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:ah.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:ah.MAX_SAMPLES,maxTextureLODBias:ah.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:ah.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:ah.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:ah.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:ah.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:ah.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:ah.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:ah.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:ah.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:ah.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:ah.MIN_PROGRAM_TEXEL_OFFSET};return{"for":function(b){var C=b._info;return C||(b._info=C=v(b,C)),C}}}(),Vl=function(){function X(V,T,X){return{def:V,getter:X?function(x){var L=mc.for(x);return L.version>1?x.getParameter(T):V}:function(r){return r.getParameter(T)},setter:X?function(s,j){var b=mc.for(s);b.version>1&&s.pixelStorei(T,j)}:function(n,g){n.pixelStorei(T,g)}}}function q(e){return"string"==typeof e?xs(e):e.r!==$?(S[0]=e.r,S[1]=e.g,S[2]=e.b,S[3]=e.a,S):e.red!==$?(S[0]=e.red,S[1]=e.green,S[2]=e.blue,S[3]=e.alpha,S):e}function G(N){return H(N)?Array.prototype.slice.call(N,0):N}function Y(m,o,U){this.gl=o,this._record=U||{},this._branches={},this._leafSync={},this._struct=m;for(var l=m.children,X=l.length;X--;){var u=l[X],y=u.name;u.isLeaf?(this._leafSync[y]=!1,this._record[y]=G(u.desc.def)):this._record[y]={}}}function Z(A){function z(E,v){Y.call(this,A,E,v);for(var u=a.length;u--;){var K=a[u];this._branches[K._name]=new K._type(E,this._record[K._name])}}function C(E,y){function t(y,r){for(var K=G,a=!1;K--;)y[K]!==r[K]&&(y[K]=r[K],a=!0);return a}var M=E.name,g=H(E.desc.def),G=g&&E.desc.def.length;if(E.isLeaf){var r=E.desc.setter,J=E.desc.parse;e.defineProperty(y,M,{configurable:!1,enumerable:!0,get:function(){return this._record[M]},set:g?function(H){J&&(H=J(H)),(t(this._record[M],H)||!this._leafSync[M])&&(r(this.gl,this._record[M]),this._leafSync[M]=!0)}:function(v){this._record[M]===v&&this._leafSync[M]||(r(this.gl,v),this._record[M]=v,this._leafSync[M]=!0)}})}else a.push({_name:M,_type:Z(E)}),e.defineProperty(y,M,{configurable:!1,enumerable:!0,get:function(){return this._branches[M]},set:function(k){this._branches[M].apply(k)}})}var a=[];return T(z,Y),A.forEach(C,z.prototype),z}var S="undefined"!=typeof Float32Array&&new Float32Array(4),m={viewport:{def:[0,0,0/0,0/0],getter:function(q){return q.getParameter(q.VIEWPORT)},setter:function(I,o){var L=o[2]!==o[2]?I.drawingBufferWidth-o[0]:o[2],d=o[3]!==o[3]?I.drawingBufferHeight-o[1]:o[3];I.viewport(o[0],o[1],L,d)}},dither:{def:!1,getter:function(l){return l.isEnabled(l.DITHER)},setter:function(z,I){I?z.enable(z.DITHER):z.disable(z.DITHER)}},rasterizerDiscard:{def:!1,getter:function(H){var c=mc.for(H);return c.version>1&&H.isEnabled(H.RASTERIZER_DISCARD)},setter:function(h,H){var i=mc.for(h);1!==i.version&&(H?h.enable(h.RASTERIZER_DISCARD):h.disable(h.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(s){return s.lineWidth?s.getParameter(s.LINE_WIDTH):1},setter:function(J,L){J.lineWidth&&J.lineWidth(L)}},color:{clear:{def:[0,0,0,0],getter:function(a){return a.getParameter(a.COLOR_CLEAR_VALUE)},setter:function(A,V){A.clearColor(V[0],V[1],V[2],V[3])},parse:q},mask:{def:[!0,!0,!0,!0],getter:function(h){return h.getParameter(h.COLOR_WRITEMASK)},setter:function(R,B){R.colorMask(B[0],B[1],B[2],B[3])}}},blend:{enabled:{def:!1,getter:function(G){return G.isEnabled(G.BLEND)},setter:function(u,c){c?u.enable(u.BLEND):u.disable(u.BLEND)}},color:{def:[0,0,0,0],getter:function(W){return W.getParameter(W.BLEND_COLOR)},setter:function(f,O){f.blendColor(O[0],O[1],O[2],O[3])},parse:q},equation:{def:[ah.FUNC_ADD,ah.FUNC_ADD],getter:function(o){return[o.getParameter(o.BLEND_EQUATION_RGB),o.getParameter(o.BLEND_EQUATION_ALPHA)]},setter:function(z,h){z.blendEquationSeparate(h[0],h[1])},parse:function(n){var T=n.length;return T>1?n:1===T?(S[1]=S[0]=n[0],S):(S[1]=S[0]=n,S)}},func:{def:[ah.ONE,ah.ZERO,ah.ONE,ah.ZERO],getter:function(j){return[j.getParameter(j.BLEND_SRC_RGB),j.getParameter(j.BLEND_DST_RGB),j.getParameter(j.BLEND_SRC_ALPHA),j.getParameter(j.BLEND_DST_ALPHA)]},setter:function(Y,P){Y.blendFuncSeparate(P[0],P[1],P[2],P[3])},parse:function(_){var V=_.length;return V>3?_:(S[2]=S[0]=_[0],S[3]=S[1]=_[1],S)}}},cullFace:{enabled:{def:!1,getter:function(o){return o.isEnabled(o.CULL_FACE)},setter:function(K,q){q?K.enable(K.CULL_FACE):K.disable(K.CULL_FACE)}},mode:{def:ah.BACK,getter:function(k){return k.getParameter(k.CULL_FACE_MODE)},setter:function(T,S){T.cullFace(S)}},frontFace:{def:ah.CCW,getter:function(G){return G.getParameter(G.FRONT_FACE)},setter:function(K,u){K.frontFace(u)}}},scissor:{enabled:{def:!1,getter:function(W){return W.isEnabled(W.SCISSOR_TEST)},setter:function(j,Z){Z?j.enable(j.SCISSOR_TEST):j.disable(j.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(s){return s.getParameter(s.SCISSOR_BOX)},setter:function(c,K){var b=K[2]!==K[2]?c.drawingBufferWidth-K[0]:K[2],k=K[3]!==K[3]?c.drawingBufferHeight-K[1]:K[3];c.scissor(K[0],K[1],b,k)}}},depth:{enabled:{def:!1,getter:function(q){return q.isEnabled(q.DEPTH_TEST)},setter:function(b,B){B?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST)}},clear:{def:1,getter:function(K){return K.getParameter(K.DEPTH_CLEAR_VALUE)},setter:function(L,R){L.clearDepth(R)}},mask:{def:!0,getter:function(l){return l.getParameter(l.DEPTH_WRITEMASK)},setter:function(H,r){H.depthMask(r)}},range:{def:[-1,1],getter:function(f){return f.getParameter(f.DEPTH_RANGE)},setter:function(W,v){W.depthRange(v[0],v[1])}},func:{def:ah.LESS,getter:function(l){return l.getParameter(l.DEPTH_FUNC)},setter:function(c,p){c.depthFunc(p)}}},stencil:{enabled:{def:!1,getter:function(w){return w.isEnabled(w.STENCIL_TEST)},setter:function(p,T){T?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST)}},clear:{def:0,getter:function(f){return f.getParameter(f.STENCIL_CLEAR_VALUE)},setter:function(m,e){m.clearStencil(e)}},frontMask:{def:255,getter:function(i){return i.getParameter(i.STENCIL_WRITEMASK)},setter:function(Y,P){Y.stencilMaskSeparate(Y.FRONT,P)}},frontOp:{def:[ah.KEEP,ah.KEEP,ah.KEEP],getter:function(K){return[K.getParameter(K.STENCIL_FAIL),K.getParameter(K.STENCIL_PASS_DEPTH_FAIL),K.getParameter(K.STENCIL_PASS_DEPTH_PASS)]},setter:function(K,R){K.stencilOpSeparate(K.FRONT,R[0],R[1],R[2])}},frontFunc:{def:[ah.ALWAYS,0,255],getter:function(g){return[g.getParameter(g.STENCIL_FUNC),g.getParameter(g.STENCIL_REF),g.getParameter(g.STENCIL_VALUE_MASK)]},setter:function(g,$){g.stencilFuncSeparate(g.FRONT,$[0],$[1],$[2])}},backMask:{def:255,getter:function(b){return b.getParameter(b.STENCIL_BACK_WRITEMASK)},setter:function(J,x){J.stencilMaskSeparate(J.BACK,x)}},backOp:{def:[ah.KEEP,ah.KEEP,ah.KEEP],getter:function(o){return[o.getParameter(o.STENCIL_BACK_FAIL),o.getParameter(o.STENCIL_BACK_PASS_DEPTH_FAIL),o.getParameter(o.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(c,E){c.stencilOpSeparate(c.BACK,E[0],E[1],E[2])}},backFunc:{def:[ah.ALWAYS,0,255],getter:function(a){return[a.getParameter(a.STENCIL_BACK_FUNC),a.getParameter(a.STENCIL_BACK_REF),a.getParameter(a.STENCIL_BACK_VALUE_MASK)]},setter:function(S,e){S.stencilFuncSeparate(S.BACK,e[0],e[1],e[2])}}},hint:{generateMipmap:{def:ah.DONT_CARE,getter:function(J){return J.getParameter(J.GENERATE_MIPMAP_HINT)},setter:function(X,k){X.hint(X.GENERATE_MIPMAP_HINT,k)}},fragmentShaderDerivative:{def:ah.DONT_CARE,getter:function(Q){var H=mc.for(Q);return 1!==H.version||H.extensions.OES_standard_derivatives?Q.getParameter(ah.FRAGMENT_SHADER_DERIVATIVE_HINT):ah.DONT_CARE},setter:function(m,w){var Z=mc.for(m);return Z.version>1||Z.extensions.OES_standard_derivatives?(m.hint(ah.FRAGMENT_SHADER_DERIVATIVE_HINT,w),void 0):void 0}}},pixelStore:{packAlignment:X(4,ah.PACK_ALIGNMENT,!1),unpackAlignment:X(4,ah.UNPACK_ALIGNMENT,!1),unpackFlipY:X(!1,ah.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:X(!1,ah.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:X(ah.BROWSER_DEFAULT_WEBGL,ah.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:X(0,ah.PACK_ROW_LENGTH,!0),packSkipPixels:X(0,ah.PACK_SKIP_PIXELS,!0),packSkipRows:X(0,ah.PACK_SKIP_ROWS,!0),unpackRowLength:X(0,ah.UNPACK_ROW_LENGTH,!0),unpackImageHeight:X(0,ah.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:X(0,ah.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:X(0,ah.UNPACK_SKIP_ROWS,!0),unpackSkipImages:X(0,ah.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(q){return q.isEnabled(q.POLYGON_OFFSET_FILL)},setter:function(c,b){b?c.enable(c.POLYGON_OFFSET_FILL):c.disable(c.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(A){return[A.getParameter(A.POLYGON_OFFSET_FACTOR),A.getParameter(A.POLYGON_OFFSET_UNITS)]},setter:function(L,A){L.polygonOffset(A[0],A[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(L){return L.isEnabled(L.SAMPLE_COVERAGE)},setter:function(K,R){R?K.enable(K.SAMPLE_COVERAGE):K.disable(K.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(s){return s.isEnabled(s.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(f,V){V?f.enable(f.SAMPLE_ALPHA_TO_COVERAGE):f.disable(f.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(e){return[e.getParameter(e.SAMPLE_COVERAGE_VALUE),e.getParameter(e.SAMPLE_COVERAGE_INVERT)]},setter:function(d,_){d.sampleCoverage(_[0],_[1])}}}},a=yk.create(m,function(X){return"def"in X});Y.prototype.reset=function(){for(var L=this._struct.children,z=L.length;z--;){var S=L[z],v=S.name;S.isLeaf?this[v]=S.desc.def:this._branches[v].reset()}},Y.prototype.save=function(H){H==$&&(H={});for(var x=this._struct.children,d=x.length;d--;){var P=x[d],z=P.name;if(P.isLeaf)H[z]=G(this._record[z]);else{var l=H[z];l==$&&(H[z]=l={}),this._branches[z].save(l)}}return H},Y.prototype.sync=function(s,b){for(var e=this._struct.children,k=e.length;k--;){var p=e[k],Z=p.name;p.isLeaf?(b||!this._leafSync[Z])&&(s?(this._record[Z]=p.desc.getter(this.gl),this._leafSync[Z]=!0):(p.desc.setter(this.gl,this._record[Z]),this._leafSync[Z]=!0)):this._branches[Z].sync(s,b)}},Y.prototype.syncLoss=function(){for(var k=this._struct.children,B=k.length;B--;){var $=k[B];$.isLeaf?this._leafSync[$.name]=!1:this._branches[$.name].syncLoss()}},Y.prototype.apply=function(F){for(var w=this._struct.children,c=w.length;c--;){var Z=w[c],d=Z.name;d in F&&(Z.isLeaf?this[d]=F[d]:this._branches[d].apply(F[d]))}},Y.prototype.append=function(c){var y=this._struct.childMap;for(var a in c){var G=y[a];G&&(G.isLeaf?this[a]=c[a]:this._branches[a].append(c[a]))}};var O=Z(a);return function(Q){var d=Q._state;return d||(Q._state=d=new O(Q)),d}}(),Rf=function(){function Z(R,E,V,n){if(R){var H=R.length;if(H!=$)for(var z=0;n>z;++z)E[V+z]=R[z];else R.toArray&&R.toArray(E,V)}else for(var z=0;n>z;++z)E[V+z]=0}function N(I,v,e){var Y=I[0];if(0>=Y||Y>0)return I;var y=v*e,c=d[y];if(c==$&&(d[y]=new Float32Array(y)),0!==v){Z(Y,c,0,e);for(var b=1,T=0;b!==v;++b)T+=e,Z(I[b],c,T,e)}return c}function x(S,h){S.uniform1f(this.addr,h)}function B(t,v){t.uniform1fv(this.addr,v)}function K(D,Q){if(Q.x!=$)D.uniform2f(this.addr,Q.x,Q.y);else{var O=d[2];O.set(Q,0),D.uniform2fv(this.addr,O)}}function M(u,w){u.uniform2fv(this.addr,N(w,this.size,2))}function F(p,N){if(N.x!=$)p.uniform3f(this.addr,N.x,N.y,N.z);else if(N.r!=$)p.uniform3f(this.addr,N.r,N.g,N.b);else if(N.red!=$)p.uniform3f(this.addr,N.red,N.green,N.blue);else{var W=d[3];W.set(N,0),p.uniform3fv(this.addr,W)}}function h(x,U){x.uniform3fv(this.addr,N(U,this.size,3))}function c(M,Q){if("string"==typeof Q&&(Q=xs(Q)),Q.x!=$)M.uniform4f(this.addr,Q.x,Q.y,Q.z,Q.w);else if(Q.r!=$)M.uniform4f(this.addr,Q.r,Q.g,Q.b,Q.a);else if(Q.red!=$)M.uniform4f(this.addr,Q.red,Q.green,Q.blue,Q.alpha);else{var S=d[4];S.set(Q,0),M.uniform4fv(this.addr,S)}}function L(e,i){e.uniform4fv(this.addr,N(i,this.size,4))}function Q(q,T){q.uniform1i(this.addr,T)
}function y(W,E){W.uniform1iv(this.addr,E)}function G(C,q){C.uniform2iv(this.addr,q)}function H(k,q){k.uniform3iv(this.addr,q)}function t(H,q){H.uniform4iv(this.addr,q)}function X(R,S){R.uniform1i(this.addr,l[S?1:0])}function z(P,m){var y=d[4];y.set(m,0),P.uniformMatrix2fv(this.addr,!1,y)}function D(i,y){i.uniformMatrix2fv(this.addr,!1,N(y,this.size,4))}function k(D,I){var S=d[9];S.set(I,0),D.uniformMatrix3fv(this.addr,!1,S)}function E(T,Q){T.uniformMatrix3fv(this.addr,!1,N(Q,this.size,9))}function C(V,y){var t=d[16];t.set(y,0),V.uniformMatrix4fv(this.addr,!1,t)}function u(r,A){r.uniformMatrix4fv(this.addr,!1,N(A,this.size,16))}function q(U,o){U.uniform1i(this.addr,this.slots[0]),U.activeTexture(U.TEXTURE0+this.slots[0]),U.bindTexture(U.TEXTURE_2D,o||U._emptyTexture)}function b(O,E){O.uniform1iv(this.addr,this.slots);for(var N=this.slots.length;N--;)O.activeTexture(O.TEXTURE0+this.slots[N]),O.bindTexture(O.TEXTURE_2D,E[N]||O._emptyTexture)}function J(o,e){o.uniform1i(this.addr,this.slots[0]),o.activeTexture(o.TEXTURE0+this.slots[0]),o.bindTexture(o.TEXTURE_CUBE_MAP,e||o._emptyCubeTexture)}function o(Z,$){Z.uniform1iv(this.addr,this.slots);for(var I=this.slots.length;I--;)Z.activeTexture(Z.TEXTURE0+this.slots[I]),Z.bindTexture(Z.TEXTURE_CUBE_MAP,$[I]||Z._emptyCubeTexture)}function s(S,V,y){i[S]=[V,y]}function m(w,G,p){switch(w.type){case 35678:case 35680:if("uSampler"===p)return[0];if("uBlendSampler"===p)return[1];for(var c=w.size,l=new Int32Array(c),I=0;c>I;++I)l[I]=G.usedTextureSlot++;return l}return $}function Y(f,X,Z,j,E){this.name=f,this.addr=X,this.size=j?Z.size:0,this.activeInfo=Z,this.setter=i[Z.type][j?1:0],this.slots=m(Z,E,f),Dg(this)}function S(I,m,s,h){var O=I.name,S=O.length;for(w.lastIndex=0;;){var t=w.exec(O),G=w.lastIndex,D=t[1],u="]"===t[2],F=t[3];if(u&&(D=0|D),F===$||"["===F&&G+2===S){s[D]=new Y(D,m,I,F!==$,h);break}var Q=s[D];Q==$&&(s[D]=Q={}),s=Q}}function W(d,C,L){this.gl=C,this._program=L,this._leaves={},this._branches={},this._struct=d}function v(j){function g(G,k){W.call(this,j,G,k);for(var x=O.length;x--;){var f=O[x];this._branches[f._name]=new f._type(G,k)}}function S(y,P){var l=y.name;if(y.isLeaf){var z=R("d.setter(this.gl, v);",["v"],["d"],[y.desc]);e.defineProperty(P,l,{configurable:!1,enumerable:!0,get:function(){return z},set:z})}else O.push({_name:l,_type:v(y)}),e.defineProperty(P,l,{configurable:!1,enumerable:!0,get:function(){return this._branches[l]},set:function(s){this._branches[l].apply(s)}})}var O=[];return T(g,W),j.forEach(S,g.prototype),g}function I($,i){for(var R=$.getProgramParameter(i,$.ACTIVE_UNIFORMS),Y={},n={usedTextureSlot:2};R--;){var L=$.getActiveUniform(i,R),A=L.name,U=$.getUniformLocation(i,A);S(L,U,Y,n)}var C=yk.create(Y,function(C){return"addr"in C}),V=v(C);return e.defineProperty(V.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:n.usedTextureSlot}),new V($,i)}var d=[];if("function"==typeof Float32Array)for(var p=1;17>p;++p)d[p]=new Float32Array(p);var l=[0,1],i=[];s(ah.FLOAT,x,B),s(ah.FLOAT_VEC2,K,M),s(ah.FLOAT_VEC3,F,h),s(ah.FLOAT_VEC4,c,L),s(ah.INT,Q,y),s(ah.INT_VEC2,G,G),s(ah.INT_VEC3,H,H),s(ah.INT_VEC4,t,t),s(ah.BOOL,X,y),s(ah.BOOL_VEC2,G,G),s(ah.BOOL_VEC3,H,H),s(ah.BOOL_VEC4,t,t),s(ah.FLOAT_MAT2,z,D),s(ah.FLOAT_MAT3,k,E),s(ah.FLOAT_MAT4,C,u),s(ah.SAMPLER_2D,q,b),s(ah.SAMPLER_CUBE,J,o);var w=/([\w\d_]+)(\])?(\[|\.)?/g;return W.prototype.apply=function(M){for(var p=this._struct.children,G=p.length;G--;){var b=p[G],j=b.name;j in M&&(b.isLeaf?this[j]=M[j]:this._branches[j].apply(M[j]))}},W.prototype.append=function(B){var t=this._struct.childMap;for(var w in B){var z=t[w];z&&(z.isLeaf?this[w]=B[w]:this._branches[w].append(B[w]))}},function(g,P){var s=P._uniforms;return s||(P._uniforms=s=I(g,P)),s}}(),rf=function(){function J(O,E,v){E.vertexAttrib1f(O.addr,v)}function H(P,T,x){if(x.x!=$)T.vertexAttrib2f(P.addr,x.x,x.y);else{var b=u[2];b.set(x,0),T.vertexAttrib2fv(P.addr,b)}}function K(N,M,R){if(R.x!=$)M.vertexAttrib3f(N.addr,R.x,R.y,R.z);else if(R.r!=$)M.vertexAttrib3f(N.addr,R.r,R.g,R.b);else if(R.red!=$)M.vertexAttrib3f(N.addr,R.red,R.green,R.blue);else{var r=u[3];r.set(R,0),M.vertexAttrib3fv(N.addr,r)}}function P(X,r,Y){if("string"==typeof Y&&(Y=xs(Y)),Y.x!=$)r.vertexAttrib4f(X.addr,Y.x,Y.y,Y.z,Y.w);else if(Y.r!=$)r.vertexAttrib4f(X.addr,Y.r,Y.g,Y.b,Y.a);else if(Y.red!=$)r.vertexAttrib4f(X.addr,Y.red,Y.green,Y.blue,Y.alpha);else{var i=u[4];i.set(Y,0),r.vertexAttrib4fv(X.addr,i)}}function N(W,M,E){E=E.el||E;for(var R=0,z=0;2>R;++R)M.vertexAttrib2f(W.addr,E[z++],E[z++])}function S(l,C,d){d=d.el||d;for(var $=0,N=0;3>$;++$)C.vertexAttrib3f(l.addr,d[N++],d[N++],d[N++])}function f(G,$,t){t=t.el||t;for(var M=0,Z=0;4>M;++M)$.vertexAttrib4f(G.addr,t[Z++],t[Z++],t[Z++],t[Z++])}function t(R,J,P,Y,N,p,X){J.bindBuffer(J.ARRAY_BUFFER,P),J.vertexAttribPointer(R.addr,1,Y||J.FLOAT,!!N,p||0,X||0),J.bindBuffer(J.ARRAY_BUFFER,null)}function I(s,$,t,X,G,b,E){$.bindBuffer($.ARRAY_BUFFER,t),$.vertexAttribPointer(s.addr,2,X||$.FLOAT,!!G,b||0,E||0),$.bindBuffer($.ARRAY_BUFFER,null)}function E(W,L,r,A,M,f,s){L.bindBuffer(L.ARRAY_BUFFER,r),L.vertexAttribPointer(W.addr,3,A||L.FLOAT,!!M,f||0,s||0),L.bindBuffer(L.ARRAY_BUFFER,null)}function h(C,i,A,d,G,U,v){i.bindBuffer(i.ARRAY_BUFFER,A),i.vertexAttribPointer(C.addr,4,d||i.FLOAT,!!G,U||0,v||0),i.bindBuffer(i.ARRAY_BUFFER,null)}function z(I,q,z,d,T,r,N){var r=r||4,N=N||0;q.bindBuffer(q.ARRAY_BUFFER,z),q.vertexAttribPointer(I.addr,2,d||q.FLOAT,!!T,r,N),q.vertexAttribPointer(I.addr+1,2,d||q.FLOAT,!!T,r,N+2),q.bindBuffer(q.ARRAY_BUFFER,null)}function C(z,P,K,t,R,Z,I){var Z=Z||9,I=I||0;P.bindBuffer(P.ARRAY_BUFFER,K),P.vertexAttribPointer(z.addr,3,t||P.FLOAT,!!R,Z,I),P.vertexAttribPointer(z.addr+1,3,t||P.FLOAT,!!R,Z,I+3),P.vertexAttribPointer(z.addr+2,3,t||P.FLOAT,!!R,Z,I+6),P.bindBuffer(P.ARRAY_BUFFER,null)}function w(Q,D,G,g,P,y,t){var y=y||16,t=t||0;D.bindBuffer(D.ARRAY_BUFFER,G),D.vertexAttribPointer(Q.addr,4,g||D.FLOAT,!!P,y,t),D.vertexAttribPointer(Q.addr+1,4,g||D.FLOAT,!!P,y,t+4),D.vertexAttribPointer(Q.addr+2,4,g||D.FLOAT,!!P,y,t+8),D.vertexAttribPointer(Q.addr+3,4,g||D.FLOAT,!!P,y,t+12),D.bindBuffer(D.ARRAY_BUFFER,null)}function D(l,D,a){B[l]=function(s,Z,B,C,O,H){this.addr==$||this.addr<0||(Z==$||Z===!1?s.disableVertexAttribArray(this.addr):an(Z)===p?(s.enableVertexAttribArray(this.addr),a(this,s,Z,B,C,O,H)):(s.disableVertexAttribArray(this.addr),D(this,s,Z)))}}function j(I,b,y){this.name=I,this.addr=b,this.activeInfo=y,this.setter=B[y.type],Dg(this)}function o(t,r,Y){this.gl=r,this.program=Y,this._branches={},this._struct=t}function Q(p){function i(P,J){o.call(this,p,P,J);for(var u=U.length;u--;){var B=U[u];this._branches[B._name]=new B._type(P,J)}}function V(n,S){var Y=n.name;if(n.isLeaf){var o=R("d.setter(this.gl, v);",["v"],["d"],[n.desc]);e.defineProperty(S,Y,{configurable:!1,enumerable:!0,get:function(){return o},set:o})}else U.push({_name:Y,_type:Q(n)}),e.defineProperty(S,Y,{configurable:!1,enumerable:!0,get:function(){return this._branches[Y]},set:function(j){this._branches[Y].apply(j)}})}var U=[];return T(i,o),p.forEach(V,i.prototype),i}function G(y,w){for(var n=y.getProgramParameter(w,y.ACTIVE_ATTRIBUTES),f={};n--;){var A=y.getActiveAttrib(w,n),L=A.name,M=y.getAttribLocation(w,L);f[L]=new j(L,M,A)}var N=yk.create(f,function(Q){return"addr"in Q}),l=Q(N);return new l(y,w)}for(var u=[],q=1;17>q;++q)u[q]=new Uj(q);var B=[],p="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return D(ah.FLOAT,J,t),D(ah.FLOAT_VEC2,H,I),D(ah.FLOAT_VEC3,K,E),D(ah.FLOAT_VEC4,P,h),D(ah.FLOAT_MAT2,N,z),D(ah.FLOAT_MAT3,S,C),D(ah.FLOAT_MAT4,f,w),o.prototype.disable=function(){for(var E=this._struct.children,p=E.length;p--;){var q=E[p],e=q.name;q.isLeaf?this.gl.disableVertexAttribArray(q.desc.addr):this._branches[e].disable()}},o.prototype.apply=function(Y){for(var F=this._struct.children,o=F.length;o--;){var _=F[o],H=_.name;H in Y&&(_.isLeaf?this[H]=Y[H]:this._branches[H].apply(Y[H]))}},o.prototype.append=function(K){var f=this._struct.childMap;for(var i in K){var M=f[i];M&&(M.isLeaf?this[i]=K[i]:this._branches[i].append(K[i]))}},function(p,j){var V=j._attribs;return V||(j._attribs=V=G(p,j)),V}}(),Oo=function(J){var d=this;e.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:J,writable:!1},glState:{configurable:!1,enumerable:!1,value:Vl(J),writable:!1}}),d._currProgram=$,d._currUniforms=$,d._currAttribs=$,d._sync=!0};e.defineProperties(Oo.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(J){var c=this;c._sync&&J===c._currProgram||(c.gl.useProgram(J),c._currProgram=J,c._currUniforms=Rf(c.gl,J),c._currAttribs=rf(c.gl,J),c._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var f=this;return f._currProgram&&!f._sync&&(f.gl.useProgram(f._currProgram),f._sync=!0),f._currUniforms},set:function(G){var y=this;y._currUniforms&&(y._currProgram&&!y._sync&&(y.gl.useProgram(y._currProgram),this._sync=!0),y._currUniforms.apply(G))}},attribs:{configurable:!1,enumerable:!1,get:function(){var S=this;return S._currProgram&&!S._sync&&(S.gl.useProgram(S._currProgram),S._sync=!0),S._currAttribs},set:function(H){var w=this;w._currUniforms&&(w._currProgram&&!w._sync&&(w.gl.useProgram(w._currProgram),this._sync=!0),w._currAttribs.apply(H))}}}),Oo.prototype.useProgram=function(c){var r=this;r._sync&&c===r._currProgram||(r.gl.useProgram(c),r._currProgram=c,r._currUniforms=Rf(r.gl,c),r._currAttribs=rf(r.gl,c),r._sync=!0)},Oo.prototype.directState=function(){return this.glState},Oo.prototype.directUniforms=function(){return this._currUniforms},Oo.prototype.directAttribs=function(){return this._currAttribs},Oo.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},Oo.for=function(c){var Y=c._renderState;return Y||(c._renderState=Y=new Oo(c)),Y};var bc="directional",il="point",tf="spot",jn="light.color",ic={},Hn=[],hj=0,dd=function(R,T){Zq(T)&&bm.test(T)?tg(R,T):on(T)&&T.modelType?wn(R,T):T===$?delete Qc[R]:Qc[R]=T},Cr=function(t){return t},Ij=function(s){s=B.convertShape3dModelName(s);var S;if(on(s)){if(s.modelType){if(s.uuid){if(S=Qc[s.uuid])return S}else s.uuid=C.Math.generateUUID();return S===$&&(Oc&&Oc[s.uuid]||wn(s.uuid,s)),$}return s}return S=Qc[s],s&&S===$&&bm.test(s)&&(Oc&&Oc[s]||tg(s,s)),S},ec=function(O,H){O.frameStack?O.frameStack.push(H):O.frameStack=[H],O.bindFramebuffer(O.FRAMEBUFFER,H)},Uc=function(h){var s=h.frameStack;if(s){if(s.pop(),s.length)return h.bindFramebuffer(h.FRAMEBUFFER,s[s.length-1]),void 0;h.frameStack=null}h.bindFramebuffer(h.FRAMEBUFFER,null)};Ki(B,{graph3dViewAttributes:V,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:Z/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:eh,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:Z,graph3dViewRotateMinPhi:0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:Z/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:dd,getShape3dModel:Ij,convertShape3dModelName:Cr,getShape3dModelMap:function(){return Qc},getCachedShape3dModelMap:function(){return qg},createMatrix:function(h,z){Xj(h)||(h=[h]);for(var v=h.length-1;v>=0;v--){var f=h[v];z=Gl(f.mat,f.s3,f.r3,f.rotationMode,f.t3,z)}return z},transformVec:function(I,E){return rq(I,E)},glBindFrame:ec,glUnbindFrame:Uc,createBoxModel:function(){return{vs:bp,ns:Vo,uv:th,is:rb}},createRoundRectModel:function(O,y){return Pq.roundRect(O,y)},createStarModel:function(_,d){return Pq.star(_,d)},createRectModel:function(R,H){return Pq.rect(R,H)},createTriangleModel:function(x,N){return Pq.triangle(x,N)},createRightTriangleModel:function(c,D){return Pq.rightTriangle(c,D)},createParallelogramModel:function(K,i){return Pq.parallelogram(K,i)},createTrapezoidModel:function(x,C){return Pq.trapezoid(x,C)},createSmoothSphereModel:function(b,e,Y,U,D,L,J){return $n(new af(b,e,Y,U,D,L,J))},createSphereModel:function(Z,o,f,W,v,z,U){return Z?zl(Z,o,f,W,v,z,U):B.createSmoothSphereModel()},createSmoothConeModel:function(N,o,e,T,g){return Xl(N,o,e,T,g)},createConeModel:function(t,p,Y,b,r,Z,M,T){return t?pr(t,p,Y,b,r,Z,M,T):Xl(Z)},createSmoothCylinderModel:function(s,I,i,k,f,G,P,B){return $n(new lm(s,I,i,k,f,G,P,B))},createCylinderModel:function(I,z,h,s,j,x,n,Q){return I?Di(I,z,h,s,j,x,n,Q):rp(x,n)},createSmoothTorusModel:function(R,g,S,f,U,V){return $n(new Xg(R,g,S,f,U,V))},createTorusModel:function(t,v,V,E,R,P,Q,f){return t?up(t,v,V,E,R,P,Q,f):bb(P,Q)},createExtrusionModel:function(y,z,v,K,g,f,N,b){return df(y,z,v,K,g,f,N,b)},createSmoothRingModel:function(F,$,P,V,B,L){for(var M=[],k=0;k<F.length-1;k+=2)M.push({x:F[k],y:F[k+1]});for(F=ds(M,$,P)[0],M=[],k=0;k<F.length;k++){var b=F[k];M.push(new Qo(b.x,0,b.y))}return $n(new Gm(M,L,V,B))},createTextGeometry:function(h,v){return $n(new Mm(h,v))},loadFontFace:function(c,P){B.xhrLoad(c,function(b){if(!b)return P();var H;try{H=JSON.parse(b)}catch(x){H=JSON.parse(b.substring(65,b.length-2))}_o.loadFace(H),P&&P(H.familyName.toLowerCase())},P?null:{sync:!0})},getShaderErrorLog:function(){return Hn.join("\n")},createRingModel:function(l,s,j,P,N,y,I,X,A,$){for(var L=[],p=0;p<l.length-1;p+=2)L.push({x:l[p],y:l[p+1]});y=y||B.shapeSide,I=I||0,X=X||y;var t,S,Y,W,e,f,r,g,d,G,p,x,c,J,T,m,K,v,i=[],h=[],U=A?[]:V,R=A?[]:V,Z=$?[]:V,u=$?[]:V,F=P?[]:V,O=P?[]:V,n=N?[]:V,_=N?[]:V,l=ds(L,s,j),E=Xr(l),q=0,Q=2*Math.PI/y;return l.forEach(function(z){if(Y=z.length,Y>1){if(W=z[0],P)for(f=W.x,g=W.y,p=I;X>p;p++)x=p+1,c=p*Q,J=x*Q,T=D(c),m=w(c),K=D(J),v=w(J),F.push(T*f,g,-m*f,K*f,g,-v*f,0,g,0),O.push(.5-.5*T,.5-.5*m,.5-.5*K,.5-.5*v,.5,.5);for(G=0;Y>G;G++){for(e=z[G],f=W.x,r=e.x,g=W.y,d=e.y,t=q/E,q+=Lf(W,e),S=q/E,p=I;X>p;p++)x=p+1,c=p*Q,J=x*Q,T=D(c),m=w(c),K=D(J),v=w(J),i.push(T*r,d,-m*r,K*r,d,-v*r,T*f,g,-m*f,K*r,d,-v*r,K*f,g,-v*f,T*f,g,-m*f),h.push(p/y,S,x/y,S,p/y,t,x/y,S,x/y,t,p/y,t),A&&p===I&&(U.push(0,g,0,0,d,0,T*r,d,-m*r,T*r,d,-m*r,T*f,g,-m*f,0,g,0),R.push(0,.5-g,0,.5-d,2*r,.5-d,2*r,.5-d,2*f,.5-g,0,.5-g)),$&&x===X&&(Z.push(0,g,0,K*r,d,-v*r,0,d,0,K*r,d,-v*r,0,g,0,K*f,g,-v*f),u.push(1,.5-g,1-2*r,.5-d,1,.5-d,1-2*r,.5-d,1,.5-g,1-2*f,.5-g));W=e}if(N)for(f=W.x,g=W.y,p=I;X>p;p++)x=p+1,c=p*Q,J=x*Q,T=D(c),m=w(c),K=D(J),v=w(J),n.push(K*f,g,-v*f,T*f,g,-m*f,0,g,0),_.push(.5-.5*K,.5+.5*v,.5-.5*T,.5+.5*m,.5,.5)}}),{vs:i,uv:h,bottom_vs:n,bottom_uv:_,top_vs:F,top_uv:O,from_vs:U,from_uv:R,to_vs:Z,to_uv:u}}},!0),Ki(a,{"3d.move.mode":$,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":$,"edge.gradient.color":$,"edge.source.t3":$,"edge.target.t3":$,"light.type":il,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":Z/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Ld,"wf.short":!1,"wf.mat":$,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:$,"transparent.mask":!1,brightness:$,"select.brightness":.7,"repeat.uv.length":$,"shadow.cast":!0,"shadow.receive":!0,bloom:!1,envmap:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":$,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"label.face":Ah,"label.t3":$,"label.r3":$,"label.texture.scale":2,"label.rotationMode":Fl,"label.light":!1,"label.blend":$,"label.reverse.flip":!1,"label.reverse.color":fl,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Ah,"label2.t3":$,"label2.r3":$,"label2.texture.scale":2,"label2.rotationMode":Fl,"label2.light":!1,"label2.blend":$,"label2.reverse.flip":!1,"label2.reverse.color":fl,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Ah,"note.t3":$,"note.r3":$,"note.texture.scale":2,"note.rotationMode":Fl,"note.light":!1,"note.blend":$,"note.reverse.flip":!1,"note.reverse.color":fl,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Ah,"note2.t3":$,"note2.r3":$,"note2.texture.scale":2,"note2.rotationMode":Fl,"note2.light":!1,"note2.blend":$,"note2.reverse.flip":!1,"note2.reverse.color":fl,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:$,"shape3d.color":lr,"shape3d.top.color":$,"shape3d.bottom.color":$,"shape3d.from.color":$,"shape3d.to.color":$,"shape3d.image":$,"shape3d.top.image":$,"shape3d.bottom.image":$,"shape3d.from.image":$,"shape3d.to.image":$,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":$,"shape3d.side.to":$,"shape3d.smooth":$,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":$,"shape3d.opacity":$,"shape3d.reverse.flip":!1,"shape3d.reverse.color":fl,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":$,"shape3d.uv.scale":$,"shape3d.uv.rotation":$,"shape3d.top.uv.offset":$,"shape3d.top.uv.scale":$,"shape3d.top.uv.rotation":$,"shape3d.bottom.uv.offset":$,"shape3d.bottom.uv.scale":$,"shape3d.bottom.uv.rotation":$,"shape3d.from.uv.offset":$,"shape3d.from.uv.scale":$,"shape3d.from.uv.rotation":$,"shape3d.to.uv.offset":$,"shape3d.to.uv.scale":$,"shape3d.to.uv.rotation":$,"shape3d.top.cap":$,"shape3d.bottom.cap":$,"shape3d.start.angle":0,"shape3d.sweep.angle":J,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.ratio":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"texture.mipmap.max":$,"texture.filter":$,"texture.filter.min":$,"texture.filter.mag":$,"texture.wrap":$,"points.image":$,"points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"all.light":!0,"all.visible":!0,"all.color":lr,"all.image":$,"all.blend":$,"all.opacity":$,"all.reverse.flip":!1,"all.reverse.color":fl,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":$,"all.uv.offset":$,"all.uv.scale":$,"all.uv.rotation":$,"all.discard.selectable":!0,mat:$,"left.mat":$,"right.mat":$,"top.mat":$,"bottom.mat":$,"front.mat":$,"back.mat":$,"edge.source.anchor.elevation":$,"edge.target.anchor.elevation":$},!0);var Pp,lf=!1,Uo=[0,0,0,0],cb=function(K){return K instanceof Np},od=function(F){return[F.x,F.e||0,F.y]},sp=function(W,x,X){for(var x=xs(x||0),u=x[0],E=x[1],D=x[2];X--;)W.push(u,E,D)},ag=function(M,y,S){for(var y=xs(y||0),N=y[0],c=y[1],E=y[2],p=y[3];S--;)M.push(N,c,E,p)},fd=function(B,Q,m){if(Q)for(var t,s,r,e=Q[0],O=Q[1],P=Q[2],D=Q[4],g=Q[5],N=Q[6],M=Q[8],y=Q[9],W=Q[10],n=Q[12],h=Q[13],q=Q[14],b=m.length,w=0,w=0;b>w;w+=3)t=m[w],s=m[w+1],r=m[w+2],B.push(e*t+D*s+M*r+n,O*t+g*s+y*r+h,P*t+N*s+W*r+q);else Qf(B,m)},xc=function(e,m){var b=m.s("light.intensity"),A=xs(m.s(jn)),$=A[0],O=A[1],H=A[2];1!==b&&($*=b,O*=b,H*=b),e.push($,O,H,m.s("light.disabled")?1:0)},iq=function(A,n){var J=Oo.for(n),Y=J.directUniforms();Y.uHeadlightRange=A._headlightRange,Y.uHeadlightAmbientIntensity=A._headlightAmbientIntensity;var M=A._headlightIntensity,Z=xs(A._headlightColor);1!==M&&(Z=[Z[0]*M,Z[1]*M,Z[2]*M]),Y.uHeadlightColor=[Z[0],Z[1],Z[2],A._headlightDisabled?1:0];var m=A._59O,O=A._spots,s=A._dirs;if(m.length){var f=[],T=[],p=[];m.forEach(function(i){xc(f,i),Qf(T,A._transformPointToViewSpace(i.p3())),p.push(i.s("light.range"))}),Y.uPointColor=f,Y.uPointRange=p,Y.uPointPosition=T}if(O.length){var I=[],P=[],c=[],u=[],B=[],$=[];O.forEach(function(p){xc(I,p),Qf(P,A._transformPointToViewSpace(p.p3())),Qf(B,A._transformDirectionToViewSpace(p.p3(),p.s("light.center"))),c.push(p.s("light.range")),u.push(D(p.s("light.angle")/2)),$.push(p.s("light.exponent"))}),Y.uSpotColor=I,Y.uSpotRange=c,Y.uSpotAngle=u,Y.uSpotExponent=$,Y.uSpotPosition=P,Y.uSpotDirection=B}if(s.length){var d=[],K=[];s.forEach(function(q){xc(d,q),Qf(K,A._transformDirectionToViewSpace(q.p3()))}),Y.uDirColor=d,Y.uDirDirection=K}},Dl=function(Q,e){return Math.max(Q.getRotateMinPhi()+zr,Math.min(Q.getRotateMaxPhi()-zr,e))},xj=function(){return.05+c()/2},hl=function(b,c,H,I){var i,V=b.getEye();return b.isOrtho()?(i=Fq(b.getCenter(),V),i[0]+=I[0],i[1]+=I[1],i[2]+=I[2]):i=V,be(c,H,I,i)},be=function(i,A,n,K){var Q=Dr(i,A),B=Fq(K,n,!0),q=Dr(B,A);if(r(q)<zr)return V;var f=(Q-Dr(n,A))/q;return[n[0]+B[0]*f,n[1]+B[1]*f,n[2]+B[2]*f]},Eg=function(T,Q){return{x:2*T.x-Q.x,y:2*T.y-Q.y}},dc=function(m,J,M,T){var _,U;if(!m)return _=I(J.y-M.y,M.x-J.x),{x:J.x+T*w(_),y:J.y+T*D(_)};if(!M)return _=I(m.y-J.y,J.x-m.x),{x:J.x+T*w(_),y:J.y+T*D(_)};var y=Fq([m.x,m.y,0],[J.x,J.y,0],!0),t=Fq([M.x,M.y,0],[J.x,J.y,0],!0),R=-(y[0]+t[0])/2,v=-(y[1]+t[1])/2,p=j(R*R+v*v);if(zr>p)return _=I(m.y-J.y,J.x-m.x),{x:J.x+T*w(_),y:J.y+T*D(_)};var x=m.x-J.x,a=m.y-J.y,N=M.x-J.x,H=M.y-J.y,f=j(x*x+a*a),E=j(N*N+H*H);_=q(Dr(y,t))/2,U=y[1]*t[0]-y[0]*t[1]>0?-1:1,R/=p,v/=p;var W=T/w(_),K=g(f,E)/D(_);p=Math.min(W,K);var Z={x:J.x+U*p*R,y:J.y+U*p*v};return M.b&&W>E/D(_)&&(Z.adjust=!0),Z},ue=function(Y){var n=Y[1],D=Y[2],_=Y[3],Q=Y[6],O=Y[7],T=Y[11];Y[1]=Y[4],Y[2]=Y[8],Y[3]=Y[12],Y[4]=n,Y[6]=Y[9],Y[7]=Y[13],Y[8]=D,Y[9]=Q,Y[11]=Y[14],Y[12]=_,Y[13]=O,Y[14]=T},Zi=function($){var N=$[0],T=$[1],x=$[2],C=$[3],Q=$[4],G=$[5],f=$[6],m=$[7],U=$[8],B=$[9],_=$[10],z=$[11],E=$[12],u=$[13],v=$[14],W=$[15],e=N*G-T*Q,h=N*f-x*Q,c=N*m-C*Q,A=T*f-x*G,H=T*m-C*G,a=x*m-C*f,l=U*u-B*E,t=U*v-_*E,M=U*W-z*E,d=B*v-_*u,r=B*W-z*u,w=_*W-z*v,k=e*w-h*r+c*d+A*M-H*t+a*l;return k?(k=1/k,$[0]=(G*w-f*r+m*d)*k,$[1]=(x*r-T*w-C*d)*k,$[2]=(u*a-v*H+W*A)*k,$[3]=(_*H-B*a-z*A)*k,$[4]=(f*M-Q*w-m*t)*k,$[5]=(N*w-x*M+C*t)*k,$[6]=(v*c-E*a-W*h)*k,$[7]=(U*a-_*c+z*h)*k,$[8]=(Q*r-G*M+m*l)*k,$[9]=(T*M-N*r-C*l)*k,$[10]=(E*H-u*c+W*e)*k,$[11]=(B*c-U*H-z*e)*k,$[12]=(G*t-Q*d-f*l)*k,$[13]=(N*d-T*t+x*l)*k,$[14]=(u*h-E*A-v*e)*k,$[15]=(U*A-B*h+_*e)*k,void 0):V},rm=function(c,K){if(K){var C=K[0],$=K[1],n=K[2];c[12]=c[0]*C+c[4]*$+c[8]*n+c[12],c[13]=c[1]*C+c[5]*$+c[9]*n+c[13],c[14]=c[2]*C+c[6]*$+c[10]*n+c[14],c[15]=c[3]*C+c[7]*$+c[11]*n+c[15]}},Ye=function(c,r){if(r){var L=r[0],x=r[1],_=r[2];c[0]=c[0]*L,c[1]=c[1]*L,c[2]=c[2]*L,c[3]=c[3]*L,c[4]=c[4]*x,c[5]=c[5]*x,c[6]=c[6]*x,c[7]=c[7]*x,c[8]=c[8]*_,c[9]=c[9]*_,c[10]=c[10]*_,c[11]=c[11]*_}},te=function(W,i,Y){var I=i[0],E=i[1],S=i[2],m=i[3],v=i[4],s=i[5],L=i[6],b=i[7],U=i[8],R=i[9],X=i[10],A=i[11],q=i[12],l=i[13],Q=i[14],J=i[15],h=Y[0],B=Y[1],g=Y[2],P=Y[3];return W[0]=h*I+B*v+g*U+P*q,W[1]=h*E+B*s+g*R+P*l,W[2]=h*S+B*L+g*X+P*Q,W[3]=h*m+B*b+g*A+P*J,h=Y[4],B=Y[5],g=Y[6],P=Y[7],W[4]=h*I+B*v+g*U+P*q,W[5]=h*E+B*s+g*R+P*l,W[6]=h*S+B*L+g*X+P*Q,W[7]=h*m+B*b+g*A+P*J,h=Y[8],B=Y[9],g=Y[10],P=Y[11],W[8]=h*I+B*v+g*U+P*q,W[9]=h*E+B*s+g*R+P*l,W[10]=h*S+B*L+g*X+P*Q,W[11]=h*m+B*b+g*A+P*J,h=Y[12],B=Y[13],g=Y[14],P=Y[15],W[12]=h*I+B*v+g*U+P*q,W[13]=h*E+B*s+g*R+P*l,W[14]=h*S+B*L+g*X+P*Q,W[15]=h*m+B*b+g*A+P*J,W},vq=function(n,g,i,J){var E,P,A,H,p,b,Z,D,c,e,m=g[0],L=g[1],G=g[2],h=J[0],$=J[1],k=J[2],T=i[0],y=i[1],W=i[2];return r(m-T)<zr&&r(L-y)<zr&&r(G-W)<zr?Md(n):(Z=m-T,D=L-y,c=G-W,e=1/j(Z*Z+D*D+c*c),Z*=e,D*=e,c*=e,E=$*c-k*D,P=k*Z-h*c,A=h*D-$*Z,e=j(E*E+P*P+A*A),e?(e=1/e,E*=e,P*=e,A*=e):(E=0,P=0,A=0),H=D*A-c*P,p=c*E-Z*A,b=Z*P-D*E,e=j(H*H+p*p+b*b),e?(e=1/e,H*=e,p*=e,b*=e):(H=0,p=0,b=0),n[0]=E,n[1]=H,n[2]=Z,n[3]=0,n[4]=P,n[5]=p,n[6]=D,n[7]=0,n[8]=A,n[9]=b,n[10]=c,n[11]=0,n[12]=-(E*m+P*L+A*G),n[13]=-(H*m+p*L+b*G),n[14]=-(Z*m+D*L+c*G),n[15]=1,n)},wr=function(Q,n,T,p,r){var J=1/z(n/2),t=1/(p-r);return Q[0]=J/T,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=J,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=(r+p)*t,Q[11]=-1,Q[12]=0,Q[13]=0,Q[14]=2*r*p*t,Q[15]=0,Q},Ml=function(t,k,p,j,Z,P,L){var v=1/(k-p),A=1/(j-Z),K=1/(P-L);return t[0]=-2*v,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*A,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*K,t[11]=0,t[12]=(k+p)*v,t[13]=(Z+j)*A,t[14]=(L+P)*K,t[15]=1,t},us=function(G,i){var F=i[0],m=i[1],O=i[2],Q=i[3],M=F*F+m*m+O*O+Q*Q,K=M?1/M:0;return G[0]=-F*K,G[1]=-m*K,G[2]=-O*K,G[3]=Q*K,G},qi=function(K,M){var w=M[0]+M[5]+M[10],Y=0;return w>0?(Y=2*Math.sqrt(w+1),K[3]=.25*Y,K[0]=(M[6]-M[9])/Y,K[1]=(M[8]-M[2])/Y,K[2]=(M[1]-M[4])/Y):M[0]>M[5]&M[0]>M[10]?(Y=2*Math.sqrt(1+M[0]-M[5]-M[10]),K[3]=(M[6]-M[9])/Y,K[0]=.25*Y,K[1]=(M[1]+M[4])/Y,K[2]=(M[8]+M[2])/Y):M[5]>M[10]?(Y=2*Math.sqrt(1+M[5]-M[0]-M[10]),K[3]=(M[8]-M[2])/Y,K[0]=(M[1]+M[4])/Y,K[1]=.25*Y,K[2]=(M[6]+M[9])/Y):(Y=2*Math.sqrt(1+M[10]-M[0]-M[5]),K[3]=(M[1]-M[4])/Y,K[0]=(M[8]+M[2])/Y,K[1]=(M[6]+M[9])/Y,K[2]=.25*Y),K},fp=function(D,I,M){var l=I[0],t=I[1],r=I[2],X=I[3],_=l+l,x=t+t,d=r+r,s=l*_,G=l*x,j=l*d,U=t*x,e=t*d,g=r*d,P=X*_,R=X*x,O=X*d;return D[0]=1-(U+g),D[1]=G+O,D[2]=j-R,D[3]=0,D[4]=G-O,D[5]=1-(s+g),D[6]=e+P,D[7]=0,D[8]=j+R,D[9]=e-P,D[10]=1-(s+U),D[11]=0,D[12]=M[0],D[13]=M[1],D[14]=M[2],D[15]=1,D},ud=function(g,B){if(g.vr.enable){var f=g.vr.getViewMatrix(B);if(f)return f}return vq(B?B:no(),g._eye,g._center,g._up)},Te=function(j,X){if(j.vr.enable){var z=j.vr.getProjectMatrix();if(z)return z}if(!X&&j._computedProjectMatrix)return Od(j._computedProjectMatrix);var Y=j.getAspect(),_=j._near,E=j._far,t=no();if(j._ortho){var u=j._orthoWidth/2,g=u/Y;Ml(t,-u,u,-g,g,_,E)}else wr(t,j._fovy,Y,_,E);return t},Ir=function(z,$){if(!z)return V;var T=0,O=1,Y=2,b=[],M=0,G=z.length,t=G/3;if($){for(;G>M;M++)b[M]=0;for(M=0;M<$.length;M+=3){var X=[],h=[],n=[];X[T]=z[3*$[M+1]+T]-z[3*$[M]+T],X[O]=z[3*$[M+1]+O]-z[3*$[M]+O],X[Y]=z[3*$[M+1]+Y]-z[3*$[M]+Y],h[T]=z[3*$[M+2]+T]-z[3*$[M+1]+T],h[O]=z[3*$[M+2]+O]-z[3*$[M+1]+O],h[Y]=z[3*$[M+2]+Y]-z[3*$[M+1]+Y],n[T]=X[O]*h[Y]-X[Y]*h[O],n[O]=X[Y]*h[T]-X[T]*h[Y],n[Y]=X[T]*h[O]-X[O]*h[T];for(var i=0;3>i;i++)b[3*$[M+i]+T]+=n[T],b[3*$[M+i]+O]+=n[O],b[3*$[M+i]+Y]+=n[Y]}}else for(M=0;t>M;M+=3){var X=[],h=[],n=[];X[T]=z[3*(M+1)+T]-z[3*M+T],X[O]=z[3*(M+1)+O]-z[3*M+O],X[Y]=z[3*(M+1)+Y]-z[3*M+Y],h[T]=z[3*(M+2)+T]-z[3*(M+1)+T],h[O]=z[3*(M+2)+O]-z[3*(M+1)+O],h[Y]=z[3*(M+2)+Y]-z[3*(M+1)+Y],n[T]=X[O]*h[Y]-X[Y]*h[O],n[O]=X[Y]*h[T]-X[T]*h[Y],n[Y]=X[T]*h[O]-X[O]*h[T];for(var i=0;3>i;i++)b[3*(M+i)+T]=n[T],b[3*(M+i)+O]=n[O],b[3*(M+i)+Y]=n[Y]}for(M=0;G>M;M+=3){var p=[];p[T]=b[M+T],p[O]=b[M+O],p[Y]=b[M+Y];var A=j(p[T]*p[T]+p[O]*p[O]+p[Y]*p[Y]);0===A&&(A=zr),p[T]=p[T]/A,p[O]=p[O]/A,p[Y]=p[Y]/A,b[M+T]=p[T],b[M+O]=p[O],b[M+Y]=p[Y]}return new Uj(b)},Dh=function(Y,X,e,P){if(e||(e=Y.createTexture()),X){var G=Y.TEXTURE_2D,i=Y.REPEAT,U=Y.CLAMP_TO_EDGE,n=Y.TEXTURE_MIN_FILTER;P=P||al;var f=P.minFilter||P.filter||Y.LINEAR,o=P.magFilter||P.filter||Y.LINEAR;Y.activeTexture(Y.TEXTURE0),Pr(Y,e),Y.texImage2D(G,0,Y.RGBA,Y.RGBA,Y.UNSIGNED_BYTE,X),fr(Y,Y.TEXTURE_MAG_FILTER,o);var B=X.naturalWidth||X.width,g=X.naturalHeight||X.height;Pl.isPOT(B)&&Pl.isPOT(g)&&!P.clampToEdge&&!X.clampToEdge?(fr(Y,Y.TEXTURE_WRAP_S,i),fr(Y,Y.TEXTURE_WRAP_T,i),fr(Y,n,f===Y.NEAREST?Y.NEAREST_MIPMAP_NEAREST:Y.LINEAR_MIPMAP_LINEAR),P.mipmapMaxLevel!==$&&fr(Y,Y.TEXTURE_MAX_LEVEL,P.mipmapMaxLevel),Y.generateMipmap(G)):(fr(Y,Y.TEXTURE_WRAP_S,U),fr(Y,Y.TEXTURE_WRAP_T,U),fr(Y,n,f)),Pr(Y,V)}return e},er=function(v,H){var U=new Uint8Array(4);return H=H||v.createTexture(),v.activeTexture(v.TEXTURE0),Pr(v,H),fr(v,v.TEXTURE_MIN_FILTER,v.LINEAR),v.texImage2D(v.TEXTURE_2D,0,v.RGBA,1,1,0,v.RGBA,v.UNSIGNED_BYTE,U),H},Jo=function(U,k){var b=new Uint8Array(4);return k=k||U.createTexture(),U.activeTexture(U.TEXTURE0),U.bindTexture(U.TEXTURE_CUBE_MAP,k),U.texParameteri(U.TEXTURE_CUBE_MAP,U.TEXTURE_MAG_FILTER,U.LINEAR),U.texParameteri(U.TEXTURE_CUBE_MAP,U.TEXTURE_MIN_FILTER,U.LINEAR),U.texImage2D(U.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,U.RGBA,1,1,0,U.RGBA,U.UNSIGNED_BYTE,b),U.texImage2D(U.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,U.RGBA,1,1,0,U.RGBA,U.UNSIGNED_BYTE,b),U.texImage2D(U.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,U.RGBA,1,1,0,U.RGBA,U.UNSIGNED_BYTE,b),U.texImage2D(U.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,U.RGBA,1,1,0,U.RGBA,U.UNSIGNED_BYTE,b),U.texImage2D(U.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,U.RGBA,1,1,0,U.RGBA,U.UNSIGNED_BYTE,b),U.texImage2D(U.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,U.RGBA,1,1,0,U.RGBA,U.UNSIGNED_BYTE,b),k},Gh=function(g){g._26I&&g._prg&&(g._26I.deleteProgram(g._prg),g._prg=V)},Ur=function(B,T,g,f){var n=B.createShader(g);return B.shaderSource(n,f),B.compileShader(n),B.attachShader(T,n),n},yc=function(O){return O.createBuffer()},Pr=function(U,a){U.bindTexture(U.TEXTURE_2D,a||U._emptyTexture)},fr=function(H,A,O){H.texParameteri(H.TEXTURE_2D,A,O)},tp=function(x,o){var c=Oo.for(x).directState();c.polygonOffset.enabled=!0,c.polygonOffset.value=o},rd=function(w){var p=Oo.for(w).directState();p.polygonOffset.enabled=!1},nb=function(M,h){if(h){var A=Oo.for(M).directState();A.color.clear=xs(h)}},Ol=function(a){var L=Oo.for(a),A=L.directUniforms(),J=L.directAttribs();A.uFix=!0,J.aNormal=!1},Yq=function(G){var s=Oo.for(G),d=s.directUniforms();s.directAttribs(),d.uFix=!1},Rl=function(y,F,m,W,j,T,h,O){var x=Oo.for(y),B=x.directState(),D=x.directUniforms();y._picking||(m?(D.uBlend=!0,D.uBlendColor=m):D.uBlend=!1,D.uLight=W==V?!0:W,Ob(j)&&1!==j&&(D.uPartOpacity=j),D.uReverseFlip=T==V?!1:T,D.uFixPickReverseColor=h||fl),B.cullFace.enabled=O?!0:!1},nn=function(x){if(!x._picking){var I=Oo.for(x),N=I.directUniforms();N.uPartOpacity=1}},wo=function(){var z=new C.Math.Matrix2d,K=[1,0,0,0,1,0,0,0,0];return function(m,J,j,I,$,q,l,W,n,M){var P=Oo.for(m),R=P.directUniforms(),f=P.directAttribs();return j?(R.uTexture=!0,R.uDiscardSelectable=hm(I)?I:!0,f.aUv=Nf(m,$,q,V,2),M?(R.uBlendTexture=!0,R.uBlendSampler=M):(R.uBlendTexture=!1,R.uBlendSampler=m._emptyBlendTexture),R.uSampler=j,R.uUvMatrix=l||W||n?nl(n,l,W,z).toArray9():K,void 0):(R.uSampler=m._emptyTexture,R.uBlendSampler=m._emptyBlendTexture,void 0)}}(),Rj=function(r,I,e){var J=Oo.for(r),T=J.directUniforms(),F=J.directAttribs();r.activeTexture(r.TEXTURE0),Pr(r,V),r.activeTexture(r.TEXTURE1),Pr(r,V),e&&(F.aUv=!1,T.uTexture=!1,T.uSampler=r._emptyTexture,T.uBlendTexture=!1,T.uBlendSampler=r._emptyBlendTexture)},dn=function(O,f,G,v,J,i){var g=Oo.for(O),Z=g.directUniforms(),F=g.directAttribs();!G||bh||pe||O.lineWidth(G),v&&!O._picking&&(Z.uFixPickReverseColor=v),J&&(F.aPosition=Nf(O,J,i,V))},Tg=function(J,T,B,M){Pp&&(M=J[Pp]),J.drawArrays(M==V?J.TRIANGLES:M,T,B);var n=J._renderInfo;n&&(n.calls++,n.vertices+=B,(M==V||M===J.TRIANGLES)&&(n.faces+=B/3),M===J.LINES&&(n.lines+=B/2),M===J.POINTS&&(n.points+=B))},Mo=function(u,T,P,d,L){Pp&&(d=u[Pp]),u.drawElements(d==V?u.TRIANGLES:d,P,L==V?u.UNSIGNED_SHORT:L,T==V?0:2*T);var c=u._renderInfo;c&&(c.calls++,c.vertices+=P,(d==V||d===u.TRIANGLES)&&(c.faces+=P/3),d===u.LINES&&(c.lines+=P/2),d===u.POINTS&&(c.points+=P))},$j=function(X,g,v){var m=X.ARRAY_BUFFER;return X.bindBuffer(m,g),v&&X.bufferData(m,v,X.STATIC_DRAW),g},Nf=function(q,J,l,d,x){return l?Um(q,q.ARRAY_BUFFER,J,l):$j(q,J,l,d,x)
},pg=function(R,O,j){var N=R.ELEMENT_ARRAY_BUFFER;R.bindBuffer(N,O),j&&R.bufferData(N,j,R.STATIC_DRAW)},jj=function(m,X,I){Um(m,m.ELEMENT_ARRAY_BUFFER,X,I)},Um=function(m,r,a,z){var A=z._bufId;A||(A=z._bufId=C.Math.generateIncreasingID());var a,$=m._bufPool;return(a=$[A])&&a._buf?m.bindBuffer(r,a._buf):(a=$[A]={_buf:yc(m)},m.bindBuffer(r,a._buf),m.bufferData(r,z,m.STATIC_DRAW)),a._fid=m._renderInfo.frame,a._buf},Nb=function(J,Y){Y!=V&&Y>=0&&J.enableVertexAttribArray(Y)},Pi=function(x,X){X!=V&&X>=0&&x.disableVertexAttribArray(X)},ug=function(m,C){var y=m.getGL(),R=Oo.for(y),u=R.directUniforms();m._7O=m._8O.pop(),C&&(u.uMVMatrix=m._7O,m._6O=C,u.uNMatrix=C)},yh=function(h,U){return U||(U=no()),Xd(U,h),Zi(U),ue(U),U},Ae=function(x,Z){var H=x.getGL(),T=x._7O,Q=Oo.for(H),I=Q.directUniforms();Z?(x._8O.push(Od(T)),I.uMMatrix=Z,te(T,T,Z),x._7O=T):I.uMMatrix=gk,I.uMVMatrix=T,I.uNMatrix=yh(T,x._6O)},dr={body:0,label:1,label2:2,note:3,note2:4,symbol:5},zq=10,sh=function(Q,K,F,C,X,B){var b;if(F){var y=C._pickId;y||(y=C._pickId=K._pickIdUsed,K._pickIdUsed+=zq);var J,A=dr[X];if(null!=A)J=y+A;else{var U=C._pickExtraPartMap;U||(U=C._pickExtraPartMap={}),(J=U[X])||(J=U[X]=K._pickIdUsed++)}K[J]||(K[J]={data:C,part:X}),b=ve(J)}else b=Uo;if(!B){var n=Oo.for(Q),f=n.directUniforms();f.uFixPickReverseColor=b}return b},Jf=function(x,N,u){"target"!==u&&(u="source");var c="target"===u?N.getTargetAgent():N.getSourceAgent(),J="edge."+u+".";if(Zb(c)){var f=N.s(J+"anchor.x"),p=N.s(J+"anchor.elevation"),C=N.s(J+"anchor.y"),n=Uf(c,x.getMat(c)),r=c.getAnchor3d();return rq([(f===$?.5:f)-r.x,(p===$?.5:p)-r.y,(C===$?.5:C)-r.z],n)}var j=N.s(J+"index"),X=x.getData3dUI(c);if(!X.info||!X.info.list)return!1;if(j>=0){var L,P,O,l,s,_=X.info._lastPointsSegments,K=_.points,M=_.segments,I=-1,h=-1;for(O=0,l=M?M.length:K.length;l>O;O++){if(P=M?M.get(O):1,3===P)s=2;else if(4===P)s=3;else{if(5===P)continue;s=1}if(I+=s,h++,h===j){L=K.get(I);break}}return L||(L=K.get(K.length-1)),[L.x,L.e||0,L.y]}var T=N.s(J+"percent")||.5;if(T=Math.max(0,Math.min(T,1)),!X||!X.getCache)return!1;var v=X.getCache(),l=v[v.length-1].length,_=x.getLineOffset(c,T*l),E=_.point;return[E.x,E.y,E.z]},ll=function(){var X={center:function(x,$,r,f,o){var J=-$[1]/2,A={x:-$[0]/2,y:J,width:$[0],height:$[1]},K=Dn(x,A,r);return[K.x+f,-K.y-o,xj()]},front:function(m,f,u,C,k){var J=-f[1]/2,G={x:-f[0]/2,y:J,width:f[0],height:f[1]},P=Dn(m,G,u);return[P.x+C,-P.y-k,f[2]/2+xj()]},back:function($,y,B,e,L){var V=-y[0]/2,Q=-y[1]/2,t={x:V,y:Q,width:y[0],height:y[1]},k=Dn($,t,B);return[-k.x-e,-k.y-L,-y[2]/2-xj()]},left:function(Q,F,l,Z,q){var J=-F[1]/2,K={x:-F[2]/2,y:J,width:F[2],height:F[1]},t=Dn(Q,K,l);return[-F[0]/2-xj(),-t.y-q,t.x+Z]},right:function(m,h,D,f,o){var I=-h[2]/2,t=-h[1]/2,w={x:I,y:t,width:h[2],height:h[1]},W=Dn(m,w,D);return[h[0]/2+xj(),-W.y-o,-W.x-f]},top:function(M,S,L,w,$){var z={x:-S[0]/2,y:-S[2]/2,width:S[0],height:S[2]},B=Dn(M,z,L);return[B.x+w,S[1]/2+xj(),B.y+$]},bottom:function(u,$,Z,r,y){var E=-$[2]/2,j={x:-$[0]/2,y:E,width:$[0],height:$[2]},g=Dn(u,j,Z);return[g.x+r,-$[1]/2-xj(),-g.y-y]}};return function(O,q,m,c,s,w){return X[c](O,q,m,s||0,w||0)}}(),bn=function(y,v,S,s,t,k,P,N,D,x){if(t&&(v[0]+=t[0],v[1]+=t[1],v[2]+=t[2]),rm(y,S),N){var e=no();if(si(e,D,x),rq(v,e),rm(y,v),y.auto=N,y.pos=rq([0,0,0],y),k){var W=y.mat2=no();si(W,k,P)}}else si(y,D,x),rm(y,v),s===ar?Ok(y,-d):s===ci?Ok(y,d):s===hp?Hi(y,-d):s===Tl?Hi(y,d):s===vi&&Ok(y,Z),si(y,k,P);return y},Qg=function(p,m){var C=m.auto,j=m.mat2,c=p.gv;if(C){var Q,e=no(),x=[0,0,0,0];Q="string"==typeof C?[C.indexOf("x")<0?c._eye[0]:c._center[0],C.indexOf("y")<0?c._eye[1]:c._center[1],C.indexOf("z")<0?c._eye[2]:c._center[2]]:c._eye,qi(x,vq(no(),Q,c._center,c._up)),fp(e,us(x,x),m.pos),j&&te(e,e,j),Ae(c,e)}else Ae(c,m)},Lh=function(j,i,Q,K,o){var u=j.s,q=j.gv,d=q.getGL(),Z=q._prg,O=q._buffer,m=q._1O,y=Oo.for(d),w=y.directAttribs();Dh(d,Zf,m),Qg(j,Q),Rl(d,Z,u(i+".blend"),u(i+".light"),u(i+".opacity"),u(i+".reverse.flip"),u(i+".reverse.color"),u(i+".reverse.cull")),wo(d,Z,m,o,O.uv,Rp),w.aPosition=Nf(d,O.vs,K,V),w.aNormal=Nf(d,O.ns,Mf,V),jj(d,O.is,ql),Mo(d,0,ql.length),Rj(d,Z,m),nn(d,Z),ug(q)},$l=function(A,x,I){var K=A.gv,u=A.data,l=A[x]={blend:K.getBodyColor(u)||K.getFaceBlend(u,x),light:K.getFaceLight(u,x),color:K.getFaceColor(u,x),opacity:K.getFaceOpacity(u,x),transparent:K.getFaceTransparent(u,x),reverseFlip:K.getFaceReverseFlip(u,x),reverseColor:K.getFaceReverseColor(u,x),reverseCull:K.getFaceReverseCull(u,x),texture:K.getFaceImage(u,x),blendTexture:K.getFaceBlendImage(u,x),discardSelectable:K.getFaceDiscardSelectable(u,x)};if("csg"!==x){l.uv=K.getFaceUv(u,x)||I&&I[x+"Uv"],l.uvScale=K.getFaceUvScale(u,x)||I&&I[x+"UvScale"],l.uvOffset=K.getFaceUvOffset(u,x)||I&&I[x+"UvOffset"],l.uvRotation=K.getFaceUvRotation(u,x)||I&&I[x+"uvRotation"];var r=K.getFaceMat(u,x);if(r){var k=Uf(u,r);u.appendAnchorMatrix3d(k),l.mat=k}}return l},Jp=function(Z,i,D,z,g){var p=Z[z];if(p){if(!g(p.transparent))return;var T=Z.data,k=Z.gv,P=k._buffer,j=k.getTexture(p.texture,T,z),Y=k.getTexture(p.blendTexture,T),o=Oo.for(i),B=o.directUniforms(),U=o.directAttribs();wo(i,D,j,p.discardSelectable,P.uv,p.tuv,p.uvOffset,p.uvScale,p.uvRotation,Y),Rl(i,D,p.blend,p.light,p.opacity,p.reverseFlip,p.reverseColor,p.reverseCull),p.cs&&!k._batchColorDisabled?(B.uBatchColor=!0,U.aBatchColor=Nf(i,P.batchColor,p.cs,D.aBatchColor,4)):B.uDiffuse=p.color||a["color.empty"],U.aPosition=Nf(i,P.vs,p.vs,V),U.aNormal=Nf(i,P.ns,p.ns,V),Tg(i,0,p.vs.length/3),p.cs&&!k._batchColorDisabled&&(B.uBatchColor=!1,Pi(i,D.aBatchColor)),nn(i,D),Rj(i,D,j)}},qm=function(K,k,_){Xj(K)?K.forEach(function(M){qm(M,k,_)}):Zq(K)?qm(rh(k,K),k,_):on(K)?K.shape3d?qm(K.shape3d,k,_):_.push(K):_.push(K)},ck=function(){for(var G=50,B=arguments.length,y=[],t=0;B>t;t++)y[t]=arguments[t];Hn[hj]="Time : "+(new Date).toLocaleString()+", Info :"+y.join(", "),hj=(hj+1)%G,console.error("Failed to create shader.")},nl=function(){var f=new Pl.Matrix2d;return function(Q,X,Z,L){L||(L=f);var j,S,x,l;return X?(j=X[0],S=X[1]):j=S=0,Z?(x=Z[0],l=Z[1]):x=l=1,L.setFromTransform(Q||0,j,S,x,l)}}(),ie=function(I,G,W,f,c,o){var Q,v,e,p,n,D,l,R,Z,M,h,z=[f-G,c-W],L=I?I.length:0;for(e=0;L>e;e++){for(p=2,Q=I[e],n=Q[0],D=Q[1];p+1<Q.length;){if(l=Q[p],R=Q[p+1],v=ji(G,W,f,c,n,D,l,R,!0)){Z=[l-n,R-D],M=Lf(Z),Z[0]/=M,Z[1]/=M,M=Dr(z,Z),M=M>0?o:-o,h=[Z[0]*M,Z[1]*M];break}n=l,D=R,p+=2}if(h)break}if(h)for(f=G+h[0],c=W+h[1],e=0;L>e;e++)for(p=2,Q=I[e],n=Q[0],D=Q[1];p+1<Q.length;){if(l=Q[p],R=Q[p+1],v=ji(G,W,f,c,n,D,l,R,!0))return[0,0];n=l,D=R,p+=2}return h?h:[f-G,c-W]},Ln=function(I){return"nearest"===I?ah.NEAREST:"linear"===I?ah.LINEAR:I},hg=C.graph3d={},Iq=function(c,g,q){ym(M+".graph3d."+c,g,q)},Tm="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!<*1/2!-opjujtpQb)5dfw!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<esppDxpebit!5dfw!hojzsbw<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<yjsubNwVv!4ubn!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",el="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!!<osvufs!<esbdtje!!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit!)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw<uvpldbmc!mppc!nspgjov~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!~!!!!!!!!gjeof$!!!!!!!!!!!!<*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!osvufs!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!qe!-*!z/f{jTmfyfu!-yyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zyy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-yzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzz/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!qe!-*!z/f{jTmfyfu!-zzy/uftggp!,!E4ec!)WVpUfcvd!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!osvufs!!!!!!!!!!!!!!!!<z/f{jTmfyfu!+!tvjebSxpebit!+!*!2!-2!.!)3dfw!>!uftggp!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!}}!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!<*!opjujtpQpUuihjm!)f{jmbnspo!>!E4ec!4dfw!!!!!!!!!!!!<tbjCxpebit!>,!qe!!!!!!!!<*!sbfObsfnbDxpebit!.!sbGbsfnbDxpebit!)!0!*!sbfObsfnbDxpebit!.!*!opjujtpQpUuihjm!)iuhofm!)!>!qe!ubpmg!!!!!!!!!!!!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!!!!!!!!!!!!<*!*!1/3!-1/5!)3dfw!+!f{jTqbNxpebit!)!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!|!*!sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTuojpQufh!ubpmg!!!!!!!!~!!!!!!!!<*!68/1!-684/1!)3dfw!,!sbobmq!+!*!63/1!-632/1!)3dfw!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!!!!!!!!!!!!!!!!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!z/w!)ohjt!>!Zohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!z/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!!!!!!!!!!!!!!!!<*!y/w!)ohjt!>!Yohjt!ubpmg!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!y/Wtcb!)!gj!ftmf!~!!!!!!!!!!!!<y/w!.!1/5!>!y/sbobmq!!!!!!!!!!!!!!!!!!!!*!1/1!?!{/w!)!gj!!!!!!!!!!!!!!!!|!*!foPutpnmb!>?!{/Wtcb!)!gj!!!!!!!!!!!!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!!!!!!!!!!!!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!!!!!!!!!!!!<zy/w!>!sbobmq!3dfw!!!!!!!!!!!!<*!Zf{jTmfyfu!+!1/3!.!1/2!)!+!fcvDpUfmbdt!>+!w!!!!!!!!!!!!<fcvDpUfmbdt!>+!Wtcb!!!!!!!!!!!!<*!*!{/Wtcb!-z/Wtcb!)ybn!-y/Wtcb!)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!!!!!!!!!!!!<*!w!)tcb!>!Wtcb!4dfw!!!!!!!!!!!!|!*!Zf{jTmfyfu!ubpmg!-w!4dfw!)WVpUfcvd!3dfw!!!!!!!!~!!!!!!!!<xpebit!osvufs!!!!!!!!!!!!~!!!!!!!!!!!!gjeof$!!!!!!!!!!!!<*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!>!xpebit!!!!!!!!!!!!!!!!ftmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit!)qsfMxpebiTE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!UGPT`GDQ`FQZU`QBNXPEBIT!)efojgfe!gjmf$!!!!!!!!!!!!<*!1/:!0!1/2!)!+!*!!!!!!!!!!!!!!!!*!{/esppDxpebit!-*!2ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!2ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1/1!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-2ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1/1!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!,!*!{/esppDxpebit!-*!1ze!-1ye!)3dfw!,!zy/esppDxpebit!-qbNxpebit!)fsbqnpDE3fsvuyfu!!!!!!!!!!!!!!!!!!!!)!>!xpebit!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!!!!!!!!!!!!!!!!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!!!!!!!!!!!!!!!!<f{jTqbNxpebit!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!!!!!*!GDQ`FQZU`QBNXPEBIT!)efojgfe!gj$!!!!!!!!!!!!|!*!utfUnvutvsg!)!gj!!!!!!!!!!!!<*!dfWutfUnvutvsg!)mmb!>!utfUnvutvsg!mppc!!!!!!!!!!!!<*!1/2!>=!{/esppDxpebit!-nvutvsGoj!)3dfwc!>!dfWutfUnvutvsg!3dfwc!!!!!!!!!!!!<*!dfWnvutvsGoj!)mmb!>!nvutvsGoj!mppc!!!!!!!!!!!!<*!1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit!)!5dfwc!>!dfWnvutvsGoj!5dfwc!!!!!!!!!!!!<tbjCxpebit!>,!{/esppDxpebit!!!!!!!!!!!!<x/esppDxpebit!>0!{zy/esppDxpebit!!!!!!!!!!!!<1/2!>!xpebit!ubpmg!!!!!!!!!!!!|!*!esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt!)xpebiTufh!ubpmg!!!!!!!!~!!!!!!!!<d!osvufs!!!!!!!!!!!!<*!y/g!-c!-b!)yjn!>!d!ubpmg!!!!!!!!!!!!<*!z/g!-us!-cs!)yjn!>!c!ubpmg!!!!!!!!!!!!<*!z/g!-um!-cm!)yjn!>!b!ubpmg!!!!!!!!!!!!<*!6/1!,!f{jt!+!wv!)udbsg!>!g!3dfw!!!!!!!!!!!!<*!fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!us!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cs!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!um!ubpmg!!!!!!!!!!!!<*!fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe!)fsbqnpDE3fsvuyfu!>!cm!ubpmg!!!!!!!!!!!!<f{jt!0!*!6/1!,!f{jt!+!wv!)sppmg!>!WVejpsuofd!3dfw!!!!!!!!!!!!<f{jt!0!*!1/2!)3dfw!>!f{jTmfyfu!3dfw!!!!!!!!!!!!<*!1/2!-1/1!)3dfw!>!uftggp!3dfw!utopd!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt!)qsfMxpebiTE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!*!*!wv!-tiuqfe!)E3fsvuyfu!)iuqfEpUBCHSldbqov!-fsbqnpd!)qfut!osvufs!!!!!!!!!!!!|!*!fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt!)fsbqnpDE3fsvuyfu!ubpmg!!!!!!!!~!!!!!!!!<*!tspudbGldbqoV!-w!)upe!osvufs|!*!w!5dfw!oj!utopd!)iuqfEpUBCHSldbqov!ubpmg!!!!!!!!<*!/2!-tspudbGldbQ!)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!!!!!!!!<*!/763!!-/763!+!/763!-/763!+!/763!+!/763!)4dfw!>!tspudbGldbQ!4dfw!utopd!!!!!!!!<*2!hojevmdyf)!opjudbsg!?.!2//1!00!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!!!!!!!!<*2!hojevmdoj)!2//1!?.!opjudbsg!00!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!!!!!!!!<esppDxpebit!5dfw!hojzsbw<fwjfdfSxpebit!mppc!nspgjov<tvjebSxpebit!ubpmg!nspgjov<tbjCxpebit!ubpmg!nspgjov<zujtofuoJxpebit!ubpmg!nspgjov<f{jTxpebit!3dfw!nspgjov<qbNxpebit!E3sfmqnbt!nspgjov<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Ki(B,{setBatchInfo:function(D,C){un[D]=C},getBatchInfo:function(R){return un[R]},getBatchInfoMap:function(){return un},setBatchInfoMap:function(w){un=w}},!0);var yo=[1,1,1],Sm=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Sf=[1,0,0,0,0,1,0,1,1,1,1,0],Ke=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],qq=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],cj=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Jg=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],vg=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],sq=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Hh=function(z,a){var Z=z._40Q;Z.each(function(o){o.ivBatch(a)})},qr=function(m,c,Q){var D=Q._id,q=c[D];if(q){var W=q.batch,t=m[W],V=t.ds,w=q.index;if(t.invalidate=!0,delete c[D],V.splice(w,1),Zj(V))return delete m[W],void 0;for(var x=q.begin,j=q.size,X=3*x,s=3*j,g=4*x,v=4*j,Y=t.vs,$=t.ps,R=t.uv,d=t.cs,y=t.bs,z=t.rs,A=t.ns,r=t.ls;w<V.length;w++)q=c[V[w]._id],q.index--,q.begin-=j;Y.splice(X,s),$.splice(g,v),R&&R.splice(2*x,2*j),d&&d.splice(g,v),y&&y.splice(X,s),z&&z.splice(x,j),A&&A.splice(X,s),r&&r.splice(x,j)}},zm=function(O,I,q,d,w){if(!d)return V;var t=I[d];if(!t){var c=w.getBatchInfo(d)||al,N=c.image?[]:V;t=I[d]={vs:[],ns:[],uv:N,cs:N?V:c.color?V:[],bs:c.blend?[]:V,ps:[],rs:c.brightness?[]:V,ds:[]}}return t.invalidate=!0,O[q._id]={index:t.ds.length,begin:t.vs.length/3,batch:d},t.ds.push(q),t},Tq=function(R,O){return O!=V&&1!==O?[R[0]*O,R[1]*O,R[2]*O,R[3]]:R},Mh=function(H){var b=H.shapeModel;b||(b=rh(H)),b&&(b._ctlineModel=[],b._lineModel=$)},_e=function(){var k;return function(H,T,y){var z=H.getData3dUI(T),w=z.shapeModel;if(w||(w=rh(z)),w||!z.shapeName){var j,_=T.s("wf.combineTriangle");if(y.geometry){if(!w&&(T instanceof C.Node&&!(T instanceof C.Shape)?(k||(k={vs:bp,is:rb,uv:th}),w=k):w=[z.left,z.front,z.right,z.back,z.top,z.bottom],!w))return $;if(_){var x=T.s("wf.normEpsilon");isNaN(x)&&(x=2),_=0|Math.min(3,Math.max(1,isNaN(_)?1:_)),j=hh[_-1](w,z,180/(Math.PI*x))}else j=Jm(w,z);if(!j||0===j.length)return}else j=y.short?De:Pc;var v=H.getBrightness(T),W=T.s("bloom"),Z=T.s("3d.reflectable"),P=xs(y.color||"white"),G=P[3]<1,A=Math.ceil(y.width)||1,Q=(G?"T":"O")+(W?"_1":"_0")+(Z?"1_":"0_")+A,D=T.getRenderLayer(),f=H._40Q.get(D),g=f.wireframeIndexMap,l=f.wireframeModelMap,Y=l[Q];Y||(Y=l[Q]={vs:[],cs:[],ps:[],ds:[],T:G,B:W,reflectable:!!Z,W:A}),Y.invalidate=!0;var E=Y.vs,t=Y.cs,L=Y.ds,d=g[T._id]={index:L.length,begin:E.length/3,batch:Q};L.push(T);var r=z.mat;T instanceof C.Edge||!(!r||!y.geometry&&T instanceof C.Shape)||(r=Uf(T,y.mat),T.appendAnchorMatrix3d(r)),fd(E,r,j);var m=d.size=E.length/3-d.begin;ag(t,Tq(P,v),m)}}}(),Sc=function(z,d,h,v,u,y,O,s,P){var Z=z.getBrightness(d);Z==V&&(Z=1);var M=Tq(xs(v),Z),U=M[3]<1;y=Math.ceil(y)||1;var j=(U?"T":"O")+y;if(O){var t=O[0],J=(O[1]||t)+t;j+="-"+t+"-"+J,P&&(j+="-"+Fh(P)+"-"+Z,P=Tq(xs(P),Z))}var W=d.getRenderLayer(),S=z._40Q.get(W),o=S.polylineIndexMap,p=S.polylineModelMap,F=p[j];F||(F=p[j]={vs:[],cs:[],ps:[],ds:[],ls:O?[]:V,T:U,W:y},O&&(F.D=t,F.G=J,F.A=P)),F.invalidate=!0;var Y,L=F.vs,G=F.cs,D=F.ds,w=F.ls,B=o[d._id]={index:D.length,begin:L.length/3,batch:j};D.push(d),Qf(L,h);var f,l=B.size=L.length/3-B.begin,K=h.length,e=0,C=[];if(O||u)for(Y=0;K>Y;Y+=6)f=Lf([h[Y],h[Y+1],h[Y+2]],[h[Y+3],h[Y+4],h[Y+5]]),C.push(f),e+=f;if(e&&u){var _,m=Tq(xs(u),Z),c=[m[0]-M[0],m[1]-M[1],m[2]-M[2],m[3]-M[3]],g=0;for(Y=0;K>Y;Y+=6)_=g/e,ag(G,[M[0]+c[0]*_,M[1]+c[1]*_,M[2]+c[2]*_,M[3]+c[3]*_],1),g+=C[Y/6],_=g/e,ag(G,[M[0]+c[0]*_,M[1]+c[1]*_,M[2]+c[2]*_,M[3]+c[3]*_],1)}else ag(G,M,l);if(O)for(g=s||0,Y=0;K>Y;Y+=6)w.push(g),g+=C[Y/6],w.push(g)},Wh=function(m,g,G){if(g){var P=4*g.begin,b=G[g.batch].ps;if(b[P]!==m[0]||b[P+1]!==m[1]||b[P+2]!==m[2]||b[P+3]!==m[3]){for(var v=0;v<g.size;v++)b[P++]=m[0],b[P++]=m[1],b[P++]=m[2],b[P++]=m[3];b._invalidateThisFrame=!0}}},de=function(){var V=new C.Math.Vector3,q=new C.Math.Vector3;return function(l,v){var o=v+["32"],D=l[v],e=l[o];if(D){if(B.extractBatchTranslation&&"vs"===v){q.set(0,0,0);for(var y=D.length,p=0;y>p;p+=3)q.add(V.fromArray(D,p));q.divideScalar(y/3);for(var K=q.x,f=q.y,h=q.z,d=new Array(y),p=0;y>p;p+=3)d[p]=D[p]-K,d[p+1]=D[p+1]-f,d[p+2]=D[p+2]-h;D=d,l.translate=[K,f,h]}e&&e.length===D.length?(e.set(D),e._bufId=null):l[o]=new Uj(D)}else delete l[o]}}(),Af=function(s,B,A,k,E,p,l,q,j){if(Xj(A))A.forEach(function(O){Af(s,B,O,k,E,p,l,q,j)});else if(Zq(A))Af(s,B,rh(k,A),k,E,p,l,q,j);else if(on(A)){var N,h=Th(A.mat,B,s),H=Th(A.s3,B,s),x=Th(A.t3,B,s),O=Th(A.r3,B,s);if((H||O||x||h)&&(N=Gl(h,H,O,Th(A.rotationMode,B,s),x),p.push(N)),A.shape3d)Af(s,B,A.shape3d,k,E,p,l,q,A);else{var P=k.s;j=j||al;var a=p[0],U=p.length,$=P("shape3d.color",A.color,j.color);if(E||(E=P("shape3d.blend",A.blend,j.blend)),U>1){a=Od(a);for(var R=1;U>R;R++)te(a,a,p[R])}A.vs&&P(Jj,A.visible,j.visible)&&wl(a,l,q,A.vs,A.uv,A.is,E,$),A.top_vs&&P(Zk,A.topVisible,j.topVisible)&&wl(a,l,q,A.top_vs,A.top_uv,A.top_is,E,P("shape3d.top.color",A.topColor,j.topColor)||$),A.bottom_vs&&P(Zc,A.bottomVisible,j.bottomVisible)&&wl(a,l,q,A.bottom_vs,A.bottom_uv,A.bottom_is,E,P("shape3d.bottom.color",A.bottomColor,j.bottomColor)||$),A.from_vs&&P(Db,A.fromVisible,j.fromVisible)&&wl(a,l,q,A.from_vs,A.from_uv,A.from_is,E,P("shape3d.from.color",A.fromColor,j.fromColor)||$),A.to_vs&&P(Sl,A.toVisible,j.toVisible)&&wl(a,l,q,A.to_vs,A.to_uv,A.to_is,E,P("shape3d.to.color",A.toColor,j.toColor)||$)}N&&p.pop()}},wl=function(j,X,Y,G,E,B,Z,z){var e,T=X.cs,H=X.uv,s=X.bs;if(B){e=B.length;for(var $=0;e>$;$++){var m=B[$];fd(Y,j,[G[3*m],G[3*m+1],G[3*m+2]]),H&&Qf(H,[E[2*m],E[2*m+1]])}}else e=G.length/3,fd(Y,j,G),H&&Qf(H,E);T&&ag(T,z,e),s&&(Z?sp(s,Z,e):Qf(s,yo,e))},gj=function(l,N,O,b){var m=[];b?Af(l.gv,l.data,b,l,l.getBodyColor(),[N],O,m):(Lc(l,ar,N,O,m),Lc(l,ci,N,O,m),Lc(l,Ah,N,O,m),Lc(l,vi,N,O,m),Lc(l,hp,N,O,m),Lc(l,Tl,N,O,m),Lc(l,"csg",N,O,m)),m.length&&(Qf(O.vs,m),Qf(O.ns,Ir(m)))},Lc=function(L,o,F,$,S){var _=L[o];if(_){var q=_.tuv;if(q){var Y=_.uvScale,B=_.uvOffset,T=_.uvRotation;if(Y||B||T){var e,R,l,i=nl(T,B,Y),H=i.a,z=i.b,U=i.c,j=i.d,a=i.tx,u=i.ty,x=q.length;for(l=0;x>l;l+=2)e=q[l],R=q[l+1],q[l]=H*e+U*R+a,q[l+1]=z*e+j*R+u}}wl(F,$,S,_.vs,q,V,_.blend,_.color)}},tq=function(d,$,c,G,f,b,W,g){var B,I=c.cs,v=c.uv,j=c.bs;if(d.getFaceVisible($,b)){var z=d.getFaceMat($,b);if(z&&(f=Uf($,z)),fd(W,f,g),I&&ag(I,d.getFaceColor($,b),6),v){var V=d.getFaceUv($,b)||G[b+"Uv"],M=d.getFaceUvScale($,b)||G[b+"UvScale"],T=d.getFaceUvOffset($,b)||G[b+"UvOffset"],C=d.getFaceUvRotation($,b)||G[b+"UvRotation"];V=V?[V[6],V[7],V[0],V[1],V[2],V[3],V[2],V[3],V[4],V[5],V[6],V[7]]:Sf;var l=V[0],X=V[1],D=V[2],H=V[3],s=V[4],a=V[5],u=V[6],L=V[7],N=V[8],k=V[9],U=V[10],E=V[11];if(M||T||C){var w=nl(C,T,M),O=w.a,n=w.b,i=w.c,A=w.d,P=w.tx,Z=w.ty;l=O*l+i*X+P,X=n*l+A*X+Z,D=O*D+i*H+P,H=n*D+A*H+Z,s=O*s+i*a+P,a=n*s+A*a+Z,u=O*u+i*L+P,L=n*u+A*L+Z,N=O*N+i*k+P,k=n*N+A*k+Z,U=O*U+i*E+P,E=n*U+A*E+Z}v.push(l,X,D,H,s,a,u,L,N,k,U,E)}j&&(B=d.getBodyColor($)||d.getFaceBlend($,b),B?sp(j,B,6):Qf(j,yo,6))}},_r=function(v,G,f,Z){var f=v._picking?v.pickColorMap:null,J=v.getGL(),K=v._prg,r=v._buffer;if(!bs(G)){Ae(v,Sm),Ol(J,K);for(var M in G){var u=G[M];if(!(Z&&!u.T||!Z&&u.T||v.isReflecting(J)&&u.reflectable===!1)){u.invalidate?(u.invalidate=!1,de(u,"vs"),de(u,"cs"),de(u,"ls"),de(u,"ps")):f&&u.ps&&u.ps._invalidateThisFrame&&(u.ps._invalidateThisFrame=!1,de(u,"ps"));var n=u.translate;n&&Ae(v,[1,0,0,0,0,1,0,0,0,0,1,0,n[0],n[1],n[2],1]);var z=u.vs32,q=f?u.ps32:u.cs32;dn(J,K,u.W,V,r.vs,z);var k=Oo.for(J),$=k.directUniforms(),D=k.directAttribs(),p=u.D,E=!v._dashDisabled&&p;$.uAlphaTest=a.alphaTest,J._blooming&&!u.B&&($.blackout=!0),E&&($.uDash=!0,$.uDashDistance=p,$.uDashGapDistance=u.G,$.uDiffuse=u.A||a["color.empty"],D.aLineDistance=Nf(J,r.lineDistance,u.ls32,V,1));var X=!v._batchColorDisabled;X&&q.length?($.uBatchColor=!0,D.aBatchColor=Nf(J,r.batchColor,q,V,4)):($.uBatchColor=!1,D.aBatchColor=!1),wo(J),Tg(J,0,z.length/3,J.LINES),Rj(J),X&&($.uBatchColor=!1,D.aBatchColor=!1),E&&($.uDash=!1,D.aLineDistance=!1),J._blooming&&!u.B&&($.blackout=!1),n&&ug(v)}}Yq(J,K),ug(v)}},ek=function(I){I.invalidate=!1,de(I,"vs"),de(I,"ns"),de(I,"cs"),de(I,"rs"),de(I,"ps"),de(I,"bs"),de(I,"uv")},hn=function(o,H,e,s,_){var n,k,G,v,u,D,W,O,K,c,Q,S,e=o._picking?o.pickColorMap:null,l=o.getGL(),C=o._prg,Y=Oo.for(l),g=Y.directUniforms(),J=Y.directAttribs(),y=o._buffer;if(!bs(H)&&!o.drawFilter){Ae(o,Sm);for(n in H)if(k=o.getBatchInfo(n)||al,k.visible!==!1&&!(s&&!k.transparent||!s&&k.transparent||o.isReflecting(l)&&k.reflectable===!1)){var h=k.renderLayerMask;
if(h==V&&(h=Un),_==V&&(_=Un),Bl(_,h)&&(G=H[n],e||!k.transparentMask)){var M=s&&k.autoSort===!0&&(o._33Q||G.invalidate);if(G.invalidate?ek(G):e&&G.ps&&G.ps._invalidateThisFrame&&(G.ps._invalidateThisFrame=!1,de(G,"ps")),u=G.vs32,D=e?G.ps32:G.cs32,K=G.uv32,W=G.bs32,O=G.rs32,Q=u.length/3,M){var N=Sn(u,o.getEye(),o);N?(G.is=N.is,G.elementTypeUint=N.useUint32):(G.is=null,G.elementTypeUint=null)}if(Q){S=G.translate,S&&Ae(o,[1,0,0,0,0,1,0,0,0,0,1,0,S[0],S[1],S[2],1]),v=k.light,c=o.getTexture(k.image),Rl(l,C,V,k.light,k.opacity,k.reverseFlip,k.reverseColor,k.reverseCull),D?o._batchColorDisabled?(g.uBatchColor=!1,J.aBatchColor=!1):(g.uBatchColor=!0,J.aBatchColor=Nf(l,y.batchColor,D,V,4)):(g.uBatchColor=!1,g.uDiffuse=k.color||a["color.empty"]);var A=k.alphaTest;g.uAlphaTest=A===$?a.alphaTest:A,g.shadowReceive=!e&&k.shadowReceive!==!1,l._blooming&&!k.bloom&&(g.blackout=!0),k.envmap!==$?(g.uUseEnvMap=!0,g.uReflectivity=k.envmap):(g.uUseEnvMap=!1,g.uReflectivity=0);var d=W&&!o._batchBlendDisabled;d&&(g.uBatchBlend=!0,J.aBatchBlend=Nf(l,y.batchBlend,W,V));var t=O&&!o._batchBrightnessDisabled;t&&(g.uBatchBrightness=!0,J.aBatchBrightness=Nf(l,y.batchBrightness,O,V,1)),K?wo(l,C,c,k.discardSelectable,y.uv,K,k.uvOffset,k.uvScale,k.uvRotation):wo(l),J.aPosition=Nf(l,y.vs,u,V),J.aNormal=Nf(l,y.ns,G.ns32,V),G.is?(pg(l,y.is,G.is),Mo(l,0,Q,null,G.elementTypeUint?l.UNSIGNED_INT:null)):Tg(l,0,Q),K?Rj(l,C,c):Rj(l),D&&!o._batchColorDisabled&&(g.uBatchColor=!1,J.aBatchColor=!1),d&&(g.uBatchBlend=!1,J.aBatchBlend=!1),t&&(g.uBatchBrightness=!1,J.aBatchBrightness=!1),l._blooming&&!k.bloom&&(g.blackout=!1),nn(l,C),S&&ug(o)}}}ug(o)}},Sn=function(C,f,q){var Z=C.length/3,d=Z>65535,Y=q._glCapabilities.elementTypeUint&&d;if(!Y&&d)return null;for(var u=new Array(Z),e=Z/3,P=new Array(e),r=0;e>r;r++)P[r]=r;P.sort(function(L,T){var W=9*L,V=[(C[W]+C[W+3]+2*C[W+6])/4,(C[W+1]+C[W+4]+2*C[W+7])/4,(C[W+2]+C[W+5]+2*C[W+8])/4];W=9*T;var G=[(C[W]+C[W+3]+2*C[W+6])/4,(C[W+1]+C[W+4]+2*C[W+7])/4,(C[W+2]+C[W+5]+2*C[W+8])/4],I=Lf(f,V)-Lf(f,G);return I>0?-1:0>I?1:0});for(var r=0;e>r;r++){var y=3*r,T=3*P[r];u[y]=T,u[y+1]=T+1,u[y+2]=T+2}return{useUint32:Y,is:Y?new Uint32Array(u):new Ad(u)}},Im={obj:function(g,t){var x={mat:g.mat,s3:g.s3,r3:g.r3,rotationMode:g.rotationMode,t3:g.t3,cube:g.cube==V?!0:g.cube,center:g.center==V?!0:g.center,ignoreMtls:g.ignoreMtls,ignoreTransparent:g.ignoreTransparent,ignoreColor:g.ignoreColor,ignoreImage:g.ignoreImage,ignoreNormal:g.ignoreNormal,prefix:g.prefix,flipY:g.flipY,flipFace:g.flipFace,reverseFlipMtls:g.reverseFlipMtls,finishFunc:function(k,J){if(k){var J=[];for(var x in k){var z=k[x];J.rawS3=z.rawS3,z.center&&(J.center=z.center),J.push(z),g.eachModel&&g.eachModel(x,z)}J.json=g,t(J)}else t()}};B.loadObj(g.obj,g.mtl,x)},bin:function(C,W){var Y={finishFunc:function(T){T?W(T):W()}};B.loadBin(C.url,Y)}};B.getModelTypeHandlers=function(){return Im},B.setModelTypeHandler=function(v,M){Im[v]=M},B.getModelTypeHandler=function($){return Im[$]},B.handleModelLoaded=function(){},B.handleUnfoundModel=function(){};var Oc=V,rs=V,vh=function(I){Oc&&!I._loadingModelView_&&(rs||(rs={}),rs[I._loadingModelView_=jl()]=I)},tg=function(Z,r){Oc||(Oc={});var s=Oc[Z];if(s){if(s.url===r)return;s.request.onload=Fm,s.request.onerror=Fm}if(r.indexOf(".bin")===r.length-4)return wn(Z,{modelType:"bin",url:r},r);if(r=B.beforeLoadURL(r),r.data){var A=B.parse(r.data);wn(Z,A,r)}else{var K=new zh;Oc[Z]={request:K,url:r},K.onload=function(){if(200===this.status||0===this.status){delete Oc[Z];var S=B.parse(K.getResponseText());wn(Z,S,r)}else _b(Z,B.handleUnfoundModel(Z,r)||V)},K.onerror=function(){_b(Z,B.handleUnfoundModel(Z,r)||V)};var T={};T.url=encodeURI(r),T.sync=!1,K.send(T)}},wn=function(i,h,f){var u=h.modelType;if(!u)return _b(i,h),B.handleModelLoaded(i,h),void 0;var y=B.getModelTypeHandler(u);if(y){if(Oc||(Oc={}),Oc[i])return;Oc[i]=!0;var v=function(q){q?(_b(i,q),B.handleModelLoaded(i,q)):_b(i,B.handleUnfoundModel(i,f,h)||V)};y(h,v)}else _b(i,B.handleUnfoundModel(i,f,h)||V)},_b=function(Q,A){if(delete Oc[Q],Zq(A)&&bm.test(A))return tg(Q,A),void 0;if(Qc[Q]=A,bs(Oc)&&(Oc=V,rs)){for(var e in rs){var d=rs[e];d.invalidateAll&&d.invalidateAll($,"modelLoaded",Q),d.redraw&&d.redraw(),d.iv(),delete d._loadingModelView_}rs=V}if(A&&rs)for(var e in rs){var d=rs[e];d.invalidateAll&&d.invalidateAll($,"modelLoading",Q),d.redraw&&d.redraw(),d.iv()}},Rp=new Uj([0,0,0,1,1,1,1,0]),Mf=new Uj([0,0,1,0,0,1,0,0,1,0,0,1]),ql=new Ad([0,1,2,2,3,0]),bp=new Uj([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),rb=new Ad([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),th=new Uj([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Vo=Ir(bp,rb),$r=(new Uj([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Ad([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[ar,Ah,ci,vi,hp,Tl]),Pc=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],De=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],zl=function(k,S,M,B,W,t,i){t=t||16,k=k||16,S=S||0,M=M||k;var R,C,r,L,c,u,s,V,Q,H=.5,p=[],K=[],A=J/k,v=Z/t;for(R=0;t>R;R++)for(u=R+1,L=R*v,Q=u*v,C=S;M>C;C++)s=C+1,r=C*A,V=s*A,p.push(H*w(L)*D(r),H*D(L),-H*w(L)*w(r),H*w(Q)*D(V),H*D(Q),-H*w(Q)*w(V),H*w(L)*D(V),H*D(L),-H*w(L)*w(V),H*w(L)*D(r),H*D(L),-H*w(L)*w(r),H*w(Q)*D(r),H*D(Q),-H*w(Q)*w(r),H*w(Q)*D(V),H*D(Q),-H*w(Q)*w(V)),K.push(C/k,R/t,s/k,u/t,s/k,R/t,C/k,R/t,C/k,u/t,s/k,u/t);if(i){var h=[];for(R=0,c=p.length;c>R;R+=3)h.push(2*p[R],2*p[R+1],2*p[R+2])}if(B){var O=[],q=[];for(r=S*A,R=0;t>R;R++)u=R+1,L=R*v,Q=u*v,O.push(0,0,0,H*w(Q)*D(r),H*D(Q),-H*w(Q)*w(r),H*w(L)*D(r),H*D(L),-H*w(L)*w(r)),q.push(0,.5,S/k,u/t,S/k,R/t)}if(W){var y=[],g=[];for(r=M*A,R=0;t>R;R++)u=R+1,L=R*v,Q=u*v,y.push(0,0,0,H*w(L)*D(r),H*D(L),-H*w(L)*w(r),H*w(Q)*D(r),H*D(Q),-H*w(Q)*w(r)),g.push(1,.5,M/k,R/t,M/k,u/t)}var P={vs:p,uv:K,from_vs:O,from_uv:q,to_vs:y,to_uv:g};return i&&(P.ns=h),P},bb=function(B,Q,e){B=B||.17,Q=Q||12,e=e||18,0>B?B=0:B>.25&&(B=.25);var T,O,h,_,t,F,E,U=.5,P=[],r=[],K=[],d=J/e,p=J/Q,V=U-B;for(O=0;Q>=O;O++)for(_=-Z+O*p,F=D(_),t=w(_),T=0;e>=T;T++)h=T*d,E=V+B*F,P.push(D(h)*E,t*B,-w(h)*E),r.push(T/e,1-O/Q);for(O=0;Q>O;O++){var S=O*(e+1),C=(O+1)*(e+1);for(T=0;e>T;T++)K.push(S+T,C+T+1,C+T,S+T,S+T+1,C+T+1)}return{vs:P,uv:r,is:K}},up=function(v,V,c,N,s,g,B,C){B=B||12,v=v||18,V=V||0,c=c||v,g=g||.17,0>g?g=0:g>.25&&(g=.25);var i,O,m,S,G,E,T,I,y,n,_=.5,a=[],Y=[],f=J/v,t=J/B,l=_-g,x=C?[]:$;for(m=0;B>m;m++)for(S=m+1,T=-Z+m*t,I=-Z+S*t,i=V;c>i;i++)O=i+1,G=i*f,E=O*f,y=l+g*D(T),n=l+g*D(I),a.push(D(G)*y,w(T)*g,-w(G)*y,D(E)*y,w(T)*g,-w(E)*y,D(E)*n,w(I)*g,-w(E)*n,D(G)*y,w(T)*g,-w(G)*y,D(E)*n,w(I)*g,-w(E)*n,D(G)*n,w(I)*g,-w(G)*n),Y.push(i/v,1-m/B,O/v,1-m/B,O/v,1-S/B,i/v,1-m/B,O/v,1-S/B,i/v,1-S/B),C&&x.push(D(G)*D(T),w(T),-w(G)*D(T),D(E)*D(T),w(T),-w(E)*D(T),D(E)*D(I),w(I),-w(E)*D(I),D(G)*D(T),w(T),-w(G)*D(T),D(E)*D(I),w(I),-w(E)*D(I),D(G)*D(I),w(I),-w(G)*D(I));if(N){var z=[],q=[];for(m=0;B>m;m++)S=m+1,T=-Z+m*t,I=-Z+S*t,G=V*f,y=l+g*D(T),n=l+g*D(I),z.push(D(G)*y,w(T)*g,-w(G)*y,D(G)*n,w(I)*g,-w(G)*n,D(G)*l,0,-w(G)*l),q.push(.5+.5*D(T),.5-.5*w(T),.5+.5*D(I),.5-.5*w(I),.5,.5)}if(s){var d=[],R=[];for(m=0;B>m;m++)S=m+1,T=-Z+m*t,I=-Z+S*t,G=c*f,y=l+g*D(T),n=l+g*D(I),d.push(D(G)*y,w(T)*g,-w(G)*y,D(G)*l,0,-w(G)*l,D(G)*n,w(I)*g,-w(G)*n),R.push(.5-.5*D(T),.5-.5*w(T),.5,.5,.5-.5*D(I),.5-.5*w(I))}var H={vs:a,uv:Y,from_vs:z,from_uv:q,to_vs:d,to_uv:R};return C&&(H.ns=x),H},rp=function(K,b){for(var q,V,n,T=.5,k=16,P=[],h=[],S=[],l=J/k,d=0;k>=d;d++)q=d*l,V=D(q)*T,n=w(q)*T,P.push(V,-T,n,V,T,n),h.push(1-d/k,1,1-d/k,0);for(d=0;k>d;d++)S.push(2*d,2*d+1,2*d+3,2*d,2*d+3,2*d+2);if(b){var r=[],s=[],o=[];for(r.push(0,-T,0),s.push(.5,.5),d=0;k>=d;d++)q=d*l,V=D(q),n=w(q),r.push(V*T,-T,-n*T),s.push(.5+.5*V,.5+.5*n);for(d=0;k>d;d++)o.push(0,d+2,d+1)}if(K){var v=[],F=[],e=[];for(v.push(0,T,0),F.push(.5,.5),d=0;k>=d;d++)q=d*l,V=D(q),n=w(q),v.push(V*T,T,-n*T),F.push(.5+.5*V,.5-.5*n);for(d=0;k>d;d++)e.push(0,d+1,d+2)}return{vs:P,uv:h,is:S,bottom_vs:r,bottom_uv:s,bottom_is:o,top_vs:v,top_uv:F,top_is:e}},Di=function(i,_,j,l,Y,F,c,h){i=i||12,_=_||0,j=j||i;for(var x,L,M,f,o,A,O,Q,z,P=.5,X=[],p=[],q=J/i,H=_;j>H;H++)x=H+1,L=H*q,M=x*q,f=D(L)*P,o=w(L)*P,A=D(M)*P,O=w(M)*P,X.push(f,-P,-o,A,-P,-O,f,P,-o,A,-P,-O,A,P,-O,f,P,-o),p.push(H/i,1,x/i,1,H/i,0,x/i,1,x/i,0,H/i,0);if(h){var I=[];for(H=0,z=X.length;z>H;H+=3)I.push(2*X[H],0,2*X[H+2])}if(c){var u=[],N=[];for(H=_;j>H;H++)L=q*H,M=q*(H+1),f=D(L),o=w(L),A=D(M),O=w(M),u.push(f*P,-P,-o*P,0,-P,0,A*P,-P,-O*P),N.push(.5+.5*f,.5+.5*o,.5,.5,.5+.5*A,.5+.5*O)}if(F){var a=[],t=[];for(H=_;j>H;H++)L=q*H,M=q*(H+1),f=D(L),o=w(L),A=D(M),O=w(M),a.push(f*P,P,-o*P,A*P,P,-O*P,0,P,0),t.push(.5+.5*f,.5-.5*o,.5+.5*A,.5-.5*O,.5,.5)}if(l){var s=[],y=[];L=q*_,f=D(L)*P,o=w(L)*P,Q=_/i,s.push(0,P,0,0,-P,0,f,-P,-o,f,-P,-o,f,P,-o,0,P,0),y.push(0,0,0,1,Q,1,Q,1,Q,0,0,0)}if(Y){var g=[],n=[];L=q*j,f=D(L)*P,o=w(L)*P,Q=j/i,g.push(0,-P,0,0,P,0,f,P,-o,f,P,-o,f,-P,-o,0,-P,0),n.push(1,1,1,0,Q,0,Q,0,Q,1,1,1)}var R={vs:X,uv:p,bottom_vs:u,bottom_uv:N,top_vs:a,top_uv:t,from_vs:s,from_uv:y,to_vs:g,to_uv:n};return h&&(R.ns=I),R},Xl=function(j,N,f,B,Q){N=N||18,f=f||0,B=B==V?J:B,Q=Q==V?.5:Q;for(var E,k,l,o,s,d,C=[0,.5,.75,.875,.9375],m=[],x=[],g=[],X=B/N,n=0;n<C.length;n++){var Z=0===n%2?0:.5;for(E=0;N>=E;E++)k=(E+Z)*X+f,l=1-C[n],m.push(D(k)*Q*l,-Q+2*C[n]*Q,-w(k)*Q*l),x.push((E+Z)/N,l)}for(n=0;n<C.length-1;n++){var G=n*(N+1),h=(n+1)*(N+1);for(E=0;N>E;E++)g.push(G+E,h+E+1,h+E,G+E,G+E+1,h+E+1)}for(d=m.length/3-(N+1),E=0;N>E;E++)m.push(0,Q,0),x.push((E+.5)/N,0);for(E=0;N>E;E++)g.push(d+E,d+E+1,d+(N+1)+E);if(j){var e=[],O=[],i=[];for(e.push(0,-Q,0),O.push(.5,.5),E=0;N>=E;E++)k=E*X+f,o=D(k),s=w(k),e.push(o*Q,-Q,-s*Q),O.push(.5+.5*o,.5+.5*s);for(E=0;N>E;E++)i.push(0,E+2,E+1)}return{vs:m,uv:x,is:g,bottom_vs:e,bottom_uv:O,bottom_is:i}},pr=function(T,E,k,p,o,e,N,q){T=T||16,E=E||0,k=k||T,N=N||1;var m,u,R,H,n,Q,f,M=.5,C=[],y=[],L=J/T,l=E,$=1/N,u=new Qe,R=new Qe,r=new Qe,i=new Qe,v=new Qe,O=new Qe,G=new Qe;for(q&&(m=[],n=new Qe,Q=new Qe,f=new Qe);k>l;l++){var K=l+1,B=L*l,Y=L*K;for(u.set(D(B)*M,-M,-w(B)*M),R.set(D(Y)*M,-M,-w(Y)*M),r.set(0,M,0),q&&(n.set(D(B),.5,-w(B)).normalize(),Q.set(D(Y),.5,-w(Y)).normalize(),f.copy(n).add(Q).normalize()),i.lerpVectors(r,u,$),v.lerpVectors(r,R,$),C.push(i.x,i.y,i.z,v.x,v.y,v.z,r.x,r.y,r.z),y.push(l/T,$,K/T,$,(l+K)/2/T,0),q&&m.push(n.x,n.y,n.z,Q.x,Q.y,Q.z,f.x,f.y,f.z),H=1;N>H;H++)i.lerpVectors(r,u,$*(H+1)),v.lerpVectors(r,R,$*(H+1)),O.lerpVectors(r,u,$*H),G.lerpVectors(r,R,$*H),C.push(i.x,i.y,i.z,v.x,v.y,v.z,O.x,O.y,O.z,O.x,O.y,O.z,v.x,v.y,v.z,G.x,G.y,G.z),y.push(l/T,$*(H+1),K/T,$*(H+1),l/T,$*H,l/T,$*H,K/T,$*(H+1),K/T,$*H),q&&m.push(n.x,n.y,n.z,Q.x,Q.y,Q.z,n.x,n.y,n.z,n.x,n.y,n.z,Q.x,Q.y,Q.z,Q.x,Q.y,Q.z)}if(e){var a=[],Z=[];for(l=E;k>l;l++){B=L*l,Y=L*(l+1);var F=D(B),h=w(B),V=D(Y),z=w(Y);a.push(F*M,-M,-h*M,0,-M,0,V*M,-M,-z*M),Z.push(.5+.5*F,.5+.5*h,.5,.5,.5+.5*V,.5+.5*z)}}if(p){var d=[],x=[];B=L*E,d.push(0,M,0,0,-M,0,D(B)*M,-M,-w(B)*M),x.push(0,0,0,1,E/T,1)}if(o){var U=[],A=[];B=L*k,U.push(0,-M,0,0,M,0,D(B)*M,-M,-w(B)*M),A.push(1,1,1,0,k/T,1)}var I={vs:C,uv:y,bottom_vs:a,bottom_uv:Z,from_vs:d,from_uv:x,to_vs:U,to_uv:A};return q&&(I.ns=m),I},df=function(M,d,P,K,k,b,E,r){for(var R=[],o=0;o<M.length-1;o+=2)R.push({x:M[o],y:M[o+1]});return xn(R,d,P,K,k,b,E,r,!1)},Pq={roundRect:function(k,F){return df([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],k,F,3)},star:function(D,K){return df([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],D,K)},rect:function(X,t){return df([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],X,t)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(r,E){return df([0,-.5,.5,.5,-.5,.5],[1,2,2,5],r,E)},rightTriangle:function(D,K){return df([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],D,K)},parallelogram:function(Z,N){return df([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],Z,N)},trapezoid:function($,q){return df([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],$,q)}},Il={sphere:1,cylinder:1,cone:1,torus:1},yd={torus:1,sphere:1,cone:1},js=Ki(Xn(Pq),{cylinder:1}),pl=Ki(Xn(Pq),{cylinder:1,cone:1}),cd=function(h,w,v){var K,p=Th(h.anchor3d,v,w),L=Th(h.mat,v,w),i=Th(h.s3,v,w),S=Th(h.t3,v,w),Y=Th(h.r3,v,w),N=i||Y||S||L;if(p||N){K=Od(w._6O);var u=N?Gl(L,i,Y,Th(h.rotationMode,v,w),S):no();p&&rm(u,[.5-p[0],.5-p[1],.5-p[2]]),Ae(w,u)}return K},ol=function(O,M,t,f,Z,W,h){if(Xj(t))t.forEach(function(B){ol(O,M,B,f,Z,W,h)});else if(Zq(t))ol(O,M,rh(f,t),f,Z,W,h);else if(on(t))if(t.shape3d){var j=cd(t,O,M);ol(O,M,t.shape3d,f,Z,W,t),j&&ug(O,j)}else km(O,M,t,f.s,Z,W,h)},km=function(p,n,F,g,I,i,K){if(K=K||al,!i||i(g("shape3d.transparent",F.transparent,K.transparent))){var O=cd(F,p,n);if(Wp(F)){var M=p.getData3dUI(n);M.dispatchBoundingBoxChanged()}var J=p._26I,w=p._prg,E=p._buffer,W=g("shape3d.color",F.color,K.color);I||(I=g("shape3d.blend",F.blend,K.blend));var h,N=F.opacity==V?K.opacity:F.opacity,v=g("shape3d.opacity");h=v!=V&&N!=V?N*v:N!=V?N:v,Rl(J,w,I,g("shape3d.light",F.light,K.light),h,g("shape3d.reverse.flip",F.reverseFlip,K.reverseFlip),g("shape3d.reverse.color",F.reverseColor,K.reverseColor),g("shape3d.reverse.cull",F.reverseCull,K.reverseCull));var T=g("polygonOffset",F.polygonOffset,K.polygonOffset);F.vs&&g(Jj,F.visible,K.visible)&&op(J,w,E,W,p.getTexture(g("shape3d.image",F.image,K.image),n),g("shape3d.discard.selectable",F.discardSelectable,K.discardSelectable),F.vs,F.uv,F.ns,F.is,g("shape3d.uv.offset",F.uvOffset,K.uvOffset),g("shape3d.uv.scale",F.uvScale,K.uvScale),g("shape3d.uv.rotation",F.uvRotation,K.uvRotation),T),F.top_vs&&g(Zk,F.topVisible,K.topVisible)&&op(J,w,E,g("shape3d.top.color",F.topColor,K.topColor)||W,p.getTexture(g("shape3d.top.image",F.topImage,K.topImage),n,"top"),g("shape3d.top.discard.selectable",F.topDiscardSelectable,K.topDiscardSelectable),F.top_vs,F.top_uv,F.top_ns,F.top_is,g("shape3d.top.uv.offset",F.topUvOffset,K.topUvOffset),g("shape3d.top.uv.scale",F.topUvScale,K.topUvScale),g("shape3d.top.uv.rotation",F.topUvRotation,K.topUvRotation),T),F.bottom_vs&&g(Zc,F.bottomVisible,K.bottomVisible)&&op(J,w,E,g("shape3d.bottom.color",F.bottomColor,K.bottomColor)||W,p.getTexture(g("shape3d.bottom.image",F.bottomImage,K.bottomImage),n,"bottom"),g("shape3d.bottom.discard.selectable",F.bottomDiscardSelectable,K.bottomDiscardSelectable),F.bottom_vs,F.bottom_uv,F.bottom_ns,F.bottom_is,g("shape3d.bottom.uv.offset",F.bottomUvOffset,K.bottomUvOffset),g("shape3d.bottom.uv.scale",F.bottomUvScale,K.bottomUvScale),g("shape3d.bottom.uv.rotation",F.bottomUvRotation,K.bottomUvRotation),T),F.from_vs&&g(Db,F.fromVisible,K.fromVisible)&&op(J,w,E,g("shape3d.from.color",F.fromColor,K.fromColor)||W,p.getTexture(g("shape3d.from.image",F.fromImage,K.fromImage),n,"from"),g("shape3d.from.discard.selectable",F.fromDiscardSelectable,K.fromDiscardSelectable),F.from_vs,F.from_uv,F.from_ns,F.from_is,g("shape3d.from.uv.offset",F.fromUvOffset,K.fromUvOffset),g("shape3d.from.uv.scale",F.fromUvScale,K.fromUvScale),g("shape3d.from.uv.rotation",F.fromUvRotation,K.fromUvRotation),T),F.to_vs&&g(Sl,F.toVisible,K.toVisible)&&op(J,w,E,g("shape3d.to.color",F.toColor,K.toColor)||W,p.getTexture(g("shape3d.to.image",F.toImage,K.toImage),n,"to"),g("shape3d.to.discard.selectable",F.toDiscardSelectable,K.toDiscardSelectable),F.to_vs,F.to_uv,F.to_ns,F.to_is,g("shape3d.to.uv.offset",F.toUvOffset,K.toUvOffset),g("shape3d.to.uv.scale",F.toUvScale,K.toUvScale),g("shape3d.to.uv.rotation",F.toUvRotation,K.toUvRotation),T),nn(J,w),O&&ug(p,O)}},op=function(O,M,x,G,Z,z,q,Q,n,I,j,y,B,$){if(q){$&&tp(O,$);var E=Oo.for(O),P=E.directUniforms(),F=E.directAttribs();P.uDiffuse=G||a["color.empty"],Q?wo(O,M,Z,z,x.uv,Q,j,y,B):wo(O),F.aPosition=Nf(O,x.vs,q,V),F.aNormal=Nf(O,x.ns,n,V),I?(jj(O,x.is,I),Mo(O,0,I.length,null,I instanceof Uint32Array?O.UNSIGNED_INT:null)):Tg(O,0,q.length/3),Q?Rj(O,M,Z):Rj(O),$&&rd(O)}},rh=function(M,f){var c=M.s;if(f||(f=c(zp)),!f)return V;var x=Ij(f);if(x)return x;if("text"===f){var o={amount:c("shape3d.text.amount"),size:c("shape3d.text.size"),font:c("shape3d.text.font"),style:c("shape3d.text.style"),weight:c("shape3d.text.weight"),fill:c("shape3d.text.fill"),curveSegments:c("shape3d.text.curveSegments"),spacing:c("shape3d.text.spacing")},k=M.gv.getShape3dText(M.data),W=k;for(var F in o)W+="_"+(o[F]===$?"U":o[F]);return M._cachedTextKey===W?M._cachedTextGeometry:(M._cachedTextKey=W,M._cachedTextGeometry=B.createTextGeometry(k,o))}var F=f;if(Il[f]){var s=c("shape3d.side"),d=c("shape3d.side.from"),X=c("shape3d.side.to"),Y=c(Db),m=c(Sl);3>s?(s=0,d=0,X=0,Y=!1,m=!1):((d==V||0>d)&&(d=0),(X==V||X>s)&&(X=s),0===d&&X===s&&(Y=!1,m=!1));var p=c("shape3d.smooth");F+="-"+s+"-"+d+"-"+X+"-"+Y+"-"+m+(p?1:0)}if(js[f]){var K=c(Zk);F+="-"+K}if(pl[f]){var N=c(Zc);F+="-"+N}if("torus"===f){var t=c("shape3d.torus.radius");0>t?t=0:t>.25&&(t=.25),F+="-"+t}if(yd[f]){var y=c(Wf);F+="-"+y}return x=qg[F],x||("box"===f?x=B.createBoxModel():Pq[f]?x=Pq[f](K,N):"sphere"===f?x=B.createSphereModel(s,d,X,Y,m,y,p):f===Wj?x=B.createCylinderModel(s,d,X,Y,m,K,N,p):"cone"===f?x=B.createConeModel(s,d,X,Y,m,N,y,p):"torus"===f&&(x=B.createTorusModel(s,d,X,Y,m,t,y,p)),qg[F]=x),x},Wp=function(){var R=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],V=["is","top_is","bottom_is","from_is","to_is"];return P=Xm(Tm.substr(Tm.indexOf("^#")+2)),Rb(B[Bb(Om+R[15]+"n"+R[16])]())&&ms()?function(T){return T&&!T._complete_?(T._complete_=!0,T.vs&&Zj(T.ns)&&(T.ns=Ir(T.vs,T.is),T.boundingBox=$),T.top_vs&&Zj(T.top_ns)&&(T.top_ns=Ir(T.top_vs,T.top_is),T.top_boundingBox=$),T.bottom_vs&&Zj(T.bottom_ns)&&(T.bottom_ns=Ir(T.bottom_vs,T.bottom_is),T.bottom_boundingBox=$),T.from_vs&&Zj(T.from_ns)&&(T.from_ns=Ir(T.from_vs,T.from_is),T.from_boundingBox=$),T.to_vs&&Zj(T.to_ns)&&(T.to_ns=Ir(T.to_vs,T.to_is),T.to_boundingBox=$),R.forEach(function(I){var i=T[I];Xj(i)&&(T[I]=new Uj(i))}),V.forEach(function(C){var Q=T[C];Xj(Q)&&(T[C]=new Ad(Q))}),!0):!1}:void 0}(),Tf=function(z,W){var s=z[W];Xj(s)&&(z[W]=new Uj(s))};Ki(Oh,{_25Q:function(j){j._16O=function(i,Q,s,E,C,g,M,K,c){var B=this.info;if(B){var $,b,e,J,r,S,u=no();if(ej[Q]?($=B.p3,b=B.c1,e=B.c2):Fp[Q]?(b=B.s1||B.c1,e=B.s2||B.c2):(b=B.t1||B.c1,e=B.t2||B.c2),$)S=ll(Q,Tc,s,E,K,c);else{var v=Fq(e,b),w=Lf(b,e);J=[0,-I(v[2],v[0]),x(v[1]/w)],r="zyx",$=[(b[0]+e[0])/2,(b[1]+e[1])/2,(b[2]+e[2])/2],S=ll(Q,[w,0,0],s,E,K,c)}return bn(u,S,$,E,C,g,M,i,J,r)}return gk},j._80o=function(J,F,L){var B=this,T=B.shapeModel;if(T){var i=B.gv;Ae(i),ol(i,B.data,T,B,B.getBodyColor(),L)}},j.createLineModel=function(Y,o,e,B,k){var y=this,d=y.s,f=Jn(Y,o,d(Wf)),X=d(B+".color");if(X){for(var b=[],I=0;I<f.length;I++){var n=f[I],E=n.length;if(E>1){var i=n[0];b.push(i.x,i.y,i.z);for(var t=1;E-1>t;t++)i=n[t],b.push(i.x,i.y,i.z),b.push(i.x,i.y,i.z);i=n[E-1],b.push(i.x,i.y,i.z)}}var W,R,m,F=d(k),x=0;F&&(R=d(k+".color"),W=d(k+".pattern"),x=d(k+".offset"),m=X),Sc(y.gv,y.data,b,R||X,m?V:d(B+".gradient.color"),e,W||d(B+".pattern"),x,m)}return f},j.createTubeModel=function(J,X,h,P){for(var _=this,D=_.s,$=D("shape3d.side")||Zn,g=D("shape3d.start.angle"),N=D("shape3d.sweep.angle"),b=D(Zk)?D("shape3d.top.cap"):V,r=D(Zc)?D("shape3d.bottom.cap"):V,G="flat"===b,Q="flat"===r,S=G&&(P?P.uv:D("shape3d.top.image")),O=Q&&(P?P.uv:D("shape3d.bottom.image")),x=P?P.uv:D("shape3d.image"),I=D("shape3d.smooth"),a={vs:[],uv:x?[]:V,ns:I?[]:V,top_vs:G?[]:V,top_uv:S?[]:V,bottom_vs:Q?[]:V,bottom_uv:O?[]:V},l=Jn(J,X,D(Wf),h),A=0,w=l.length;w>A;A++)oi(a,l[A],D(Wr),h,$,g,N,b,r);if(P){var E=[];Af(_.gv,_.data,a,_,_.getBodyColor(),_.mat?[_.mat]:[],P,E),E.length&&(Qf(P.vs,E),Qf(P.ns,Ir(E)))}else _.shapeModel=a;return _.lineShapeModel=a,l},j.getCache=function(){var r=this.info;if(r){var R=r.list;if(R){var o=r.cache;return o||(o=r.cache=Zl(R)),o}}return V}}});var or=function(o,x){for(var M,A=0,Y=o.length,n=0,G=Y-1;G>=n;)if(A=b(n+(G-n)/2),M=o[A].length-x,0>M)n=A+1;else{if(!(M>0)){G=A;break}G=A-1}A=G;var d=o[A],v=d.point;return A===Y-1||d.length===x||(v=(new Qo).subVectors(o[A+1].point,v).normalize().multiplyScalar(x-d.length).add(v)),{point:v,tangent:d.tangent}},Zl=function(W){for(var z,g,V=[],K=0,M=0;M<W.length;M++){for(var G=W[M],R=0;R<G.length;R++){z=G[R],g&&(K+=g.distanceTo(z));var O=new Qo,Q=G[R+1];Q?O.subVectors(Q,z):g?O.subVectors(z,g):O.x=1,O.normalize(),V.push({point:z,length:K,tangent:O}),g=z}g=null}return V},Jn=function(k,H,v,K){v=v||Nl;for(var x=[],U=0,t=k.size();t>U;U++){var y=k.get(U);x.push(new Qo(y.x,y.e||0,y.y))}H&&(Lq(H)&&(H=H._as),H.length||(H=null));for(var p,l,Z,T,C,d=[],Q=0,O=0,L=H?H.length:t;L>O;O++)if(C=H?H[O]:0===O?1:2,1===C)d.push(Z=[]),Z.push(x[Q++]);else if(2===C||5===C)if(T=2===C?x[Q++]:Z[0],K){var Y=H?H[O+1]:L>O+1?2:V;if(2===Y||5===Y){var n=Z[Z.length-1],P=2===Y?x[Q]:Z[0],r=(new Qo).subVectors(n,T),F=(new Qo).subVectors(P,T),W=r.length(),q=F.length();if(W&&q)if(K>W/2&&K>q/2)Z.push(T);else for(r.multiplyScalar(s(K,W/2)/W).add(T),F.multiplyScalar(s(K,q/2)/q).add(T),p=new Lr(r,T,F).getPoints(v),l=0;v>=l;l++)Z.push(p[l])}else Z.push(T)}else Z.push(T);else if(3===C)for(p=new Lr(Z[Z.length-1],x[Q++],x[Q++]).getPoints(v),l=1;v>=l;l++)Z.push(p[l]);else if(4===C)for(p=new Wm(Z[Z.length-1],x[Q++],x[Q++],x[Q++]).getPoints(v),l=1;v>=l;l++)Z.push(p[l]);return d},Ik=function(X){for(var B,I,l=new Qo,m=[],_=[],Y=[],D=0,g=X.length;g>D;D++)B=X[D],I=X[D+1],I?l.subVectors(I,B):l.subVectors(B,X[D-1]),m.push(l.normalize().clone());var s,A=new Qo,M=new Qo,j=new hb,K=1e-4,c=m[0],u=_[0]=new Qo,O=Y[0]=new Qo;for(Math.abs(Math.abs(c.y)-1)<K?A.set(1,0,0):A.set(0,1,0),M.crossVectors(c,A).normalize(),u.crossVectors(c,M),O.crossVectors(c,u),D=1;g>D;D++)_[D]=_[D-1].clone(),Y[D]=Y[D-1].clone(),M.crossVectors(m[D-1],m[D]),M.length()>K&&(M.normalize(),s=q(Sk(m[D-1].dot(m[D]),-1,1)),_[D].applyMatrix4(j.makeRotationAxis(M,s))),Y[D].crossVectors(m[D],_[D]);return{B:Y,T:m,N:_}},oi=function(){var l=function(K){for(var d=1;d<arguments.length;d++){var Z=arguments[d];K.push(Z.x,Z.y,Z.z)}},y=function(v){for(var G=1;G<arguments.length;G++){var J=arguments[G].uv;v.push(J[0],J[1])}},b=function(Q){for(var b=1;b<arguments.length;b++){var J=arguments[b].ns;Q.push(J[0],J[1],J[2])}},h=function(c,x,F,t,J){var H=-t*D(J),m=t*w(J);return new Qo(c.x+H*F.x+m*x.x,c.y+H*F.y+m*x.y,c.z+H*F.z+m*x.z)},U=function(H,r,w,f,p,_,I,z,U){I=I||J;for(var C,q=[],g=I/p,C=U?new Qe:V,m=0;p>=m;m++){var A=h(H,r,w,f,m*g+_);q.push(A),z!=V&&(A.uv=[z,1-m/p]),U&&(A.ns=C.subVectors(A,H).normalize().toArray())}return q},_=function(Z,b,m,E,U,V,s,c,_){_=_||J;var A=b?Z.top_vs:Z.bottom_vs;if(A)for(var K=b?Z.top_uv:Z.bottom_uv,t=_/s,z=0;s>z;z++){var o,N;b?(o=z*t+c,N=(z+1)*t+c):(N=z*t+c,o=(z+1)*t+c),l(A,h(m,E,U,V,o),h(m,E,U,V,N),m),K&&K.push(.5-.5*D(o),.5-.5*w(o),.5-.5*D(N),.5-.5*w(N),.5,.5)}};return function(n,c,T,p,k,Z,Y,e,h){var C=c.length;if(C>1){var S,x,w,F,m,X,s,g=Ik(c),A=g.T,r=g.N,P=g.B;"flat"===e&&_(n,!0,c[0],P[0],r[0],p,k,Z,Y),"flat"===h&&_(n,!1,c[C-1],P[C-1],r[C-1],p,k,Z,Y);var z,W,B=[],i=L(k/2),D="round"===e,M="round"===h,a=c[0],t=A[0],o=P[0],E=r[0],Q=c[C-1],I=A[C-1],N=P[C-1],R=r[C-1];if(D){for(w=1;i>=w;w++)r.splice(0,0,E),P.splice(0,0,o),A.splice(0,0,t),W=-w/i*p,c.splice(0,0,t.clone().multiplyScalar(W).add(a)),B[i-w]=j(p*p-W*W);C+=i}if(M){for(w=1;i>=w;w++)r.push(R),P.push(N),A.push(I),W=w/i*p,c.push(I.clone().multiplyScalar(W).add(Q)),B[c.length-1]=j(p*p-W*W);C+=i}if(n.uv){var K=0,H=0,v=[];for(T&&(K=T),m=c[0],v[0]=0,w=1;C>w;w++)F=c[w],v[w]=m.distanceTo(F),m=F,T||(K+=v[w]);for(z=[],w=0;C>w;w++)H+=v[w],z[w]=K?H/K:0}var J=n.ns?!0:!1;for(w=0;C>w;w++){if(F=c[w],X=P[w],s=r[w],S=U(F,X,s,B[w]===$?p:B[w],k,Z,Y,z?z[w]:V,J),x)for(var f=0;k>f;f++){var d=x[f],u=x[f+1]||x[0],O=S[f],G=S[f+1]||S[0];l(n.vs,u,d,O,O,G,u),n.uv&&y(n.uv,u,d,O,O,G,u),J&&b(n.ns,u,d,O,O,G,u)}x=S}}}}();Ki(B,{getLineLength:function(H){return H[H.length-1].length},getLineOffset:function(g,D){return or(g,D)},getLineCacheInfo:function(h,X,f,C){return Zl(Jn(h,X,f,C))}});var ff=C.graph3d.RenderLite={},pd=new Array(0),dp=ff.Buffer=function(t,m,i,x){this.gl=t,this.buffer=t.createBuffer(),this.type=m||t.ARRAY_BUFFER,this.drawType=x||t.STATIC_DRAW,this.data=pd,i&&this.upload(i)};dp.prototype.upload=function(N,U,Y){Y||this.bind();var g=this.gl;N=N||this.data,U=U||0,this.data.byteLength>=N.byteLength?g.bufferSubData(this.type,U,N):g.bufferData(this.type,N,this.drawType),this.data=N},dp.prototype.bind=function(){var N=this.gl;N.bindBuffer(this.type,this.buffer)},dp.createVertexBuffer=function(A,j,m){return new dp(A,A.ARRAY_BUFFER,j,m)},dp.createIndexBuffer=function(R,N,n){return new dp(R,R.ELEMENT_ARRAY_BUFFER,N,n)},dp.create=function(I,_,w,f){return new dp(I,_,f)},dp.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var mq=ff.Shader=function(A,w,Z){this.gl=A,this.program=pf(A,w,Z),this.attributes=he(A,this.program);var N=lk(A,this.program);this.uniforms=ir(A,N)};mq.prototype.bind=function(){this.gl.useProgram(this.program)},mq.prototype.destroy=function(){this.gl};var pf=function(Y,M,w){var A=Se(Y,Y.VERTEX_SHADER,M),C=Se(Y,Y.FRAGMENT_SHADER,w),x=Y.createProgram();return Y.attachShader(x,A),Y.attachShader(x,C),Y.linkProgram(x),Y.getProgramParameter(x,Y.LINK_STATUS)||(ck("LINK","LITE",Y.getProgramParameter(x,Y.VALIDATE_STATUS),Y.getError(),Y.getProgramInfoLog(x)),Y.deleteProgram(x),x=null),Y.deleteShader(A),Y.deleteShader(C),x},Se=function(T,H,t){var V=T.createShader(H);return T.shaderSource(V,t),T.compileShader(V),T.getShaderParameter(V,T.COMPILE_STATUS)?V:(ck("COMPILE","LITE",H,T.getError(),T.getShaderInfoLog(V)),null)},lk=function(N,X){for(var y={},f=N.getProgramParameter(X,N.ACTIVE_UNIFORMS),l=0;f>l;l++){var o=N.getActiveUniform(X,l),q=o.name.replace(/\[.*?\]/,""),W=cn(N,o.type);y[q]={type:W,size:o.size,location:N.getUniformLocation(X,q),value:Yo(W,o.size)}}return y},he=function(q,N){for(var o={},y=q.getProgramParameter(N,q.ACTIVE_ATTRIBUTES),k=0;y>k;k++){var u=q.getActiveAttrib(N,k),I=cn(q,u.type);o[u.name]={type:I,size:Uk(I),gl:q,location:q.getAttribLocation(N,u.name),pointer:pj}}return o},pj=function(j,o,U,e,x){var p=this.gl;p.enableVertexAttribArray(this.location),j instanceof ff.Buffer||(j=ff.Buffer.createVertexBuffer(p,j)),p.bindBuffer(j.type,j.buffer),p.vertexAttribPointer(this.location,this.size,o||p.FLOAT,U||!1,e||0,x||0)},Uk=function(L){return gm[L]},gm={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},cn=function(g,Z){if(!Jr){var V=e.keys(Yk);Jr={};for(var y=0;y<V.length;++y){var h=V[y];Jr[g[h]]=Yk[h]}}return Jr[Z]},Jr=null,Yk={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Yo=function(b,j){switch(b){case"float":return 0;case"vec2":return new Float32Array(2*j);case"vec3":return new Float32Array(3*j);case"vec4":return new Float32Array(4*j);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*j);case"ivec3":return new Int32Array(3*j);case"ivec4":return new Int32Array(4*j);case"bool":return!1;case"bvec2":return wg(2*j);case"bvec3":return wg(3*j);case"bvec4":return wg(4*j);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},wg=function(N){for(var e=new Array(N),E=0;E<e.length;E++)e[E]=!1;return e},ir=function(P,D){var g={data:{}};g.gl=P;for(var z=e.keys(D),i=0;i<z.length;i++){var U=z[i],F=U.split("."),W=F[F.length-1],n=bi(F,g),s=D[U];n.data[W]=s,n.gl=P,e.defineProperty(n,W,{get:Bc(W),set:ge(W,s)})}return g},Bc=function(M){var j=zj.replace("%%",M);return new Function(j)},ge=function(B,d){var C,e=Wb.replace(/%%/g,B);return C=1===d.size?Qp[d.type]:sd[d.type],C&&(e+="\nthis.gl."+C+";"),new Function("value",e)},bi=function(l,i){for(var v=i,L=0;L<l.length-1;L++){var P=v[l[L]]||{data:{}};v[l[L]]=P,v=P}return v},zj=["return this.data.%%.value;"].join("\n"),Wb=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Qp={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},sd={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},tr=function(Y){function g(J){if("string"!=typeof J)return 0|J;switch(J){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}var S=this;S.enable=!1;var f,G,c=B.graph3dViewShadowType,I=B.graph3dViewShadowIntensity,j=B.graph3dViewShadowBias,W=B.graph3dViewShadowQuality,Q=B.graph3dViewShadowRadius,R=B.graph3dViewShadowDegreeX,P=B.graph3dViewShadowDegreeZ,h=1,m=g(W),D=!1,x=new C.Math.Matrix4,X=new C.Math.Matrix4,d=S.pvMatrix=new C.Math.Matrix4;S.render=function(){if(!Y._picking&&S.enable){var u=Y.getGL();if(u){D&&S.setupShadowCamera(),Y._glCapabilities&&(m=Math.min(m,Y._glCapabilities.maxTextureSize)),S.map?f.setSize(m,m):f=S.map=new Ei(Y,Y.getGL(),0,0,{samples:1,minFilter:ah.NEAREST,magFilter:ah.NEAREST,width:m,height:m}),u._shadowShader||(u._shadowShader=new ff.Shader(u,tr.shaderSrc.vs,tr.shaderSrc.fs));var W=Y._frameState,B=W.renderState.glState;B.blend.enabled=!1,B.depth.enabled=!0,B.depth.mask=!0;var z=B.color.clear.slice(0);nb(u,[1,1,1,1]),W.renderState.useProgram(u._shadowShader.program),A(),nb(u,z)}}},S.getShadow=function(){var n={degreeX:R,degreeZ:P,intensity:I,quality:W,type:c,radius:Q,bias:j};return 1!==h&&(n.boundExtend=h),n},S.setShadow=function(U,F){U=!!U;var d=S.enable!==U;S.enable=U,"object"==typeof F&&(F.intensity!==$&&(I=F.intensity),F.bias!==$&&(j=F.bias),F.radius!==$&&(Q=F.radius),F.degreeX!==$&&(R=F.degreeX),F.degreeZ!==$&&(P=F.degreeZ),F.quality!==$&&(W=F.quality),F.type!==$&&c!==F.type&&(c=F.type,d=!0),m=g(W),F.boundExtend!==$&&(h=F.boundExtend)),U&&S.setupShadowCamera(),d&&Gh(Y),Y.iv()
},S.refresh=function(){this.enable&&(this.setupShadowCamera(),Y.iv())},S.tryUpdateBounding=function(B){var j=this.boundingSphere;if(j){var C=(new hb).fromArray(Uf(B,Y.getMat(B))),L=B.getAnchor3d(),N=new Qe;j.containsPoint(N.set(0-L.x,0-L.y,0-L.z).applyMatrix4(C))&&j.containsPoint(N.set(0-L.x,0-L.y,1-L.z).applyMatrix4(C))&&j.containsPoint(N.set(0-L.x,1-L.y,0-L.z).applyMatrix4(C))&&j.containsPoint(N.set(0-L.x,1-L.y,1-L.z).applyMatrix4(C))&&j.containsPoint(N.set(1-L.x,0-L.y,0-L.z).applyMatrix4(C))&&j.containsPoint(N.set(1-L.x,0-L.y,1-L.z).applyMatrix4(C))&&j.containsPoint(N.set(1-L.x,1-L.y,0-L.z).applyMatrix4(C))&&j.containsPoint(N.set(1-L.x,1-L.y,1-L.z).applyMatrix4(C))||S.setupShadowCamera()}},S.createShadow=function(a){a||(a=Y._frameState.renderState.directUniforms()),a.shadowMatrix=d.toArray(),a.shadowMap=f.texture,a.shadowSize=[f.width,f.height],a.shadowIntensity=I,a.shadowBias=j,a.shadowRadius=Q},S.genShaderDefine=function(){var K="#define USE_SHADOWMAP\n";return"hard"===c?K+="#define SHADOWMAP_TYPE_PCF\n":"soft"===c&&(K+="#define SHADOWMAP_TYPE_PCF_SOFT\n"),K};var L;S.setupShadowCamera=function(){G||(G=S.boundingSphere=new C.Math.Sphere),D=!1;var $,o,r=Y.getBoundingBox(Y.dm().toDatas(function(z){return z.s("shadow.cast")&&Y.isVisible(z)}));r?($=new Qe(r.min),o=new Qe(r.max)):($=new Qe(-256,-256,-256),o=new Qe(256,256,256),D=!0),G.set($.clone().add(o).multiplyScalar(.5),.5*$.distanceTo(o)*h);var j,u=G.radius,z=Y.getBoundingBox(Y.dm().toDatas(function(Q){return(Q.s("shadow.cast")||Q.s("shadow.receive"))&&Y.isVisible(Q)}));if(z){$.copy(z.min),o.copy(z.max);var W=.5*$.distanceTo(o);j=W+Math.min(W,u+G.center.distanceTo($.add(o).multiplyScalar(.5)))}else j=2*u;L=Ml(no(),-u,u,-u,u,j/1e3,j),d.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),d.multiply(x.fromArray(L));var a=Math.tan(-R*Math.PI/180),f=Math.tan(-P*Math.PI/180),H=u/Math.sqrt(a*a+f*f+1),M=new Qe(H*a,H,H*f);x.lookAt(M,new Qe(0,0,0),new Qe(0,1,0)).setPosition(M.add(G.center)),x.getInverse(x),d.multiply(x)};var A=function(){var Z=Y.getGL(),$=m,o=m;f.setSize(Z,$,o),f.bind(Z),Z.clear(ah.COLOR_BUFFER_BIT|ah.DEPTH_BUFFER_BIT);var p=Y._frameState,G=p.renderState,z=G.directUniforms(),K=G.directAttribs(),y=G.directState();z.projectionMatrix=L;var W=Y._viewport;Y.setViewport(Z,0,0,$,o);var k,s,U,g;for(k=0,s=Al.length;s>k;k++)if(U=Al[k],!Oj[U].ignore&&(g=Y._40Q.get(U))){var t=g.batchIndexMap;S.renderItems(Z,z,K,y,g.opaque,t),S.renderItems(Z,z,K,y,g.transparent,t),S.renderBatch(Z,z,K,y,g.batchModelMap,t)}f.unbind(Z),Y.setViewport(Z,W[0],W[1],W[2],W[3])};S._renderDirect=function(S,T,y,c){y&&y.length&&(T.position=Nf(S,Y._buffer.vs,y,V),c?(jj(S,Y._buffer.is,c),Mo(S,0,c.length,null,c instanceof Uint32Array?S.UNSIGNED_INT:null)):Tg(S,0,y.length/3))},S.renderShapeModel=function(E,s,L,x){var X,u,z;if(Xj(L))for(u=0,z=L.length;z>u;u++)X=L[u],X&&S.renderShapeModel(E,s,X,x);else Zq(L)?S.renderShapeModel(E,s,rh(x,L),x):on(L)&&(L.shape3d?S.renderShapeModel(E,s,L.shape3d,x):S.renderShapeModelImpl(E,s,L))},S.renderShapeModelImpl=function(D,I,X){Wp(X),S._renderDirect(D,I,X.vs,X.is),S._renderDirect(D,I,X.top_vs,X.top_is),S._renderDirect(D,I,X.bottom_vs,X.bottom_is),S._renderDirect(D,I,X.from_vs,X.from_is),S._renderDirect(D,I,X.to_vs,X.to_is)},S.renderBatch=function(D,v,Q,L,m){if(!bs(m)&&!Y.drawFilter){v.modelViewMatrix=X.identity().premultiply(x).toArray();var z,h,f;for(z in m)f=Y.getBatchInfo(z)||al,f.visible!==!1&&f.shadowCast!==!1&&(h=m[z],h.invalidate&&ek(h),S._renderDirect(D,Q,h.vs32,h.is))}},S.renderItems=function(q,A,U,M,r,o){var k,R,j,p,B,g=r.length;for(k=0;g>k;k++)R=r[k],p=R.ui,j=R.data,!cb(j)&&j.s("shadow.cast")&&Y.isVisible(j)&&(o[j._id]||(B=p.shapeModel||rh(p),B||(B=j instanceof C.Node&&!(j instanceof C.Shape)?{vs:bp,is:rb}:[p.left,p.front,p.right,p.back,p.top,p.bottom]),A.modelViewMatrix=(p.mat?X.fromArray(p.mat):X.identity()).premultiply(x).toArray(),M.cullFace.enabled=!!j.s("shape3d.reverse.cull"),S.renderShapeModel(q,U,B,p)))}};tr.shaderSrc={vs:["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","void main() {","vec3 transformed = vec3( position );","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},tr.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z"];var Np=C.Light=function(){Le(Np,this),this.s(jn,a[jn]),this.s(zp,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};Yb("Light",zo,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(M,n,x){Np.superClass.onStyleChanged.apply(this,arguments),M===jn&&this.s("shape3d.color",x)}});var Ho=hg.FrameState=function(Q,g){this.renderState=Oo.for(g),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=$,this.projectMatrix=$,this.viewMatrix=$,this.view=Q,this.defaultProgram=$,this.pickColorMap=$,this._pvStack=[],this._renderStateStack=[]};Ho.prototype.savePV=function(){var e=this.view;this._pvStack.push([Od(this.projectMatrix),Od(this.viewMatrix),e._18Q,Od(e._7O)])},Ho.prototype.restorePV=function(){var k=this._pvStack.pop();if(k){var A=this.view;this.projectMatrix=A._projectMatrix=k[0],this.viewMatrix=A._viewMatrix=k[1],A._18Q=k[2],A._7O=k[3]}},Ho.prototype.setPV=function(o,J){var U=this.view,y=!1;if(o&&(this.projectMatrix=U._projectMatrix=o,y=!0),J&&(this.viewMatrix=U._viewMatrix=J,U._7O=Od(J),y=!0),y){var q=U.getWidth(),P=U.getHeight(),I=Od(this.projectMatrix);U._18Q=te(I,I,J),U._18Q._wh=q/P}},Ho.prototype.syncEnv=function(r){var F=this,G=F.view;F.envmapReflectivity=G._envmapReflectivity||.5,F.cameraPosition=G.getEye(),F.projectMatrix=G._projectMatrix,F.viewMatrix=G._viewMatrix,F.pickColorMap=r,F.picking=G.getGL()._picking},Ho.prototype.setGLState=function(){var K=[0,0,0,0],Q=[!0,!0,!0,!0],a=[-1,1],z=[ah.FUNC_ADD,ah.FUNC_ADD],d=[ah.SRC_ALPHA,ah.ONE_MINUS_SRC_ALPHA,ah.ONE,ah.ONE_MINUS_SRC_ALPHA];return function(i,W){var N=this,A=N.renderState.gl,H=N.renderState.glState;H.dither=!1,W?H.color.mask=Q:H.color.reset(),H.pixelStore.reset(),H.blend.color=K,H.blend.equation=z,H.blend.func=d,H.cullFace.enabled=!1,H.scissor.enabled=!1,H.depth.enabled=!0,H.depth.clear=1,H.depth.func=A.LEQUAL,H.depth.range=a,H.stencil.enabled=!1,H.polygonOffset.enabled=!1,i?(H.depth.mask=!1,H.blend.enabled=!0):(H.depth.mask=!0,H.blend.enabled=!1)}}(),Ho.prototype.setUniforms=function(J){var z=this,G=z.view,S=z.renderState,B=S.gl,n=S.uniforms;n.uBrightness=1,n.uOpacity=1,n.uPartOpacity=1,n.uPick=z.picking,n.uTexture=!1,n.uBlendTexture=!1,n.uAlphaTest=a.alphaTest,n.uTransparent=!!J,n.uFix=!1,n.uBatchColor=!1,n.uBatchBlend=!1,n.uBatchBrightness=!1,n.uReflectivity=z.envmapReflectivity||.5,n.uCameraPosition=z.cameraPosition,n.uPMatrix=z.projectMatrix,n.uViewMatrix=z.viewMatrix,G.bindEnvMap(B),z.picking||(iq(G,B,$),G._fogDisabled||(n.uFogColor=G._fogColor,n.uFogDensity=G._fogDensity,n.uFogNear=G._fogNear,n.uFogFar=G._fogFar))},Ho.prototype.drawLayer=function(A){return this.view.renderLayers(A,!0)},Ho.prototype.drawData=function(q,K,R){var c=this.view;if(c.isVisible(q)){var l=this.renderState,B=l.uniforms,x=c.getData3dUI(q);if(x){var H=l.gl,z=H._picking,v=c._picking,I=q._pickId;R&&(q._pickId=R),B.uPick=H._picking=c._picking=!!R,B.uTransparent=!!K,x._42(l.gl,l.program,K?Q:y),B.uPick=H._picking=z,c._picking=v,q._pickId=I}}};var Ic=hg.Graph3dView=function(v,w){var S=this;S._webGLVersion=1,S._attributes=w||B.graph3dViewAttributes,S._25I={},S._view=mk(1,S);var J=S._canvas=ob(S._view);A(J,"webglcontextlost",function(H){H.preventDefault(),Gh(S),S._26I&&S._doBufferGC(S._26I,!0),S._26I=V,S._1o.onContextLost(),S._35O=!0}),A(J,"webglcontextrestored",function(){S._35O=!1,S.iv()}),S._40Q=new Vf,S._43Q={},S._44Q=-1,S._batchIndexMap={},S._batchModelMap={},S._wireframeIndexMap={},S._wireframeModelMap={},S._wireframeIndexMapSwap={},S._wireframeModelMapSwap={},S._polylineIndexMap={},S._polylineIndexMap={},S._polylineIndexMapSwap={},S._polylineIndexMapSwap={},S._8O=[],S._7O=no(),S._6O=no(),S._1o=new qh(S),S._30O=new sm(S),S._31O=new Vk(S),S._32O=new ul(S),S._raycaster=new Vr(S),S._highlightHelper=new ee(S),S._postProcessing=new Ms(S),S._41Q=[],S._42Q=0,S.vr=new Js(S),S.shadowMap=new tr(S),S._33Q=!0,S._eye=Xn(B.graph3dViewEye),S._center=Xn(B.graph3dViewCenter),S._up=Xn(B.graph3dViewUp),S._lightChanged=!1,S._59O=[],S._spots=[],S._dirs=[],S._frameId=0,S._batchInfoMap={},S.overlappingBox=new Gf(S),S.dm(v?v:new jo),S._coreInteractor=new No(this),S.setInteractors([new se(S)]),S._initView()},Cf={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},og=0;Iq("Graph3dView",e,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",nj,Fd,"firstPersonMode",bj,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Qd,cc,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay","batchInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:B.graph3dViewSortable,_editHelperDisabled:B.graph3dViewEditHelperDisabled,_blockSelectable:B.graph3dViewBlockSelectable,_devicePixelRatio:$,_boundaries:$,_moveStep:B.graph3dViewMoveStep,_rotateStep:B.graph3dViewRotateStep,_rotateMinPhi:B.graph3dViewMinPhi===$?B.graph3dViewRotateMinPhi:B.graph3dViewMinPhi,_rotateMaxPhi:B.graph3dViewMaxPhi===$?B.graph3dViewRotateMaxPhi:B.graph3dViewMaxPhi,_pannable:B.graph3dViewPannable,_rotatable:B.graph3dViewRotatable,_walkable:B.graph3dViewWalkable,_resettable:B.graph3dViewResettable,_zoomable:B.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:B.graph3dViewFirstPersonMode,_mouseRoamable:B.graph3dViewMouseRoamable,_gridVisible:B.graph3dViewGridVisible,_gridSize:B.graph3dViewGridSize,_gridGap:B.graph3dViewGridGap,_gridColor:B.graph3dViewGridColor,_originAxisVisible:B.graph3dViewOriginAxisVisible,_centerAxisVisible:B.graph3dViewCenterAxisVisible,_axisXColor:B.graph3dViewAxisXColor,_axisYColor:B.graph3dViewAxisYColor,_axisZColor:B.graph3dViewAxisZColor,_ortho:B.graph3dViewOrtho,_orthoWidth:B.graph3dViewOrthoWidth,_fovy:B.graph3dViewFovy,_near:B.graph3dViewNear,_far:B.graph3dViewFar,_headlightColor:B.graph3dViewHeadlightColor,_headlightIntensity:B.graph3dViewHeadlightIntensity,_headlightRange:B.graph3dViewHeadlightRange,_headlightAmbientIntensity:B.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:B.graph3dViewHeadlightDisabled,_rectSelectable:B.graph3dViewRectSelectable,_rectSelectBackground:B.graph3dViewRectSelectBackground,_editSizeColor:B.graph3dViewEditSizeColor,_autoMakeVisible:cp,_fogDisabled:B.graph3dViewFogDisabled,_fogMode:B.graph3dViewFogMode,_fogDensity:B.graph3dViewFogDensity,_fogColor:B.graph3dViewFogColor,_fogNear:B.graph3dViewFogNear,_fogFar:B.graph3dViewFogFar,_pickerResolution:B.graph3dViewPickerResolution,_dashDisabled:B.graph3dViewDashDisabled,_batchColorDisabled:B.graph3dViewBatchColorDisabled,_batchBlendDisabled:B.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:B.graph3dViewBatchBrightnessDisabled,addCamera:function(h){var L=this,P=e.freeze({id:L._42Q++,priority:h.priority||0,ignoreInPick:!!h.ignoreInPick,render:h.render});h.switch3DStatus&&(L._43Q[P.id]=!0),L._41Q.push(P),L._41Q.sort(function(y,U){return y.priority!==U.priority?y.priority-U.priority:y.id-U.id})},setEye:function(h,r,I){1===arguments.length&&(r=h[1],I=h[2],h=h[0]);var W=this._eye;W[0]=h,W[1]=r,W[2]=I,this.fp(Qd,V,W)},setCenter:function(P,R,C){1===arguments.length&&(R=P[1],C=P[2],P=P[0]);var f=this._center;f[0]=P,f[1]=R,f[2]=C,this.fp(cc,V,f)},setUp:function(H,F,D){1===arguments.length&&(F=H[1],D=H[2],H=H[0]);var Z=this._up;Z[0]=H,Z[1]=F,Z[2]=D,this.fp("up",V,Z)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||Me},isTransparentMask:function(x){return x.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var K=this,F=K._aspect;return F?F:(F=K.getWidth()/K.getHeight(),F||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(z){var r=this,P=r._dataModel,i=r._selectionModel;P!==z&&(P&&(P.ump(r.handleDataModelPropertyChange,r),P.umm(r.handleDataModelChange,r),P.umd(r.handleDataPropertyChange,r),i||P.sm().ums(r.handleSelectionChange,r)),r._dataModel=z,z.mp(r.handleDataModelPropertyChange,r),z.mm(r.handleDataModelChange,r),z.md(r.handleDataPropertyChange,r),i?i._21I(z):z.sm().ms(r.handleSelectionChange,r),r._postProcessing.handleDataModleChange(P,z),r.invalidateAll(!0),r.invalidateLight(),r.fp(dq,P,z),r._canvas.style.background=z.getBackground()||"")},handleDataModelPropertyChange:function(f){if("background"===f.property){var O=this._canvas.style.background,E=f.newValue||"";this._canvas.style.background=E,this.fp("canvasBackground",O,E)}else"envmap"===f.property?this.iv():"cubicEnvmap"===f.property&&(this._lastEnvMap=$,this.iv())},handleDataPropertyChange:function(T){var a=T.data;this.invalidateData(a),cb(a)&&"s:light.type"===T.property?this.invalidateLight():"s:shadow.cast"===T.property?this.shadowMap.tryUpdateBounding(a):("s:alwaysOnTop"===T.property||"s:shape3d.alwaysOnTop"===T.property)&&(T.newValue?a.setRenderLayer("top"):a.setRenderLayer($))},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(K){var d=this,p=K.property;d.iv(),d._18Q=V,"eye"===p?d._33Q=!0:"devicePixelRatio"===p?d._42(V,d.getDevicePixelRatio()):Cf[p]&&Gh(d)},_5O:function(d){var N=d._22Q();return N?new N(this,d):V},getData3dUI:function(d){var q=this._25I[d._id];return q===$&&(q=this._5O(d),this._25I[d._id]=q),q},invalidateAll:function(C){var g=this;if(C){for(var v in g._25I){var r=g._25I[v];r&&r.dispose()}g._25I={},g.iv(),Hh(g)}else Hh(g),g.dm().each(function(q){g.invalidateData(q)})},invalidateSelection:function(){var D=this;D.sm().each(function(v){D.invalidateData(v)})},invalidateData:function(X){var K=this,y=K.getData3dUI(X);y&&(y.iv(),K.iv()),Hh(K,X)},getShape3dText:function(q){return q.getStyle("shape3d.text")||this.getLabel(q)},invalidateBatch:function(O){var M=this,D=M._40Q;D.each(function(K){M._invalidateBatch(K.batchModelMap,K.batchIndexMap,K.polylineModelMap,K.polylineIndexMap,K.wireframeModelMap,K.wireframeIndexMap,O),K.markBatchInvalid()})},_invalidateBatch:function(A,I,k,z,N,u,K){var L=this,y=A[K],r=[],O={};if(y){y.ds.forEach(function(b){var m=L.getData3dUI(b);m&&m.iv(),delete I[b._id],r.push(b._id)}),delete A[K];for(var B,v,Z,w,s,j,l,a,e,W=[N,k],H=[u,z],q=0;q<W.length;q++){var F=W[q],G=H[q];for(O={},a=0;a<r.length;a++){var Q=G[r[a]];if(Q){delete G[r[a]],e=Q.batch,B=F[e];var i=Q.begin,n=Q.size,m=3*i,g=3*n,M=4*i,D=4*n;for(v=B.ds,Z=B.vs,w=B.cs,s=B.ps,j=B.ls,l=Q.index,B.invalidate=!0,v[l]=$,l=m;m+g>l;l++)Z[l]=$;for(l=M;M+D>l;l++)w[l]=$;for(l=M;M+D>l;l++)s[l]=$;if(j)for(l=m;m+g>l;l++)j[l]=$;O[e]=!0}}for(e in O){B=F[e],v=B.ds,Z=B.vs,w=B.cs,s=B.ps,j=B.ls;var o=[];for(l=0;l<v.length;l++)v[l]!==$&&o.push(v[l]);if(0===o.length)delete F[e];else{for(B.ds=o,o=[],l=0;l<Z.length;l++)Z[l]!==$&&o.push(Z[l]);for(B.vs=o,o=[],l=0;l<w.length;l++)w[l]!==$&&o.push(w[l]);for(B.cs=o,o=[],l=0;l<s.length;l++)s[l]!==$&&o.push(s[l]);if(B.ps=o,j){for(o=[],l=0;l<j.length;l++)j[l]!==$&&o.push(j[l]);B.ls=o}}}}L.iv()}},handleDataModelChange:function(z){var n=this,a=z.kind,U=z.data;if("add"===a)n.invalidateData(U),hf(U)&&U.getEdgeGroup()&&U.getEdgeGroup().eachSiblingEdge(n.invalidateData,n),cb(U)&&n.invalidateLight();else if(a===nr){var s=U._id,O=n._25I[s];O&&(O.dispose(),delete n._25I[s],n.iv()),U===n._currentSubGraph&&n.setCurrentSubGraph(V),Hh(n,U),cb(U)&&n.invalidateLight()}else a===ac&&(n.invalidateAll(!0),n.setCurrentSubGraph(V),Hh(n),n.invalidateLight())},toCanvas:function(G,W,A){var r=this,u=r.getGL();if(r.validate(),G){var w=u.getParameter(u.COLOR_CLEAR_VALUE);nb(u,G)}r._42(V,1);var _=r.getWidth()||1,j=r.getHeight()||1,Y=new Uint8Array(4*_*j),D=ob(),n=D.getContext("2d");u.readPixels(0,0,_,j,u.RGBA,u.UNSIGNED_BYTE,Y),Yl(D,_,j,1);for(var d=n.getImageData(0,0,_,j),l=d.data,F=0;F<l.length;F+=4){var O=F/4,N=b(O/_),y=O-N*_;O=4*((j-1-N)*_+y),l[O]=Y[F],l[O+1]=Y[F+1],l[O+2]=Y[F+2],l[O+3]=Y[F+3]}if(n.putImageData(d,0,0),G&&nb(u,w),r._42(V,r.getDevicePixelRatio()),W&&A){var P=ob(),i=P.getContext("2d");return Yl(P,W,A,1),B.drawImage(i,D,0,0,W,A),P}return D},toDataURL:function(r,o){var I=this,$=I.getGL();if(I.validate(),r){var X=$.getParameter($.COLOR_CLEAR_VALUE);nb($,r)}I._42(V,1);var N=I._canvas.toDataURL(o||"image/png",1);return r&&nb($,X),I._42(V,I.getDevicePixelRatio()),N},getGL:function(){var S=this._26I;if(S)return this.acquireProgram(),S;if(!this._35O){var U=this,I=U._canvas,j=U._attributes;if(!j||j.requestWebGL2!==!1)try{S=I.getContext("webgl2",j)||I.getContext("experimental-webgl2",j),S&&(U._webGLVersion=2,U._26I=S)}catch(i){}if(!S)try{S=I.getContext("webgl",j)||I.getContext("experimental-webgl",j)}catch(i){throw new Error("WebGL not supported")}if(!S)throw new Error("WebGL not supported");U._26I=S;var e=U._frameState=new Ho(this,S);U._glExtensions=new E(S),U._glCapabilities=new f(S,U._glExtensions),U._2O={},S._emptyCubeTexture=Jo(S),S._compiledShader={},S._emptyTexture=er(S),S._emptyBlendTexture=er(S),S._bufPool={},S._id=++og,e.setGLState(),U._buffer={vs:yc(S),ns:yc(S),is:yc(S),uv:yc(S),batchColor:yc(S),batchBlend:yc(S),batchBrightness:yc(S),lineDistance:yc(S)},U._1O=Dh(S);var p=U._cube={vs:yc(S),ns:yc(S),is:yc(S),uv:yc(S)};return $j(S,p.vs,bp),$j(S,p.ns,Vo),$j(S,p.uv,th),pg(S,p.is,rb),U.acquireProgram(),S._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,frame:0,cacheTimeCost:0},S}},getGLCapabilities:function(){var S=this.getGL();return S?this._glCapabilities:void 0},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<B.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},acquireProgram:function(){var f=this,c=f._26I;if(c){var z=B.getImage(f.getEnvmap()),g=z&&z.tagName?!0:!1,k=f._prg&&f._prg.envMapFlag?!0:!1;if(!f._prg||g!==k){var u=f._prg=c.createProgram();if(!u)return V;u.envMapFlag=g;var K=f._dirs.length,r=f._spots.length,O=f._59O.length,$=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];K&&$.push("uDirColor","uDirDirection"),r&&$.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),O&&$.push("uPointColor","uPointRange","uPointPosition"),lf||(Tm=Xm(Tm.substring(0,Tm.indexOf("^#"))),el=Xm(el),lf=!0);var x=["#define MAX_DIR "+K,"#define MAX_SPOT "+r,"#define MAX_POINT "+O,f._fogDisabled?"":"#define FOG","exp2"===f.getFogMode()?"#define FOG_EXP2":"",f._dashDisabled?"":"#define DASH",g?"#define USE_ENVMAP":"",f.isOrtho()?"#define ORTHOGRAPHIC":"",f._batchColorDisabled?"":"#define BATCHCOLOR",f._batchBlendDisabled?"":"#define BATCHBLEND",f._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",f.shadowMap.enable?f.shadowMap.genShaderDefine():"",""].join("\n"),Z=Ur(c,u,c.VERTEX_SHADER,Tm.replace("PREFIX",x));c.getShaderParameter(Z,c.COMPILE_STATUS)||ck("COMPILE",c.VERTEX_SHADER,c.getError(),c.getShaderInfoLog(Z));var Y=Ur(c,u,c.FRAGMENT_SHADER,el.replace("PREFIX",x));if(c.getShaderParameter(Y,c.COMPILE_STATUS)||ck("COMPILE",c.FRAGMENT_SHADER,c.getError(),c.getShaderInfoLog(Y)),bh?$.push("aPosition"):(u.aPosition=0,c.bindAttribLocation(u,0,"aPosition")),c.linkProgram(u),!c.getProgramParameter(u,c.LINK_STATUS))return ck("LINK",c.getProgramParameter(u,c.VALIDATE_STATUS),c.getError(),c.getProgramInfoLog(u)),c.deleteProgram(u),u=V,V;$.forEach(function(L){u[L]=/^u/.test(L)?c.getUniformLocation(u,L):c.getAttribLocation(u,L)});var X=this._frameState;X.renderState.program=X.defaultProgram=u,c.deleteShader(Z),c.deleteShader(Y)}}},getBrightness:function(K){var a=K.s("brightness"),f=this.isSelected(K)?K.s("select.brightness"):V;return a==V?f:f==V?a:a*f},setHighlightMode:function(N){var j;j="selection"===N||"selected"===N?ee.Mode.Selection:"mouseover"===N||"hover"===N?ee.Mode.MouseOver:"style"===N?ee.Mode.Style:ee.Mode.Disable;var d=this._highlightHelper.mode;this._highlightHelper.mode=j,this.firePropertyChange("highlightMode",d,j)},getHighlightMode:function(){var r=this._highlightHelper.mode;return r===ee.Mode.Selection?"selected":r===ee.Mode.MouseOver?"hover":r===ee.Mode.Style?"style":"disabled"},getDataHighlightMode:function(S){return S.s("highlight.mode")},getHighlightColor:function(){return this._highlightHelper.color||a["highlight.color"]},setHighlightColor:function(F){var e=this._highlightHelper.color;this._highlightHelper.color=F,this.firePropertyChange("highlightColor",e,F)},getHighlightWidth:function(){return this._highlightHelper.width||a["highlight.width"]},setHighlightWidth:function(T){var h=this._highlightHelper.width;this._highlightHelper.width=T,this.firePropertyChange("highlightWidth",h,T)},bindEnvMap:function(A){var M=this,R=Oo.for(A),i=R.directUniforms(),Q=M.getEnvmap(),T=B.getImage(Q);if(T&&T.tagName){if(Q!==M._lastEnvMap){var F={};if(M.dm().isCubicEnvmap()){var x=Fe(T),o=Dm(T);if(0===x||0===o)return;var $=x/4,H=o/3,C={top:{x:$,y:0},left:{x:0,y:H},front:{x:$,y:H},right:{x:2*$,y:H},back:{x:3*$,y:H},bottom:{x:$,y:2*H}};["top","left","front","right","back","bottom"].forEach(function(M){var h=C[M],Q=F[M]=ob();Yl(Q,$,H,1);var i=ye(Q);i.drawImage(T,h.x,h.y,$,H,0,0,$,H),i.restore(),F[M]=B.resizeImagePOT(Q,!0)})}else T=B.resizeImagePOT(T,!0);M._envMapTexture&&A.deleteTexture(M._envMapTexture);var p=M._envMapTexture=A.createTexture();A.activeTexture(A.TEXTURE0),A.bindTexture(A.TEXTURE_CUBE_MAP,p),A.texParameteri(A.TEXTURE_CUBE_MAP,A.TEXTURE_MAG_FILTER,A.LINEAR),A.texParameteri(A.TEXTURE_CUBE_MAP,A.TEXTURE_MIN_FILTER,A.LINEAR),A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,F.right||T),A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,F.left||T),A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,F.top||T),A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,F.bottom||T),A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,F.front||T),A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,F.back||T),A.bindTexture(A.TEXTURE_CUBE_MAP,A._emptyCubeTexture),M._lastEnvMap=Q}i.uEnvMap=M._envMapTexture}},getWireframe:function(j){var c=j.s("wf.visible"),n=j.s("wf.width");return c===!0||n>0&&"selected"===c&&this.isSelected(j)?{color:j.s("wf.color"),width:n,"short":j.s("wf.short"),mat:j.s("wf.mat")}:void 0},_transformPointToViewSpace:function(K){var t=[K[0],K[1],K[2]];return rq(t,this._viewMatrix),t},_transformDirectionToViewSpace:function(c,D){var B=[c[0],c[1],c[2]];rq(B,this._viewMatrix);var O=D?[D[0],D[1],D[2]]:[0,0,0];rq(O,this._viewMatrix);var T=O[0]-B[0],Z=O[1]-B[1],F=O[2]-B[2],h=Math.sqrt(T*T+Z*Z+F*F);return h?[T/h,Z/h,F/h]:[T,Z,F]},getWireframeGeometry:function(D){return D.s("wf.geometry")?{color:D.s("wf.color"),width:D.s("wf.width"),mat:D.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function($){return $.s("body.color")},getMat:function(Q){return Q.getMat?Q.getMat():Q.s("mat")},getFaceMat:function(p,F){return p.getFaceMat?p.getFaceMat(F):p.s(F+".mat")},getFaceBlend:function(X,p){return X.s(p+".blend")||X.s("all.blend")},getFaceColor:function(m,B){return m.s(B+".color")||m.s("all.color")},getFaceImage:function(e,B){return e.s(B+".image")||e.s("all.image")},getFaceBlendImage:function(i,S){return i.s(S+".blend.image")||i.s("all.blend.image")},getFaceDiscardSelectable:function(o,W){var C=o.s(W+".discard.selectable");return C==V?o.s("all.discard.selectable"):C},getFaceUv:function(i,t){return i.s(t+".uv")||i.s("all.uv")},getFaceUvOffset:function(c,R){return c.s(R+".uv.offset")||c.s("all.uv.offset")},getFaceUvScale:function(B,$){return B.s($+".uv.scale")||B.s("all.uv.scale")},getFaceUvRotation:function(V,H){return V.s(H+".uv.rotation")||V.s("all.uv.rotation")},getFaceLight:function(J,F){var Q=J.s(F+".light");return Q==V?J.s("all.light"):Q},getFaceVisible:function(N,$){var j=N.s($+".visible");return j==V?N.s("all.visible"):j},getFaceOpacity:function(S,Y){var N=S.s(Y+".opacity");return N==V?S.s("all.opacity"):N},getFaceTransparent:function(m,J){var Z=m.s(J+".transparent");return Z==V?m.s("all.transparent"):Z},getFaceReverseColor:function(O,z){return O.s(z+".reverse.color")||O.s("all.reverse.color")},getFaceReverseFlip:function(H,P){var J=H.s(P+".reverse.flip");return J==V?H.s("all.reverse.flip"):J},getFaceReverseCull:function(O,_){var d=O.s(_+".reverse.cull");return d==V?O.s("all.reverse.cull"):d},getTextureMap:function(){return this._2O},deleteTexture:function(u){var n=this,p=n._2O[u];p&&(delete n._2O[u],n.getGL().deleteTexture(p))},renderPickScene:function(){var J=this.getGL();this._picking=J._picking=!0,this.renderScene(),this._picking=J._picking=!1},invalidateCachedTexture:function(d){var z=this.getData3dUI(d);z.invalidateCachedTexture(this.getGL()),this.invalidateData(d)},invalidateShape3dCachedImage:function(Q){this.invalidateCachedTexture(Q)},invalidateCachedGeometry:function(l){var J=this.getData3dUI(l);J.invalidateCachedGeometry(),this.invalidateData(l)},isInteractive:function(A){return A.s("interactive")},getTexture:function(J,Z,k){if(!J)return V;var E=this,F=E.getGL(),G=E._2O[J];if(!G){var e=Cc(J),I={};if(!e)return F._emptyTexture;if(Z){I.mipmapMaxLevel=Z.s("texture.mipmap.max");var M=Z.s("texture.wrap");I.clampToEdge="clampToEdge"===M?!0:"repeat"===M?!1:$}if(e.uuid||(e.uuid=C.Math.generateUUID()),e.tagName){if(e.dynamic)return Dh(F,e,E._1O,I);G=E._2O[J]=Dh(F,e,$,I)}else{var t,y=Z&&(Z.s("texture.cache")||Z.s("shape3d.image.cache")||e.textureCache),U=E.vr.isPresenting();if(U&&(Z._textureUpdateFrame===F._renderInfo.frame?y=!0:Z._textureUpdateFrame=F._renderInfo.frame),y&&(t=E.getData3dUI(Z),G=t.getCachedTexture(k),G&&t.interactiveInfo&&G.interactiveInfo&&(t.interactiveInfo[G.interactiveInfo.key]=G.interactiveInfo.info)),!G){var T=F._renderInfo.textureCache;if(y){if(T.time>B.graph3dMaxVectorCacheTime)return E.redraw(),F._emptyTexture;if(!vl(e,Z))return F._emptyTexture}var N;Z&&(1!==Z.s("texture.scale")?N=Z.s("texture.scale"):1!==Z.s("shape3d.texture.scale")&&(N=Z.s("shape3d.texture.scale"))),N||(N=1);var _=Z&&(Z.s("fixSizeOnScreen")||Z.s("shape3d.fixSizeOnScreen")),f=_?F.NEAREST:F.LINEAR;_?"number"==typeof _&&(N*=0>_?1:_):Z&&(Z.s("vector.dynamic")||Z.s("shape3d.vector.dynamic"))&&(t||(t=E.getData3dUI(Z)),_=t.getVectorDynamicSize());var Y,p,K,W=Z&&Z.s("shape3d");"billboard"===W?K=Z.getTall()/Z.getWidth():"plane"===W&&(K=Z.getHeight()/Z.getWidth());var o=Fe(e,Z);if(_){var d;d=y?E._devicePixelRatio||Me:E.getDevicePixelRatio(),Y=_[0]>0?_[0]*d:N*o*d,p=_[1]>0?_[1]*d:N*(K?Dm(e,Z,E,Math.min(4096,o*K)):Dm(e,Z))*d}else Y=N*o,p=N*(K?Dm(e,Z,E,Math.min(4096,o*K)):Dm(e,Z));if(Y>=1&&p>=1){var v=0;(y||U)&&(v=Date.now());var g=E._glCapabilities.maxTextureSize;Y=Math.min(Y,g),p=Math.min(p,g);var i=oe(Y,p);if(!t&&Z&&(t=E.getData3dUI(Z)),t&&t.interactiveInfo){var l=J;"object"==typeof l&&(l=l.uuid||(l.uuid=C.Math.generateUUID()));var h=t.interactiveInfo[l]={};i.interactiveInfo=h.bodyInfo={compInfos:[],matrix:new Ge,rect:{x:0,y:0,width:Y,height:p}}}em(i,e,0,0,Y,p,Z,E),i.interactiveInfo&&(i.interactiveInfo=null),i.restore(),T.count++,T.pixels+=Y*p,Z?(I.minFilter=Ln(Z.s("texture.filter.min")||Z.s("texture.filter"))||f,I.magFilter=Ln(Z.s("texture.filter.mag")||Z.s("texture.filter"))||f):I.minFilter=I.magFilter=f,y||U?(G=Dh(F,Zf,null,I),t.setCachedTexture(G,k),T.time+=Date.now()-v,h&&(G.interactiveInfo={key:l,info:h}),Zf=null):G=Dh(F,Zf,E._1O,I)}}}}return G},redraw:function(){this.iv()},validateImpl:function(){var O=this;if(O._lightChanged){O._lightChanged=!1;var f=[],n=[],U=[];O.dm().each(function(L){if(cb(L)){var s=L.s("light.type");s===il?f.push(L):s===tf?n.push(L):s===bc&&U.push(L)}}),(f.length!==O._59O.length||n.length!==O._spots.length||U.length!==O._dirs.length)&&Gh(O),O._59O=f,O._spots=n,O._dirs=U}O._42(),O._1o.iv()},getRenderInfo:function(){var q=this.getGL();return q?q._renderInfo:void 0},getDebugTip:function(){var k=this,K=k.getRenderInfo();if(K){var i=k.getGL()._validBufCount||0,v="Draw Calls: "+K.calls+"<br/>"+"Vertices: "+K.vertices+"<br/>"+"Faces: "+K.faces+"<br/>"+"Lines: "+K.lines+"<br/>"+(K.points?"Points: "+K.points+"<br/>":"")+"Buffers: "+i+"<br/>"+"Cache Models: "+e.keys(qg).length+"<br/>"+"Shape3d Models: "+e.keys(Qc).length;if(k.vr.isPresenting()&&(v+="<br/>VR fps: "+k.vr.getFps()),K.textureCache){var g=K.textureCache.count;if(v+="<br/>2D Dynamic Textures: "+K.textureCache.count,g>0){var q,y=K.textureCache.pixels;q=y>1e6?Math.round(y/1e6)+"M":y>1e3?Math.round(y/1e3)+"K":Math.round(y),v+="<br/>2D Dynamic pixels: "+q}}return v}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var g=new C.Math.Box3,t=new C.Math.Matrix4;return function(E){var c=E;if(c instanceof C.Data&&(c=this.getData3dUI(c)),!c.mat)return!0;var Q=c.getBoundingBox();g.copy(Q).applyMatrix4(t.fromArray(c.mat));var r=this.getFrustum();return r.intersectsBox(g)}}(),updateScene:function(){var h=this;h._81O=V,h.overlappingBox.clear();var k=h._40Q;k.init();var n=h.getGL(),O=h.dm();if(O.isHierarchicalRendering())O.eachByHierarchical(function(R){var $=h.getData3dUI(R);$&&$.update(h,n,k)});else{var r,g,Z,W=O.getDatas().getArray(),m=W.length;for(r=0;m>r;r++)g=W[r],Z=h.getData3dUI(g),Z&&Z.update(h,n,k)}k.onUpdated()},renderScene:function(){function x(A,h){z.setGLState(A,h),z.setUniforms(A),z.renderState.attribs.disable(),L=b.directUniforms(),y=b.directAttribs(),y.disable()}function Y(b){for(;U>v;v++){var N=j[v];if(!A||!N.ignoreInPick){if(N.priority>=b)break;(!Z._43Q[Z._44Q=N.id]||En[Bm.length])&&(N.render(G,Z,z),x())}}}var Z=this;Z.shadowMap.render(),Z._44Q=-1;var y,z=Z._frameState,b=z.renderState,H=b.glState,L=b.directUniforms(),G=Z.getGL(),T=Z._prg;b.syncLoss(),Z._projectMatrix=Te(Z),ud(Z,Z._7O),Z._viewMatrix=Od(Z._7O),te(Z._projScreenMatrix=no(),Z._projectMatrix,Z._viewMatrix),z.syncEnv(this._picking?this.pickColorMap:$),b.useProgram(T),x(!1,!0),G.clear(G.DEPTH_BUFFER_BIT);var A=Z._picking,j=this._41Q,v=0,U=j.length;if(Y(B.cameraPriority.skybox),A){var K=H.color.clear.slice(0);nb(G,[0,0,0,0])}else nb(G,[0,0,0,0]),H.blend.enabled=!1,H.depth.enabled=!1,H.depth.mask=!1,Z.drawSky(G,T),Z.drawReflectors(G)&&(Z._projectMatrix=Te(Z),ud(Z,Z._7O),Z._viewMatrix=Od(Z._7O),z.syncEnv(),x()),H.blend.enabled=!1,H.depth.enabled=!0,H.depth.mask=!0,L.uTransparent=!1,Z._31O._42(G,T);if(!G.textureBatch||En[(ONE_FRAME_TIME-6)/2]){!A&&Z.shadowMap.enable&&Z.shadowMap.createShadow(L);
for(var a=0,Q=Al.length;Q>a;a++){var w=Al[a],O=Oj[w];if(!O.ignore){var t=O.priority;Y(t),this.renderLayer(w)}}H.depth.enabled=!1,L.uTransparent=!1,L.shadowReceive=!1,A?Z.drawFilter||Z._30O._42(G,T):(H.blend.enabled=!1,H.depth.mask=!0,Z._32O._42(G,T),Z._30O._42(G,T),Z._highlightHelper._42(G,T)),H.depth.enabled=!0,Y(B.cameraPriority.infinity),A&&nb(G,K),$j(G,V),pg(G,V),Z._44Q=-1}},renderLayers:function(D,S){S&&(D=Vc(D));for(var $=0,L=D.length;L>$;$++)this.renderLayer(D[$])},renderLayer:function(q){var C=this,F=C._picking,J=C._40Q.get(q);if(J){var d=C.getGL(),k=C._frameState,R=k.renderState,N=R.glState,K=R.directUniforms();!F&&C.isSortable()&&J.sort(C._sortFunc,C._projScreenMatrix);var l,o,j,S=J.opaque,V=J.transparent,x=J.batchModelMap,u=J.polylineModelMap,b=J.wireframeModelMap,d=C.getGL(),i=C._prg;F||(N.blend.enabled=!1,N.depth.enabled=!0,N.depth.mask=!0),K.uTransparent=!1,Oj[q].clearDepth!==!1&&d.clear(d.DEPTH_BUFFER_BIT);var g=this.drawFilter;if(g)for(j=S,l=0,o=j.length;o>l;l++)g(j[l].data)!==!0&&j[l].ui._42(d,i,y);else{for(j=S,l=0,o=j.length;o>l;l++)j[l].ui._42(d,i,y);if(F)for(j=V,l=0,o=j.length;o>l;l++)j[l].ui._46Q(d);hn(C,x),_r(C,u),_r(C,b)}if(F||(N.blend.enabled=!0,N.depth.mask=!1),C._45Q=K.uTransparent=!0,g)for(j=V,l=0,o=j.length;o>l;l++)g(j[l].data)!==!0&&j[l].ui._42(d,i,Q);else{for(j=V,l=0,o=j.length;o>l;l++)j[l].ui._42(d,i,Q);hn(C,x,null,!0),_r(C,u,null,!0),_r(C,b,null,!0)}C._45Q=null}},drawV2:function(Q){var D=this;if(!D._35O&&(!Ef||En(Ef))){var p=D.getWidth(),C=D.getHeight();if(p&&C){var I=D.getGL();if(I){var B,_=D._canvas;if(Q?B=!0:Q=D.getDevicePixelRatio(),!D._picking&&(B||p!==_.clientWidth||C!==_.clientHeight)){Yl(_,p,C,Q);var N=Q;p&&Math.abs(I.drawingBufferWidth-p*Q)>1&&(N=Math.min(N,I.drawingBufferWidth/p)),C&&Math.abs(I.drawingBufferHeight-C*Q)>1&&(N=Math.min(N,I.drawingBufferHeight/C)),N!==Q&&(D.setDevicePixelRatio(Q=N),Yl(_,p,C,Q)),D._18Q=null}I.clear(I.COLOR_BUFFER_BIT);var f=I._renderInfo;f.calls=0,f.vertices=0,f.faces=0,f.lines=0,f.points=0,f.textureCache={time:0,count:0,pixels:0},f.frame=++D._frameId,f.cacheTimeCost=0,f.reflectDepth=0,p*=Q,C*=Q;do{if(D.vr.enable&&D.vr.render(I,p,C))break;if(D.updateScene(),D._postProcessing.render(I,p,C))break;D.setViewport(I,0,0,p,C),D.renderScene()}while(!1);D._33Q=!1,D.countFrame(),D._doBufferGC(I)}}}},_42:function(z,$){return this.drawV2($)},drawReflectors:function(S){S._renderInfo.reflectDepth++;var G,g,V,m=this,T=m._dataModel.getReflectors(),P=!1;for(G in T)g=T[G],m.isVisible(g)&&(V=m.getData3dUI(g),V&&V.drawReflector(S)&&(P=!0));return S._renderInfo.reflectDepth--,P},isReflecting:function(G){return G._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(a,O){return this._postProcessing.enableModule(a,O)},getPostProcessingModule:function(j){return this._postProcessing.getModule(j)},getPostProcessingValue:function(X,H){var O=this._postProcessing.getModule(X);return O?O[H]:$},setPostProcessingValue:function(w,J,R){var M=this.getPostProcessingValue(w,J),p=this._postProcessing.getModule(w);p&&M!==R&&("enable"===J?this.enablePostProcessing(w,R):p[J]=R,this.firePropertyChange("postProcessing."+w+"."+J,M,R))},setViewport:function(z,Y,A,B,I){this._viewport=[Y,A,B,I],Oo.for(z).directState().viewport=this._viewport},getRenderState:function(){return Oo.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(u){this._bufferGCInterval=u},_doBufferGC:function(r,V){var O,F,t=r._bufPool,v=0,N=0,W=r._renderInfo.frame,z=this._bufferGCInterval||10;for(O in t)v++,F=t[O],F&&(V||W-F._fid>z?(r.deleteBuffer(F._buf),F._buf=null,t[O]=null):N++);if(v/2>N&&v>128){var U={};for(O in t)t[O]&&(U[O]=t[O]);r._bufPool=U}r._validBufCount=N},_swapLineMap:function(){var X=this;fk=X._polylineModelMap,X._polylineModelMap=X._polylineModelMapSwap,X._polylineModelMapSwap=fk,fk=X._wireframeModelMap,X._wireframeModelMap=X._wireframeModelMapSwap,X._wireframeModelMapSwap=fk,fk=X._polylineIndexMap,X._polylineIndexMap=X._polylineIndexMapSwap,X._polylineIndexMapSwap=fk,fk=X._wireframeIndexMap,X._wireframeIndexMap=X._wireframeIndexMapSwap,X._wireframeIndexMapSwap=fk},_updateSkybox:function(h){if(this._skybox&&h){var G=h.property,m=!1,x=this._skybox;if("eye"===G||"forceUpdate"===G){var g=this._eye;x.p3(g[0],g[1],g[2]),m=!0}if("near"===G||"far"===G||"forceUpdate"===G){var t=this._near,S=this._far,y=x.getFinalScale3d();if(y[0]/=2,y[1]/=2,y[2]/=2,y[0]<=t||y[0]>=S||y[1]<=t||y[1]>=S||y[2]<=t||y[2]>=S){var u=2*t*S/(t+S),r=Math.min(y[0],y[1],y[2]),E=u/r,D=x.getScale3d();x.setScale3d(D[0]*E,D[1]*E,D[2]*E),m=!0}}m&&this.invalidateData(x)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(d){return this.setSkybox(d)},getSkybox:function(){return this._skybox},setSkybox:function(U){var i=this._skybox;return i===U?(U&&this._updateSkybox({property:"forceUpdate"}),void 0):(i&&(this._skyboxStyleMap&&i.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&i.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&i.p3(this._skyboxP3),this._skyboxP3=null),this._skybox=U,this.ump(this._updateSkybox,this),U&&(U.dm()&&U.dm().remove(U),this._skyboxStyleMap=C.Default.clone(U.getStyleMap()),this._skyboxAnchor3d=U.getAnchor3d(),U.setAnchor3d(.5,.5,.5),this._skyboxP3=U.p3().slice(0),U.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})),this.fp("skybox",i,U),void 0)},drawSky:function(v,h){var l=this,c=l._skybox;if(c){var K=Oo.for(v).directUniforms(),L=l._headlightIntensity,e=xs(l._headlightColor),h=l._prg;1!==L&&(e=[e[0]*L,e[1]*L,e[2]*L]),K.uHeadlightColor=[e[0],e[1],e[2],1];var E=l.getData3dUI(c);if(E){var S=l.isOrtho(),Q=S||this._computedProjectMatrix;if(Q){var k=l._projectMatrix;S&&(l._ortho=!1),K.uPMatrix=l._projectMatrix=Te(l,!0)}var Z=c.p3(),U=this._eye;(Z[0]!==U[0]||Z[1]!==U[1]||Z[2]!==U[2])&&(c._position.x=U[0],c._54O=U[1],c._position.y=U[2]),E.validate(),E._42(v,h,u),Q&&(S&&(l._ortho=!0),K.uPMatrix=l._projectMatrix=k)}v.clear(v.DEPTH_BUFFER_BIT),K.uHeadlightColor=[e[0],e[1],e[2],l._headlightDisabled?1:0]}},getLogicalPoint:function(n){return Kf(n,this._canvas)},isRectOverlapping:function(T){var o=this.getData3dUI(T);return o._rectOverlapping},getHitFaceInfo:function(G){G.target&&(G=this.lp(G));var W=this.getDataInfoAt(G);if(W){var E=this.intersectObject(G,W.data);if(E)return{data:W.data,face:E.part}}return V},unproject:function(e,O){var c=this,B=c.getWidth(),R=c.getHeight(),j=e.target?c.lp(e):e,b=j.x-B/2,I=j.y-R/2,X=2*(b/B),Y=2*(-1*I/R);O=O||0;var G=no(),E=Te(c),_=ud(c);te(G,E,_),Zi(G);var V=Vh([X,Y,O,1],G);return[V[0]/V[3],V[1]/V[3],V[2]/V[3]]},getDataAt:function(h){var B=this.getDataInfoAt(h);return B?B.data:V},getDataInfoAt:function(Z,y,m){return Z.target&&(Z=this.lp(Z)),this._1o.get(Aj(Z.x,Z.y,y),!0,m)},getDatasInRect:function(y){return this._1o.get(y)},setEditable:function(j){var k=this,S=k._editable;k._editable=j,this.fp(As,S,j)},isEditable:function(z){var f=this;return z?f._editable?Zb(z)?z.s("3d.editable")?f._editableFunc?f._editableFunc(z):!0:!1:!1:!1:f._editable},isSelectable:function(G){return G.s("3d.selectable")&&this.sm().isSelectable(G)},isMovable:function(y){var R=this;return hf(y)&&y.getStyle(mf)!==Jd?!1:y.s("3d.movable")?R._movableFunc?R._movableFunc(y):!0:!1},isSizeEditable:function(Z){return Zb(Z)?this._sizeEditableFunc?this._sizeEditableFunc(Z):!0:!1},isRotationEditable:function(T){return Zb(T)&&T.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(T):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(X){this.setZoom(kf,X)},zoomOut:function(B){this.setZoom(1/kf,B)},setZoom:function(){var $=new Qe,b=new Qe,V=new Qe,L=new Qe;return function(q,D){if(1!==q){var y=this;y._14o&&y._14o.stop(!0);var H,z=1/q;$.copy(y.getCenter()),b.copy(y.getEye());var w=y._ortho;if(w){if(H=y._orthoWidth,H<y._moveStep&&q>1)return}else if($.distanceTo(b)<y._moveStep&&1>z)return;var g=!1;return y._zoomToCenter===!1&&y._lastZoomLP&&(V.copy(b).sub($).normalize(),y._81O=null,L.copy(y.getHitPosition(y._lastZoomLP,$.toArray(),V.toArray())),g=!0,y._lastZoomHit=L),(D=Vi(D))?(D.action=function(M){y.fi({kind:y._zooming?"betweenZoom":"beginZoom"}),y._zooming=1;var A=(z-1)*M+1;w&&y.setOrthoWidth(H*A),g?(y.setEye(V.lerpVectors(L,b,A).toArray()),y.setCenter(V.lerpVectors(L,$,A).toArray())):y.setEye(V.lerpVectors($,b,A).toArray())},D._37o=function(){delete y._14o,delete y._zooming,y.fi({kind:"endZoom"}),y.onZoomEnded()},y._14o=Tp(D)):(w&&y.setOrthoWidth(H*z),g?(y.setEye(V.lerpVectors(L,b,z).toArray()),y.setCenter(V.lerpVectors(L,$,z).toArray())):w||y.setEye(V.lerpVectors($,b,z).toArray()),void 0)}}}(),setOrthoZoom:function(X,o){return this.setZoom(X,o)},getPositionInfo:function(Z){var q=this,V=q._eye,P=q._center,p=q.getAspect(),f=Z?Dr(Fq(P,V,!0),Fq(Z,V)):Lf(V,P);if(q._ortho){var M=q._orthoWidth;return{length:f,height:M/p,width:M}}var c=2*z(q._fovy/2)*f;return{length:f,height:c,width:c*p}},getCenterInfo:function(){var J=this;return J._81O||(J._81O=J.getPositionInfo()),Xn(J._81O)},rotate:function(y,v,$,K){var L=this;if(y||v){K==V&&(K=L._firstPersonMode),L._88O&&L._88O.stop(!0);var q=L._center,m=L._eye,S=L.getCenterInfo().length,s=K?q:m,o=K?m:q,c=Fq(s,o),r=I(c[0],c[2]),f=I(j(c[0]*c[0]+c[2]*c[2]),c[1]),H=K?cc:Qd;return K&&(v=-v),($=Vi($))?($.action=function(Y){L.fi({kind:L._rotating?"betweenRotate":"beginRotate"}),L._rotating=1;var G=r+y*Y,x=f+v*Y;x=K?Z-Dl(L,Z-x):Dl(L,x),c[0]=S*w(x)*w(G),c[1]=S*D(x),c[2]=S*w(x)*D(G),s[0]=o[0]+c[0],s[1]=o[1]+c[1],s[2]=o[2]+c[2],L.fp(H,V,s)},$._37o=function(){delete L._88O,delete L._rotating,L.fi({kind:"endRotate"}),L.onRotateEnded()},L._88O=Tp($)):(r+=y,f+=v,f=K?Z-Dl(L,Z-f):Dl(L,f),c[0]=S*w(f)*w(r),c[1]=S*D(f),c[2]=S*w(f)*D(r),s[0]=o[0]+c[0],s[1]=o[1]+c[1],s[2]=o[2]+c[2],L.fp(H,V,s),void 0)}},pan:function(X,m,o,g){if(X||m){var q=this;g==V&&(g=q._firstPersonMode),q._89O&&q._89O.stop(!0);var L=ud(q),Y=[L[0]*X,L[4]*X,L[8]*X],x=[L[1]*m,L[5]*m,L[9]*m],T=Y[0]+x[0],$=Y[1]+x[1],U=Y[2]+x[2],f=q._center,k=q._eye;if(g){var n=ie(q.getBoundaries(),k[0],k[2],k[0]+T,k[2]+U,j(T*T+U*U));T=n[0],U=n[1]}if(o=Vi(o)){var Z=Xn(k),l=Xn(f);return o.action=function(F){q.fi({kind:q._panning?"betweenPan":"beginPan"}),q._panning=1,f[0]=l[0]+T*F,f[1]=l[1]+$*F,f[2]=l[2]+U*F,k[0]=Z[0]+T*F,k[1]=Z[1]+$*F,k[2]=Z[2]+U*F,q.fp(Qd,V,k),q.fp(cc,V,f)},o._37o=function(){delete q._89O,delete q._panning,q.fi({kind:"endPan"}),q.onPanEnded()},q._89O=Tp(o)}f[0]+=T,f[1]+=$,f[2]+=U,k[0]+=T,k[1]+=$,k[2]+=U,q.fp(Qd,V,k),q.fp(cc,V,f)}},walk:function(B,M,J){if(B){var i=this;J==V&&(J=i._firstPersonMode),i._90O&&i._90O.stop(!0);var $=i._center,c=i._eye,l=Fq($,c,!0);if(J){var P=ie(i.getBoundaries(),c[0],c[2],c[0]+l[0]*B,c[2]+l[2]*B,r(B));if(B=Lf(P),!B)return;l=[P[0]/B,0,P[1]/B]}if(M=Vi(M)){var t=Xn(c),C=Xn($);return M.action=function(N){i.fi({kind:i._walking?"betweenWalk":"beginWalk"}),i._walking=1;var A=B*N;c[0]=t[0]+l[0]*A,c[1]=t[1]+l[1]*A,c[2]=t[2]+l[2]*A,$[0]=C[0]+l[0]*A,$[1]=C[1]+l[1]*A,$[2]=C[2]+l[2]*A,i.fp(Qd,V,c),i.fp(cc,V,$)},M._37o=function(){delete i._90O,delete i._walking,i.fi({kind:"endWalk"}),i.onWalkEnded()},i._90O=Tp(M)}c[0]+=l[0]*B,c[1]+=l[1]*B,c[2]+=l[2]*B,$[0]+=l[0]*B,$[1]+=l[1]*B,$[2]+=l[2]*B,i.fp(Qd,V,c),i.fp(cc,V,$)}},handleScroll:function(h,M){h.preventDefault();var p=this,Z=p._moveStep,m=p.getDataInfoAt(h);if(m){var s=m.data;if(s&&p.isInteractive(s)){var J=p.intersectObject(h,s);if(J){var b=J.part,t=Cc(s.s(b+".image")||s.s("shape3d."+b+".image")||s.s("all.image")||s.s("shape3d.image"));if(t&&Th(t.scrollable,s,p))return}}}return p.isFirstPersonMode()?(p.isPannable()&&p.pan(0,M>0?Z:-Z),void 0):(p.isZoomable()&&(p._lastZoomLP=p.lp(h),p.setZoom(0>M?1/bg:bg),p._lastZoomLP=p._lastZoomHit=null),void 0)},handlePinch:function(o,$){if(this.isZoomable()){if(Math.abs(o-$)<B.pinchZoomThreshold)return;this.setZoom($>o?1/sf:sf)}},reset:function(){this.setCenter(B.graph3dViewCenter),this.setEye(B.graph3dViewEye),this.setUp(B.graph3dViewUp)},moveSelection:function(d,k,j){var P=this;P.dm().beginTransaction(),lh(this.sm().toSelection(this.isMovable,this),d,k,j),P.dm().endTransaction()},getMoveMode:function(R,M){var X=M.s("3d.move.mode");if(X)return X;var D="88",u="89",W="90";return Fk(R)||vm[D]&&vm[u]&&vm[W]?"xyz":vm[D]&&vm[u]?"xy":vm[D]&&vm[W]?"xz":vm[u]&&vm[W]?"yz":vm[D]?"x":vm[u]?"y":vm[W]?"z":"xz"},handleTick:function(){var u=this,G=!1,P=u._moveStep,y=P,m=!1,T=!0,F=u._rotateStep*(T?-1:1);if(u.isWalkable()||(y=0),u.isPannable()||(P=0),u.isRotatable()||(F=0),u._32Q){var R=(Gc()-u._32Q)/50;y*=R,P*=R,F*=R}u._31Q&&(xl(u._31Q),delete u._31Q,delete u._32Q),xk()&&(G=!0,u.pan(-P,0,m,T)),gb()&&(G=!0,u.pan(P,0,m,T)),tj()&&(G=!0,Fk()?u.pan(0,P,m,T):u.walk(y,m,T)),Je()&&(G=!0,Fk()?u.pan(0,-P,m,T):u.walk(-y,m,T)),Yg()&&(G=!0,u.rotate(-F,0,m,T)),hq()&&(G=!0,u.rotate(F,0,m,T)),Xe()&&(G=!0,u.rotate(0,-F/2,m,T)),Xh()&&(G=!0,u.rotate(0,F/2,m,T)),G&&(u._32Q=Gc(),u._31Q=aq(u.handleTick,u))},handleKeyDown:function(V){var J=this;!kj(V)&&sr[V.keyCode]?J.handleTick():$g(V)?J.selectAll():Ab(V)?J.handleDelete(V):uo(V)&&this.isResettable()&&J.reset()},checkDoubleClickOnNote:function(v,o,B){var p=this;if(B===Bq){if(o.s("note.toggleable"))return o.s(Zo,!o.s(Zo)),p.fi({kind:"toggleNote",event:v,data:o,part:B}),!0}else if(B===ho&&o.s("note2.toggleable"))return o.s(Ne,!o.s(Ne)),p.fi({kind:"toggleNote2",event:v,data:o,part:B}),!0;return!1},checkDoubleClickOnRotation:function(l,H,s){return s===so?(H.setRotationX(0),!0):s===xe?(H.setRotationY(0),!0):s===Cq?(H.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(q){var M=this;if(M.isOrtho())return M.getWidth()/M.getOrthoWidth();var V=M.getCenter(),R=M.getHeight(),J=M.getEye(),y=[V[0]-J[0],V[1]-J[1],V[2]-J[2]],b=[q[0]-J[0],q[1]-J[1],q[2]-J[2]],u=Math.sqrt(y[0]*y[0]+y[1]*y[1]+y[2]*y[2]),U=1/Math.tan(M.getFovy()/2);return R*u*U/(b[0]*y[0]+b[1]*y[1]+b[2]*y[2])},inViewSpace:function(d){var w,n=this,m=n._transformPointToViewSpace(d),k=n.getAspect(),q=n.getNear(),K=n.getFar();return-m[2]<q||-m[2]>K?!1:n.isOrtho()?(w=n.getOrthoWidth()/2,Math.abs(m[0])<=w&&Math.abs(m[1]*k)<=w):(w=Math.sqrt(m[0]*m[0]+m[1]*m[1]+m[2]*m[2])*Math.tan(n.getFovy()/2),Math.abs(m[1]<=w)&&Math.abs(m[0])<=w*k)},getPVMatrix:function(){var i,y=this;return(i=y._18Q)||(i=Te(y),y._18Q=te(i,i,ud(y)),y._18Q._wh=y.getWidth()/2/y.getHeight()),i},getFrustum:function(){var _=new hb,l=new as,Y=new Array(16);return function(){for(var $=this.getPVMatrix(),b=!1,a=0;16>a;a++)$[a]!==Y[a]&&(b=!0,Y[a]=$[a]);return b&&l.setFromMatrix(_.fromArray($)),l}}(),toViewPosition:function(W){var s=this,Y=s.getWidth()/2,v=s.getHeight()/2,E=s.getPVMatrix();return W=Vh([W[0],W[1],W[2],1],E),{x:Y+Y*W[0]/W[3],y:v-v*W[1]/W[3],z:W[2]/W[3]}},getHitPosition:function(X,o,H){var i=this,K=i.getWidth(),t=i.getHeight(),y=X.target?i.lp(X):X,x=y.x-K/2,w=y.y-t/2,V=i.getCenterInfo(),Z=ud(i);o=o?o:[0,0,0],H=H?H:[0,1,0],x=x/K*V.width,w=-1*w/t*V.height;var E=[Z[0]*x,Z[4]*x,Z[8]*x],v=[Z[1]*w,Z[5]*w,Z[9]*w],n=[E[0]+v[0],E[1]+v[1],E[2]+v[2]],q=i.getCenter(),d=hl(i,o,H,[n[0]+q[0],n[1]+q[1],n[2]+q[2]]);return d?d:[0,0,0]},intersectObject:function(V,h){return this._raycaster.intersectObject(V,h)},intersectObjects:function(G,v,C){return this._raycaster.intersectObjects(G,v,C)},getLineLength:function(T){this.validate();var c=this.getData3dUI(T);if(c&&c.getCache){var l=c.getCache();if(l)return l[l.length-1].length}return 0},getLineOffset:function(b,q){var j=this.getData3dUI(b);if(j&&j.getCache){var d=j.getCache();if(d){var a=or(d,q);if(!b.r3)return a;var C=b.r3();if(0===C[0]&&0===C[1]&&0===C[2])return a;var M=new Qe(b.p3()),A=new Qe(a.point).sub(M),n=new Qe(a.tangent).add(A),W=(new fh).setFromEuler(new of(C,b.getRotationMode(),!0));return A.applyQuaternion(W),n.applyQuaternion(W),{point:A.add(M),tangent:n.sub(A).normalize()}}}return V},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(X,v,z){var S=this,E=S.getEye();E=[E[0],E[1],E[2]];var T=S.getCenter();if(T=[T[0],T[1],T[2]],X||(X=E),v||(v=T),S._flyAnim&&S._flyAnim.stop(!0),z=Vi(z),!z)return S.setEye(X[0],X[1],X[2]),S.setCenter(v[0],v[1],v[2]),delete S._flyAnim,!0;var s=[X[0]-E[0],X[1]-E[1],X[2]-E[2]],J=[v[0]-T[0],v[1]-T[1],v[2]-T[2]];return z.action=function(B){S.setCenter(T[0]+J[0]*B,T[1]+J[1]*B,T[2]+J[2]*B),S.setEye(E[0]+s[0]*B,E[1]+s[1]*B,E[2]+s[2]*B)},z._37o=function(){delete S._flyAnim},S._flyAnim=Tp(z)},flyTo:function(){function a(u,K,X){if(X instanceof C.Node){r.fromArray(Uf(X,K.getMat(X)));var R=X.getAnchor3d();u.push((new Qe).set(0-R.x,0-R.y,0-R.z).applyMatrix4(r)),u.push((new Qe).set(0-R.x,0-R.y,1-R.z).applyMatrix4(r)),u.push((new Qe).set(0-R.x,1-R.y,0-R.z).applyMatrix4(r)),u.push((new Qe).set(0-R.x,1-R.y,1-R.z).applyMatrix4(r)),u.push((new Qe).set(1-R.x,0-R.y,0-R.z).applyMatrix4(r)),u.push((new Qe).set(1-R.x,0-R.y,1-R.z).applyMatrix4(r)),u.push((new Qe).set(1-R.x,1-R.y,0-R.z).applyMatrix4(r)),u.push((new Qe).set(1-R.x,1-R.y,1-R.z).applyMatrix4(r))}}var U=new Qe,W=new Qe,z=new Qe,F=new Qe,r=new hb,Q=new C.Math.Quaternion,E=new of,y=new ss;return function(u,T,I){var N=this;if(I!==$)T={animation:T,ratio:I};else{var R=typeof T;("boolean"===R||"object"===R&&T.duration)&&(T={animation:T})}T=T||{},U.fromArray(N.getEye()),W.fromArray(N.getCenter());var x,j,V=[],H=T.center,t=T.distance===$;if(H&&z.fromArray(H),u instanceof C.Node)H||z.fromArray(u.p3()),t&&(a(V,N,u),x=V.length);else{if(u||(u=N.dm().getDatas()),!u.length)return;if((t||!H)&&(V=[],u.forEach(function(c){a(V,N,c)}),x=V.length,!x))return;H||(y.setFromPoints(V),z.copy(y.min).add(y.max).multiplyScalar(.5))}if(N.setCenter(z.x,z.y,z.z),F.subVectors(U,W),T.direction||T.worldDirection){!T.worldDirection&&u instanceof C.Node?Q.setFromEuler(E.set(u.r3(),u.getRotationMode(),!0)):Q.set(0,0,0,1);var d=F.length();F.fromArray(T.worldDirection||T.direction).applyQuaternion(Q).setLength(d)}var h=0;if(t){var c,D,w,I=T.ratio||.8,M=T.xRatio||I,O=T.yRatio||I;if(N.isOrtho()){var L=-1/0;for(N._eye[0]=F.x+z.x,N._eye[1]=F.y+z.y,N._eye[2]=F.z+z.z,c=Te(N),te(c,c,ud(N)),j=0;x>j;j++)w=V[j],D=Vh([w.x,w.y,w.z,1],c),L=Math.max(L,Math.max(Math.abs(D[0])/M,Math.abs(D[1])/O));h=N.getOrthoWidth()*L,F.add(z)}else{for(var k,g,A=N.getNear(),G=10;G--;){for(N._eye[0]=F.x+z.x,N._eye[1]=F.y+z.y,N._eye[2]=F.z+z.z,c=Te(N),te(c,c,ud(N)),k=!0,g=-1/0,j=0;x>j;j++){if(w=V[j],D=Vh([w.x,w.y,w.z,1],c),D[3]<A&&G){F.multiplyScalar(2),k=!1;break}g=Math.max(g,Math.max(Math.abs(D[0])/M,Math.abs(D[1])/O)-D[3])}if(k)break}F.setLength(g+F.length()).add(z)}}else F.setLength(T.distance).add(z);N._flyAnim&&N._flyAnim.stop(!0);var p=Vi(T.animation);if(p){N.setEye(U.x,U.y,U.z),N.setCenter(W.x,W.y,W.z);var B=(new Qe).subVectors(F,U),K=(new Qe).subVectors(z,W);if(h)var f=N.getOrthoWidth();var _=new Qe,q=new Qe,P=p.action,J=p._37o,i=U.clone(),X=W.clone();return p.action=function(H,o){_.copy(i).addScaledVector(B,H),q.copy(X).addScaledVector(K,H),N.setCenter(q.x,q.y,q.z),N.setEye(_.x,_.y,_.z),h&&N.setOrthoWidth((h-f)*H+f),P&&P(H,o)},p._37o=function(){delete N._flyAnim,J&&J()},{lastEye:U,lastCenter:W,eye:F,center:z,orthoWidth:h,animation:N._flyAnim=Tp(p)}}return N.setEye(F.x,F.y,F.z),h&&N.setOrthoWidth(h),delete N._flyAnim,{lastEye:U,lastCenter:W,eye:F,center:z,orthoWidth:h}}}(),getBoundingBox:function(){function h(d,F,X){k.fromArray(Uf(X,F.getMat(X)));var n=X.getAnchor3d();d.push((new Qe).set(0-n.x,0-n.y,0-n.z).applyMatrix4(k)),d.push((new Qe).set(0-n.x,0-n.y,1-n.z).applyMatrix4(k)),d.push((new Qe).set(0-n.x,1-n.y,0-n.z).applyMatrix4(k)),d.push((new Qe).set(0-n.x,1-n.y,1-n.z).applyMatrix4(k)),d.push((new Qe).set(1-n.x,0-n.y,0-n.z).applyMatrix4(k)),d.push((new Qe).set(1-n.x,0-n.y,1-n.z).applyMatrix4(k)),d.push((new Qe).set(1-n.x,1-n.y,0-n.z).applyMatrix4(k)),d.push((new Qe).set(1-n.x,1-n.y,1-n.z).applyMatrix4(k))}var k=new hb;return function(S){if(S=S||this.sm().getSelection(),S instanceof C.Node&&(S=[S]),0===S.length)return V;var f=[];S.forEach(function(U){Zb(U)&&h(f,this,U)},this);var L=[1/0,1/0,1/0],T=[-1/0,-1/0,-1/0];return f.forEach(function(Z){L[0]=Math.min(Z.x,L[0]),L[1]=Math.min(Z.y,L[1]),L[2]=Math.min(Z.z,L[2]),T[0]=Math.max(Z.x,T[0]),T[1]=Math.max(Z.y,T[1]),T[2]=Math.max(Z.z,T[2])}),{min:L,max:T}}}(),setBatchInfo:function(e,u){var i=this._batchInfoMap[e];this._batchInfoMap[e]=u,this.fp("batchInfo",i,u)},getBatchInfo:function(D){return this._batchInfoMap[D]||un[D]}}),hg.RenderEnv=function(z){this.gv=z,this.enable=!1},e.defineProperties(hg.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(I){this._debugOn=I,this.capture&&this.capture()}}}),e.assign(hg.RenderEnv.prototype,{renderEnvToCube:function(c,m,v,h){var S=this,d=S.gv;if(!c||!m||!v)return S.enable=!1,S._42=null,void 0;S.enable=!0;var E=Math.floor(h/c*m),s=d.getGL(),k=S._renderTargets;k?k.length<v&&(k=S._renderTargets=k.concat(new Array(v-k.length))):k=S._renderTargets=new Array(v);for(var p=0;v>p;p++)k[p]?k[p].setSize(s,h,E):k[p]=new hg.RenderTarget(d,s,h,E);var n=!1;S.capture=function(){n=!0,d._42(),n=!1};var y=new Qe,B=new Qe,N=new Qe,M=new Qe,x=(new Qe).setY(0),J=2*Math.PI/v,z=c/2/Math.tan(Math.PI/v),l=2*Math.atan2(m/2,z),W=c/m;S._42=function(h,Y,p,e){var c=S._debugOn;if(!n&&!c)return!1;y.copy(d.getEye()),M.copy(d.getCenter()).sub(y);var s=Math.atan2(M.z,M.x),D=d.getNear(),g=d.getFovy(),T=d.getAspect();B.copy(d.getCenter());for(var R,u=0;v>u;u++)if(R=k[u],x.setZ(Math.cos(s)).setX(Math.sin(s)).multiplyScalar(z),s-=J,N.addVectors(y,x),d.setNear(z),d.setCenter([N.x,N.y,N.z]),d.setFovy(l),d.setAspect(W),c){var P=Math.round(Y/v);Oo.for(h).glState.viewport=[P*u,0,P,p],e()}else ec(h,R.frame),Oo.for(h).glState.viewport=[0,0,R.width,R.height],h.clear(h.COLOR_BUFFER_BIT),e(),Uc(h),R.assureTexture();return d.setNear(D),d.setCenter([B.x,B.y,B.z]),d.setFovy(g),d.setAspect(T),!0},S.capture()},getTextureInfo:function(J){var U=this._renderTargets;if(!U)return null;var B=this._renderTargets[J];return B?{index:J,texture:B.texture,textureName:B.uuid}:null}}),e.assign(hg.Graph3dView.prototype,{renderEnvToCube:function(q,R,e,h){var Y=this;Y.envRenderer||(Y.envRenderer=new hg.RenderEnv(Y)),Y.envRenderer.renderEnvToCube(q,R,e,h)}});var Fc=["left","front","right","back","top","bottom"],vp=hg._RenderList=function(){function Z(){K.length=0,B.length=0,n={}}function p(S){var o=S.gv,h=S.data;if(O&&!m)return S._renderParams=null,void 0;var j,v,X,r,Q=S.shapeModel;if(Q){var d,l,n,t=h.s("shape3d.transparent")||h.s("points.transparent");for(Xj(Q)||(d=Th(Q.transparent,h,o),Q=[Q]),X=0,r=Q.length;r>X;X++)n=Q[X],l=Th(n.transparent,h,o),l===$&&(l=d),l===$&&(l=t),l?v=!0:j=!0}for(X=0,r=Fc.length;r>X;X++){var B=S[Fc[X]];B&&(B.transparent?v=!0:j=!0)}o.isLabelVisible(h)&&(S.labelInfo&&(h.s(rj+".transparent")?v=!0:j=!0),S.label2Info&&(h.s(_d+".transparent")?v=!0:j=!0)),o.isNoteVisible(h)&&(S.noteInfo&&(h.s(Bq+".transparent")?v=!0:j=!0),S.note2Info&&(h.s(ho+".transparent")?v=!0:j=!0)),S._38o&&(v=j=!0),v||(j=!0),S._renderParams={opaque:j,transparent:v}}function P(Q,r){r&&p(Q);var v=Q.data,C=v._id;if(!n[C]){n[C]=!0;var c=Q._renderParams;c&&c.visible!==!1&&(Q={ui:Q,data:v,z:0,id:C},c.opaque&&K.push(Q),c.transparent&&B.push(Q))}}function f(Z,j){if(B.length>1){for(var l,p=0,C=B.length;C>p;p++)l=B[p].data.p3(),B[p].z=rq(l,j)[2];B.sort(Z||F)}}function e(J){J?(qr(N,t,J),qr(H,k,J),qr(Q,M,J)):(N=this.batchModelMap={},t=this.batchIndexMap={},H=this.polylineModelMap={},k=this.polylineIndexMap={},Q=this.wireframeModelMap={},M=this.wireframeIndexMap={}),this.markBatchInvalid()}function y(R){R?qr(N,t,R):(N=this.batchModelMap={},t=this.batchIndexMap={}),this.markBatchInvalid()}function i(q){q?qr(H,k,q):(H=this.polylineModelMap={},k=this.polylineIndexMap={}),this.markBatchInvalid()}function L(n){n?qr(Q,M,n):(Q=this.wireframeModelMap={},M=this.wireframeIndexMap={}),this.markBatchInvalid()}function E(){return this._batchInvalid}function G(){this._batchInvalid=!0}function C(){this._batchInvalid=null}var K=[],B=[],N={},t={},H={},k={},Q={},M={},n={};return{opaque:K,transparent:B,init:Z,push:P,batchModelMap:N,batchIndexMap:t,polylineModelMap:H,polylineIndexMap:k,wireframeModelMap:Q,wireframeIndexMap:M,ivBatch:e,ivModelBatch:y,ivPolylineBatch:i,ivWireframeBatch:L,markBatchInvalid:G,isBatchInvalid:E,onUpdated:C,sort:f}},Vf=hg._RenderLists=function(){function D(){for(var X in M)M[X].init()}function V(){for(var _ in M)M[_].onUpdated()}function n(z,x){z=z||"main";var h=M[z];return!h&&x&&(h=M[z]=new vp),h}function T(L,q){var V=L.data.getRenderLayer(),H=n(V,!0);H.push(L,q)}function u(b){for(var t in M)b(M[t])}var M={};return{init:D,onUpdated:V,get:n,push:T,each:u,lists:M}},Ei=hg.RenderTarget=function(z,e,g,T,K){var I=this;K=K||{},K.samples=Math.min(z._glCapabilities.maxSamples,K.samples&&K.samples>1&&2===z._webGLVersion?K.samples:0),I.options=K,I.uuid=C.Math.generateUUID(),I.gv=z,I.init(z,e,K),K.samples&&!z._glCapabilities._maxSamplesChecked?I.setSize(e,g||1,T||1):I.setSize(e,g,T)};e.assign(hg.RenderTarget.prototype,{bind:function(U){ec(U,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(W){Uc(W),this.options.samples&&(W.bindFramebuffer(W.READ_FRAMEBUFFER,this._MSAAFbo),W.bindFramebuffer(W.DRAW_FRAMEBUFFER,this.frame),W.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,W.COLOR_BUFFER_BIT,W.NEAREST),W.bindFramebuffer(W.READ_FRAMEBUFFER,null),W.bindFramebuffer(W.DRAW_FRAMEBUFFER,null))},init:function(S,o,M){var Z=this,N=Z.texture=o.createTexture();o.activeTexture(o.TEXTURE0),Pr(o,N);var T=M.samples,O=T?o.NEAREST:o.LINEAR;o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,M.minFilter||O),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,M.magFilter||O),Pr(o,null),Z.render=o.createRenderbuffer(),Z.frame=o.createFramebuffer(),S._2O[Z.uuid]=N},assureTexture:function(){var X=this,Z=X.uuid,H=X.gv._2O;H[Z]||(H[Z]=X.texture)},setSize:function(W,y,m){var Q=this;if(y&&m&&(Q.width!==y||Q.height!==m)){var Z=W.RGBA,v=W.TEXTURE_2D,E=W.RENDERBUFFER,d=W.FRAMEBUFFER,n=Q.options.samples;if(W.activeTexture(W.TEXTURE0),Pr(W,Q.texture),W.texImage2D(v,0,Z,y,m,0,Z,W.UNSIGNED_BYTE,V),Pl.isPOT(y)&&Pl.isPOT(m)&&!Q.options.clampToEdge?(W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_S,W.REPEAT),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_S,W.REPEAT)):(W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_S,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_T,W.CLAMP_TO_EDGE)),W.bindRenderbuffer(E,Q.render),n){var k=Q.gv._glCapabilities;if(k._maxSamplesChecked)W.renderbufferStorageMultisample(E,n,W.DEPTH_COMPONENT16,y,m);else{for(W.getError();n>1&&(W.renderbufferStorageMultisample(E,n,W.DEPTH_COMPONENT16,y,m),W.getError());)n=Math.floor(n>>1);1>=n&&(n=0,W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MIN_FILTER,Q.options.minFilter||W.LINEAR),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MAG_FILTER,Q.options.magFilter||W.LINEAR),W.renderbufferStorage(E,W.DEPTH_COMPONENT16,y,m)),k._maxSamplesChecked=!0,k.maxSamples=Q.options.samples=n}}else W.renderbufferStorage(E,W.DEPTH_COMPONENT16,y,m);n&&!Q._MSAAFbo&&(Q._MSAAFbo=W.createFramebuffer(),Q._MSAARbO=W.createRenderbuffer()),ec(W,Q.frame),W.framebufferTexture2D(d,W.COLOR_ATTACHMENT0,v,Q.texture,0),n||W.framebufferRenderbuffer(d,W.DEPTH_ATTACHMENT,E,Q.render),Uc(W),n&&(W.bindRenderbuffer(W.RENDERBUFFER,Q._MSAARbO),W.renderbufferStorageMultisample(W.RENDERBUFFER,n,W.RGBA8,y,m),ec(W,Q._MSAAFbo),W.framebufferRenderbuffer(W.FRAMEBUFFER,W.COLOR_ATTACHMENT0,W.RENDERBUFFER,Q._MSAARbO),W.framebufferRenderbuffer(d,W.DEPTH_ATTACHMENT,E,Q.render),Uc(W)),Pr(W,V),W.bindRenderbuffer(E,V),Q.width=y,Q.height=m}},toCanvas:function(){var n=this,$=n.gv.getGL();ec($,n.frame);var g=n.width,N=n.height,R=new Uint8Array(4*g*N);$.readPixels(0,0,g,N,$.RGBA,$.UNSIGNED_BYTE,R),Uc($);var F=i.createElement("canvas");F.width=g,F.height=N;var k=F.getContext("2d"),Y=k.createImageData(g,N);return Y.data.set(R),k.putImageData(Y,0,0),F}});var vo=hg.Interactor=function(B){this.gv=this.g3d=B};Iq("Interactor",e,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(m){this.gv.fi(m)},startDragging:function(Y){Lj(this,Y)}});var se=hg.DefaultInteractor=function(C){Le(se,this,[C])};Iq("DefaultInteractor",vo,{getState:function(){return this._62O},setState:function(j){this._62O=j},getDataInfoAt:function(W,o){var z=this.gv,w=z.getDataInfoAt(W);if(!z.isBlockSelectable()||!w||!w.data)return w;if(!o&&z.isSelected(w.data))return w;for(var $=w.data;($=$.getParent())&&$ instanceof C.Block&&z.isSelectable($);){var t=z.isSelected($);if(t&&o)break;if(w={data:$,part:w},t&&!o)break}return w},handle_contextmenu:function(X){qk(X)},handle_mousewheel:function(f){this.gv.handleScroll(f,f.wheelDelta/40)},handle_DOMMouseScroll:function(F){2===F.axis&&this.gv.handleScroll(F,-F.detail)},handle_keydown:function(S){this.gv.handleKeyDown(S)},handle_mousedown:function(U){this.handle_touchstart(U)},handle_touchstart:function(M){qk(M);var m=this,t=m.gv,k=gl(M),O=m.getDataInfoAt(M),Z=O?O.data:V,A=O?O.part:V,c=t.sm(),U=$k(M),y=Bg(M);t.setFocus(M)&&(m._62O=V,m._57I=V,m.pendingClickThrough=V,m.__lastClientPoint__=kd(M),Z?kj(M)?c.co(Z)?c.rs(Z):c.as(Z):c.co(Z)?Z instanceof Zm&&Z.isClickThroughEnabled()&&gl(M)&&(m.pendingClickThrough=kd(M)):c.ss(Z):k&&(kj(M)?t.isRectSelectable()&&(m._62O=aj):m._57I=kd(M)),m._31Q&&(xl(m._31Q),delete m._31Q,delete m._32Q),m._62O||(t.isFirstPersonMode()&&(Fk(M)||Bk(M)||y>2?m._62O="pan":t.isMouseRoamable()||jk(M)?(m._62O="roaming",m.foward=U&&gl(M),m._32Q=Gc(),m._31Q=aq(m.tick,m)):k||(m._62O="roaming")),m._62O||(k&&U&&Nc[A]?(m._62O=A,m.p3=Z.p3()):k&&U&&Zb(Z)&&t.isSelected(Z)?t.isMovable(Z)?(m._62O="move",m.p3=Z.p3(),m.movedata=Z):t._39Q(Z)&&(m._62O="none"):jk(M)&&(y>2?m._62O="pan":2===y&&(m.dist=eq(M),m._62O="pinch")))),m.point=t.lp(M),Lj(m,M),Kr(M)?t.handleDoubleClick(M,Z,A):t.handleClick(M,Z,A))},tick:function(){var o=this,N=o.gv,F=N._moveStep;o.point&&N.isWalkable()&&(o._32Q&&(F*=(Gc()-o._32Q)/50),N.walk(o.foward?F:-F),o._32Q=Gc(),o._31Q=aq(o.tick,o))},handle_mouseup:function(R){this.handle_touchend(R)},handle_touchend:function(o){var n=this._57I;if(n&&(Lf(n,kd(o))<=1&&this.gv.sm().cs(),this._57I=V),n=this.pendingClickThrough){if(Lf(n,kd(o))<=1){var e=this.getDataInfoAt(o);e&&e.data instanceof Zm&&e.data.isClickThroughEnabled()&&(e=this.getDataInfoAt(o,!0),e&&(o.clickThrough=!0,this.gv.sm().ss(e.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(w){this.handleWindowTouchMove(w)},handleWindowTouchMove:function(m){var u,k,b=this,Y=b.gv,l=b._62O,D=b.point,H=Y.dm(),K=Y.lp(m),$=K.x-D.x,W=K.y-D.y,R=Y.getWidth(),g=Y.getHeight();if(R&&g){var O=kd(m),U=xr(Y,O,b.__lastClientPoint__),Q=Lf({x:0,y:0},U),_=-J*$/R,A=-J*W/g;if("roaming"===l)b.rotate(m,_/2,A/2);else if(l===so||l===xe||l===Cq)Y._86O||H.beginTransaction(),Y.fi({kind:Y._86O?"betweenEditRotation":"beginEditRotation",event:m}),Y._86O=1,Y.sm().each(function(q){if(Zb(q)&&Y.isRotationEditable(q)){var z=r(_)>r(A)?_:A;l===so?q.setRotationX(q.getRotationX()+z):l===xe?q.setRotationY(q.getRotationY()+z):l===Cq&&q.setRotationZ(q.getRotationZ()+z)}});else if("move"===l||Nc[l]){if(l===fe||l===Ac||l===pq)Y._87O||H.beginTransaction(),Y.fi({kind:Y._87O?"betweenEditScale":"beginEditScale",event:m}),Y._87O=1;else{if(!Y._moving){if(Q<B.touchMoveThreshold)return;H.beginTransaction()}Y.fi({kind:Y._moving?"betweenMove":"beginMove",event:m}),Y._moving=1}var L,o=b.p3,q=Y.getPositionInfo(o),V=ud(Y);L=l===$h?"x":l===fq?"y":l===Ed?"z":l===fe?"sx":l===Ac?"sy":l===pq?"sz":Y.getMoveMode(m,b.movedata),$=$/R*q.width,W=-1*W/g*q.height;var p,d,j=[V[0]*$,V[4]*$,V[8]*$],T=[V[1]*W,V[5]*W,V[9]*W],E=j[0]+T[0],X=j[1]+T[1],G=j[2]+T[2],f=[o[0]+E,o[1]+X,o[2]+G],x=Fq(Y.getEye(),f,!0);if("xyz"===L?(p=f,Y.moveSelection(E,X,G)):"xz"===L?(p=hl(Y,o,[0,1,0],f),p&&Y.moveSelection(p[0]-o[0],0,p[2]-o[2])):"xy"===L?(p=hl(Y,o,[0,0,1],f),p&&Y.moveSelection(p[0]-o[0],p[1]-o[1],0)):"yz"===L?(p=hl(Y,o,[1,0,0],f),p&&Y.moveSelection(0,p[1]-o[1],p[2]-o[2])):"x"===L||"sx"===L?(x[0]=0,p=hl(Y,o,x,f),p&&(d=p[0]-o[0],"x"===L?Y.moveSelection(d,0,0):Y.sm().each(function(X){Zb(X)&&Y.isSizeEditable(X)&&(u=X.getScaleX()+d/100,k=u/X.getScaleX(),X.setScaleX(u),Fk(m)&&(X.setScaleY(X.getScaleY()*k),X.setScaleTall(X.getScaleTall()*k)))
}))):"y"===L||"sy"===L?(x[1]=0,p=hl(Y,o,x,f),p&&(d=p[1]-o[1],"y"===L?Y.moveSelection(0,d,0):Y.sm().each(function(X){Zb(X)&&Y.isSizeEditable(X)&&(u=X.getScaleTall()+d/100,k=u/X.getScaleTall(),X.setScaleTall(u),Fk(m)&&(X.setScaleY(X.getScaleY()*k),X.setScaleX(X.getScaleX()*k)))}))):("z"===L||"sz"===L)&&(x[2]=0,p=hl(Y,o,x,f),p&&(d=p[2]-o[2],"z"===L?Y.moveSelection(0,0,d):Y.sm().each(function($){Zb($)&&Y.isSizeEditable($)&&(u=$.getScaleY()+d/100,k=u/$.getScaleY(),$.setScaleY(u),Fk(m)&&($.setScaleX($.getScaleX()*k),$.setScaleTall($.getScaleTall()*k)))}))),!p)return;b.p3=p}else if(l===aj){var z=b.div;z||(z=b.div=Rn(),os(b.getView(),z),z.op=D,z.style.background=Y.getRectSelectBackground()),Y.fi({kind:Y._rectSelecting?"betweenRectSelect":"beginRectSelect",event:m}),Y._rectSelecting=1,z.rect=lq(z.op,K),$m(z,z.rect)}else if("pinch"===l&&2===Bg(m)){Y.fi({kind:Y._pinching?"betweenPinch":"beginPinch",event:m}),Y._pinching=1;var d=eq(m);Y._lastZoomLP||(Y._lastZoomLP=gf(m)),Y.handlePinch(d,b.dist),b.dist=d}else"pan"===l||Fk(m)||Bk(m)?b.pan(m,$,W):"none"===l||Y.isFirstPersonMode()||b.rotate(m,_,A);b.point=K}},pan:function(S,Q,$){var t=this.gv;if(t.isPannable()){var z=t.getWidth(),N=t.getHeight();if(!z||!N)return;var B=t.getCenterInfo(),b=Q/z*B.width,V=-1*$/N*B.height;t.fi({kind:t._panning?"betweenPan":"beginPan",event:S}),t._panning=1,t.pan(-b,-V)}},rotate:function(f,h,r){var O=this.gv;O.isRotatable()&&(O.fi({kind:O._rotating?"betweenRotate":"beginRotate",event:f}),O._rotating=1,O.rotate(h,r))},handleWindowMouseUp:function(c){this.handleWindowTouchEnd(c)},handleWindowTouchEnd:function(s){var w=this,B=w.gv,y=B.dm(),E=w.div;if(E){var R=B.getDatasInRect(E.rect);if(!R.isEmpty()){var O=B.sm(),b=O.toSelection();R.each(function(G){O.co(G)?b.remove(G):b.add(G)}),O.ss(b)}zg(E)}B._moving&&(delete B._moving,B.fi({kind:"endMove",event:s}),B.onMoveEnded(),y.endTransaction()),B._panning&&(delete B._panning,B.fi({kind:"endPan",event:s}),B.onPanEnded()),B._rotating&&(delete B._rotating,B.fi({kind:"endRotate",event:s}),B.onRotateEnded()),B._86O&&(delete B._86O,B.fi({kind:"endEditRotation",event:s}),y.endTransaction()),B._87O&&(delete B._87O,B.fi({kind:"endEditScale",event:s}),y.endTransaction()),B._pinching&&(delete B._pinching,B.fi({kind:"endPinch",event:s}),B.onPinchEnded()),B._rectSelecting&&(delete B._rectSelecting,B.fi({kind:"endRectSelect",event:s}),B.onRectSelectEnded()),B._walking&&(delete B._walking,B.fi({kind:"endWalk",event:s}),B.onWalkEnded()),B._lastZoomLP=B._lastZoomHit=null,w.dist=w.point=w._62O=w.p3=w.movedata=w.div=w._57I=w.pendingClickThrough=w._32Q=w._31Q=w.foward=V,w.__lastClientPoint__=V}});var Ud=hg.MapInteractor=function(t){Le(Ud,this,[t]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this.maxPhi=5*Math.PI/12};Iq("MapInteractor",vo,{handle_contextmenu:function($){qk($)},handle_mousewheel:function(P){this.gv.handleScroll(P,P.wheelDelta/40)},handle_DOMMouseScroll:function(F){2===F.axis&&this.gv.handleScroll(F,-F.detail)},handle_keydown:function(S){this.gv.handleKeyDown(S)},handle_mousedown:function(Q){this.handle_touchstart(Q)},handle_touchstart:function(Q){qk(Q);var U=this,n=U.gv;if(n.setFocus(Q)){var J=n.getDataInfoAt(Q),Z=J?J.data:V,j=J?J.part:V,v=U.editing={point:n.lp(Q)};jk(Q)?v.touch=!0:(v.touch=!1,v.clickLeft=gl(Q),v.pan=Bk(Q)?!0:"left"===this.panButton===v.clickLeft),Z&&n._39Q(Z)&&(v.preventDefault=!0),Lj(U,Q),Kr(Q)?n.handleDoubleClick(Q,Z,j):n.handleClick(Q,Z,j)}},handle_mouseup:function(C){this.handle_touchend(C)},handle_touchend:function(){},handleWindowMouseMove:function(Q){this.handleWindowTouchMove(Q)},handleWindowTouchMove:function(Y){var h=this,L=h.gv,K=h.editing;if(K){var D=L.lp(Y),i=K.point,H=D.x-i.x,w=D.y-i.y;if(!K.moved){if(Math.abs(H)<h.threshold&&Math.abs(w)<h.threshold&&!(Y.touches&&Y.touches.length>1))return;K.moved=!0}if(!K.preventDefault)if(K.point=D,K.touch){var k=Y.touches.length;if(2!==k)h.pan(Y,H,w);else{if(1>=k)return;var b=Y.touches,t={x:b[0].clientX,y:b[0].clientY},r={x:b[1].clientX,y:b[1].clientY},y={x:r.x-t.x,y:r.y-t.y},C=K.lastCenter,W=Math.atan2(y.y,y.x),q=K.theta,v=0;q==V?q=K.theta=W:(v=W-q,K.thetaStarted||Math.abs(v)>h.touchRotateThreshold?(K.thetaStarted=!0,K.theta=W):v=0);var Q=Z*(t.y+r.y)/2/L.getHeight(),F=K.phi,X=0;F==V?F=K.phi=Q:(X=Q-F,K.phiStarted||Math.abs(X)>h.touchRotateThreshold?(K.phiStarted=!0,K.phi=Q):X=0);var o,E=Math.sqrt(y.x*y.x+y.y*y.y),j=K.vlen;if(j){var c=t.x-C.x,g=t.y-C.y,p=r.x-C.x,S=r.y-C.y,G=Math.sqrt(c*c+g*g),u=Math.sqrt(p*p+S*S),l=j/2,N=h._sign2(G-l),B=h._sign2(u-l);0>N*B||0===N&&0===B?(o=1,K.vlen=E):(o||(o=E/j),K.scaleStarted||Math.abs(o-1)>h.touchScaleThreshold?(K.vlen=E,K.scaleStarted=!0):o=1)}else j=K.vlen=E,o=1;1!==o&&L.setZoom(o),(X||v)&&h.rotate(Y,v,-X),K.lastCenter={x:(r.x+t.x)/2,y:(r.y+t.y)/2}}}else if(K.pan)h.pan(Y,H,w);else{var e=L.getWidth(),$=L.getHeight();if(!e||!$)return;var x=-J*H/e,O=-J*w/$;h.rotate(Y,x,O)}}},_sign2:function(U){return Math.abs(U)<this._touchScaleCheckAccuracy?0:U>0?1:-1},handleWindowMouseUp:function(Y){this.handleWindowTouchEnd(Y)},handleWindowTouchEnd:function(c){var b=this,Q=b.editing;if(b.editing=null,Q){var B=b.gv;if(Q.moved||!Q.clickLeft&&!Q.touch)B._panning=null,B._rotating=null,B.fi({kind:Q.pan?"endPan":"endRotate",event:c});else{var h=B.getDataAt(c);h?B.sm().setSelection([h]):B.sm().clearSelection()}}},pan:function(o,x,K){var D=this,X=D.gv;if(X.isPannable()){var M=X.getWidth(),J=X.getHeight();if(M&&J){var S=X.getCenterInfo(),n=-x/M*S.width,y=1*K/J*S.height;X.fi({kind:X._panning?"betweenPan":"beginPan",event:o}),X._panning=1;var T=D.keepHorizon,B=D.editing.touch;if((B&&o.touches&&o.touches.length>1||!B&&Fk(o))&&(T=!T),!T)return X.pan(n,y);if(n||y){var R=ud(X),h=[R[0]*n,R[4]*n,R[8]*n],N=[R[1],0,R[9]],v=Math.sqrt(N[0]*N[0]+N[2]*N[2]);v&&(N=[N[0]/v*y,0,N[2]/v*y]);var Y=h[0]+N[0],d=h[1]+N[1],Z=h[2]+N[2],_=X._center,p=X._eye;_[0]+=Y,_[1]+=d,_[2]+=Z,p[0]+=Y,p[1]+=d,p[2]+=Z,X.fp(Qd,V,p),X.fp(cc,V,_)}}}},rotate:function(f,c,o){var A=this,W=A.gv;if(W.isRotatable()){var n=W._center,l=W._eye,u=Fq(l,n),k=I(j(u[0]*u[0]+u[2]*u[2]),u[1]),Z=Dl(W,k+o);o=Z-k,W.fi({kind:W._rotating?"betweenRotate":"beginRotate",event:f}),W._rotating=1,W.rotate(c,o)}}}),e.defineProperties(Ud.prototype,{panButton:{get:function(){return this._panButton},set:function(i){this._panButton=i}},minPhi:{get:function(){return this.gv.getRotateMinPhi()},set:function(L){this.gv.setRotateMinPhi(L)}},maxPhi:{get:function(){return this.gv.getRotateMaxPhi()},set:function(n){this.gv.setRotateMaxPhi(n)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(F){this._keepHorizon=F}},threshold:{get:function(){return this._threshold},set:function(K){this._threshold=K}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(P){this._touchScaleThreshold=P}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(a){this._touchRotateThreshold=a}}});var Rg,jb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",vj=32,Br=hg.GlobeInteractor=function(A,e){Le(Br,this,[A]);var Z,S=e.radius||6378137,U=this,p=null;Rg||(Rg=Rn(),Rg.style.border="",Rg.style.backgroundImage="url("+jb+")");var D=new fh,z=new Qe,I=new Qe,O=new Qe,m=new bd,C="number"==typeof S?{x:S,y:S,z:S}:S,g={center:new Qe(0,0,0),radius:C},B=function(h){A._81O=null;var q=A.getHitPosition(h,A.getCenter(),z.copy(A.getEye()).sub(I.copy(A.getCenter())).toArray());return m.origin.copy(A.getEye()),m.direction.copy(q).sub(m.origin).normalize(),m.intersectEllipsoid(g)},H=function(P,Z){A._81O=null,m.origin.copy(A.getEye());for(var H,C,N=A.getCenter(),u=z.copy(A.getEye()).sub(I.copy(A.getCenter())).toArray(),X=1,r=16,O=0,t=1,c={x:0,y:0};r--;){if(c.x=Z.x+(P.x-Z.x)*X,c.y=Z.y+(P.y-Z.y)*X,H=A.getHitPosition(c,N,u),m.direction.copy(H).sub(m.origin).normalize(),C=m.intersectEllipsoid(g),C&&1===X)return{hit:C};C?O=X:t=X,X=(O+t)/2}return{hit:C,out:1>X}},n=function(g,x){if(p){var y=Date.now();p.deltaTime=p.lastTime?y-p.lastTime:1e3,p.lastTime=y,p.lastAxis=g,p.lastAngle=x}x&&(D.setFromAxisAngle(g,x),A.setEye(z.copy(A.getEye()).applyQuaternion(D).toArray()),A.setCenter(z.copy(A.getCenter()).applyQuaternion(D).toArray()),A.setUp(z.copy(A.getUp()).applyQuaternion(D).toArray()))};U._showCrossIcon=function($){os(U.getView(),Rg),$m(Rg,{x:$.clientX-vj/2,y:$.clientY-vj/2,width:vj,height:vj})},U._hideCrossIcon=function(){zg(Rg)},U._scrollImpl=function(m,S){p={point:A.lp(m),screen:kd(m),hit:B(m),type:"right"},p.hitNormalize=p.hit?p.hit.clone().normalize():new Qe;var W={clientX:p.screen.x,clientY:p.screen.y+10*S};U._handleMoveImpl(W),U._endMoveImpl(W)},U._startMoveImpl=function(P){Z&&(Z.stop(!0),Z=null),p={point:A.lp(P),screen:kd(P),hit:B(P)},p.hitNormalize=p.hit?p.hit.clone().normalize():new Qe,jk(P)?1===P.touches.length?p.hit&&(p.type="left"):2===P.touches.length&&(p.type="touch2"):(gl(P)?p.hit&&(p.type="left"):Fb(P)?p.type="right":Bk(P)&&p.hit&&(p.type="middle"),!p.hit||"right"!==p.type&&"middle"!==p.type||U._showCrossIcon(P)),p.type&&Lj(U,P)},U._handleMoveImpl=function(j){if(p)switch(p.type){case"left":return U._handleLeft(j);case"right":return U._handleRight(j);case"middle":return U._handleMiddle(j);case"touch2":return U._handleTouch2(j)}},U._endMoveImpl=function(){if(p){if(this._hideCrossIcon(),"left"===p.type||"middle"===p.type){var t=1e3*(p.lastAngle/(p.deltaTime||30)),$=p.lastAxis,d=p.lastTime,m=function(){var q=Date.now(),N=(q-d)/1e3;return d=q,t*=Math.pow(Math.abs(U.decelerationRate),3*N),Math.abs(t)<.01?(t=0,Z&&Z.stop(),void 0):(n($,t*N),void 0)};Z=Tp({action:function(){m(arguments)},duration:5e3})}p=null}},U._handleLeft=function(A){if(!p.finished){var i=kd(A),X=H(i,p.lastScreen||p.screen);if(p.lastScreen=i,!X.hit)return p.finished=!0,U._endMoveImpl(A),void 0;var e=X.hit;e.normalize();var f=p.hitNormalize,D=Math.acos(e.dot(f)),S=e.cross(f).normalize();n(S,D),X.out&&(p.finished=!0,U._endMoveImpl(A))}},U._handleRight=function(y){var W=p.lastScreen||p.screen,N=W.y;W=p.lastScreen=kd(y);var q=W.y,G=q-N;if(G){var Z=Math.min(.5,G*U.scaleSpeed);z.copy(A.getEye());var F=p.hit;F||(F=z.clone().divide(C).normalize().multiply(C)),I.copy(z).lerp(F,Z),A.setEye(I.toArray()),z.copy(A.getUp()),I.normalize();var b=z.clone().cross(I).normalize();if(O.copy(A.getCenter()),O.sub(b.multiplyScalar(O.dot(b))),A.setCenter(O.toArray()),p.hit){var j=B(p.screen),v=p.hitNormalize;if(j){j.normalize();var E=Math.acos(j.dot(v)),c=j.cross(v).normalize();E&&n(c,E)}}}};var d=function(f){return Math.abs(f)<.01?0:f>0?1:-1};U._handleTouch2=function(e){var z=e.touches.length;if(2===z){var u=e.touches,M={x:u[0].clientX,y:u[0].clientY},R={x:u[1].clientX,y:u[1].clientY},P={x:R.x-M.x,y:R.y-M.y},m=p.lastCenter,v=Math.atan2(P.y,P.x),i=p.theta,Q=0;i==V?i=p.theta=v:(Q=v-i,p.thetaStarted||Math.abs(Q)>.03?(p.thetaStarted=!0,p.theta=v):Q=0);var y,L=Math.sqrt(P.x*P.x+P.y*P.y),Y=p.vlen;if(Y){var k=M.x-m.x,X=M.y-m.y,W=R.x-m.x,a=R.y-m.y,o=Math.sqrt(k*k+X*X),g=Math.sqrt(W*W+a*a),J=Y/2,F=d(o-J),Z=d(g-J);0>F*Z||0===F&&0===Z?(y=1,p.vlen=L):(y||(y=L/Y),p.scaleStarted||Math.abs(y-1)>.05?(p.vlen=L,p.scaleStarted=!0):y=1)}else Y=p.vlen=L,y=1;var P=I.copy(A.getEye()).clone();1!==y&&A.setEye(P.setLength((P.length()-S)/y+S).toArray()),Q&&n(P.normalize(),Q),p.lastCenter={x:(R.x+M.x)/2,y:(R.y+M.y)/2}}},U._handleMiddle=function(q){var E=kd(q),Y=p.screen;p.screen=E;var C=(E.y-Y.y)/180*Math.PI*U.rollSpeed;I.copy(A.getCenter()).sub(z.copy(A.getEye())).normalize(),z.copy(A.getUp()).cross(I).normalize(),I.copy(A.getEye()).sub(p.hit).applyAxisAngle(z,C).add(p.hit);var P=I.clone();I.copy(A.getCenter()).sub(p.hit).applyAxisAngle(z,C).add(p.hit);var R=I.clone(),h=I.copy(A.getUp()).applyAxisAngle(z,C).clone(),o=!1;C>0&&(O.copy(h),I.copy(R).sub(P).normalize(),z.copy(P).multiplyScalar(-1).normalize(),z.dot(O)-I.dot(O)>0&&(o=!0)),o||O.copy(p.hit).sub(P).dot(p.hitNormalize)>=0&&(o=!0),o||(A.setEye(P.toArray()),A.setCenter(R.toArray()),A.setUp(h.toArray()));var u=-(E.x-Y.x)/180*Math.PI*U.rotateSpeed;n(p.hitNormalize,u)}};Iq("GlobeInteractor",vo,{handle_contextmenu:function(G){qk(G)},handle_mousewheel:function(Y){this._scrollImpl(Y,Y.wheelDelta/40)},handle_DOMMouseScroll:function(M){2===M.axis&&this._scrollImpl(M,-M.detail)},handle_keydown:function(o){this.gv.handleKeyDown(o)},handle_mousedown:function(w){this.handle_touchstart(w)},handle_touchstart:function(t){qk(t);var m=this.gv;if(m.setFocus(t)){var a=m.getDataInfoAt(t),f=a?a.data:V;f&&m.isInteractive(f)||this._startMoveImpl(t);var w=a?a.part:V;Kr(t)?m.handleDoubleClick(t,f,w):m.handleClick(t,f,w)}},handle_mouseup:function(t){this.handle_touchend(t)},handle_touchend:function(){},handleWindowMouseMove:function(t){this.handleWindowTouchMove(t)},handleWindowTouchMove:function(K){this._handleMoveImpl(K)},handleWindowMouseUp:function(x){this.handleWindowTouchEnd(x)},handleWindowTouchEnd:function(Y){this._endMoveImpl(Y)}}),e.defineProperties(Br.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(H){this._rotateSpeed=H}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(T){this._rollSpeed=T}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(M){this._scaleSpeed=M}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(C){this._decelerationRate=C}}});var ve=function(j){var _=2147483648|j;return[(255&_>>16)/255,(255&_>>8)/255,(255&_)/255,(255&_>>24)/255]},qh=function(Y){this.gv=Y,this.gv.pickColorMap={_pickIdUsed:1e3}};ym(qh,e,{_iv:!0,iv:function(){this._iv=!0},get:function(m,T,p){this.validate();var Z=this,u=Z.gv.getGL();if(!u)return V;var W,q,D=Z._resolution,n=Math.round(m.x*D),k=Math.ceil(m.width*D),C=Math.ceil(m.height*D),r=Z.height-Math.round(m.y*D)-C,j=b(k/2),H=new Uint8Array(4*k*C),l=0,O=H.length,N=T?V:new le,L=T?V:{};if(ec(u,Z.frame),u.readPixels(n,r,k,C,u.RGBA,u.UNSIGNED_BYTE,H),Uc(u),T){for(;j>=l;l++)for(var E=j-l,y=j+l,B=E;y>=B;B++)for(var s=E;y>=s;s++)if((B===E||B===y||s===E||s===y)&&(W=Z.info(H,4*(B*k+s)))){if(p&&p(W)===!1)continue;return W}}else for(;O>l;l+=4)if(W=Z.info(H,l)){if(p&&p(W)===!1)continue;q=W.data,L[q._id]||(N.add(q),L[q._id]=q)}return N},info:function(l,e){return this.gv.pickColorMap[(l[e]<<16)+(l[e+1]<<8)+l[e+2]+((127&l[e+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var M=this,d=M.gv,i=d.getGL();if(i){var y=M._resolution=d._pickerResolution*d.getDevicePixelRatio(),P=Math.round(y*d.getWidth()),K=Math.round(y*d.getHeight()),G=i.RGBA,f=i.TEXTURE_2D,E=i.RENDERBUFFER,T=i.FRAMEBUFFER;if(M.texture||(M.texture=Dh(i),M.render=i.createRenderbuffer(),M.frame=i.createFramebuffer()),(M.width!==P||M.height!==K)&&(i.activeTexture(i.TEXTURE0),Pr(i,M.texture),i.texImage2D(f,0,G,P,K,0,G,i.UNSIGNED_BYTE,V),fr(i,i.TEXTURE_MIN_FILTER,i.LINEAR),i.bindRenderbuffer(E,M.render),i.renderbufferStorage(E,i.DEPTH_COMPONENT16,P,K),ec(i,M.frame),i.framebufferTexture2D(T,i.COLOR_ATTACHMENT0,f,M.texture,0),i.framebufferRenderbuffer(T,i.DEPTH_ATTACHMENT,E,M.render),Pr(i,V),i.bindRenderbuffer(E,V),Uc(i),M.width=P,M.height=K),M._iv){M._iv=!1;var v=!1;d._40Q.each(function(u){!v&&u.isBatchInvalid()&&(v=!0)}),v&&d.updateScene(),ec(i,M.frame),i.clear(i.COLOR_BUFFER_BIT),d.overlappingBox.clear(),d.setViewport(i,0,0,P,K),d.renderPickScene(),Uc(i)}}}});var Vk=function(n){this.gv=n};ym(Vk,e,{gap:0,size:0,_42:function(j,w){var _=this,U=_.gv,E=U._gridGap,$=U._gridSize;if(U._gridVisible){if(_.gap!==E||_.size!==$){for(var I=[],z=U._gridSize/2,B=E*z,l=0;2*z+1>l;l++){var m=6*l,J=6*(2*z+1)+m;I[m]=-B,I[m+1]=0,I[m+2]=-B+l*E,I[m+3]=B,I[m+4]=0,I[m+5]=-B+l*E,I[J]=-B+l*E,I[J+1]=0,I[J+2]=-B,I[J+3]=-B+l*E,I[J+4]=0,I[J+5]=B}_.vs=new Uj(I),_.gap=E,_.size=$}Ae(U),Ol(j,w),wo(j),dn(j,w,1,U._gridColor,U._buffer.vs,_.vs),Tg(j,0,_.vs.length/3,j.LINES),Rj(j),Yq(j,w)}else _.vs=_.gap=_.size=V}});var ul=function(k){this.gv=k};ym(ul,e,{_42:function(M,J){var x=this.gv,C=x._buffer.vs,y=x._axisXColor,r=x._axisYColor,W=x._axisZColor,b=x._originAxisVisible,k=x._centerAxisVisible;if(b||k){var Z=bh?M.TRIANGLES:M.TRIANGLE_FAN,t=M.LINES;if(Ae(x),Ol(M,J),wo(M),b){var f=x.getCenterInfo(),g=s(f.width,f.height)/5,Q=.8*g,R=.05*g;dn(M,J,1.5,y,C,new Uj([0,0,0,g,0,0,Q,R,0,Q,0,R,Q,-R,0,Q,0,-R,Q,R,0,0,0,0,0,g,0,R,Q,0,0,Q,R,-R,Q,0,0,Q,-R,R,Q,0,0,0,0,0,0,g,R,0,Q,0,R,Q,-R,0,Q,0,-R,Q,R,0,Q])),Tg(M,0,2,t),Tg(M,1,6,Z),dn(M,J,V,r),Tg(M,7,2,t),Tg(M,8,6,Z),dn(M,J,V,W),Tg(M,14,2,t),Tg(M,15,6,Z)}if(k){var L=x._center,B=L[0],H=L[1],p=L[2],f=x.getPositionInfo(L);g=s(f.width,f.height)/20,dn(M,J,1.5,y,C,new Uj([B,H,p,B+g,H,p,B,H,p,B,H+g,p,B,H,p,B,H,p+g])),Tg(M,0,2,t),dn(M,J,V,r),Tg(M,2,2,t),dn(M,J,V,W),Tg(M,4,2,t)}Rj(M),Yq(M,J)}}});var ee=function(k){this.gv=k,this.onMouseOver=this.onMouseOver.bind(this),this.mode=ee.Mode.Style,this.color=$,this.width=$};ee.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},ym(ee,e,{onMouseOver:function(i){B.preventDefault(i);var n=this.gv.getDataAt(i);n!==this.mouseOverData&&(this.mouseOverData=n,this.gv.iv())},setFetchTargetFunc:function(i){this.fetchTargetFunc=i},_42:function(d,$){var z,R,U=this,C=U._mode,r=U.gv;if(!d._renderInfo.reflectDepth&&C!==ee.Mode.Disable){if(C===ee.Mode.Selection?z=r.sm().getSelection().toArray(function(c){return c.s("highlight.visible")}):C===ee.Mode.MouseOver&&U.mouseOverData&&U.mouseOverData.s("highlight.visible")&&(z=[U.mouseOverData]),U.fetchTargetFunc&&(z=U.fetchTargetFunc(z)),C===ee.Mode.Style)z=z||[],R=function(_){if(z.indexOf(_)>=0)return!1;var x=r.getDataHighlightMode(_);return x===!1?!0:x===!0?!1:"selected"===x?r.isSelected(_)?!1:!0:"hover"===x?_===U.mouseOverData?!1:!0:!0};else{if(!z||!z.length)return;R=function(d){return z.indexOf(d)<0?!0:void 0}}var y=r.vr.isPresenting(),I=r.getWidth();if(y){var N=r.getWidth;I/=2,r.getWidth=function(){return I};var c=r.getViewport()}var Q,w=r.getDevicePixelRatio(),u=I*w,l=r.getHeight()*w;(Q=U._renderTarget)?Q.setSize(d,u,l):U._renderTarget=Q=new hg.RenderTarget(r,d,u,l),ec(d,Q.frame),d.clear(d.COLOR_BUFFER_BIT),r.setViewport(d,0,0,u,l),r.drawFilter=R,r.renderPickScene(),r.drawFilter=null,Uc(d),bh&&Pi(d,$.aPosition),Pi(d,$.aNormal),y&&(r.getWidth=N,r.setViewport(d,c[0],c[1],c[2],c[3]));var v=d._compiledShader.highlight;v||(v=d._compiledShader.highlight=new ff.Shader(d,Km.vs,Km.fs)),v.bind();var M=Oo.for(d),o=M.directState();o.blend.enabled=!0,o.depth.enabled=!1,d.activeTexture(d.TEXTURE0+0),Pr(d,Q.texture),v.uniforms.image=0,v.uniforms.textureSize=[u,l],v.uniforms.edgeWidth=r.getHighlightWidth();var S=r.getHighlightColor();if(U._lastHighlightColor!==S){var j=Fh(U._lastHighlightColor=S);U._highlightColorData=[j[0]/255,j[1]/255,j[2]/255,j[3]/255]}v.uniforms.edgeColor=U._highlightColorData,U.ibuffer?(U.ibuffer.upload(),U.vbuffer.upload()):(U.ibuffer=ff.Buffer.createIndexBuffer(d,new Uint16Array([0,2,1,1,2,3])),U.vbuffer=ff.Buffer.createVertexBuffer(d,new Float32Array([0,0,1,0,0,1,1,1]))),v.attributes.pos.pointer(U.vbuffer),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0),o.blend.enabled=!1,o.depth.enabled=!0,Pr(d,null),d.useProgram($),bh&&Nb(d,$.aPosition)}}}),e.defineProperties(ee.prototype,{mode:{get:function(){return this._mode},set:function(S){var T=this._mode;if(S!==T){this._mode=S;var Q=T===ee.Mode.MouseOver||T===ee.Mode.Style,X=S===ee.Mode.MouseOver||S===ee.Mode.Style;X&&Q||(Q&&Y(this.gv.getView(),"mousemove",this.onMouseOver),X&&A(this.gv.getView(),"mousemove",this.onMouseOver))}}}});var Km={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},sm=function(c){this.gv=c},$h="edit_tx",fq="edit_ty",Ed="edit_tz",so="edit_rx",xe="edit_ry",Cq="edit_rz",fe="edit_sx",Ac="edit_sy",pq="edit_sz",Nc={};Nc[$h]=101,Nc[fq]=102,Nc[Ed]=103,Nc[so]=104,Nc[xe]=105,Nc[Cq]=106,Nc[fe]=107,Nc[Ac]=108,Nc[pq]=109,ym(sm,e,{_42:function(x,v,T){var K=this,o=K.gv,O=o.sm().ld();if(O&&o.isEditable(O)&&!o.isEditHelperDisabled()&&Zb(O)&&(!o.isFirstPersonMode()||!o.isMouseRoamable()&&!gp)){Ae(o);var D=o.isMovable(O),V=o.isRotationEditable(O),m=o.isSizeEditable(O),j=o._axisXColor,L=o._axisYColor,_=o._axisZColor,R=o._editSizeColor,k=O.p3(),M=Lf(o.getEye(),o.getCenter())/10;o.isOrtho()&&(M=M*o.getOrthoWidth()/B.graph3dViewOrthoWidth);var z,u,Y=M/(T?5:10),w=.7*M,r=.4*w,S=k[0],X=k[1],Z=k[2];z=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],D&&K._17O(x,v,O,T,$h,j,z,[S,X-Y,Z,S+w,X-Y,Z,S+w,X,Z,S+w,X,Z,S,X,Z,S,X-Y,Z,S,X-Y,Z+Y,S+w,X-Y,Z+Y,S+w,X-Y,Z,S+w,X-Y,Z,S,X-Y,Z,S,X-Y,Z+Y]),u=S+w,m&&K._17O(x,v,O,T,fe,R,z,[u,X-Y,Z,u+r,X-Y,Z,u+r,X,Z,u+r,X,Z,u,X,Z,u,X-Y,Z,u,X-Y,Z+Y,u+r,X-Y,Z+Y,u+r,X-Y,Z,u+r,X-Y,Z,u,X-Y,Z,u,X-Y,Z+Y]),u+=r,V&&K._17O(x,v,O,T,so,j,z,[u,X-Y,Z,u+r,X-Y,Z,u+r,X,Z,u+r,X,Z,u,X,Z,u,X-Y,Z,u,X-Y,Z+Y,u+r,X-Y,Z+Y,u+r,X-Y,Z,u+r,X-Y,Z,u,X-Y,Z,u,X-Y,Z+Y]),z=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],D&&K._17O(x,v,O,T,fq,L,z,[S,X,Z,S,X+w,Z,S-Y,X+w,Z,S-Y,X+w,Z,S-Y,X,Z,S,X,Z,S,X,Z,S,X,Z-Y,S,X+w,Z-Y,S,X+w,Z-Y,S,X+w,Z,S,X,Z]),u=X+w,m&&K._17O(x,v,O,T,Ac,R,z,[S,u,Z,S,u+r,Z,S-Y,u+r,Z,S-Y,u+r,Z,S-Y,u,Z,S,u,Z,S,u,Z,S,u,Z-Y,S,u+r,Z-Y,S,u+r,Z-Y,S,u+r,Z,S,u,Z]),u+=r,V&&K._17O(x,v,O,T,xe,L,z,[S,u,Z,S,u+r,Z,S-Y,u+r,Z,S-Y,u+r,Z,S-Y,u,Z,S,u,Z,S,u,Z,S,u,Z-Y,S,u+r,Z-Y,S,u+r,Z-Y,S,u+r,Z,S,u,Z]),z=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],D&&K._17O(x,v,O,T,Ed,_,z,[S,X,Z,S,X,Z+w,S,X-Y,Z+w,S,X-Y,Z+w,S,X-Y,Z,S,X,Z,S,X-Y,Z,S-Y,X-Y,Z,S-Y,X-Y,Z+w,S-Y,X-Y,Z+w,S,X-Y,Z+w,S,X-Y,Z]),u=Z+w,m&&K._17O(x,v,O,T,pq,R,z,[S,X,u,S,X,u+r,S,X-Y,u+r,S,X-Y,u+r,S,X-Y,u,S,X,u,S,X-Y,u,S-Y,X-Y,u,S-Y,X-Y,u+r,S-Y,X-Y,u+r,S,X-Y,u+r,S,X-Y,u]),u+=r,V&&K._17O(x,v,O,T,Cq,_,z,[S,X,u,S,X,u+r,S,X-Y,u+r,S,X-Y,u+r,S,X-Y,u,S,X,u,S,X-Y,u,S-Y,X-Y,u,S-Y,X-Y,u+r,S-Y,X-Y,u+r,S,X-Y,u+r,S,X-Y,u])}},_17O:function(u,c,I,$,P,j,f,W){var m=this.gv,X=m._buffer,Z=Oo.for(u),o=Z.directUniforms(),z=Z.directAttribs();if(m._picking){$=m.pickColorMap;var e=Nc[P];$[e]={data:I,part:P},o.uFixPickReverseColor=ve(e)}Rl(u,c,V,!0,V,!0,V,!1),o.uDiffuse=j,z.aPosition=$j(u,X.vs,new Uj(W),V),z.aNormal=$j(u,X.ns,new Uj(f),V),wo(u),Tg(u,0,12),Rj(u),nn(u,c)}});var Vr=C.Raycaster=function(F){this.gv=F,this.maxTriangleTest=1/0,this.backfaceCulling=!0};Yb("Raycaster",e,{intersect:function(R){var Q=this,J=Q.gv,$=J.getDataAt(R);return $?Q.intersectObject(R,$):null},intersectObjects:function(q,F,l){var L,t,m,J,V=this,T=1/0,Y=q.origin||(new Qe).fromArray(V.gv.getEye()),v=V.maxTriangleTest,W=[];F.forEach(function(o){l&&l(o)===!1||o.s("intersect")!==!1&&W.push(o)});var w=Y.distanceToSquared2([0,0,0]);return W.sort(function(f,W){return(f.p3?Y.distanceToSquared2(f.p3()):w)-(W.p3?Y.distanceToSquared2(W.p3()):w)}),V.countTriangles=0,W.forEach(function(p){V.countTriangles>v||(L=V.intersectObject(q,p),L&&(t=Y.distanceToSquared(L.world),T>t&&(m=p,J=L,T=t)))}),V.countTriangles=0,{data:m,intersect:J}},intersectObject:function(u,t){if(u instanceof bd)return this._intersectObjectImpl(u,t);var r=this,o=r.gv,J=o.unproject(u),X=new Qe,x=o.getEye(),b=new Qe;if(o.isOrtho()){var p=new Qe(x);b.copy(o.getCenter()).sub(p).normalize();var c=X.copy(J).sub(p).dot(b);X.copy(b).setLength(-c).add(p.copy(J))}else X.copy(x),b.copy(J).sub(X).normalize();var v=new C.Math.Ray(X,b);return r._intersectObjectImpl(v,t)},_intersectObjectImpl:function(){function D(){var p=new Qe;return p.subVectors(k,U),N.subVectors(i,U),p.cross(N).normalize(),p}function z(m,G,W,y,b,j,e){return Sh.barycoordFromPoint(m,G,W,y,n),b.multiplyScalar(n.x),j.multiplyScalar(n.y),e.multiplyScalar(n.z),b.add(j).add(e),b.clone()}var H=new hb,u=new hb,J=new bd,y=new Qe,r=new Qe,P=new Qe,w=new Qe,F=new Qe,i=new Qe,U=new Qe,k=new Qe,$=new kp,x=new kp,R=new kp,N=new Qe,g={vs:bp,is:rb,uv:th},n=new Qe,Q=$r.slice(0);return Q.push("csg"),function(G,I){var p=this.gv.getData3dUI(I),f=I.mat||p.mat;f?H.fromArray(f):H.identity(),u.getInverse(H),J.copy(G).applyMatrix4(u);var v,a,M,s="body",c=p.shapeModel;if(!c&&(I instanceof C.Polyline||I instanceof C.Edge)&&p.lineShapeModel&&(c=p.lineShapeModel),c||(c=rh(p)),c||(C.CSGNode&&I instanceof C.CSGNode||C.CSGShape&&I instanceof C.CSGShape?(M=!0,c=[p.left,p.front,p.right,p.back,p.top,p.bottom,p.csg]):I instanceof C.Node&&!(I instanceof C.Shape)?(v=!0,c=g):(a=!0,c=[p.left,p.front,p.right,p.back,p.top,p.bottom])),!c)return console.log("Can not find shape model."),null;Xj(c)||(c=[c]);var q,X,j,o,m,Y,d,b,Z,l,n,t,N,K,V,E,_=1/0,e=["","top_","bottom_"],T=!1,L=this.backfaceCulling,h=[];for(qm(c,p,h),q=0,X=h.length;X>q;q++)if(N=h[q])for(j=0,o=e.length;o>j;j++)if(K=e[j],d=N[K+"vs"],b=N[K+"is"],Z=N[K+"uv"]||N[K+"tuv"],d){if(V=N[K+"boundingBox"]){var n=J.intersectBox(V);if(!n)continue;if(J.origin.distanceTo(n)>_)continue;E=!1}else N[K+"boundingBox"]=V=new C.Math.Box3,E=!0;for(m=0,Y=b?b.length:d.length/3;Y>m;m+=3)this.countTriangles++,b?(r.fromArray(d,3*b[m]),P.fromArray(d,3*b[m+1]),w.fromArray(d,3*b[m+2])):(r.fromArray(d,3*m),P.fromArray(d,3*(m+1)),w.fromArray(d,3*(m+2))),E&&(V.expandByPoint(r),V.expandByPoint(P),V.expandByPoint(w)),l=J.intersectTriangle(r,P,w,L,y),l&&(t=J.origin.distanceTo(l),_>t&&(_=t,F.copy(l),i.copy(r),U.copy(P),k.copy(w),""!==K?s=K.slice(0,-1):v?s=$r[Math.floor(m/6)]:a?s=$r[q]:M&&(s=Q[q]),Z&&(T=!0,b?($.fromArray(Z,2*b[m]),x.fromArray(Z,2*b[m+1]),R.fromArray(Z,2*b[m+2])):($.fromArray(Z,2*m),x.fromArray(Z,2*(m+1)),R.fromArray(Z,2*(m+2))))))}if(!isFinite(_))return null;var W,B=F.clone().applyMatrix4(H);T&&(W=z(F,i,U,k,$,x,R));var O=D(i,U,k),A=D(i.applyMatrix4(H),U.applyMatrix4(H),k.applyMatrix4(H)),S=J.direction.dot(O);return S>0&&(O.multiplyScalar(-1),A.multiplyScalar(-1)),{world:B,local:F.clone(),worldNormal:A,normal:O,uv:W,part:s}}}()});var xb=function(n,c){this.gv=n,this.s=function(L,s,Q){return s==V&&(s=Q),s==V?c.getStyle(L):Th(s,c,n)},this.data=c};ym(xb,e,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:$,iv:function(){this._iv=!0},update:function(S,h,e){var D=this,$=D.data;if(S||(S=D.gv,h=S.getGL(),e=h._40Q),!D.needValidate(h)||!S.isVisible($))return e.push(this,!1),void 0;var E,y,H,R,c,T=$._id,U=D.s("autorotate")||D.s("shape3d.autorotate")||D.s("fixSizeOnScreen")||D.s("shape3d.fixSizeOnScreen")?null:D.s("batch"),P=$.getRenderLayer(),C=e.get(P,!0),v=C.batchIndexMap,t=C.batchModelMap,i=S.getBrightness($),X=i!=V&&1!==i;E=zm(v,t,$,U,S);var G=D.validate(E,U?S.getBatchInfo(U)||al:V);if(E&&(y=v[T],H=y.size=E.vs.length/3-y.begin,c=E.rs))for(i=X?i:1,R=0;H>R;R++)c.push(i);var W=S.getWireframeGeometry($);if(W)_e(S,$,W);else if(Zb($)){var u=S.getWireframe($);u&&_e(S,$,u)}D.labelInfo=D.label2Info=D.noteInfo=D.note2Info=D._38o=V,D._24O(rj,"getLabel"),D._24O(_d,"getLabel2"),D._26O(Bq,"getNote"),D._26O(ho,"getNote2"),D._15O(),D.interactiveInfo=S.isInteractive($)?{}:V,C.push(this,!0),G!==!1&&(D._iv=!1)},clearWireframeGeometryCache:function(){var D=this;Mh(D),D.data.iv()},_46Q:function(N){var C=this,F=C.data,k=C.gv;if(k.isVisible(F)){var W=F._id,d=k._40Q.get(F._renderLayer,!0),Y=d.batchIndexMap[W],h=d.polylineIndexMap[W],z=d.wireframeIndexMap[W];if(Y||h||z){var L=sh(N,k.pickColorMap,k.isSelectable(F),F,Zr,!0);L&&(Wh(L,Y,d.batchModelMap),Wh(L,h,d.polylineModelMap),Wh(L,z,d.wireframeModelMap))}}},_42:function(s,P,v){function G(t,I,u){var s=I.getBrightness(u),U=u.s("alphaTest"),J=u.s("envmap"),W=Oo.for(t),w=W.directUniforms();s!=V&&1!==s&&(w.uBrightness=s),w.uAlphaTest=U,w.uUseEnvMap=J?!0:!1,w.uReflectivity=J||.01,w.shadowReceive=!S&&u.s("shadow.receive"),w.shadowCull=!S&&!!u.s("shadow.cull");var i=h.s("3d.clip.direction");if(i){var x=h.s("3d.clip.percentage");switch(0===x&&(A=!1),i){case"left":i=2;break;case"top":i=3;break;case"bottom":i=4;break;case"front":i=5;break;case"back":i=6;break;case"right":default:i=1}if(0===i%2&&(x=1-x),u instanceof C.Shape){var q=u.s3(),n=u.p3(),H=u.getAnchor3d();x=3>i?(x-H.x)*q[0]+n[0]:5>i?(x-H.y)*q[1]+n[1]:(x-H.z)*q[2]+n[2]}else x-=.5;w.uClipPercent=x}w.uClipDirection=i||0,t._blooming&&!u.s("bloom")&&(w.blackout=!0)}var h=this,c=h.data,N=h.gv;if(N.isVisible(c)){var t,S=N._picking;if(S)t=N.pickColorMap;else{if(N.isTransparentMask(c)||N.isReflecting(s)&&c.s("3d.reflectable")===!1)return;t=$}if(xb.getTitle===$){xb.getTitle=0;for(var W in B)if(W.length===_d.length+1&&W[_d.length]===_n[4].toUpperCase()&&W[_d.length-1]===_n[_d.length+1].toUpperCase()){xb.getTitle=Ng;break}}if(!xb.getTitle||En[_d.length+2]){if(xb.getHead===$){xb.getHead=0;for(var W in o){var H="box-sizing";6===W.length&&W[0]===_n[4]&&W[3]===H[0]&&W[4]===H[1]&&W[5]===H[2]&&(xb.getHead=Ng)}}if(!xb.getHead||En[_d.length]){var p,M,D=c._id,q=N._40Q.get(c._renderLayer,!0),T=q.batchIndexMap,d=q.batchModelMap,l=N.isSelectable(c),i=!1,A=!0,L=T[D];if(S&&(M=sh(s,t,l,c,Zr,L),M&&!N._45Q&&(Wh(M,L,d),Wh(M,q.polylineIndexMap[D],q.polylineModelMap),Wh(M,q.wireframeIndexMap[D],q.wireframeModelMap))),L||(i||(i=!0,G(s,N,c)),A&&h._80o(s,P,v)),N.isLabelVisible(c)&&((p=h.labelInfo)&&(S&&sh(s,t,l,c,rj),i||(i=!0,G(s,N,c)),h._28O(p,rj,v)),(p=h.label2Info)&&(S&&sh(s,t,l,c,_d),i||(i=!0,G(s,N,c)),h._28O(p,_d,v))),N.isNoteVisible(c)&&((p=h.noteInfo)&&(S&&sh(s,t,l,c,Bq),i||(i=!0,G(s,N,c)),h._29O(p,Bq,v)),(p=h.note2Info)&&(S&&sh(s,t,l,c,ho),i||(i=!0,G(s,N,c)),h._29O(p,ho,v))),(p=h._38o)&&(i||(i=!0,G(s,N,c)),h._99O(s,P,p,t,l,v)),i){var x=Oo.for(s).directUniforms();x.uBrightness=1,x.uClipDirection=0,s._blooming&&(x.blackout=!1)}}}}},prepare:function(){var d=this,l=d.data;if(!(l instanceof Zm)){var q,f,D,e,T,K=d.gv,c=K.getGL(),$=l._id,W=d.s("batch"),s=K._batchIndexMap,x=K._batchModelMap,i=K.getBrightness(l),A=i!=V&&1!==i;
if(d.needValidate(c)){if(q=zm(s,x,l,W,K),d.validate(q,W?K.getBatchInfo(W)||al:V),q&&(f=s[$],D=f.size=q.vs.length/3-f.begin,T=q.rs))for(i=A?i:1,e=0;D>e;e++)T.push(i);if(Zb(l)){var I=K.getWireframeGeometry(l);if(I)_e(K,l,I);else{var o=K.getWireframe(l);o&&_e(K,l,o)}}d.labelInfo=d.label2Info=d.noteInfo=d.note2Info=d._38o=V,d._24O(rj,"getLabel"),d._24O(_d,"getLabel2"),d._26O(Bq,"getNote"),d._26O(ho,"getNote2"),d._15O(),d.interactiveInfo=K.isInteractive(l)?{}:V,d._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=$},getBoundingBox:function(){var g,E,R,F,y,L;return function(){if(this._cacheBoundingBox)return this._cacheBoundingBox;g||(g={vs:bp,is:rb,uv:th},E=new Qe,R=new Qe,F=new Qe,y=new Qe,L=new Qe);var O=this,J=O.data,I=O.shapeModel;if(I||J instanceof C.Shape||(I=rh(O)),!I&&J instanceof C.Shape&&(O.prepare(),I=O.shapeModel),I||(J instanceof C.Node&&!(J instanceof C.Shape)?I=g:(O.left||O.front||O.right||O.back||O.top||O.bottom)&&(I=[O.left,O.front,O.right,O.back,O.top,O.bottom])),!I)return $;Xj(I)||(I=[I]);var m,A,z,Q,G,h,b,u,p,_,t,r,Y=["","top_","bottom_"],Z=new C.Math.Box3,V=!1;if(O._needRecoverPosition){y.set.apply(y,J.p3());var o=J.s3();L.set(1/(o[0]||1),1/(o[1]||1),1/(o[2]||1))}else y.set(0,0,0),L.set(1,1,1);for(m=0,A=I.length;A>m;m++)if(p=I[m])for(z=0,Q=Y.length;Q>z;z++)if(_=Y[z],b=p[_+"vs"],u=p[_+"is"],b){if(r=_+"boundingBox",t=p[r],!t)for(p[r]=t=new C.Math.Box3,G=0,h=u?u.length:b.length/3;h>G;G+=3)u?(E.fromArray(b,3*u[G]).sub(y).multiply(L),R.fromArray(b,3*u[G+1]).sub(y).multiply(L),F.fromArray(b,3*u[G+2]).sub(y).multiply(L)):(E.fromArray(b,3*G).sub(y).multiply(L),R.fromArray(b,3*(G+1)).sub(y).multiply(L),F.fromArray(b,3*(G+2)).sub(y).multiply(L)),!E.isNaN()&&t.expandByPoint(E),!R.isNaN()&&t.expandByPoint(R),!F.isNaN()&&t.expandByPoint(F);Z.expandByBox(t),V=!0}return V?(this._cacheBoundingBox=Z,e.freeze(Z),e.freeze(Z.min),e.freeze(Z.max),Hh(O.gv,J),Z):$}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return gk},_80o:function(){},dispose:function(){},getBodyColor:function(W){var u=this.data,y=this.gv.getBodyColor(u);return y?y:W?u.getStyle(W):V},getCachedTexture:function($){var b=this._cachedTextures;return b?b[$||"main"]:null},setCachedTexture:function($,S){var J=this._cachedTextures;return J||(J=this._cachedTextures={}),J[S||"main"]=$,$},invalidateCachedTexture:function(w){var t=this._cachedTextures;if(t){for(var d in t)w.deleteTexture(t[d]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(g,y){var e=this,d=e.data,E=e.gv,T=e.s,L=E[y](d);if(L!=V){var i=T(g+".scale"),W=T(g+".max"),c=e[g+"Info"]={label:L,textureScale:T(g+".texture.scale"),color:E[y+"Color"](d),font:T(g+".font"),align:T(g+".align"),background:E[y+"Background"](d)},G=c.rect=zn(c,L);W>0&&W<G.width&&(c.labelWidth=G.width,G.width=W),G.x=G.y=0,G.width*=i,G.height*=i,c.mat=e._16O(T(g+".autorotate"),T(g+".position"),G,T(g+".face"),T(g+".t3"),T(g+".r3"),T(g+".rotationMode"));var A=G.width/2,q=G.height/2;c.vs=new Uj([-A,q,0,-A,-q,0,A,-q,0,A,q,0]),G.width/=i,G.height/=i}},_26O:function(N,D){var l=this,k=l.data,p=l.gv,T=l.s,P=p[D](k);if(P!=V){var K=T(N+".scale"),$=this[N+"Info"]={note:P,textureScale:T(N+".texture.scale"),expanded:T(N+".expanded"),font:T(N+".font"),color:T(N+".color"),align:T(N+".align"),borderWidth:T(N+".border.width"),borderColor:T(N+".border.color"),background:p[D+"Background"](k)};if($.expanded){var A=T(N+".max"),z=zn($,P);z.width+=6,z.height+=2,A>0&&A<z.width&&($.labelWidth=z.width,z.width=A);var e={x:-z.width/2,y:-8-z.height,width:z.width,height:z.height+8}}else e={x:-6,y:-18,width:12,height:18};$.mat=l._16O(T(N+".autorotate"),T(N+".position"),V,T(N+".face"),T(N+".t3"),T(N+".r3"),T(N+".rotationMode")),$.rect=e,1!==K&&(e=Xn(e),e.x*=K,e.height*=K,e.y=-e.height,e.width*=K);var n=e.x,x=e.y,X=e.width,m=e.height;$.vs=new Uj([n,-x,0,n,-x-m,0,n+X,-x-m,0,n+X,-x,0])}},eachShapeModel:function(f,o){function l(W){Wp(W),W.vs&&f(W.vs,W.is,W.ns,W.uv),W.top_vs&&f(W.top_vs,W.top_is,W.top_ns,W.top_uv),W.bottom_vs&&f(W.bottom_vs,W.bottom_is,W.bottom_ns,W.bottom_uv),W.from_vs&&f(W.from_vs,W.from_is,W.from_ns,W.from_uv),W.to_vs&&f(W.to_vs,W.to_is,W.to_ns,W.to_uv)}function t(F){var G,h,X;if(Xj(F))for(h=0,X=F.length;X>h;h++)G=F[h],G&&t(G);else Zq(F)?t(rh(K,F),K):on(F)&&(F.shape3d?t(F.shape3d):l(F))}var K=this,i=K.data,o=o||K.shapeModel||rh(K);o||(o=i instanceof C.Node&&!(i instanceof C.Shape)?{vs:bp,is:rb}:[K.left,K.front,K.right,K.back,K.top,K.bottom]),t(o)},_28O:function(y,h,V){if(V(this.s(h+".transparent"))){var M=y.rect,c=y.textureScale,N=M.width*c,Z=M.height*c;if(N>=1&&Z>=1){var O=oe(N,Z);1!==c&&(O.translate(O,M.x,M.y),O.scale(c,c),O.translate(O,-M.x,-M.y)),Er(O,y),O.restore(),Lh(this,h,y.mat,y.vs,!0)}}},_29O:function(p,B,s){if(s(this.s(B+".transparent"))){var t=p.rect,U=p.textureScale,r=t.x,k=t.y,Z=t.width*U,O=t.height*U;if(Z>=1&&O>=1){t.x=t.y=0;var F=oe(Z,O);1!==U&&F.scale(U,U),ik(F,p),F.restore(),t.x=r,t.y=k,Lh(this,B,p.mat,p.vs,!1)}}},_99O:function(i,z,r,x,b,E){if(r){var I=this,p=I.gv,h=I.data,S=p._buffer,t=p._1O,B=r.icons,f=Oo.for(i),v=f.directAttribs();for(var T in B){var J=B[T],H=r.rects[T];if(H&&E(Th(J.transparent,h,p))){p._picking&&sh(i,x,b,h,T);var l=Th(J.shape3d,h,p),N=l?[l]:Th(J.names,h,p),D=N?N.length:0,d=Th(J.textureScale,h,p)||1,F=Th(J.light,h,p);F==V&&(F=l?!0:!1),Rl(i,z,Th(J.blend,h,p),F,Th(J.opacity,h,p),Th(J.reverseFlip,h,p),Th(J.reverseColor,h,p),Th(J.reverseCull,h,p));for(var m=0;D>m;m++){var U=N[m],q=H[m];if(Qg(I,q.mat),l)ol(p,h,rh(I,l),I);else{var C=Cc(U);if(C){var M=q.width*d,G=q.height*d;if(M>=1&&G>=1){var n=oe(M,G);kr(n,C,Th(J.stretch,h,p),0,0,M,G,h,p),n.restore(),Dh(i,Zf,t),wo(i,z,t,Th(J.discardSelectable,h,p),S.uv,Rp),v.aPosition=$j(i,S.vs,q.vs,V),v.aNormal=Nf(i,S.ns,Mf,V),jj(i,S.is,ql),Mo(i,0,ql.length),Rj(i,z,t)}}}ug(p)}nn(i,z)}}}}});var Mc=function(M,v){Le(Mc,this,[M,v])};ym(Mc,xb,{_16O:function(e,i,p,y,U,v,q,D,g){var E=this.data,x=E.getFinalScale3d(),u=ll(i,x,p,y,D,g);if(E.hasOwnProperty("_anchor")||E.hasOwnProperty("_anchorElevation")){var K=E.getAnchor3d();u[0]-=(K.x-.5)*x[0],u[1]-=(K.y-.5)*x[1],u[2]-=(K.z-.5)*x[2]}return bn(no(),u,E.p3(),y,U,v,q,e,E.getFinalRotation3d(),E.getRotationMode())},clear:function(){var d=this;d.faceMat=d.mat=d.shapeModel=d.left=d.right=d.front=d.back=d.top=d.bottom=d.csg=V},needValidate:function(i){if(this._iv)return this._validateFrameId=i._renderInfo.frame,!0;if(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var G=i._renderInfo.frame;if(this._validateFrameId!==G)return this._validateFrameId=G,!0}return!1},validate:function(k,W){var I=this,A=I.gv,_=I.data,h=I.shapeName=I.s(zp),X=rh(I,h);if(I._updateAutoRotation(),I._updateFixSize2d(),I._updateOverlapping(),I.dispatchBoundingBoxChanged(),this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")){var i=_.getRenderLayer(),g=A._40Q.get(i);g&&g.ivWireframeBatch(_)}var v=Uf(_,A.getMat(_),X?I.s("shape3d.scaleable"):!0);if(_.appendAnchorMatrix3d(v),I.clear(),I.mat=_.mat=v,X||!h)if(I.shapeModel=X,k){var f=[];X?Af(A,_,X,I,I.getBodyColor(),[v],k,f):(tq(A,_,k,W,v,ar,f,Ke),tq(A,_,k,W,v,ci,f,qq),tq(A,_,k,W,v,hp,f,cj),tq(A,_,k,W,v,Tl,f,Jg),tq(A,_,k,W,v,Ah,f,vg),tq(A,_,k,W,v,vi,f,sq)),f.length&&(Qf(k.vs,f),Qf(k.ns,Ir(f)))}else X||(I._cubeUvs=null,I.vf(ar,0),I.vf(ci,16),I.vf(Ah,8),I.vf(vi,24),I.vf(hp,32),I.vf(Tl,40))},_updateAutoRotation:function(){var N=new of,V=new hb,B=new Qe,d=new Qe,n=new Qe;return function(){var O=this,e=O.data,U=O.s("autorotate")||O.s("shape3d.autorotate");if(!U)return e._dynamicRotation&&delete e._dynamicRotation,void 0;var G=O.gv;n.copy(O.s("shape3d.autorotate.up")||G._up);var s;s="string"==typeof U?[U.indexOf("x")<0?G._eye[0]:G._center[0],U.indexOf("y")<0?G._eye[1]:G._center[1],U.indexOf("z")<0?G._eye[2]:G._center[2]]:G._eye;var o=G._center,Z=e.p3();B.copy(Z),d.set(s[0]-o[0],s[1]-o[1],s[2]-o[2]).add(B),V.lookAt(d,B,n),N.set(0,0,0,e.getRotationMode(),!0).setFromRotationMatrix(V);var l=e._dynamicRotation;l&&Math.abs(l[0]-N.x)<1e-5&&Math.abs(l[1]-N.y)<1e-5&&Math.abs(l[2]-N.z)<1e-5||(e._dynamicRotation=[N.x,N.y,N.z])}}(),_updateFixSize2d:function(){var N=this,X=N.data,T=N.s("fixSizeOnScreen")||N.s("shape3d.fixSizeOnScreen");if(!T)return X._dynamicScale3d&&delete X._dynamicScale3d,void 0;var C=N.gv,Q=Uf(X,C.getMat(X)),A=rq([0,0,0],Q),E=C.toViewPosition(A);if(!isNaN(E.x)&&!isNaN(E.y)){var w=rq([1,0,0],Q),s=C.toViewPosition(w),j=rq([0,1,0],Q),F=C.toViewPosition(j),k=s.x-E.x,B=F.y-E.y;if(k&&B){var Y,u,v=X._dynamicScale3d||[1,1,1],P=Cc(X.s("shape3d.image"));if(T[0]>0&&(Y=T[0]),T[1]>0&&(u=T[1]),!Y||!u){var h=T>0?T:1;Y||(Y=(Fe(P,X)||X.getWidth())*h),u||(u=(Dm(P,X)||X.getTall())*h)}var L=Math.abs(k/Y),Z=Math.abs(B/u);Math.abs(L-1)<.001&&Math.abs(Z-1)<.001||(X._dynamicScale3d=[v[0]/L,v[1]/Z,v[2]])}}},_updateOverlapping:function(){var E=this,l=E.s("hide.overlapping.group");if(!l)return E._rectOverlapping&&(E._rectOverlapping=$),void 0;var v,W,S,V=E.gv,a=E.data,F=Uf(a,V.getMat(a)),k=1/0,C=1/0,g=-1/0,J=-1/0,Q=a.getAnchor3d(),c=Q.x,e=Q.y,X=Q.z;for(v=0;8>v;v++){if(W=rq([(v>>2)-c,(1&v>>1)-e,(1&v)-X],F),S=V.toViewPosition(W),isNaN(S.x)||isNaN(S.y))return;k=Math.min(k,S.x),g=Math.max(g,S.x),C=Math.min(C,S.y),J=Math.max(J,S.y)}var j={x:k,y:C,w:g-k,h:J-C};E._rectOverlapping=V.overlappingBox.isOverlapping(l,j)},getVectorDynamicSize:function(){var Y,a=this,$=a.s("shape3d"),N=a.data;if("billboard"===$||"plane"===$||(Y=N._currentCubeElementId)!=V){var u,e,h=a.gv,H=Uf(N,h.getMat(N)),_=N.getAnchor3d(),S=.5-_.x,B=.5-_.y,D=.5-_.z,E=Math.min(a.s("vector.dynamic.maxsize"),h._glCapabilities.maxTextureSize)/h.getDevicePixelRatio(),I=function(w,t){w[0]+=S,w[1]+=B,w[2]+=D,t[0]+=S,t[1]+=B,t[2]+=D;var q=h.toViewPosition(rq(w,H)),G=h.toViewPosition(rq(t,H)),u=q.x-G.x,r=q.y-G.y;return Math.min(E,Math.sqrt(u*u+r*r))};if("billboard"===$)u=I([-.5,0,0],[.5,0,0]),e=I([0,-.5,0],[0,.5,0]);else if("plane"===$)u=I([-.5,0,0],[.5,0,0]),e=I([0,0,-.5],[0,0,.5]);else if(N._currentCubeElementId!=V){var v=3*rb[Y+1],t=3*rb[Y],X=3*rb[Y+2];u=I([bp[v],bp[v+1],bp[v+2]],[bp[X],bp[X+1],bp[X+2]]),e=I([bp[v],bp[v+1],bp[v+2]],[bp[t],bp[t+1],bp[t+2]])}return[u,e]}},vf:function(s,l){var p=this;if(p.gv.getFaceVisible(p.data,s)){var g=$l(p,s);g.mat&&(p.faceMat=!0);var d=g.uv;if(d){var O=p._cubeUvs;O||(O=p._cubeUvs=new Uj([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var V=0;8>V;V++)O[l+V]=d[V]}return g}},_billboardInView:function(){var Q=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],A=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],y=new ss,i=new Qe,R=new hb;return function($){var I=this;if(!I.mat)return!0;var C=I.gv.getFrustum(),D="billboard"===$?Q:A;y.makeEmpty(),R.fromArray(I.mat);for(var h=0,u=D.length;u>h;h+=3)y.expandByPoint(i.fromArray(D,h).applyMatrix4(R));return C.intersectsBox(y)}}(),_80o:function(H,b,h){var x=this;if(x._rectOverlapping)return!0;var n=x.shapeModel;if(n||!x.shapeName){var g=x.s("shape3d");if(("billboard"===g||"plane"===g)&&!x._billboardInView(g))return!0;var R=x.gv,o=x.data,E=R._cube,m=Oo.for(H),k=m.directAttribs();Ae(R,x.mat),x.s("shape3d.reflector")&&!H._picking||(n?ol(R,o,n,x,x.getBodyColor(),h):(k.aPosition=$j(H,E.vs,V,V),k.aNormal=$j(H,E.ns,V,V),pg(H,E.is),x._18O(H,b,"left",0,h),x._18O(H,b,"front",6,h),x._18O(H,b,"right",12,h),x._18O(H,b,"back",18,h),x._18O(H,b,"top",24,h),x._18O(H,b,"bottom",30,h))),ug(R),x.faceMat&&(x._18O(H,b,"left",0,h,!0),x._18O(H,b,"front",6,h,!0),x._18O(H,b,"right",12,h,!0),x._18O(H,b,"back",18,h,!0),x._18O(H,b,"top",24,h,!0),x._18O(H,b,"bottom",30,h,!0))}},_18O:function(J,z,q,t,u,$){var n=this[q];if(n){if(!u(n.transparent))return;if($&&!n.mat||!$&&n.mat)return;var M=this.data.s("polygonOffset");M&&tp(J,M),$&&Ae(this.gv,n.mat);var l=this,k=l.data,N=Oo.for(J),_=N.directUniforms();k._currentCubeElementId=t;var T=l.gv,E=T.getTexture(n.texture,k,q),S=n.uv,K=n.uvScale,c=n.uvOffset,f=n.uvRotation,F=n.discardSelectable;E?S?wo(J,z,E,F,T._buffer.uv,l._cubeUvs,c,K,f):wo(J,z,E,F,T._cube.uv,V,c,K,f):wo(J),Rl(J,z,n.blend,n.light,n.opacity,n.reverseFlip,n.reverseColor,n.reverseCull),_.uDiffuse=n.color||a["color.empty"],Mo(J,t,6),nn(J,z),Rj(J,z,E),$&&ug(T),M&&rd(J),k._currentCubeElementId=null}},drawReflector:function(){var x=new Qe,R=new Qe,B=new of,b=new hb,P=new Qe,q=new Qe,f=new Qe,E=new Qe,K=new hb,d=new hb,z=new Xq,H=new Wl,T=new Wl,m=function(Z,G,n){Z[n]=G[0],Z[n+1]=G[1],Z[n+2]=G[2]},W=function(D,c){m(D,c.getEye(),0),m(D,c.getCenter(),3),m(D,c.getUp(),6)},l=function(P,o){o._eye=[P[0],P[1],P[2]],o._center=[P[3],P[4],P[5]],o._up=[P[6],P[7],P[8]],o._18Q=V;var d=o._skybox;d&&(d.p3([P[0],P[1],P[2]]),o.getData3dUI(d).iv())};return function(s){var t=this;t._reflectorInfo=null;var j=t.data;if(j._reflecting)return!1;var U=t.gv;if(U._picking)return!1;var p=t._reflectorRenderTarget,v=U.getDevicePixelRatio(),g=U.getWidth()*v,L=U.getHeight()*v;p?p.setSize(s,g,L):p=t._reflectorRenderTarget=new hg.RenderTarget(U,s,g,L),x.copy(j.p3()),R.copy(U.getEye()),b.makeRotationFromEuler(B.set(j.r3(),j.getRotationMode(),!0));var A;if(!t._reflectNormal){var A=rh(t,t.s("shape3d"));if(!A)return!1;if(!A.ns&&A.length&&(A=A[0]),!A.ns||!A.vs)return!1;t._reflectNormal=[A.ns[0],A.ns[1],A.ns[2]],t._reflectorVbuffer=ff.Buffer.createVertexBuffer(s,new Float32Array(A.vs))}if(P.copy(t._reflectNormal),P.applyMatrix4(b),q.subVectors(x,R),q.dot(P)>0)return!1;q.reflect(P).negate(),q.add(x),f.copy(U.getCenter()).negate().add(x),f.reflect(P).negate(),f.add(x),E.copy(U.getUp()),E.reflect(P);var D=[0,0,0,0,0,0,0,0,0];W(D,U),U._eye=q.toArray(),U._center=f.toArray(),U._up=E.toArray(),U._18Q=V;var G=U._skybox;G&&(G.p3(U._eye),U.getData3dUI(G).iv()),ec(s,p.frame),s.viewport(0,0,p.width,p.height);var _=j.s("shape3d.reflector.background");if(_){var M=s.getParameter(s.COLOR_CLEAR_VALUE);nb(s,_)}else s.clearColor(0,0,0,1);Oo.for(s).glState.depth.mask=!0,s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var Z=Te(U),F=ud(U);z.setFromNormalAndCoplanarPoint(P,x),z.applyMatrix4(d.fromArray(F)),H.set(z.normal.x,z.normal.y,z.normal.z,z.constant),T.x=(Math.sign(H.x)+Z[8])/Z[0],T.y=(Math.sign(H.y)+Z[9])/Z[5],T.z=-1,T.w=(1+Z[10])/Z[14],H.multiplyScalar(2/H.dot(T));var y=j.s("shape3d.reflector.clip"),J=y===$?.003:y;Z[2]=H.x,Z[6]=H.y,Z[10]=H.z+1-J,Z[14]=H.w;var I=U._computedProjectMatrix;U._computedProjectMatrix=Z,j._reflecting=!0,U.renderScene(),U._computedProjectMatrix=I,K.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),K.multiply(d.fromArray(U._projectMatrix)),K.multiply(d.fromArray(U._viewMatrix)),_&&nb(s,M),Uc(s),l(D,U);var o=j.s("shape3d.reflector.blur");if(o){var w=U.getPostProcessingModule("Blur");w&&w.drawImpl(s,p,o,j.s("shape3d.reflector.blur.ratio"))}var h=s._compiledShader.reflector;h||(h=s._compiledShader.reflector=new ff.Shader(s,ic.Reflector.vs,ic.Reflector.fs)),h.bind(),s.activeTexture(s.TEXTURE0),Pr(s,p.texture),h.uniforms.tDiffuse=0,h.uniforms.color=xs(j.s("shape3d.reflector.color")||"rgb(128,128,128)"),h.uniforms.textureMatrix=K.toArray(),h.uniforms.modelMatrix=Uf(j),h.uniforms.viewMatrix=ud(U),h.uniforms.projectionMatrix=Te(U),t._reflectorVbuffer.upload(),h.attributes.pos.pointer(t._reflectorVbuffer);var c=this.s("shape3d.transparent");if(c){var m=Oo.for(s).glState,e=m.depth.mask;m.depth.mask=!1}return s.drawArrays(s.TRIANGLES,0,6),c&&(m.depth.mask=e),j._reflecting=!1,s.useProgram(U._prg),Pr(s,V),!0}}()}),ic.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var Ek=function(b,A){Le(Ek,this,[b,A])};ym(Ek,Mc,{_80o:function(){}});var Ds=function(Q,u){Le(Ds,this,[Q,u])};ym(Ds,xb,{_25Q:1,validate:function(I){var Z=this;if(!Z.s("geometry.cache")||!Z.info){var H=Z.gv,D=Z.data,R=Z.s,U=R("edge.width"),z=D._40I,p=D._41I;if(Z.shapeModel=Z.info=Z.lineShapeModel=V,z&&p){var L,o,J,d,g,b,K,m,E,A,N=D.isLooped(),M=R(mf),Q=B.getEdgeType(M);if(Q){var t=Q(D,Pg(Z,H,D,N,M),H,Z._19Q);if(!t.points||t.points.isEmpty())return;b=Z.info={},K=t.segments,g=t.points,m=g.size();for(var j=z.getElevation(),q=p.getElevation(),c=0;m>c;c++){var w=g.get(c);w.e==V&&(w.e=j+(q-j)*c/(m-1))}E=od(g.get(0)),A=od(g.get(m-1));var r=m%2;0===r?(b.c1=od(g.get(m/2-1)),b.c2=od(g.get(m/2))):b.p3=od(g.get((m-r)/2)),b.s1=E,b.s2=od(g.get(1)),b.t1=od(g.get(m-2)),b.t2=A}else{g=new le,b=Z.info={};var e=R("edge.offset"),G=R("edge.center"),$=R("edge.source.t3"),i=R("edge.target.t3"),f=Jf(H,D,"source"),y=Jf(H,D,"target");if(!f||!y)return H.invalidateData(D),delete Z.info,!1;if($&&(f[0]+=$[0],f[1]+=$[1],f[2]+=$[2]),i&&(y[0]+=i[0],y[1]+=i[1],y[2]+=i[2]),M===Jd){K=R("edge.segments");var O=b.points=R(go)||io;if(m=O.size()){E=od(O.get(0)),A=od(O.get(m-1)),!G&&e&&(J=Fq(E,f,!0),e=s(e,Lf(f,E)),f=[f[0]+J[0]*e,f[1]+J[1]*e,f[2]+J[2]*e],J=Fq(y,A,!0),e=s(e,Lf(A,y)),y=[y[0]-J[0]*e,y[1]-J[1]*e,y[2]-J[2]*e]);var r=m%2;0===r?(L=od(O.get(m/2-1)),o=od(O.get(m/2))):b.p3=od(O.get((m-r)/2)),b.s1=f,b.s2=E,b.t1=A,b.t2=y}else!G&&e&&(J=Fq(y,f,!0),d=Lf(f,y),e=sg(e,d),f=[f[0]+J[0]*e,f[1]+J[1]*e,f[2]+J[2]*e],y=[y[0]-J[0]*e,y[1]-J[1]*e,y[2]-J[2]*e]),L=f,o=y;g.add({x:f[0],y:f[2],e:f[1]}),g.addAll(O),g.add({x:y[0],y:y[2],e:y[1]})}else{var T=Pg(Z,H,D,N,M);if(Z._19Q||(T=-T),N){var u=f[0],_=f[1],v=f[2],W=z.getTall()/2+T;L=[u-T,_+W,v],o=[u+T,_+W,v],g.add({x:u-T,y:v,e:_}),g.add({x:u-T,y:v,e:_+W}),g.add({x:u+T,y:v,e:_+W}),g.add({x:u+T,y:v,e:_})}else{J=Fq(y,f,!0),d=Lf(f,y);var x={x:f[0],y:f[2]},a={x:y[0],y:y[2]},Y=dc(V,x,a,T),n=Y.x-x.x,C=Y.y-x.y;e=sg(e,d),J[0]*=e,J[1]*=e,J[2]*=e,L=[f[0]+J[0]+n,f[1]+J[1],f[2]+J[2]+C],o=[y[0]-J[0]+n,y[1]-J[1],y[2]-J[2]+C],G?(g.add({x:f[0],y:f[2],e:f[1]}),g.add({x:L[0],y:L[2],e:L[1]}),g.add({x:o[0],y:o[2],e:o[1]}),g.add({x:y[0],y:y[2],e:y[1]})):(g.add({x:L[0],y:L[2],e:L[1]}),g.add({x:o[0],y:o[2],e:o[1]}))}}b.c1=L,b.c2=o}b._lastPointsSegments={points:g,segments:K},b.list=R(zp)===Wj?Z.createTubeModel(g,K,U/2,I):Z.createLineModel(g,K,U,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=V}});var Es=function(V,d){Le(Es,this,[V,d]),this._needRecoverPosition=!0};ym(Es,Mc,{_80o:function(X,t,w){var u=this,A=u.mat;if(A){var L=u.gv,U=u.shapeModel;Ae(L,A),U?ol(L,u.data,U,u,u.getBodyColor(),w):(Jp(u,X,t,"left",w),Jp(u,X,t,"front",w),Jp(u,X,t,"right",w),Jp(u,X,t,"back",w),Jp(u,X,t,"top",w),Jp(u,X,t,"bottom",w)),ug(L)}},validate:function(G,t){var c,e,o=this,s=o.s,u=o.data,F=u._thickness/2,z=u.isClosePath(),w=u.getPoints(),O=u.getSegments(),b=s(Wf),Q=G&&G.uv;if(o.clear(),o.dispatchBoundingBoxChanged(),0>F){try{e=o.shapeModel=xn(w,O,s(Zk),s(Zc),b,s(Wr),u.getTall(),u.getShapeElevation(),z)}catch(Y){e=o.shapeModel={}}s(Jj)?s("shape3d.image")||delete e.uv:(delete e.vs,delete e.ns,delete e.uv),s("shape3d.top.image")||delete e.top_uv,s("shape3d.bottom.image")||delete e.bottom_uv}else if(s(zp)===Wj)c=ds(w,O,b,z),e=o.shapeModel={vs:[]},s("shape3d.image")&&(e.uv=[],e.sum=s(Wr)||Xr(c)||1,e.len=0),s(Zk)&&!z&&(e.top_vs=[],s("shape3d.top.image")&&(e.top_uv=[])),s(Zc)&&!z&&(e.bottom_vs=[],s("shape3d.bottom.image")&&(e.bottom_uv=[])),o._12O(c,F);else{var M,p,k,K,v,d,S,l,B,r;if(c=ds(w,O,b,z),v=o.vf(Ah,Q,!1,t),F&&(d=o.vf(vi,Q,!1,t),S=z?V:o.vf(ar,Q,!1,t),l=z?V:o.vf(ci,Q,!1,t),B=o.vf(hp,Q,!1,t),r=o.vf(Tl,Q,!1,t)),F){for(var H=0,W=c.length;W>H;H++)c[H]=o._tryRemoveBezierPoints(c[H],F);o._12O(c,F)}else v&&c.forEach(function(D){if(K=D.length,K>0)for(M=D[0],k=1;K>k;k++)p=D[k],o.addV(v.vs,M,p),M=p});o._20Q(c),G||(v&&(v.ns=Ir(v.vs),Tf(v,"vs"),Tf(v,Ll)),F&&(d&&(d.ns=Ir(d.vs),Tf(d,"vs"),Tf(d,Ll)),S&&(S.ns=Ir(S.vs),Tf(S,"vs"),Tf(S,Ll)),l&&(l.ns=Ir(l.vs),Tf(l,"vs"),Tf(l,Ll)),B&&(B.ns=Ir(B.vs),Tf(B,"vs"),Tf(B,Ll)),r&&(r.ns=Ir(r.vs),Tf(r,"vs"),Tf(r,Ll))))}var n=o.mat=u.getPointsMatrix3d().getElements();G&&(gj(o,n,G,e),o.clear())},_20Q:function($){var A,Z,W,i,e,K,p,M=this,E=M.front,v=M.back,H=M.top,O=M.bottom,m=E?E.tuv:V,s=v?v.tuv:V,P=H?H.tuv:V,y=O?O.tuv:V,B=0;(m||s||P||y)&&(A=M.s(Wr)||Xr($)||1,$.forEach(function(j){if(Z=j.length,Z>0)for(K=j[0],W=1;Z>W;W++)p=j[W],i=B/A,B+=Lf(K,p),e=B/A,M._14O(E,i,e),M._14O(v,1-e,1-i),M._14O(H,i,e),M._14O(O,i,e),K=p}))},_14O:function(X,o,d){if(X){var J=X.uv,U=X.tuv;if(U){if(J)var w=J[0]+(J[6]-J[0])*o,g=J[1]+(J[7]-J[1])*o,Q=J[2]+(J[4]-J[2])*o,p=J[3]+(J[5]-J[3])*o,s=J[2]+(J[4]-J[2])*d,N=J[3]+(J[5]-J[3])*d,u=J[0]+(J[6]-J[0])*d,H=J[1]+(J[7]-J[1])*d;else w=o,g=0,Q=o,p=1,s=d,N=1,u=d,H=0;U.push(Q,p,s,N,u,H,u,H,w,g,Q,p)}}},_13O:function(y){var L=y.uv,p=y.tuv;p&&(L?p.push(L[2],L[3],L[4],L[5],L[6],L[7],L[6],L[7],L[0],L[1],L[2],L[3]):p.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(w,a){var v=w.length;if(4>v)return w;var u,S,n,Y,$,e,y=!1,K=function(H){return w[H]},L=function(O){return w[v-1-O]};for($=0;1>=$;$++)for(e=$?L:K,S=e(0),n=e(1),u=2;v-1>u;u++)if(Y=e(u),!Y.remove)if(Y.b){var f=dc(S,n,Y,a);f.adjust?(Y.remove=!0,y=!0):(S=n,n=Y)}else S=n,n=Y;if(!y)return w;var C=[];for(u=0;v>u;u++)w[u].remove||C.push(w[u]);return C},_12O:function(b,M){var a,h,C,q,m,k=this.s("shape3d.point.epsilon"),s=this;b.forEach(function(i){if(m=i.length,m>0)for(a={p:i[0],n:!0},q=1;m>q;q++)h=i[q],C=m-1>q?i[q+1]:V,C&&Math.abs(h.x-C.x)<k&&Math.abs(h.y-C.y)<k||s.addPoint(a,h,C,M,i)})},addPoint:function(J,H,L,g,c){var k,q,C,S,e,I,f,o,O,z=this,M=J.p,T=J.f,v=J.b,B=z.s("shape3d.side")||Zn,p=z.s("shape3d.start.angle"),P=z.s("shape3d.sweep.angle"),N=z.shapeModel,s=z.data.isClosePath();if(J.n&&(J.n=!1,T=s&&c.length>2?dc(c[c.length-2],M,H,g):dc(V,M,H,g),v=Eg(M,T),N?N.top_vs&&z._10O(v,T,B,p,P,N.top_vs,N.top_uv):(k=z.left)&&(z.addV(k.vs,v,T),z._13O(k))),q=L?dc(M,H,L,g):s&&c.length>2?dc(M,H,c[1],g):dc(M,H,V,g),C=Eg(H,q),N){var U,r,y=N.vs,E=N.uv,j=N.sum;for(E&&(U=N.len/j,N.len+=Lf(M,H),r=N.len/j),I=z._9O(v,T,B,p,P),f=z._9O(C,q,B,p,P),o=0;B>o;o++)O=o+1,Qf(y,I[O]),Qf(y,f[o]),Qf(y,I[o]),Qf(y,f[o]),Qf(y,I[O]),Qf(y,f[O]),E&&(S=o/B,e=O/B,E.push(U,e,r,S,U,S,r,S,U,e,r,e));!L&&N.bottom_vs&&z._10O(C,q,B,p,P,N.bottom_vs,N.bottom_uv,!0)}else!L&&(k=z.right)&&(z.addV(k.vs,q,C),z._13O(k)),(k=z.front)&&z.addV(k.vs,T,q),(k=z.back)&&z.addV(k.vs,C,v),(k=z.top)&&z.addH(k.vs,T,q,C,v,!0),(k=z.bottom)&&z.addH(k.vs,v,C,q,T);J.p=H,J.f=q,J.b=C},_10O:function(q,$,K,i,Y,S,W,C){var Z,m,p=this,n=p.data,o=p._9O(q,$,K,i,Y),s=(q.x+$.x)/2,j=(q.y+$.y)/2,P=n.getShapeElevation(),_=0;for(_=0;K>_;_++)C?(Qf(S,o[_]),Qf(S,o[_+1])):(Qf(S,o[_+1]),Qf(S,o[_])),Qf(S,[s,P,j]),W&&(C?(Z=J*(_+1)/K+i,m=J*_/K+i):(Z=J*_/K+i,m=J*(_+1)/K+i),W.push(.5-.5*D(m),.5-.5*w(m),.5-.5*D(Z),.5-.5*w(Z),.5,.5))},_9O:function(l,R,X,s,z){var i,g,Z=this,E=Z.data,Y=[],u=(l.x+R.x)/2,N=(l.y+R.y)/2,d=E.getTall()/2,q=E.getShapeElevation(),I=0;for(z==V&&(z=J);X>=I;I++)i=z*I/X+s,g=D(i),Y.push([u+(l.x-u)*g,q+d*w(i),N+(l.y-N)*g]);return Y},addV:function(R,Z,I){var S=Z.x,x=Z.y,W=I.x,i=I.y,T=this.data,l=T.getShapeElevation(),V=T.getTall()/2;R.push(S,l-V,x,W,l-V,i,W,l+V,i,W,l+V,i,S,l+V,x,S,l-V,x)},addH:function(S,L,z,t,n,g){var G=this.data,u=G.getTall()/2,x=G.getShapeElevation()+(g?u:-u);S.push(L.x,x,L.y,z.x,x,z.y,t.x,x,t.y,t.x,x,t.y,n.x,x,n.y,L.x,x,L.y)},vf:function(T,$,b,B){var t,F=this,_=F.gv.getFaceVisible(F.data,T);return(b||_)&&(t=$l(F,T,B),t.vs=[],t.tuv=_&&(t.texture||$)?[]:V,t.visible=_),t}});var Fs,Gs,Hs=function(n,m){Le(Hs,this,[n,m])};ym(Hs,Mc,{validate:function(){var P=this,w=P.gv,M=P.data,q=P.s,k=xs(q("points.color"));k=[k[0],k[1],k[2]];var h=q("points.size"),T=q("points.image")||"rect";("rect"===T||"circle"===T)&&("rect"===T?(Fs||(Fs=P._createCachedImage(T)),T=Fs):(Gs||(Gs=P._createCachedImage(T)),T=Gs));var Z=q("points.model");if(Z){if(P._lastShapeModel!==Z||!P.shapeModel){var K=rh(P,Z);if(!K)return;var i=[],A={};P.eachShapeModel(function(G){for(var d=0,$=G.length;$>d;d+=3){var _=G[d],o=G[d+1],e=G[d+2],a=""+_+"_"+o+"_"+e;A[a]||(A[a]=!0,i.push(_,o,e))}},K),P.shapeModel={vs:new Uj(i)},M._pointsDirty=!0,P._lastShapeModel=Z}}else{var z=M.points,L=z.length,n=L/3;if(M._pointsDirty||!P.shapeModel){var v=new Uj(z);P.shapeModel={vs:v},M._pointsDirty=!1,P._lastShapeModel=null}}if(P.info={mat:Uf(M),size:h,diffuse:k,opacity:q("points.opacity"),texture:T,alphaTest:q("points.transparent")?0:q("alphaTest")},M._colorsDirty){for(var Q,j,U,u=[],E=!1,t=M.colors,Y=0;L>Y;Y+=3)Q=t[Y],j=t[Y+1],U=t[Y+2],Q===$||j===$||U===$?u.push(k[0],k[1],k[2]):(E=!0,u.push(Q,j,U));P.shapeModel.cs=E?new Uj(u):null,M._colorsDirty=!1}if(M._sizesDirty){for(var C=[],R=!1,S=M.sizes,Y=0;n>Y;Y++)S[Y]?(C.push(S[Y]),R=!0):C.push(h);P.shapeModel.ss=R?new Uj(C):null,M._sizesDirty=!1}if(P._lastPointNumber!==n){var p=w.pickColorMap,V=p._pickIdUsed;p._pickIdUsed=V+n;for(var W=[],Y=0;n>Y;Y++){var r=V+Y,H=ve(r);W.push(H[0],H[1],H[2],H[3]),p[r]||(p[r]={data:M,part:Y})}P.shapeModel.ps=new Uj(W),P._lastPointNumber=n}this.dispatchBoundingBoxChanged()},_createCachedImage:function(e){var F=128,Y=ob(),c=Y.getContext("2d");Yl(Y,F,F,1),em(c,{width:F,height:F,comps:[{type:e,background:"white",borderWidth:0,rect:[0,0,F,F]}]},0,0,F,F);var y=C.Math.generateUUID();return Qk[y]=Y,y},_80o:function(C,x){var t=this,m=t.gv,e=t.shapeModel,W=t.info;if(e&&e.vs&&e.vs.length){var n=Oo.for(C);n.useProgram(t._asureProgram(C)),n.directState();var N=n.directUniforms(),M=n.directAttribs();N.modelMatrix=W.mat,N.modelViewMatrix=te([],m._viewMatrix,W.mat),N.projectionMatrix=m._projectMatrix,N.viewMatrix=m._viewMatrix,N.scale=m.getHeight()/2,N.size=W.size,N.diffuse=W.diffuse,N.opacity=W.opacity,N.map=m.getTexture(W.texture,t.data),N.alphaTest=W.alphaTest,N.resolution=m.getDevicePixelRatio(),M.position=Nf(C,m._buffer.vs,e.vs,V),m._picking?(N.picking=!0,M.pickColor=Nf(C,m._buffer.ps,e.ps,V),N.useColor=!1,M.color=null):(N.picking=!1,M.pickColor=null,e.cs?(N.useColor=!0,M.color=Nf(C,m._buffer.cs,e.cs,V)):(N.useColor=!1,M.color=null)),e.ss?(N.useSizeArray=!0,M.sizeArray=Nf(C,m._buffer.ss,e.ss,V)):(N.useSizeArray=!1,M.sizeArray=null),Tg(C,0,e.vs.length/3,C.POINTS),n.useProgram(x)}},_asureProgram:function(Z){return Z._pointsShader||(Z._pointsShader=this.gv._postProcessing.createShader(Z,Hs.shaderSrc)),Z._pointsShader.program}}),Hs.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj4t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vv)o!jggjp!sn<!ocppjpumj!tqpjQdwlnj!o+h!<yj!sbuubuNsojpcjvuudff!kwpfsdq5!!>q!jodpljDupjmtppsQ<`mh!!vo<jogppjsunj!tgpmQpwbnu!!+t!jy{jfs<ub!NvxofjjgWpmsfne!pgnm!p>b!uo!psjfutjptmpvQuwjnp!o<<*!!v1o/j2g!p-senf!ncspppgmt!ovbtsfuT!j){5fdBfsws!b>z!<op!jbuujutspjQcwvnu!f5!dgfmwp!bu<!*t!jo{pfjBusjstbpzq<!)4!dcfpwp!m>!!jetfQnfssptgqtfodbusjuw!f4Ndbfuws!jy~)!!n<b*u15/!2n!!-*s!p|mp!ds)f5udvfswo!!>n!]s!p3m!p^D]w!!4!|^!!*>s>p!m.p!D2f/t1v<)!!g~j!f!twmpfj!e!~n!bj<os)p*m!p|Dl!djjgq!!)>q!jsdplmjpoDhw*!!|^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!4>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*j!delsjpophD<uo!jvpoQj`gmphs!n-!qcbpnp!m)!Ee3jftsdvbusyefTuf!m>f+d!usbpcmmpfD<ftvg$gjjge!!ef|g!j*offmec)b!uVdTfFm`fNTBeQs!b*dt!jveoaj!g}p}s!nh!otjblndqjmqfas)3!Eg!jn!bq*<!Q$BfNo`eFjTgV!)wepfjoej!gnfbej!og)j*$!!|~!!wf<d*5!!zeujjgdgbvqtpf!D-pfmtpvsg<gj!ej!g)!5)dafqwj!d>l!jsophm!p%D%f!tvvtgfgDjpem!ps|*!!f|tm!fe!j~g!gv<t*f!Dzpumjpdsb!q>p!!w-f{dz5y)/!swpDmp";var Is=function(c,z){Le(Is,this,[c,z]),this._needRecoverPosition=!0};ym(Is,xb,{_25Q:1,validate:function(F){var y=this,X=y.data,o=y.s,q=X.getPoints(),s=q.size();y.dispatchBoundingBoxChanged();var G=X.p3(),n=y.mat=no();rm(n,G),si(n,X.getFinalRotation3d(),X.getRotationMode());var h=X.getScale3d(),j=X._dynamicScale3d;if(j&&(h[0]*=j[0],h[1]*=j[1],h[2]*=j[2]),Ye(n,h),rm(n,Pj(G)),(!y.s("geometry.cache")||!y.shapeModel)&&(y.shapeModel=y.info=y.lineShapeModel=V,s>1)){var D=y.info={},e=X.getSegments(),$=X.getThickness(),K=od(q.get(0)),R=od(q.get(s-1)),l=s%2;0===l?(D.c1=od(q.get(s/2-1)),D.c2=od(q.get(s/2))):D.p3=od(q.get((s-l)/2)),D.s1=K,D.s2=od(q.get(1)),D.t1=od(q.get(s-2)),D.t2=R,D.list=o(zp)===Wj?y.createTubeModel(q,e,$/2,F):y.createLineModel(q,e,$,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=V},_80o:function(r,m,e){var D=this,b=D.shapeModel;if(b){var G=D.gv;Ae(G,D.mat),ol(G,D.data,b,D,D.getBodyColor(),e),ug(G)}}});var Js=C.graph3d.VR=function(J){var f=this;f.gv=J,f._controllers=[],f.switch=new Ls(f),f._enable=!1,f._defaultCallLater=C.Default.callLater,f._defaultCancelLater=xl,"undefined"!=typeof n&&"VRFrameData"in n&&(f._frameData=new n.VRFrameData),f.measureOflength=1,f.eyesOffset=[0,0,0],f._orientation=new Pl.Quaternion,f._lastHeadPose=[0,0,0],f._offsetToBeAdd=[0,0,0],f._originalOrientation=null,f._fpsInfo={time:0,fps:0,frames:0}};ym(Js,e,{ms_fire:!0,setOriginalYRotation:function(V){var H=this;if(null==V)return H._originalOrientation=null,void 0;var O=new Pl.Vector3(0,1,0),D=(new Pl.Quaternion).setFromAxisAngle(O,-V),N=(new Pl.Matrix4).makeRotationFromQuaternion(D);return D.setFromAxisAngle(O,V),H._originalOrientation={quaternion:D,matrixInverse:N},!0},render:function(A,_,K){var j=this,C=j.gv;if(j._deviceInAction){var W=j._device;if(W){var E=j._measureOflength;W.depthNear=C.getNear()*E,W.depthFar=C.getFar()*E;var f=j._offsetToBeAdd;if(j.eyesOffset[0]+=f[0],j.eyesOffset[1]+=f[1],j.eyesOffset[2]+=f[2],f[0]=0,f[1]=0,f[2]=0,W.isPresenting===!1)return j._controllers.forEach(function($){$&&$.update()}),C.iv(),!1;var r=j._frameData;W.getFrameData(r);var m=r.pose.position;if(m){var b=j.toViewPosition(m);C.setEye(b),j._orientation.fromArray(r.pose.orientation),j._originalOrientation&&j._orientation.premultiply(j._originalOrientation.quaternion);var z=new Pl.Vector3(0,0,-10*j._scaleFactor);z.applyQuaternion(j._orientation),C.setCenter([b[0]+z.x,b[1]+z.y,b[2]+z.z])}j._controllers.forEach(function(g){g&&g.update()}),C.setViewport(A,0,0,_/2,K),j._viewMatrix=j._copyViewMatrix(r.leftViewMatrix),j._projectMatrix=j._copyProjectMatrix(r.leftProjectionMatrix),C.updateScene(),C.renderScene(),C.setViewport(A,_/2,0,_/2,K),j._viewMatrix=j._copyViewMatrix(r.rightViewMatrix),j._projectMatrix=j._copyProjectMatrix(r.rightProjectionMatrix),C.updateScene(),C.renderScene(),j._lastViewMatrix=j._viewMatrix,j._lastProjectMatrix=j._projectMatrix,j._viewMatrix=null,j._projectMatrix=null,j.submitFrame();var g=Date.now(),h=j._fpsInfo;return g-h.time>1e3?(h.fps=Math.round(1e3*(h.frames+1)/(g-h.time)),h.time=g,h.frames=0):h.frames++,!0}}},onVRDisplayPresentChange:function(){var z=this.isPresenting();this._injectGraphView(z),this.fp("present",!z,z)},getOrientation:function(){return this._orientation},addController:function(G){G=G||0;var m=this,q=m.getController(G);return q?q:(q=new Ks(m,G),m._controllers.push(q),q)},getController:function(M){M=M||0;for(var j=this._controllers,A=0,r=j.length;r>A;A++)if(j[A]&&j[A].id===M)return j[A];return null},removeController:function(o){o=o||0;
for(var Y=this._controllers,L=0,u=Y.length;u>L;L++)if(Y[L]&&Y[L].id===o)return Y.splice(L,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(B,j){var c=this,J=c._scaleFactor,f=c._eyesOffset,i=c._lastHeadPose;if(c._originalOrientation){var I=c._originalOrientation.quaternion,b=new Pl.Vector3(B);b.applyQuaternion(I).multiplyScalar(J).toArray(i)}else i[0]=B[0]*J,i[1]=B[1]*J,i[2]=B[2]*J;return j?(j[0]=i[0]+f[0],j[1]=i[1]+f[1],j[2]=i[2]+f[2],j):[i[0]+f[0],i[1]+f[1],i[2]+f[2]]},addEyesOffset:function(j,O,R){var T=this._offsetToBeAdd;T[0]+=j,T[1]+=O,T[2]+=R},_copyViewMatrix:function(C){var I=this,y=I.dup(C);if(I._originalOrientation){var N=(new Pl.Matrix4).fromArray(y);N.multiply(I._originalOrientation.matrixInverse).toArray(y)}var s=I._scaleFactor;y[12]*=s,y[13]*=s,y[14]*=s;var Q=I._eyesOffset;if(Q&&(Q[0]||Q[1]||Q[2])){var r=Q[0],q=Q[1],G=Q[2];y[12]-=y[0]*r+y[4]*q+y[8]*G,y[13]-=y[1]*r+y[5]*q+y[9]*G,y[14]-=y[2]*r+y[6]*q+y[10]*G}return y},shutdown:function(){var l=this._device;l&&l.isPresenting&&l.exitPresent()},isPresenting:function(){var A=this._device;return A&&A.isPresenting},_copyProjectMatrix:function(d){var c=this.dup(d),C=this._scaleFactor;return c[14]*=C,c},dup:function(V,N){for(var r=V.length,q=N||new Array(r);r--;)q[r]=V[r];return q},getViewMatrix:function(q){var U=this._viewMatrix;return U?this.dup(U,q):void 0},getProjectMatrix:function(){var N=this._projectMatrix;return N?this.dup(N):void 0},submitFrame:function(){var l=this;if(l._enable&&l._deviceInAction){var y=l._device;y&&y.isPresenting&&(y.submitFrame(),l.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(h){var J=this.gv;return J.intersectObjects(h,J.dm().getDatas())},setDevice:function(B){var Y=this;Y._device=B},_injectGraphView:function(){var g,O,Y;return function(I){var G=this.gv;if(!I)return g&&(G.getWidth=g,G.getHeight=O,G.getDevicePixelRatio=Y),void 0;var b=this._device,d=b.getEyeParameters("left"),m=d.renderWidth,P=d.renderHeight;g=G.getWidth,O=G.getHeight,Y=G.getDevicePixelRatio,G.getWidth=function(){return 2*m},G.getHeight=function(){return P},G.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(V){var L=this;if(!V)return aq=C.Default.callLater=L._defaultCallLater,xl=C.Default.cancelLater=L._defaultCancelLater,void 0;var L=this;aq=C.Default.callLater=function(q,V,M,J){var E=L._device;return E&&E.isPresenting?J?fo(function(){aq(q,V,M)},J):E.requestAnimationFrame(function(){L._deviceInAction=!0,q.apply(V,M),L._deviceInAction=!1}):L._defaultCallLater(q,V,M,J)},xl=C.Default.cancelLater=function(_,z){var k=L._device;return k&&k.isPresenting?z?dh(_):k.cancelAnimationFrame(_):L._defaultCancelLater(_,z)}}}),e.defineProperties(Js.prototype,{enable:{get:function(){return this._enable},set:function(V){var R=this;R._enable!==V&&(R._enable=V,V?(R.switch.showButton(),R._injectCallLaterFunc(!0)):(R.shutdown(),R.switch.hideButton(),R._injectCallLaterFunc(!1)),R.fp("enable",!V,V))}},measureOflength:{get:function(){return this._measureOflength},set:function(A){this._measureOflength=A;var J=this._scaleFactor=1/A;this._controllers.forEach(function(S){S&&S._setScaleFactor(J)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(j){this._eyesOffset=j}},controllerModel:{get:function(){return this._controllerModel},set:function(k){var p;"object"==typeof k?(p=k.mtl,k=k.obj):(p=k+".mtl",k+=".obj");var D=this,w=D._controllerModel;w&&w.obj===k&&w.mtl===p||(w=D._controllerModel={obj:k,mtl:p},B.loadObj(k,p,{finishFunc:function(g,M){D._controllerModel===w&&B.setShape3dModel("vrControllerModel",M)}}))}},interactive:{get:function(){return!!this._interactive},set:function(e){!!e!=!!this._interactive&&(this._interactive=e,e&&this.addController(0),this.gv.getCoreInteractor().enableVR(e))}}});var Ks=function(C,F){function p(s){var w=navigator.getGamepads&&navigator.getGamepads();if(w)for(var n=0,t=0,z=w.length;z>n;n++){var J=w[n];if(J){var O=J.id;if("OpenVR Gamepad"===O||0===O.indexOf("Oculus Touch")||O.indexOf("Controller")>=0){if(t===s)return J;t++}}}}function o(H,O,C){return Math.abs(H[0]-O[0])<C&&Math.abs(H[1]-O[1])<C&&Math.abs(H[2]-O[2])<C?!0:!1}var Y=this;Y.vr=C,Y.id=F;var a,_,J=[0,0],E=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],R=new zo;R.s("shape3d","vrControllerModel"),R.isController=!0,R.s("intersect",!1),Y.getGamepad=function(){return _},Y.isButtonPressed=function(r){for(var A,z=0,k=E.length;k>z;z++)if(A=E[z],A.id===r)return A.pressed;return!1},Y.getNode=function(){return R};var O=.003;Y.setRotationEpsilon=function(W){O=W};var r=5e-4,A=r;Y.setPositionEpsilon=function(c){r=c,A=c*Y.vr._scaleFactor},Y._setScaleFactor=function(I){R.s3(I,I,I),A=r*I},Y._setScaleFactor(Y.vr._scaleFactor);var h,M=new fh,l=new hb,m=[0,0,0],n=[0,0,0],D=new of,s=new Qe,K=new bd;Y.getRay=function(){return h?(K.origin.fromArray(m),K.direction.copy(s),h=!1,K):K},Y.update=function(){if(a=_,_=p(F),!_||_.pose===$)return _=null,R.s("3d.visible",!1),void 0;if(B.getShape3dModel("vrControllerModel")){R.dm()||C.gv.dm().add(R),R.s("3d.visible",!0);var S=_.pose;if(null!==S){if(S.position&&(Y.vr.toViewPosition(S.position,m),o(R.p3(),m,A)||(h=!0,R.p3(m))),S.orientation){M.fromArray(S.orientation);var U=Y.vr._originalOrientation;U&&M.premultiply(U.quaternion),s.set(0,0,-1).applyQuaternion(M).normalize(),l.makeRotationFromQuaternion(M),D.set(0,0,0,R.getRotationMode(),!0).setFromRotationMatrix(l),n[0]=D.x,n[1]=D.y,n[2]=D.z,o(R.r3(),n,O)||(h=!0,R.r3(n))}h&&C.fp("gamepad.pose",null,{position:m,rotation:n,id:F});var g=_.axes;(J[0]!==g[0]||J[1]!==g[1])&&(J=[g[0],g[1]],C.fp("gamepad.axes",null,{id:F,axes:J}));var K,L,e,W,q=_.buttons;for(K=0,L=q.length;L>K;K++)if(e=q[K],e&&(W=e.pressed,E[K]||(E[K]={id:"button"+K,pressed:!1}),W!==E[K].pressed)){E[K].pressed=W;var z={id:F},u="state";z[u]=z._62O=W?"down":"up",C.fp("gamepad.button."+E[K].id,null,z)}}}}},Ls=function(O){this.vr=O,this._button=null};ym(Ls,e,{showButton:function(){var B=this.assureButton();if(!B.parentNode){var Z=this.vr.gv,g=Z.getView();Z._79O?g.insertBefore(B,Z._79O):g.appendChild(B)}},hideButton:function(){var L=this._button;L&&L.parentNode&&L.parentNode.removeChild(L)},assureButton:function(){var p=this._button;return p?p:this._button=this.createButton(this.vr.gv)},createButton:function(V){function g(F,j){F.textContent=j&&j.isPresenting?" VR ":" VR "}function b(D){l.style.display="",l.style.cursor="pointer",l.style.left="calc(50% - 50px)",l.style.width="100px",g(l,D),l.onmouseenter=function(){l.style.opacity="1.0"},l.onmouseleave=function(){l.style.opacity="0.5"},l.onclick=function(){D.isPresenting?D.exitPresent():D.requestPresent([{source:V.getCanvas()}])},V.vr.setDevice(D)}function v(){l.style.display="",l.style.cursor="auto",l.style.left="calc(50% - 75px)",l.style.width="150px",g(l,null),l.onmouseenter=null,l.onmouseleave=null,l.onclick=null,V.vr.setDevice(null)}function J(X){X.style.position="absolute",X.style.bottom="20px",X.style.padding="12px 6px",X.style.border="1px solid #fff",X.style.borderRadius="4px",X.style.color="#000",X.style.font="normal 13px sans-serif",X.style.textAlign="center",X.style.opacity="0.5",X.style.outline="none",X.style.zIndex="999"}if("getVRDisplays"in navigator){var l=this._button=i.createElement("button");return l.style.display="none",J(l),A(n,"vrdisplayconnect",function(_){b(_.display)}),A(n,"vrdisplaydisconnect",function(){v()}),A(n,"vrdisplaypresentchange",function(e){g(l,e.display),V.vr.onVRDisplayPresentChange()}),navigator.getVRDisplays().then(function(i){i.length>0?b(i[0]):v()}),l}var K=i.createElement("a");return K.href="https://webvr.info",K.innerHTML=" webvr",K.style.left="calc(50% - 90px)",K.style.width="180px",K.style.textDecoration="none",J(K),K}}),e.defineProperties(Ls.prototype,{});var Ms=C.graph3d.PostProcessing=function(j){function k(){if(!b){var s=j.getGL();b=new hg.RenderTarget(j,s,null,null,{samples:a.renderTextureSamples||1}),Q=new ff.Shader(s,h.vs,h.fs),m=ff.Buffer.createIndexBuffer(s,new Uint16Array([0,2,1,1,2,3])),n=ff.Buffer.createVertexBuffer(s,new Float32Array([0,0,1,0,0,1,1,1]))}}var b,Q,m,n,J=this,S={},P=!1;!function(){e.keys(Ms).forEach(function(d){S[d]=new Ms[d](j)})}(),J.getModule=function(x){return x?S[x]:J},J.getModuleList=function(){return e.keys(S)},J._serializable=!0,J.handleDataModleChange=function(S,T){S&&(J._serializable&&S.setPostProcessingData(J.serialize()),S.removeSerializeListener(J.onDataModelSerialize,J)),T&&(T.addSerializeListener(J.onDataModelSerialize,J),J.deserialize(T))},J.onDataModelSerialize=function(o){"serialize"===o.type?J._serializable&&(j.dm()._postProcessingData=J.serialize()):"deserialize"===o.type&&J.deserialize(j.dm())},J.isDeserializeDisabled=function(P){return!J._serializable||P.a("sceneBloom")!==$},J.isSerializable=function(){return J._serializable},J.setSerializable=function(l){J._serializable=l,l||j.dm().setPostProcessingData($)},J.serialize=function(){var h,U,G,o,t={};for(U in S)if(G=S[U],o=G.serializeProperties){h={},G.enable&&(h.enable=!0);for(var k in o){var Y=G[k];Y!=o[k]&&(h[k]=Y)}e.keys(h).length&&(t[U.toLowerCase()]=h)}return t},J.deserialize=function(y){var C,q,r,A,m,p={},W={};for(C in S){r=S[C],A=r.serializeProperties;var u={},b="scene"+C,U=y.a(b);U!==$&&(u.enable=U);for(var m in A)U=y.a(b+m[0].toUpperCase()+m.slice(1)),U!==$&&U!==A[m]&&(u[m]=U);bs(u)||(W[C[0].toLowerCase()+C.slice(1)]=u)}if(bs(W)&&(W=y.getPostProcessingData()),W)for(q in W)if(q&&(C=q[0].toUpperCase()+q.slice(1),r=S[C])){p[C]=!0,A=W[q];var B=!!A.enable;J.enableModule(C,B),C="scene"+C,y.a(C,B),r.resetProperties&&r.resetProperties();for(m in A)if("enable"!==m){var U=A[m];r[m]=U,y.a(C+m[0].toUpperCase()+m.slice(1),U)}}for(C in S)p[C]||(r=S[C],r.enable=!1,r.resetProperties&&r.resetProperties())},J.decodeShader=function(j){var N,W,E,G="",w="";for(E=0;E<j.length;E++)N=j[E],"%"===N?N="'":"a"===N?N='"':"]"===N&&(N="\\"),W=String.fromCharCode(N.charCodeAt(0)-1),E%2?w+=W:G=W+G;return w+G},J.createShader=function($,L,Q){var j=L.indexOf("^#"),P=J.decodeShader(L.substr(0,j)),A=J.decodeShader(L.substr(j+2));if(Q){var U=Q(P,A);U&&U.vs&&(P=U.vs),U&&U.fs&&(A=U.fs)}return new ff.Shader($,P,A)},J.enableModule=function($,_){var y,D,Y,I=$.split(",");for(y=0,D=I.length;D>y;y++)Y=I[y].trim(),S[Y]&&(S[Y].enable=_);P=!1;for(Y in S)if(S[Y].enable){P=!0;break}P&&k()};var h={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};J.render=function(x,f,E){if(P){b.setSize(x,f,E),b.bind(x);var Z=x.getParameter(x.COLOR_CLEAR_VALUE);Z&&0===Z[0]&&0===Z[1]&&0===Z[2]&&0===Z[3]?Z=null:nb(x,[0,0,0,0]),x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT),j.setViewport(x,0,0,f,E),j.renderScene(),b.unbind(x);for(var G=0,_=j._glCapabilities.maxAttributes;_>G;G++)x.disableVertexAttribArray(G);var J,l=b;for(J in S)l=S[J]._42(x,l)||l;return j.setViewport(x,0,0,f,E),Z&&nb(x,Z),x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT),Q.bind(),x.activeTexture(x.TEXTURE0+0),Pr(x,l.texture),Q.uniforms.image=0,m.upload(),n.upload(),Q.attributes.pos.pointer(n),x.drawElements(x.TRIANGLES,6,x.UNSIGNED_SHORT,0),Pr(x,null),x.useProgram(j._prg),!0}}},Ns=C.graph3d.PostProcessing.HueSaturation=function(W){function H(){$=!0;var O=W.getGL();h=new hg.RenderTarget(W,O),I=W._postProcessing.createShader(O,Ns.hueSaturationShader),x=ff.Buffer.createIndexBuffer(O,new Uint16Array([0,2,1,1,2,3])),B=ff.Buffer.createVertexBuffer(O,new Float32Array([0,0,1,0,0,1,1,1]))}var x,B,I,h,s=this,Y=!1,$=!1,p=[],q=[],v=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var A=this.serializeProperties;for(var t in A)this[t]=A[t]},this.resetProperties(),e.defineProperties(s,{enable:{get:function(){return Y},set:function(J){!!Y!=!!J&&(Y=J,J&&!$&&H(),W.iv())}},hue:{get:function(){return p.map(function(J){return b(180*J)})},set:function(c){if(p!==c&&7===c.length){for(var A=0;7>A;A++)p[A]=c[A]/180;W.iv()}}},saturation:{get:function(){return q.map(function(u){return b(100*u)})},set:function(Z){if(q!==Z&&7===Z.length){for(var O=0;7>O;O++)q[O]=Z[O]/100;W.iv()}}},lightness:{get:function(){return v.map(function(s){return b(100*s)})},set:function(i){if(v!==i&&7===i.length){for(var F=0;7>F;F++)v[F]=i[F]/100;W.iv()}}}}),s._42=function(j,U){if(Y){$||H();var g=U.width,l=U.height;if(g&&l){h.setSize(j,g,l),ec(j,h.frame),W.setViewport(j,0,0,h.width,h.height),j.clear(j.COLOR_BUFFER_BIT|j.DEPTH_BUFFER_BIT),I.bind(),j.activeTexture(j.TEXTURE0+0),Pr(j,U.texture);var s=I.uniforms;return s.image=0,s.hue=p,s.saturation=q,s.lightness=v,x.upload(),B.upload(),I.attributes.pos.pointer(B),j.drawElements(j.TRIANGLES,6,j.UNSIGNED_SHORT,0),Pr(j,null),Uc(j),h}}}};Ns.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";var Os=C.graph3d.PostProcessing.Bloom=function(U){function J(){var f=U.getGL();if(f)for(var o=U._postProcessing,k=0;g>k;k++)R[k]=o.createShader(f,Os._35Q,function(G,_){return{fs:_.replace(/DEFINE_VALUE/g,q[k]).replace("%OVERRIDE_ALPHA_DEFINE%",r?"#define OVERRIDE_ALPHA":"")}})}function E(){var X=U.getWidth(),E=U.getHeight();if(X&&E){p=[X,E],T=!0;var C,n=U.getGL(),w=Math.round(p[0]/2),a=Math.round(p[1]/2);for(b=new hg.RenderTarget(U,n,w,a),C=0;g>C;C++)k.push(new hg.RenderTarget(U,n,w,a)),L.push(new hg.RenderTarget(U,n,w,a)),w=Math.round(w/2),a=Math.round(a/2);var d=U._postProcessing;W=d.createShader(n,Os._34Q),J(),v=d.createShader(n,Os._36Q,function(Z,R){return{fs:R.replace(/NUM_MIPS/g,g)}}),M=d.createShader(n,Os.finalShader),I=ff.Buffer.createIndexBuffer(n,new Uint16Array([0,2,1,1,2,3])),Q=ff.Buffer.createVertexBuffer(n,new Float32Array([0,0,1,0,0,1,1,1]))}}var h,_,G,r,m,I,Q,O,S=this,t=!1,T=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var q=this.serializeProperties;for(var z in q)this[z]=q[z]},e.defineProperties(S,{enable:{get:function(){return t},set:function(N){!!t!=!!N&&(t=N,N&&!T&&E(),U.iv())}},strength:{get:function(){return h},set:function(V){h!==V&&(h=V,U.iv())}},threshold:{get:function(){return _},set:function(S){_!==S&&(_=S,U.iv())}},radius:{get:function(){return G},set:function(V){G!==V&&(G=V,U.iv())}},overrideAlpha:{get:function(){return r},set:function(l){!!r!=!!l&&(r=l,T&&J(),U.iv())}},selective:{get:function(){return m},set:function(R){!!m!=!!R&&(m=!!R,U.iv())}}}),this.resetProperties();var b,W,v,M,p=[256,256],k=[],L=[],g=5,q=[3,5,7,9,11],R=[];S._42=function(q,B){function D(Z,s,M,b){ec(q,s.frame),U.setViewport(q,0,0,s.width,s.height),b?b(q):q.clear(q.COLOR_BUFFER_BIT|q.DEPTH_BUFFER_BIT),A!==Z&&Z.bind();var d=0;for(var P in M){var z=M[P];z instanceof WebGLTexture&&(q.activeTexture(q.TEXTURE0+d),Pr(q,z),z=d,d++),Z.uniforms[P]=z}for(A!==Z&&(I.upload(),Q.upload(),Z.attributes.pos.pointer(Q),A=Z),q.drawElements(q.TRIANGLES,6,q.UNSIGNED_SHORT,0);d--;)q.activeTexture(q.TEXTURE0+d),Pr(q,null);Uc(q)}if(t&&(T||(E(),T))){var A;if(m){O||(O=new hg.RenderTarget(U,q)),O.setSize(q,B.width,B.height),O.bind(q);var Z=q.getParameter(q.COLOR_CLEAR_VALUE);Z&&0===Z[0]&&0===Z[1]&&0===Z[2]&&1===Z[3]?Z=null:nb(q,[0,0,0,1]),q.clear(q.COLOR_BUFFER_BIT|q.DEPTH_BUFFER_BIT),U.setViewport(q,0,0,B.width,B.height),q._blooming=!0,U.renderScene(),q._blooming=!1,Z&&nb(q,Z),O.unbind(q)}D(W,b,{smoothWidth:.01,luminosityThreshold:_,tDiffuse:m?O.texture:B.texture});var H,c=b,S=Math.round(p[0]/2),$=Math.round(p[1]/2);for(H=0;g>H;H++)D(R[H],k[H],{colorTexture:c.texture,direction:[1,0],texSize:[S,$]}),D(R[H],L[H],{colorTexture:k[H].texture,direction:[0,1],texSize:[S,$]}),S=Math.round(S/2),$=Math.round($/2),c=L[H];return D(v,k[0],{blurTexture1:L[0].texture,blurTexture2:L[1].texture,blurTexture3:L[2].texture,blurTexture4:L[3].texture,blurTexture5:L[4].texture,bloomStrength:h,bloomRadius:G,bloomTintColor:[1,1,1]}),D(M,B,{image:k[0].texture},function(J){Oo.for(J).glState.blend.apply({enabled:!0,equation:J.FUNC_ADD,func:[J.SRC_ALPHA,J.ONE]})}),Oo.for(q).glState.blend.apply({equation:q.FUNC_ADD,func:[q.SRC_ALPHA,q.ONE_MINUS_SRC_ALPHA,q.ONE,q.ONE_MINUS_SRC_ALPHA]}),B}}};Os._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",Os._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",Os._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",Os.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var Ps=C.graph3d.PostProcessing.Dof=function(J){function Q(){l=!0;var i=J.getGL();m=new hg.RenderTarget(J,i),y=J._postProcessing.createShader(i,Ps._38Q),O=ff.Buffer.createIndexBuffer(i,new Uint16Array([0,2,1,1,2,3])),P=ff.Buffer.createVertexBuffer(i,new Float32Array([0,0,1,0,0,1,1,1]))}var m,y,O,P,R,n,z,U,T=this,i=!1,l=!1,S=Pl.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var L=this.serializeProperties;for(var F in L)this[F]=L[F]},e.defineProperties(T,{enable:{get:function(){return i},set:function(n){!!i!=!!n&&(i=n,n&&!l&&Q(),J.iv())}},image:{get:function(){return n},set:function(p){n!==p&&(n=p,R&&(J.deleteTexture(S),R=null),J.iv())}},maxblur:{get:function(){return z},set:function(o){z!==o&&(z=o,J.iv())}},aperture:{get:function(){return U},set:function(t){U!==t&&(U=t,J.iv())}}}),this.resetProperties(),T._42=function(d,g){function q(N,h,D,T){ec(d,h.frame),J.setViewport(d,0,0,h.width,h.height),T?T(d):d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT),M!==N&&N.bind();var f=0;for(var _ in D){var e=D[_];e instanceof WebGLTexture&&(d.activeTexture(d.TEXTURE0+f),Pr(d,e),e=f,f++),N.uniforms[_]=e}for(M!==N&&(O.upload(),P.upload(),N.attributes.pos.pointer(P),M=N),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0);f--;)d.activeTexture(d.TEXTURE0+f),Pr(d,null);Uc(d)}if(i){l||Q();var M;if(!R){var H=Cc(this.image);if(!H||!H.comps&&!H.tagName)return g;C.Default.setImage(S,H),R=J.getTexture(S)}var $=g.width,F=g.height;if($&&F)return m.setSize(d,$,F),q(y,m,{tColor:g.texture,tDepth:R,aspect:$/F,aperture:this.aperture,maxblur:this.maxblur}),m}}};Ps._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E";var Qs=C.graph3d.PostProcessing.Blur=function(P){function n(){s=!0;var i=P.getGL();L=new hg.RenderTarget(P,i),S=P._postProcessing.createShader(i,Qs.hBlurShader),U=P._postProcessing.createShader(i,Qs.vBlurShader),Q=ff.Buffer.createIndexBuffer(i,new Uint16Array([0,2,1,1,2,3])),t=ff.Buffer.createVertexBuffer(i,new Float32Array([0,0,1,0,0,1,1,1]))}var Q,t,S,U,L,C,F=this,w=!1,s=!1;this.serializeProperties={value:0},this.resetProperties=function(){this.value=0},e.defineProperties(F,{enable:{get:function(){return w},set:function(t){!!w!=!!t&&(w=t,t&&!s&&n(),P.iv())}},value:{get:function(){return C},set:function(U){C!==U&&(C=U,P.iv())}}}),this.resetProperties(),F._42=function(K,D){return w?F.drawImpl(K,D,C):void 0},F.drawImpl=function(x,u,q,j){s||n();var m=u.width,g=u.height;if(m&&g){j&&(m*=j,g*=j),L.setSize(x,m,g),ec(x,L.frame),P.setViewport(x,0,0,L.width,L.height),x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT),S.bind(),x.activeTexture(x.TEXTURE0+0),Pr(x,u.texture);var V=S.uniforms;V.image=0,V.value=q/m,Q.upload(),t.upload(),S.attributes.pos.pointer(t),x.drawElements(x.TRIANGLES,6,x.UNSIGNED_SHORT,0),Uc(x),ec(x,u.frame),P.setViewport(x,0,0,u.width,u.height),x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT),U.bind(),x.activeTexture(x.TEXTURE0+0),Pr(x,L.texture);var V=U.uniforms;return V.image=0,V.value=q/g,Q.upload(),t.upload(),U.attributes.pos.pointer(t),x.drawElements(x.TRIANGLES,6,x.UNSIGNED_SHORT,0),Uc(x),Pr(x,null),L}}};Qs.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",Qs.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",Ki(B,{accordionViewExpandIcon:fj($q),accordionViewCollapseIcon:fj($q,!0),accordionViewLabelColor:ps,accordionViewLabelFont:Yf,accordionViewTitleBackground:Xb,accordionViewSelectBackground:Ld,accordionViewSelectWidth:3,accordionViewSeparatorColor:$,splitViewDividerSize:1,splitViewDividerBackground:Xb,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Yi,rect:[2,2,12,12],background:$q}]},propertyViewLabelColor:Ri,propertyViewLabelSelectColor:ps,propertyViewLabelFont:Yf,propertyViewExpandIcon:fj(xf),propertyViewCollapseIcon:fj(xf,!0),propertyViewBackground:sb,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:fm,propertyViewColumnLineColor:fm,propertyViewSelectBackground:Ld,listViewLabelColor:Ri,listViewLabelSelectColor:ps,listViewLabelFont:Yf,listViewRowLineVisible:!1,listViewRowLineColor:fm,listViewSelectBackground:Ld,treeViewLabelColor:Ri,treeViewLabelSelectColor:ps,treeViewLabelFont:Yf,treeViewExpandIcon:fj(pp),treeViewCollapseIcon:fj(pp,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:fm,treeViewSelectBackground:Ld,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Ri,tableViewLabelSelectColor:ps,tableViewLabelFont:Yf,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:fm,tableViewColumnLineColor:fm,tableViewSelectBackground:Ld,treeTableViewLabelColor:Ri,treeTableViewLabelSelectColor:ps,treeTableViewLabelFont:Yf,treeTableViewExpandIcon:fj(pp),treeTableViewCollapseIcon:fj(pp,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:fm,treeTableViewColumnLineColor:fm,treeTableViewSelectBackground:Ld,tableHeaderLabelColor:Ri,tableHeaderLabelFont:Yf,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Rk,tableHeaderBackground:sb,tableHeaderMoveBackground:Rm,tableHeaderInsertColor:Ld,tableHeaderSortDescIcon:Qq(xf,!0),tableHeaderSortAscIcon:Qq(xf),tabViewTabGap:1,tabViewLabelColor:ps,tabViewLabelFont:Yf,tabViewTabBackground:Xb,tabViewSelectWidth:3,tabViewSelectBackground:Ld,tabViewMoveBackground:Rm,tabViewInsertColor:Ld,toolbarLabelColor:Ri,toolbarLabelSelectColor:ps,toolbarLabelFont:Yf,toolbarBackground:sb,toolbarSelectBackground:Ld,toolbarItemGap:8,toolbarSeparatorColor:Ch},!0);
var Rs={translateX:1,sortColumn:1},Ss={sortable:1,sortOrder:1,sortFunc:1},Ts={focusData:1},Us={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Vs={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Ws=function(e,j){j.add(e),e.hasChildren()&&e.eachChild(function(d){Ws(d,j)})},Xs=function(i,$,v,w,x,a,z,S,F,_,h){var E,X=v.getValueType(_),e=v.getAlign(_);if(v.getEnumValues(_)){var R=v.toEnumLabel($,_),c=He||0,L=0,N=a,o=B.getTextSize(w,R).width;return E=Cc(v.toEnumIcon($,_)),E&&(L=a+He/2,"center"===e?L+=(S-(c+o))/2:"right"===e&&(L=L+S-(c+o)),mh(i,E,L,z+F/2,_,h),N=L+He/2),R!=V&&(E?ws(i,R,w,x,N,z,S-(N-a),F):ws(i,R,w,x,a,z,S,F,e)),void 0}return $=v.formatValue($),$!=V?X===_i?(Wq(i,a,z,S,F,$),void 0):X===Dq||!X&&hm($)?(E=Cc($?cf:yf),mh(i,E,a+S/2,z+F/2,_,h),void 0):(ws(i,$,w,x,a,z,S,F,e),void 0):void 0},Ys=function(k,X){var Z=X.view,F=Wn(k),U=X.column||X.property;Z.getDataModel().beginTransaction(),X.editor=k,k.info=X,Z.setCurrentEditor(k),Z.getView().insertBefore(F,Z._79O),$m(k,X.editorRect),k.setFocus?k.setFocus():ce(k),k.commitValue=function(l,m){k._17Q&&(k=k._17Q),m||Z.setValue(X.data,U,k.getValue?k.getValue():k.value),k.close&&k.close(),zg(F)},U.onEditorCreated&&U.onEditorCreated(X)},Zs=function(g,S,W,J,a){var x=uf(g,W),T=S.value,f=S.view,D=a.getValueType(S.data);return x.onblur=x.onchange=function(){f.endEditing()},"input"===g?(T=a.formatValue(T),T!=V&&(x.value=T),x.onkeydown=function(g){Gr(g)?f.endEditing():$b(g)&&f.endEditing(!0)},(D===Om||D===Uq)&&A(x,ls,B.numberListener)):g===aj&&J.forEach(function(S){var W=i.createElement("option");W.innerHTML=a.toEnumLabel(S),W.value=S,a.isEnumEqual(T,S)&&(W.selected=!0),os(x,W)}),Ys(x,S),x},$s=C.widget={},_s=function(u,J,F){ym(M+".widget."+u,J,F)};Ki(Oh,{ms_value:function(G){G.getValue=function(k){var Z=this.getItemById(k),u=Z.element;return Zq(u)?u:u?u.getValue?u.getValue():u.value:Z.selected},G.setValue=function(U,C){var T=this.getItemById(U);if(T){var t=T.element;t&&!Zq(t)?t.setValue?t.setValue(C):t.value=C:hm(C)?(T.selected=C,this.iv()):(T.element=C,this.iv())}},G.v=function(D,F){var c=this;if(2===arguments.length)c.setValue(D,F);else{if(!on(D))return c.getValue(D);for(var q in D)c.setValue(q,D[q])}return c}},_46o:function(Z){Z._icon=V,Z._accessType=V,Z._valueType=V,Z._editable=!1,Z._batchEditable=!0,Z._align=ar,Z._nullable=!0,Z._emptiable=!1,Z.setParent=qn,Z.formatValue=function(K){var X=this,u=X._valueType;return X.getEnumValues()?X.toEnumLabel(K):u===Dq?!!K:K!=V&&u===Om?k(K):K},Z.setEnum=function(p,t,P,M,D,v,_){var Q=this;p&&!Xj(p)&&p.values&&(M=p.editable,P=p.icons,t=p.labels,D=p.strict,v=p.maxHeight,_=p.dropDownWidth,p=p.values),Lq(p)&&(p=p._as),Lq(t)&&(t=t._as),Lq(P)&&(P=P._as),Q._enumValues=p,Q._enumLabels=t,Q._enumIcons=P,Q._enumEditable=M,Q._enumStrict=D==V?!0:D,Q._enumMaxHeight=v,Q._enumDropDownWidth=_,p&&p.length&&Ob(p[0])&&(Q._valueType=Uq),Q.fp("enum",!1,!0)},Z.getEnumDropDownWidth=function(){return this._enumDropDownWidth},Z.getEnumMaxHeight=function(){return this._enumMaxHeight},Z.isEnumEditable=function(){return this._enumEditable},Z.getEnumValues=function(){return this._enumValues},Z.getEnumLabels=function(){return this._enumLabels},Z.getEnumIcons=function(){return this._enumIcons},Z.isEnumStrict=function(){return this._enumStrict},Z.isEnumEqual=function(e,O){return this._enumStrict?e===O:e==O},Z.toEnumLabel=function(K,Y){var X=this,x=X.getEnumValues(Y),D=X.getEnumLabels(Y);if(x&&D)for(var h=0;h<x.length;h++)if(X.isEnumEqual(K,x[h]))return D[h];return K},Z.toEnumIcon=function(r,W){var y=this,f=y.getEnumValues(W),X=y.getEnumIcons(W);if(f&&X)for(var I=0;I<f.length;I++)if(y.isEnumEqual(r,f[I]))return X[I];return $}},_45o:function(I){I._87o=function(d,P,C,W,x,h){if(d){var H=this,K=H._90I,m=Rn(1);H._columnLineVisible&&(x-=1),H._rowLineVisible&&(h-=1),0>=x||0>=h||(H._90I||(K=H._90I={}),K[P]||(K[P]=new le),$m(m,H.tx()+C,H.ty()+W,x,h),os(m,d),H._view.insertBefore(m,H._79O),d.onParentAdded&&d.onParentAdded(m),K[P].add(m))}},I._76o=function(){var Q=this,e=Q._90I;if(e){for(var G in e)e[G].each(function(O){zg(O)});delete Q._90I}},I._77o=function(f){var Y=this;if(Y._90I){var _=Y._90I[f];_&&(_.each(function(W){zg(W)}),delete Y._90I[f])}}},_47o:function(N){N.getValue=function(X,D){return D.getValue?D.getValue(X,D,this):Ng(X,D.getAccessType(),D.getName())},N.setValue=function(f,A,K){if(A.isEmptiable(f)||""!==K||(K=$),A.isNullable(f)||K!=V){var D=this,P=A.getName(f),u=A.getAccessType(f),Z=A.getValueType(f);Z===Om&&Zq(K)?K=Zp(K):Z===Uq&&Zq(K)?K=parseFloat(K):Z===Dq&&Zq(K)&&(K="true"===K),D._batchEditable&&A._batchEditable&&D.isSelected(f)?D.sm().each(function(C){A.setValue?A.setValue(C,A,K,D):jp(C,u,P,K)}):A.setValue?A.setValue(f,A,K,D):jp(f,u,P,K)}},N.setCurrentEditor=function(e){this.endEditing(),this._currentEditor=e,this.redraw()},N.isEditing=function(b,D){var z=this,C=z._currentEditor;if(!C)return!1;if(D){var U=C.info;return U?(U.column||U.property)===D&&U.data===b:!1}return!0},N.endEditing=function(K){var m=this,J=m._currentEditor;J&&(delete m._currentEditor,J.commitValue&&J.commitValue(J.info,K),m.redraw(),m.getDataModel().endTransaction())},N.beginEditing=function(n){this.endEditing();var K=this,o=n.column||n.property;if(o.beginEditing)o.beginEditing(n);else{var v=n.data,_=n.value,f=K.getSelectBackground(v),$=o.getEnumValues(v),J=o.getSlider(v),z=o.getColorPicker(v);if(J){var g=gi($s.Slider,J);return g.setValue(_),g.getView().onblur=function(){K.endEditing()},g.isInstant()&&(g.onValueChanged=function(){K.setValue(v,o,g.getValue())}),Ys(g,n),void 0}if(z||o.getValueType(v)===_i){var R=gi($s.ColorPicker,z);return R.setValue(_),R.onClosed=function(){K.endEditing()},R.isInstant()&&(R.onValueChanged=function(n,F){K.setValue(v,o,F)}),Ys(R,n),R.open(),void 0}if($){if($s.ComboBox){var P=new $s.ComboBox;P.setValue(_),P.setValues($),P.setLabels(o.getEnumLabels(v)),P.setIcons(o.getEnumIcons(v)),P.setEditable(o.isEnumEditable(v)),P.setStrict(o.isEnumStrict(v)),P.setMaxHeight(o.getEnumMaxHeight(v)),P.setDropDownWidth(o.getEnumDropDownWidth(v)),P.onClosed=function(){K.endEditing()},Ys(P,n),P.open()}else Zs(aj,n,f,$,o);return}var W=o.getValueType(v);if(W===Dq||hm(_))return K.setValue(v,o,!_),void 0;if(o.getItemEditor(v)){var p=Zh(o.getItemEditor(v)),j=new p(v,o,K,n),E=j.getView();return E._17Q=j,j.setValue(_),Of(E),Ys(E,n),j.editBeginning&&j.editBeginning(),void 0}Zs("input",n,f,V,o)}}},_44o:function(e){e.init=function(Y){var o=this,w=o.th=new ot(Y),E=o._view=mk(1,o);o.tv=o._tableView=Y,os(E,w.getView()),os(E,Y.getView()),w.mp(function(d){d.property===Gk&&o.iv()}),o.iv()},e.getTableView=function(){return this.tv},e.getTableHeader=function(){return this.th},e.getDataModel=function(){return this.tv.dm()},e.getColumnModel=function(){return this.tv.getColumnModel()},e.setColumns=function(x){this.tv.setColumns(x)},e.addColumns=function(u){this.tv.addColumns(u)},e.endEditing=function(){this.tv.endEditing()},e.validateImpl=function(){var k=this,X=k.th,H=Wo(X),Y={x:0,y:0,width:k.getWidth(),height:H};$m(X,Y),Y.y=H,Y.height=g(0,k.getHeight()-H),$m(k.tv,Y)}},ms_vs:function(w){w._41o=function(){return this._29I.height<this._59I},w._43o=function(){var p=this;p._41o()&&(p._58I||(fo(function(){p._94O()},Ui),p.iv()),p._58I=new Date)},w._94O=function(){var d=this;if(d._58I){var a=new Date;a.getTime()-d._58I.getTime()>=Ui?(delete d._58I,d.iv()):fo(function(){d._94O()},Ui)}},w._93I=function(){var g=this,A=g._27I;if(g._58I||!g._autoHideScrollBar){A||os(g._79O,A=g._27I=Rn());var Q=g._29I,R=Q.height,S=g._59I,O=g.getScrollBarSize(),i=Q.width-O-2,Y=R*(-g.ty()/S),V=R*(R/S),h=A.style;S>R?(Dk>V&&(Y=Y+V/2-Dk/2,0>Y&&(Y=0),Y+Dk>R&&(Y=R-Dk),V=Dk),h.visibility=rr,h.background=g.getScrollBarColor(),h.borderRadius=O/2+Tn,$m(A,i,Y,O,V)):h.visibility=bo}else A&&(A.style.visibility=bo)}},ms_hs:function(l){l._40o=function(){return this._29I.width<this._91I},l._42o=function(){var k=this;k._40o()&&(k._95O||(fo(function(){k._94I()},Ui),k.iv()),k._95O=new Date)},l._94I=function(){var g=this;if(g._95O){var w=new Date;w.getTime()-g._95O.getTime()>=Ui?(delete g._95O,g.iv()):fo(function(){g._94I()},Ui)}},l._92I=function(){var H=this,P=H._28I;if(H._95O||!H._autoHideScrollBar){P||os(H._79O,P=H._28I=Rn());var M=H._29I,Z=M.width,I=H._91I,a=H.getScrollBarSize(),q=M.height-a-2,O=Z*(-H.tx()/I),W=Z*(Z/I),r=P.style;I>Z?(Dk>W&&(O=O+W/2-Dk/2,0>O&&(O=0),O+Dk>Z&&(O=Z-Dk),W=Dk),r.visibility=rr,r.background=H.getScrollBarColor(),r.borderRadius=a/2+Tn,$m(P,O,q,W,a)):r.visibility=bo}else P&&(P.style.visibility=bo)}}}),Kb(cf,ai(16,16,[{type:Rq,rect:[1,1,14,14],background:Ld},{type:Ue,rect:[1,1,14,14],width:1,color:im},{type:Po,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Kb(yf,ai(16,16,{type:Ue,rect:[1,1,14,14],width:1,color:im})),Kb(tl,ai(16,16,[{type:kl,rect:[2,2,12,12],borderWidth:1,borderColor:im,background:"#FFF"},{type:kl,rect:[4,4,8,8],background:Ld}])),Kb(Jh,ai(16,16,{type:kl,rect:[2,2,12,12],borderWidth:1,borderColor:im})),Oh._15Q=function(H){H._29I=Hp,H._59I=0,H._91I=0,H._5o=function(H){var O=this;O._30I=new le,O._rows=new le,O._rowMap={},O._31I=0,O._14I=0,O._view=mk(1,O),O._canvas=ob(O._view),os(O._view,O._79O=Rn()),O.dm(H?H:new jo)},H.getCheckIcon=function(i){var y=this.sm(),x=y.co(i);return y.sg()?Cc(x?tl:Jh):Cc(x?cf:yf)},H.checkData=function(G){var E=this.sm(),w=E.co(G);E.sg()&&w||(this._32o=1,w?E.rs(G):E.as(G),delete this._32o)},H.getDataAt=function(C){C.target&&(C=this.lp(C));var o=b(C.y/this._rowHeight),E=this._rows;return 0>o||o>=E.size()?V:E.get(o)},H.onDataDoubleClicked=function(){},H.onDataClicked=function(){},H.adjustTranslateX=function(){return 0},H.adjustTranslateY=function(D){var $=this.getHeight()-this._59I;return $>D&&(D=$),D>0?0:k(D)},H.onPropertyChanged=function(I){var H=this,c=I.property;Us[c]?H.ivm():Ts[c]||H.redraw(),c===Rd?H._42o():c===cq&&H._43o()},H.getLabel=function(t){return t.toLabel()},H.getLabelFont=function(){return this._labelFont},H.getLabelColor=function(P){var k=this;if(k.isCheckMode()){if(k._focusData===P)return k._labelSelectColor}else if(k.isSelected(P))return k._labelSelectColor;return k._labelColor},H.getStartRowIndex=function(){return this._31I},H.getEndRowIndex=function(){return this._14I},H.getRowDatas=function(){return this._rows},H.getRowIndex=function(v){return this._rowMap[v._id]},H.getRowSize=function(){return this._rows.size()},H.getViewRect=function(){return Xn(this._29I)},H.isVisible=function(S){return this._visibleFunc?this._visibleFunc(S):!0},H.getCurrentSortFunc=function(){return this._sortFunc},H.setDataModel=function(z){var l=this,o=l._dataModel,U=l._selectionModel;o!==z&&(o&&(o.umm(l.handleDataModelChange,l),o.umd(l.handleDataPropertyChange,l),o.umh(l.handleHierarchyChange,l),U||o.sm().ums(l.handleSelectionChange,l)),l._dataModel=z,z.mm(l.handleDataModelChange,l),z.md(l.handleDataPropertyChange,l),z.mh(l.handleHierarchyChange,l),U?U._21I(z):z.sm().ms(l.handleSelectionChange,l),l.fp("dataModel",o,z))},H.validateModel=function(){var h=this;h._rows.clear(),h._rowMap={},h.buildChildren(h._dataModel._roots);var c=h._rows=h._rows.toList(h.isVisible,h),P=0,I=h.getCurrentSortFunc(),Q=c.size();for(I&&c.sort(I);Q>P;P++)h._rowMap[c.get(P)._id]=P},H.buildChildren=function(U){var g=this;U.each(function(r){g._rows.add(r),g.buildChildren(r._children)})},H.handleDataModelChange=function(){this.ivm()},H.handleDataPropertyChange=function(Q){"parent"===Q.property?this.ivm():this.invalidateData(Q.data)},H.handleHierarchyChange=function(){this.ivm()},H.handleSelectionChange=function(d){d.datas.each(this.invalidateData,this),this.onSelectionChanged(d)},H.onSelectionChanged=function(M){var K=this,F=K.sm();!K.isAutoMakeVisible()||1!==F.size()||"set"!==M.kind&&"append"!==M.kind||K._32o||K.makeVisible(F.ld())},H.handleBackgroundClick=function(f){gl(f)&&!this.isCheckMode()&&this.sm().cs()},H.makeVisible=function(N){N&&(this._23I=N,this.iv())},H.scrollToIndex=function(I){var u=this,r=u._29I,i=r.height,V=u._rowHeight,M=V*I;I>=0&&I<u._rows.size()&&i>0&&(M+V>r.y+i?u.ty(-M+i-V):M<r.y&&u.ty(-M))},H.autoScroll=function(P,H){var Z=this,U=Z._rowHeight,v=U,l=U/4,S=Z._29I,h=Z.lp(P),s={x:Z.tx(),y:Z.ty()};return U>0&&S&&(h.x-S.x<v?Z.translate(l,0):S.x+S.width-h.x<v&&Z.translate(-l,0),h.y-S.y<v?Z.translate(0,l):S.y+S.height-h.y<v&&Z.translate(0,-l)),s.x=Z.tx()-s.x,s.y=Z.ty()-s.y,H&&(H.x+=s.x,H.y+=s.y),s},H.getTopRowOrderSelection=function(){var t=this.sm().getTopSelection(),V={},$=new le;return t.each(function(A){V[A._id]=A}),this._rows.each(function(Q){V[Q._id]&&$.add(Q)}),$},H.getRowOrderSelection=function(){var E=new le;return this._rows.each(function(k){this.isSelected(k)&&E.add(k)},this),E},H.ivm=function(){this.invalidateModel()},H.invalidateModel=function(){var F=this;F._96I||(F._96I=1,F._32I=1,delete F._24I),F.iv()},H.redraw=function(){var C=this;C._32I||(C._32I=1,delete C._24I,C.iv())},H.invalidateData=function(h){var X=this;wb?X.redraw():X._32I||(X._24I||(X._24I={}),X._24I[h._id]=h,X.iv())},H.getFocusData=function(){return this._focusData},H.setFocusDataById=function(I){this.setFocusData(this.dm().getDataById(I))},H.setFocusData=function(j){var k=this,K=k._focusData;K!==j&&(k._focusData=j,k.fp("focusData",K,j),K&&k.invalidateData(K),j&&(k.invalidateData(j),k.isAutoMakeVisible()&&k.makeVisible(j)))},H.drawRowBackground=function(s,I,l,w,P,g,j){var G=this,V=G.isCheckMode();(I===G._focusData&&V||l&&!V)&&Wq(s,w,P,g,j,G.getSelectBackground(I))},H.drawData=function(k,u,I){var W=this,a=W._rowHeight,e=a*I,c=W._29I,Q=c.x,x=c.width;k.save(),k.beginPath(),k.rect(Q,e,x,a),k.clip(),W._87o(W.drawRow(k,u,W.isSelected(u),Q,e,x,a),I,Q,e,x,a),k.restore(),W._rowLineVisible&&Wq(k,Q,e+a-1,x,1,W._rowLineColor)},H._12I=function(J){var n=this,L=n._31I,U=n._29I,g=U.x,q=U.y,z=U.width,s=U.height;for(J.beginPath(),J.rect(g,q,z,s),J.clip(),J.clearRect(g,q,z,s),n._76o(),n._93db(J);L<n._14I;L++)n.drawData(J,n._rows.get(L),L);n._92db(J)},H._13I=function(R){for(var t,Z=this,J=Z._rowHeight,f=Z._29I,m=f.x,s=f.width,i=Z._31I,v=Z._30I;i<Z._14I;i++)t=Z._rows.get(i),Z._24I[t._id]&&v.add({data:t,index:i});v.isEmpty()||(R.beginPath(),v.each(function(n){R.rect(m,n.index*J,s,J)}),R.clip(),v.each(function(c){R.clearRect(m,c.index*J,s,J)}),v.each(function(C){Z._77o(C.index)}),Z._93db(R),v.each(function(y){Z.drawData(R,y.data,y.index)}),Z._92db(R),v.clear())},H.preValidateModel=function(){this.endEditing&&this.endEditing()},H.validateImpl=function(){var J=this,h=J._canvas,Z=J.getWidth(),F=J.getHeight(),D=J._rowHeight,I=J._32I;(Z!==h.clientWidth||F!==h.clientHeight)&&(Yl(h,Z,F),I=1);var $=O&&!m;J._96I&&!$&&(J.preValidateModel(),J.validateModel());var B=J._29I,a={x:-J.tx(),y:-J.ty(),width:Z,height:F},K=J._rows.size(),s=ye(h),f=J._23I;I||Rh(a,B)||(I=1),J._29I=a,J._59I=K*D,J._31I=b(a.y/D),J._14I=L((a.y+a.height)/D),J._31I<0&&(J._31I=0),J._14I>K&&(J._14I=K),J._99I&&I&&J._99I(),(J._40o()||J._41o())&&(J._59I+=J.getScrollBarSize(),J._99I&&I&&(J._91I+=J.getScrollBarSize())),Dd(s,J.tx(),J.ty(),1),I?J._12I(s):J._24I&&J._13I(s),J._93I(),J._92I(),s.restore(),J._32I=J._24I=J._96I=V,f&&(J.scrollToIndex(J.getRowIndex(f)),delete J._23I),J.tx(J.tx()),J.ty(J.ty())},H.canHandleSelectMode=function(){return!0}},Oh._48o=function(f){f._rootVisible=!0,f._rootData=V,f._35o=function(){this._expandMap={},this._levelMap={}},f.validateModel=function(){var U=this,Y=U._rootData;U._rows.clear(),U._levelMap={},U._rowMap={},U._currentLevel=0,Y?U._rootVisible?U.isVisible(Y)&&U.buildData(Y):U.buildChildren(Y):U.buildChildren(),delete U._currentLevel},f.buildData=function(c){var R=this,S=c._id,E=R._rows;R._rowMap[S]=E.size(),E.add(c),R._levelMap[S]=R._currentLevel,R.isExpanded(c)&&(R._currentLevel++,R.buildChildren(c),R._currentLevel--)},f.buildChildren=function(r){var G=this,U=r?r._children:G._dataModel._roots,E=G.getCurrentSortFunc();E&&G.isChildrenSortable(r)?U.toList(G.isVisible,G).sort(E).each(G.buildData,G):U.each(function(q){G.isVisible(q)&&G.buildData(q)})},f.getLevel=function(_){return this._levelMap[_._id]},f.getToggleIcon=function(r){var $=this,m=$._loader,k=$._collapseIcon;return m&&!m.isLoaded(r)?k:r.hasChildren()?$.isExpanded(r)?$._expandIcon:k:V},f.isCheckMode=function(){return this._checkMode!=V},f.isChildrenSortable=function(){return!0},f.handleDataModelChange=function(K){var q=this;K.kind===nr?delete q._expandMap[K.data._id]:K.kind===ac&&(q._expandMap={}),q.ivm()},f.toggle=function(_){var C=this;C.isExpanded(_)?C.collapse(_):C.expand(_)},f.isExpanded=function(I){return 1===this._expandMap[I._id]},f.expand=function(m){var H=this,J=H._loader;H.isExpanded(m)||(J&&!J.isLoaded(m)&&J.load(m),H._expandMap[m._id]=1,H.ivm(),H.onExpanded(m))},f.onExpanded=function(){},f.collapse=function(g){var H=this;H.isExpanded(g)&&(delete H._expandMap[g._id],H.ivm(),H.onCollapsed(g))},f.onCollapsed=function(){},f.expandAll=function(l){if(l)this.expand(l),l.eachChild(function(t){this.expandAll(t)},this);else{var q=this;q._dataModel.each(function(T){T.hasChildren()&&(q._expandMap[T._id]=1)}),q.ivm()}},f.collapseAll=function(){this._expandMap={},this.ivm()},f.makeVisible=function(l){if(l){var u=this;if(!u._rootData||l.isDescendantOf(u._rootData)){for(var v=l._parent;v;)u.expand(v),v=v._parent;u._23I=l,u.iv()}}},f.checkData=function(E){var h,H=this,a=H._checkMode,U=H.sm(),L=U.co(E);if(!U.sg()||!L){if(H._32o=1,a===Or)L?U.rs(E):U.as(E);else if(a===Cb)h=new le(E),h.addAll(E._children);else if("descendant"===a)h=new le,Ws(E,h);else if("all"===a&&(h=new le,Ws(E,h),!L))for(var M=E._parent;M;)h.add(M),M=M._parent;h&&(L?U.rs(h):U.as(h)),delete H._32o}},f.drawTree=function(a,S,b,L,$,B,u){var I=this,O=I._indent,q=I._levelMap[S._id],N=I.getIconWidth(S),r=Cc(I.getToggleIcon(S));r?(L+=O*q,mh(a,r,L+O/2,$+u/2,S,I),L+=O):L+=O*(q+1),I._checkMode&&(mh(a,I.getCheckIcon(S),L+O/2,$+u/2,S,I),L+=O),I.drawIcon(a,S,L,$,N,u),I.drawLabel(a,S,L+N,$,u)}},Oh._14Q=function(C){C.getIcon=function(S){return S.getIcon()},C.getIconWidth=function(E){return this.getIcon(E)?this._indent:0},C.drawIcon=function(i,L,Z,O,k,M){if(k){var w=this,Q=w.getBodyColor(L),$=Cc(w.getIcon(L),Q);$&&(M-=w.isRowLineVisible()?1:0,kr(i,$,re,Z,O,k,M,L,w,Q),hk(i,w.getBorderColor(L),Z,O,k,M))}},C.drawLabel=function(F,u,i,V,C){var J=this;ws(F,J.getLabel(u),J.getLabelFont(u),J.getLabelColor(u),i,V,0,C)}},Oh._50o=function(p){p._98I=function(){var M=this,A=M._39o=new jo;M._60I=new le,A.mm(M._17o,M),A.md(M._18o,M),A.mh(M._19o,M)},p.setColumns=function(f){this._39o.clear(),this.addColumns(f)},p.addColumns=function(w){var z=this._39o;w.forEach(function(V){if(!(V instanceof bt)){var $=Zh(V.className);V=gi($?$:bt,V)}z.add(V)})},p.onColumnClicked=function(){},p.onCheckColumnClicked=function(){},p._3Q=function(H){for(var I,C=0,o=this._60I,Y=o.size();Y>C;C++)if(I=o.get(C),I.column===H)return I;return V},p.getColumnAt=function(o){var B=this._4Q(o);return B?B.column:V},p._4Q=function(o){for(var F=this,K=o.target?F.lp(o).x:o.x,z=F._60I,v=0;v<z.size();v++){var Q=z.get(v),r=Q.startX;if(K>=r&&K<r+Q.column.getWidth())return Q}return V},p.getToolTip=function(F){var c=this,B=c.getDataAt(F),d=c.getColumnAt(F);return B&&d?d.getToolTip(B,c):V},p.adjustTranslateX=function(I){var j=this.getWidth()-this._91I;return j>I&&(I=j),I>0?0:k(I)},p._99I=function(){var s=this,W=s._29I,e=s._60I;e.clear(),s._91I=0,s._39o._roots.each(function(M){if(M.isVisible()){var H=s._91I+M.getWidth();s._91I<=W.x+W.width&&H>=W.x&&e.add({column:M,startX:s._91I}),s._91I=H}})},p.drawData=function(e,k,c){var N=this,P=N._rowHeight,$=P*c,W=N.isSelected(k),h=N._29I,C=h.x,F=h.width;N.drawRowBackground(e,k,W,C,$,F,P),N._60I.each(function(F){var L=F.column,X=F.startX,C=L.getWidth();C>0&&!N.isEditing(k,L)&&(e.save(),e.beginPath(),e.rect(X,$,C,P),e.clip(),N._87o(N.drawCell(e,k,W,L,X,$,C,P),c,X,$,C,P),N._columnLineVisible&&Wq(e,X+C-1,$,1,P,N._columnLineColor),e.restore())}),N._rowLineVisible&&Wq(e,C,$+P-1,F,1,N._rowLineColor)},p.drawCell=function(_,z,o,y,N,v,P,R){var W=this;if(y.drawCell)return y.drawCell(_,z,o,y,N,v,P,R,W);var p=W.getValue(z,y);Xs(_,p,y,W.getLabelFont(z,y,p),W.getLabelColor(z,y,p),N,v,P,R,z,W)},p.getColumnModel=function(){return this._39o},p._17o=function(){this.redraw()},p._18o=function(m){var O=this;m.data===O._sortColumn&&Ss[m.property]?O.ivm():(O._42o(),O.redraw())},p._19o=function(){this.redraw()},p.getCurrentSortFunc=function(){var r=this,q=r._sortColumn;if(q&&q.isSortable()){var E=q.getSortFunc(),d=nk===q.getSortOrder()?1:-1;return E||(E=uc),function(Q,p){return E.call(r,r.getValue(Q,q),r.getValue(p,q),Q,p)*d}}return r._sortFunc},p.isCellEditable=function(m,c,w){return c.isEditable()&&this.isEditable()?c.isCellEditable?c.isCellEditable(m,c,w,this):!0:!1},p._37O=function(j,H){if(gl(H))for(var V=this,R=V.lp(H),x=V._60I,D=V._rowHeight,F=V._29I,P=F.x,I=F.y,J=F.width,U=F.height,o=0;o<x.size();o++){var m=x.get(o),k=m.startX,u=m.column,Q=u.getWidth();if(u!==V._31o&&u!==V._4o&&R.x>=k&&R.x<k+Q&&V.isCellEditable(j,u,H)){var i={x:k,y:V.getRowIndex(j)*D,width:Q,height:D},Y={x:i.x+V.tx(),y:i.y+V.ty(),width:i.width,height:i.height},K=0,O=0;return i.x<P?K=i.x-P:i.x+i.width>P+J&&(K=i.x+i.width-P-J),K&&(V.tx(V.tx()-K),Y.x-=K),i.y<I?O=i.y-I:i.y+D>I+U&&(O=i.y+D-I-U),O&&(V.ty(V.ty()-O),Y.y-=O),V.beginEditing({data:j,column:u,value:V.getValue(j,u),event:H,rect:i,editorRect:Y,view:V}),void 0}}}},$s.BaseItemEditor=function(A,r,g,G){this._data=A,this._column=r,this._master=g,this._editInfo=G},_s("BaseItemEditor",e,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var at=C.Tab=function(){Le(at,this)};Yb("Tab",Tr,{ms_ac:["view","closable","disabled","visible"],_icon:V,_closable:!1,_disabled:!1,_visible:!0,setParent:qn});var bt=C.Column=function(){Le(bt,this)};Yb("Column",Tr,{_46o:1,ms_ac:["accessType","valueType",rr,As,Lm,ed,"align",_i,"sortOrder",sj,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:nk,_sortFunc:V,_sortable:!0,_clickable:!0,setWidth:function(t){16>t&&(t=16);var v=this._width;this._width=t,this.fp(ed,v,t)},getToolTip:function(u,p){return this.formatValue(p.getValue(u,this))}});var ct=C.Property=function(){Le(ct,this)};Yb("Property",Tr,{_46o:1,ms_ac:["accessType","valueType",As,Lm,"categoryName",_i,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:V,getToolTip:function(u,b,s){var k=this;return b?k.formatValue(s.getValue(u,k)):s.getPropertyName(k)}}),$s.AccordionView=function(){var l=this;l._20o={},l._21o=new le,l._10o=V,l._9o=V,l._11o=V,l._view=mk(0,l),l.iv()},_s("AccordionView",e,{ms_v:1,ms_fire:1,ms_ac:[Vp,Nj,"titleHeight",Qm,Rc,"titleBackground","selectWidth",pi,"orientation","separatorColor"],_expandIcon:B.accordionViewExpandIcon,_collapseIcon:B.accordionViewCollapseIcon,_titleHeight:sl,_labelColor:B.accordionViewLabelColor,_labelFont:B.accordionViewLabelFont,_titleBackground:B.accordionViewTitleBackground,_selectBackground:B.accordionViewSelectBackground,_selectWidth:B.accordionViewSelectWidth,_orientation:"v",_separatorColor:B.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(x,t,W,m){var C=this,M=Rn(),q={content:t,div:M,canvas:ob(M),icon:m};if(C._20o[x])throw x+" already exists";var S=q.downEventFunc=function(d){qk(d)},I=q.upEventFunc=function($){qk($),gl($)&&(C._10o===x?C.collapse():C.expand(x))};[Ip,Zg].forEach(function(C){A(M,C,S)}),[fn,Ce].forEach(function(k){A(M,k,I)}),M.style.cursor=Ig,os(C._view,M),C._20o[x]=q,C._21o.add(x),W&&C.expand(x),C.iv()},remove:function(E){var w=this,j=w._20o[E];if(j){var m=j.div;zg(m),[Ip,Zg].forEach(function(V){Y(m,V,j.downEventFunc)}),[fn,Ce].forEach(function(J){Y(m,J,j.upEventFunc)}),delete w._20o[E],w._21o.remove(E),w.iv()}},clear:function(){var K=this;K._21o.toArray().forEach(K.remove,K),K._20o={},K._21o.clear(),K.iv()},isExpanded:function(m){return this._10o===m},expand:function(w){var X=this;X._20o[w]&&X._10o!==w&&(X._10o=w,X.onExpanded(w),X.iv())},onExpanded:function(){},collapse:function(){var Y=this;Y._10o&&(Y.onCollapsed(Y._10o),delete Y._10o,Y.iv())},onCollapsed:function(){},initCanvas:function(Z,U,p){Yl(Z,U,p);var W=ye(Z);return Dd(W,0,0,1),W.clearRect(0,0,U,p),W},drawTitle:function(j,t,R,i,m){var G=this,z=Cc(m.icon),E=G.isExpanded(t),A=G._titleHeight,S=G._titleBackground,V=G._selectWidth,p=G._separatorColor,I=Cc(E?G._expandIcon:G._collapseIcon),k=V+4;Wq(j,0,0,R,i,S),E&&V&&Wq(j,0,0,V,i,G._selectBackground),(E||G._21o.get(G._21o.size()-1)!==t)&&Wq(j,0,i-1,R,1,p?p:cr(S)),z&&(mh(j,z,k+Fe(z)/2,A/2),k+=Fe(z)+2),ws(j,t,G.getLabelFont(t),G.getLabelColor(t),k,0,0,A),I&&mh(j,I,R-Fe(I)/2-4,A/2)},validateImpl:function(){var j=this,u=j._view,f=0,n=0,A=j.getWidth(),C=j.getHeight(),D=j._titleHeight,v=j._21o.size()*D,w=j._11o,l=j._9o;delete j._11o,delete j._9o,j._21o.each(function(S){var c,Y,X=j._20o[S],M=X.content,P=j._10o===S;Ug(j)?($m(X.div,f,0,D,C),c=j.initCanvas(X.canvas,D,C),Sg(c,0,C),Nh(c,-d),j.drawTitle(c,S,C,D,X),c.restore(),P?(Y=g(0,A-v),M&&(j._11o=M,j._9o=Wn(M),$m(M,f+D,0,Y,C)),f+=D+Y):f+=D):($m(X.div,0,n,A,D),c=j.initCanvas(X.canvas,A,D),j.drawTitle(c,S,A,D,X),c.restore(),P?(Y=g(0,C-v),M&&(j._11o=M,j._9o=Wn(M),$m(M,0,n+D,A,Y)),n+=D+Y):n+=D)});var Y=j._9o;w&&w!==j._11o&&w.endEditing&&w.endEditing(),Y&&Y!==l&&os(u,Y),l&&l!==Y&&zg(l)}}),$s.SplitView=function(T,n,S,I){var v=this,u=v._dividerDiv=Rn(),Y=v._60O=ob(),_=v._61O=ob(),E=Y.style,g=_.style;v._view=mk(1,v),os(v._view,u),E.msTouchAction=xo,E.pointerEvents=xo,E.cursor=Ig,g.msTouchAction=xo,g.pointerEvents=xo,g.cursor=Ig,T&&v.setLeftView(T),n&&v.setRightView(n),S&&v.setOrientation(S),I!=V&&v.setPosition(I),v.setStatus(wm),new dt(v)},_s("SplitView",e,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:B.splitViewDividerSize,_dividerBackground:B.splitViewDividerBackground,_dragOpacity:B.splitViewDragOpacity,_toggleIcon:B.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(Y,o){var w=this,q=w._position;isNaN(Y)||(o||(w._82O=0>Y?-1:Y>1?1:0),w._position=Y,w.fp(Ii,q,Y))},getLeftView:function(){return this._leftView},setLeftView:function(r){var M=this,E=M._leftView,i=M._view;if(M._leftView!==r){if(E&&E!==M._rightView){var s=Wn(E);s.parentNode===i&&zg(s)}if(M._leftView=r,r){var g=Wn(r);g.parentNode!==i&&i.insertBefore(g,M._dividerDiv)}M.fp("leftView",E,r)}},getRightView:function(){return this._rightView},setRightView:function(q){var U=this,Y=U._rightView,e=U._view;if(U._rightView!==q){if(Y&&Y!==U._leftView){var E=Wn(Y);E.parentNode===e&&zg(E)}if(U._rightView=q,q){var V=Wn(q);V.parentNode!==e&&e.insertBefore(V,U._dividerDiv)}U.fp("rightView",Y,q)}},validateImpl:function(){var P=this,x=P._draggable,p=P._position,e=P.getWidth(),C=P.getHeight(),y=P._dividerSize,U=P._dividerBackground,J=gp?18:8,R=P._dividerDiv,f=P._82O,X=P._60O,z=P._61O,S=P._toggleIcon,Y=P._status,t=R.style,$=null,L=gp?20:4,m=S.comps[0];y>=J||0===y?P._coverDiv&&(zg(P._coverDiv),delete P._coverDiv):P._coverDiv||(P._coverDiv=Rn(),bh&&(P._coverDiv.style.background=Vm),os(R,P._coverDiv)),P._togglable?X.parentNode||(os(R,X),os(R,z)):(zg(X),zg(z));var A=P._coverDiv,v=P._leftView,B=P._rightView;if(Ug(P)){if(y>e&&(y=e),Y===wm)if(1===f)var W=s(p,e),G=g(0,e-y-W);else-1===f?(G=s(-p,e),W=g(0,e-y-G)):(W=k((e-y)*p),G=g(0,e-y-W));else"cl"===Y?(W=0,G=g(0,e-y)):"cr"===Y&&(G=0,W=g(0,e-y));v&&$m(v,0,0,W,C),B&&$m(B,W+y,0,G,C),$m(R,W,0,y,C),P._22o=W,A&&($m(A,y/2-J/2,0,J,C),A.style.cursor=x?Hr:""),R.style.cursor=x?Hr:"";var q=R.clientHeight/2,o=R.clientWidth;Yl(X,o,o),$m(X,0,q-o-L,o,o),$=ye(X),Dd($,0,0,1),m.rotation=-d,em($,S,0,0,o,o),$.restore(),Yl(z,o,o),$m(z,0,q+L,o,o),$=ye(z),Dd($,0,0,1),m.rotation=d,em($,S,0,0,o,o),$.restore()}else{if(y>C&&(y=C),Y===wm)if(1===f)var l=s(p,C),Q=g(0,C-y-l);else-1===f?(Q=s(-p,C),l=g(0,C-y-Q)):(l=k((C-y)*p),Q=g(0,C-y-l));else"cl"===Y?(l=0,Q=g(0,C-y)):"cr"===Y&&(Q=0,l=g(0,C-y));v&&$m(v,0,0,e,l),B&&$m(B,0,l+y,e,Q),$m(R,0,l,e,y),P._22o=l,A&&($m(A,0,y/2-J/2,e,J),A.style.cursor=x?xp:""),t.cursor=x?xp:"";var n=R.clientWidth/2,o=R.clientHeight;Yl(X,o,o),$m(X,n-o-L,0,o,o),$=ye(X),Dd($,0,0,1),m.rotation=0,em($,S,0,0,o,o),$.restore(),Yl(z,o,o),$m(z,n+L,0,o,o),$=ye(z),Dd($,0,0,1),m.rotation=Z,em($,S,0,0,o,o),$.restore()}t.background=U}});var dt=function(W){this.sv=W,this.addListeners()};ym(dt,e,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(i){var l=this,s=l.sv,T=s._dividerDiv,V=s._60O,E=s._61O,O=s._status,C=i.target;if(C===V)O===wm?s.setStatus("cl"):"cr"===O&&s.setStatus(wm);else if(C===E)O===wm?s.setStatus("cr"):"cl"===O&&s.setStatus(wm);else if($k(i)&&(C===T||C===s._coverDiv)&&(qk(i),s.isDraggable())){s.getLeftView(),s.getRightView();var y=l.maskDiv=Rn();if(y.style.left=0,y.style.top=0,y.style.width=s.getWidth()+"px",y.style.height=s.getHeight()+"px",s.getView().appendChild(y),!s.isContinuousLayout()){var k=l.resizeDiv=Rn();k.style.left=T.style.left,k.style.top=T.style.top,k.style.width=T.style.width,k.style.height=T.style.height,k.style.opacity=s.getDragOpacity(),k.style.background=s.getDividerBackground(),os(l.getView(),k)}l._lastAbsPosition=s._22o,l._86o=Ug(s)?kd(i).x:kd(i).y,Lj(l,i)}},handleWindowTouchMove:function(j){$k(j)&&this.update(j,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(Q){var S=this;S.update(Q,!0),S.sv.setStatus(wm),S.maskDiv&&zg(S.maskDiv),S.resizeDiv&&zg(S.resizeDiv),S.maskDiv=S.resizeDiv=V},handle_mousedown:function(Z){gl(Z)&&this.handle_touchstart(Z)},handleWindowMouseMove:function(Q){this.handleWindowTouchMove(Q)},handleWindowMouseUp:function(h){this.handleWindowTouchEnd(h)},update:function(b,k){var S=this,$=S.sv,e=Ug($)?$.getWidth():$.getHeight(),y=$._dividerSize,D=S._lastAbsPosition-S._86o;Ug($)?(D+=kd(b).x,D>e-y&&(D=e-y),0>D&&(D=0),S.resizeDiv&&(S.resizeDiv.style.left=D+Tn)):(D+=kd(b).y,D>e-y&&(D=e-y),0>D&&(D=0),S.resizeDiv&&(S.resizeDiv.style.top=D+Tn)),k&&e!==y&&(1===$._82O?$.setPosition(D,1):-1===$._82O?$.setPosition(D-e+y,1):$.setPosition(D/(e-y),1))}}),$s.TabView=function(){var N=this,I=N._view=mk(1,N),T=N._91O=Rn(1),Y=N._tabModel=new jo,B=Y.sm(),r=N.invalidate;N._7o=new le,N._canvas=ob(T),os(I,T),os(I,N._92O=Rn(1)),B.setSelectionMode(ad),B.ms(N.handleSelectionChange,N),Y.mm(r,N),Y.mh(r,N),Y.md(r,N),N._interactor=new et(N),N.iv()},_s("TabView",e,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Qm,Rc,"tabHPadding","tabBackground","selectWidth",pi,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:hp,_tabHeight:sl,_tabGap:B.tabViewTabGap,_labelColor:B.tabViewLabelColor,_labelFont:B.tabViewLabelFont,_tabBackground:B.tabViewTabBackground,_selectWidth:B.tabViewSelectWidth,_selectBackground:B.tabViewSelectBackground,_moveBackground:B.tabViewMoveBackground,_insertColor:B.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(J,B,h){var y,Q=this._tabModel;return J instanceof at?(y=J,B&&y.setView(B)):(y=new at,y.setName(J),y.setView(B)),Q.add(y),h&&Q.sm().ss(y),y},getLabel:function(U){return U.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(A){this._23o=A,this.iv()},get:function(J){var H=this,r=H._tabModel;if(Ob(J))return r._roots.get(J);if(Zq(J)){var l;return r.each(function(c){J===H.getLabel(c)&&(l=c)}),l}return J instanceof at?J:V},select:function(e){this._tabModel.sm().ss(this.get(e))},remove:function(l){var q=this;if(l=q.get(l)){var T=q._tabModel,Z=T._roots.indexOf(l);q._tabModel.remove(l),q.selectByIndex(--Z)}},getCurrentTab:function(){return this._8o},hideTabView:function(h,W){W.parentNode===this._92O&&(wj(W)?(W.style.display=ef,W._tab_=h):zg(W),ur())},showTabView:function(q,D){wj(D)&&(D.style.display="block",D._tab_=q),D.parentNode!==this._92O&&(os(this._92O,D),ur())
},_24o:function(){var w,$=this,D=$._8o,x=$._9o,q=$._tabModel.sm().ld();q&&(w=Wn(q.getView())),w!==x&&(x&&(D.getView()&&D.getView().endEditing&&D.getView().endEditing(),$.hideTabView(D,x)),w&&$.showTabView(q,w)),$._8o=q,$._9o=w,D!==q&&$.onTabChanged(D,q)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(u,R){this.selectByIndex(--R)},selectByIndex:function(x){var H=this,J=H._tabModel,U=J.size();if(U&&!J.sm().ld()){x==V&&(x=0),x>=U&&(x=U-1),0>x&&(x=0);for(var i=x;i>=0;i--){var I=H.get(i);if(!I.isDisabled())return H.select(I),I}for(i=x+1;U>i;i++)if(I=H.get(i),!I.isDisabled())return H.select(I),I}},getTabWidth:function(v){var M=this.getTabHPadding(),C=4+2*M,J=Cc(v.getIcon());J&&(C+=Fe(J,v)+4);var d=this.getLabel(v);return d&&(C+=ts(this.getLabelFont(v),d).width+4),v.isClosable()&&(C+=10),C},drawTab:function(Y,J,E,u,Q,P,_){var e,f=this,x=f._tabPosition,A=this.getTabHPadding(),h=E+4+A,w=f._selectWidth,o=Cc(J.getIcon()),K=J.isDisabled(),V=f.getLabelColor(J),p=f.getLabelFont(J),N=f.getLabel(J),v=f._selectBackground,b=x===ar+"-vertical",H=x===ci+"-vertical";(b||H)&&(h=u+4+A),K&&(Y.globalAlpha=_m),Wq(Y,E,u,Q,P,_),J===f._8o&&w&&(x===hp?Wq(Y,E,u+P-w,Q,w,v):x===ar?Wq(Y,E+Q-w,u,w,P,v):x===ci?Wq(Y,E,u,w,P,v):b?Wq(Y,E+Q-w,u,w,P,v):H?Wq(Y,E,u,w,P,v):Wq(Y,E,u,Q,w,v));var m=Q/2;if(b&&(Sg(Y,m,u+P/2),Nh(Y,Z),Sg(Y,-m,-u-P/2)),o){var z=Dm(o,J),y=Fe(o,J);if(b||H){var T=E+Q/2,a=h+z/2;Sg(Y,T,a),Nh(Y,d),Sg(Y,-T,-a),mh(Y,o,E+Q/2,h+z/2,J,f),Sg(Y,T,a),Nh(Y,-d),Sg(Y,-T,-a),h+=z+4}else mh(Y,o,h+y/2,u+P/2,J,f),h+=y+4}return b||H?(Sg(Y,Q/2,h+Q/2),Nh(Y,d),Sg(Y,-Q/2,-h-Q/2),ws(Y,N,p,V,E,h,P,Q),Sg(Y,Q/2,h+Q/2),Nh(Y,-d),Sg(Y,-Q/2,-h-Q/2)):ws(Y,N,p,V,h,u,Q,P),b&&(Sg(Y,m,u+P/2),Nh(Y,-Z),Sg(Y,-m,-u-P/2)),J.isClosable()&&(e=H?{x:E+Q-12,y:u+P-12,width:12,height:12}:{x:E+Q-12,y:u+2,width:12,height:12},this.drawCloseIcon(J,Y,V,e)),K&&(Y.globalAlpha=1),e},drawCloseIcon:function(M,c,q,P){var X=P.x,H=P.y;c.strokeStyle=q,c.lineWidth=1,c.beginPath(),c.moveTo(X+2,H+8),c.lineTo(X+8,H+2),c.moveTo(X+8,H+8),c.lineTo(X+2,H+2),c.stroke()},getTabAt:function(v){var Q=this._interactor._8Q(v);return Q?Q.tab:null},validateImpl:function(){var J=this;J._24o();var q,B=J._canvas,h=J._tabPosition,M=J._91O,G=J._92O,m=J._tabModel,K=J.getWidth(),X=J.getHeight(),o=J._tabHeight,j=J._7o,N=J._tabGap,u=h===hp,Q=h===ar,s=h===ci,Z=h===ar+"-vertical",O=h===ci+"-vertical",r=J._23o,d=0;if((Q||s)&&m._roots.each(function(r){d=g(J.getTabWidth(r),d)}),u?($m(M,0,0,K,o),q={x:0,y:o,width:K,height:g(0,X-o)}):Q?($m(M,0,0,d,X),q={x:d,y:0,width:g(0,K-d),height:X}):s?($m(M,K-d,0,d,X),q={x:0,y:0,width:g(0,K-d),height:X}):Z?($m(M,0,0,o,X),q={x:o,y:0,width:g(0,K-o),height:X}):O?($m(M,K-o,0,o,X),q={x:0,y:0,width:g(0,K-o),height:X}):($m(M,0,X-o,K,o),q={x:0,y:0,width:K,height:g(0,X-o)}),$m(G,q),Z||O){J._9o&&(q.x=0,$m(J._8o.getView(),q)),Yl(B,o,X);var H=ye(B),C=0;if(Dd(H,0,J.ty(),1),H.clearRect(0,0,o,X),j.clear(),m._roots.each(function(m){if(m.isVisible()){var G,s=J.getTabWidth(m);if(!r||r.tab!==m){var W=J.getTabBackground(m);G=J.drawTab(H,m,0,C,o,s,W)}j.add({_75o:G,tab:m,startY:C,endY:C+s,height:s}),C+=s+N}}),J._23Q=g(0,C-N),r){var x=r.position;J.drawTab(H,r.tab,0,r.startY,o,r.height,J._moveBackground),Wq(H,0,x,o,1,J._insertColor)}if(H.restore(),J._selectionChanged){J._selectionChanged=!1;for(var A=J.ty(),E=0;E<j.size();E++){var W=j.get(E);if(W.tab===J._8o){if(W.endY+A<0){J.ty(-W.startY);break}if(W.startY+A>X){J.ty(X-W.endY);break}}}}J.ty(J.ty())}else if(Q||s){J._9o&&(q.x=0,$m(J._8o.getView(),q)),Yl(B,d,X);var H=ye(B),C=0;if(Dd(H,0,J.ty(),1),H.clearRect(0,0,d,X),j.clear(),m._roots.each(function(X){if(X.isVisible()){var B;if(!r||r.tab!==X){var g=J.getTabBackground(X);B=J.drawTab(H,X,0,C,d,o,g)}j.add({_75o:B,tab:X,startY:C,endY:C+o,height:o}),C+=o+N}}),J._23Q=g(0,C-N),r){var x=r.position;J.drawTab(H,r.tab,0,r.startY,d,r.height,J._moveBackground),Wq(H,0,x,d,1,J._insertColor)}if(H.restore(),J._selectionChanged){J._selectionChanged=!1;for(var A=J.ty(),E=0;E<j.size();E++){var W=j.get(E);if(W.tab===J._8o){if(W.endY+A<0){J.ty(-W.startY);break}if(W.startY+A>X){J.ty(X-W.endY);break}}}}J.ty(J.ty())}else{J._9o&&(q.y=0,$m(J._8o.getView(),q)),Yl(B,K,o);var H=ye(B),L=0;if(Dd(H,J.tx(),0,1),H.clearRect(0,0,K,o),j.clear(),m._roots.each(function(a){if(a.isVisible()){var F,c=J.getTabWidth(a);if(!r||r.tab!==a){var s=J.getTabBackground(a);F=J.drawTab(H,a,L,0,c,o,s)}j.add({_75o:F,tab:a,startX:L,endX:L+c,width:c}),L+=c+N}}),J._64I=g(0,L-N),r){var x=r.position;J.drawTab(H,r.tab,r.startX,0,r.width,o,J._moveBackground),ao(H,J._insertColor,x,0,o)}if(H.restore(),J._selectionChanged){J._selectionChanged=!1;for(var P=J.tx(),E=0;E<j.size();E++){var W=j.get(E);if(W.tab===J._8o){if(W.endX+P<0){J.tx(-W.startX);break}if(W.startX+P>K){J.tx(K-W.endX);break}}}}J.tx(J.tx())}for(var i=[],y=G.children,E=0;E<y.length;E++){var V=y[E],w=V._tab_;w&&!m.contains(w)&&i.push(V)}i.forEach(function(e){G.removeChild(e)})}});var et=function(P){this.tv=P,this.addListeners()};ym(et,e,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(B){this.handleScroll(B,10*(B.wheelDelta/40))},handle_DOMMouseScroll:function(W){this.handleScroll(W,10*-W.detail)},handleScroll:function(Z,s){qk(Z);var a=this.tv,j=a._tabPosition;!a._40o()||j!==hp&&j!==Tl||a.tx(this.tv.tx()+s),!a._41o()||j!==ar&&j!==ci&&j!==ar+"-vertical"&&j!==ci+"-vertical"||a.ty(this.tv.ty()+s)},_8Q:function(c){var s,g,O=this.tv,k=O._tabPosition,v=O._7o;if(k===hp||k===Tl){var M=O.lp(c).x;for(s=0;s<v.size();s++)if(g=v.get(s),g.startX<=M&&M<=g.endX)return g}else if(k===ar||k===ci||k===ar+"-vertical"||k===ci+"-vertical"){var F=O.lp(c).y;for(s=0;s<v.size();s++)if(g=v.get(s),g.startY<=F&&F<=g.endY)return g}return V},isClickable:function(Q){var B=this.tv,T=B._tabPosition,t=this._73o=this._8Q(Q);return!B._40o()||T!==hp&&T!==Tl?!B._41o()||T!==ar&&T!==ci&&T!==ar+"-vertical"&&T!==ci+"-vertical"?t&&(!t.tab.isDisabled()||B.isMovable()):!0:!0},handle_mousemove:function(g){var j=this;mr?j._74o=j._8Q(g):j.getView().style.cursor=j.isClickable(g)?Ig:""},handle_mousedown:function(C){this.handle_mousemove(C),this.handle_touchstart(C)},handle_touchstart:function(W){var D=this,A=D.tv,Y=A._tabPosition;qk(W),gl(W)&&D.isClickable(W)&&(Y===hp||Y===Tl?(D.x=kd(W).x,D.lp=A.lp(W),D.tx=A.tx()):(D.y=kd(W).y,D.lp=A.lp(W),D.ty=A.ty()),Lj(D,W))},handleWindowMouseMove:function(B){this.handleWindowTouchMove(B)},handleWindowTouchMove:function(S){var N,I=this,x=I.tv,z=x._tabPosition,y=I._73o;if(z===hp||z===Tl){if(N=kd(S).x-I.x,!I._25o&&!I.moving&&r(N)>2&&(x._40o()&&!kj(S)?I._25o=1:y&&x.isMovable()&&(I.moving=1)),I._25o)x.tx(I.tx+N);else if(I.moving){var L=I.lp.x+N,B=x._tabGap/2;x._7o.each(function(n){var J=n.endX,O=L-n.startX<J-L;L>=n.startX&&J>=L&&x._7Q({tab:y.tab,startX:y.startX+N,width:y.width,front:O,insertTab:n.tab,position:O?g(0,n.startX-B):s(x._64I,J+B)})})}}else if(N=kd(S).y-I.y,!I._25o&&!I.moving&&r(N)>2&&(x._41o()&&!kj(S)?I._25o=1:y&&x.isMovable()&&(I.moving=1)),I._25o)x.ty(I.ty+N);else if(I.moving){var O=I.lp.y+N,B=x._tabGap/2;x._7o.each(function(T){var I=T.endY,L=O-T.startY<I-O;O>=T.startY&&I>=O&&x._7Q({tab:y.tab,startY:y.startY+N,height:y.height,front:L,insertTab:T.tab,position:L?g(0,T.startY-B):s(x._23Q,I+B)})})}},handleWindowMouseUp:function(Y){this.handleWindowTouchEnd(Y)},handleWindowTouchEnd:function(){var c=this,k=c.tv,U=k._tabPosition,n=k.getTabModel(),T=n._roots,M=c._73o;if(c.moving){var W=k._23o;if(W&&W.insertTab!==W.tab){var m=W.tab,S=T.remove(m),d=T.indexOf(W.insertTab);d>=0&&(W.front||d++,d<=T.size()&&(T.add(m,d),n._38I(m,S,d)))}k._7Q(V),delete c.moving}else if(!c._25o&&M){m=M.tab;var K=c._74o;if(!K||K.tab===m)if(!m.isDisabled()&&lc(M._75o,c.lp)){var a=function(){var O=T.indexOf(m);n.remove(m),k.onTabClosed(m,O)};k.onTabClosing(m,a)&&a()}else m.isDisabled()||k._8o===m||n.sm().ss(m)}c._25o=c._73o=c._74o=U===hp||U===Tl?c.x=c.lp=c.tx=V:c.y=c.lp=c.ty=V}}),$s.PropertyView=function(x){var U=this;U._view=mk(1,U),U._canvas=ob(U._view),os(U._view,U._79O=Rn()),U._rows=new le,U._28o=new le,U._26o={},U._26Q={};var J=U._propertyModel=new jo,N=U.ivm;J.mm(N,U),J.md(N,U),J.mh(N,U),U.dm(x?x:new jo),new ft(U)},_s("PropertyView",e,{ms_ac:[Qm,dl,Rc,As,Lm,"categorizable",Yh,sj,bj,Vp,Nj,Pd,gq,nc,"selectRowIndex",pi,"background",Lb,yq,qc,Fn,_n],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Hp,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:He,_background:B.propertyViewBackground,_expandIcon:B.propertyViewExpandIcon,_collapseIcon:B.propertyViewCollapseIcon,_scrollBarColor:kk,_scrollBarSize:Qb,_autoHideScrollBar:Sr,_selectBackground:B.propertyViewSelectBackground,_rowHeight:hi,_rowLineVisible:B.propertyViewRowLineVisible,_rowLineColor:B.propertyViewRowLineColor,_10I:.5,_columnLineVisible:B.propertyViewColumnLineVisible,_columnLineColor:B.propertyViewColumnLineColor,_labelColor:B.propertyViewLabelColor,_labelSelectColor:B.propertyViewLabelSelectColor,_labelFont:B.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function($){0>$&&($=0),$>1&&($=1);var o=this,i=o._10I;o._10I=$,o.fp("columnPosition",i,$)},getPropertyName:function(Q){return Q.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(i,Z,Y){return Y===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(d,P){return P===this._selectRowIndex?this._labelSelectColor:d.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(q){var H=this.getHeight()-this._59I;return H>q&&(q=H),q>0?0:k(q)},isExpanded:function(T){if(!T)return!0;var t=this._26o[T];return t?t.isExpanded:!(this._26Q[T]===!1)},toggle:function(T){var K=this;K.isExpanded(T)?K.collapse(T):K.expand(T)},expandAll:function(){this.validate();for(var v in this._26o)this.expand(v)},expand:function(T){if(T&&T!==ef){var A=this,U=A._26o[T];U&&!U.isExpanded&&(U.isExpanded=!0,A.onExpanded(T),A.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var r in this._26o)this.collapse(r)},collapse:function(d){if(d&&d!==ef){var F=this,v=F._26o[d];v&&v.isExpanded&&(v.isExpanded=!1,F.onCollapsed(d),F.ivm())}},onCollapsed:function(){},getCategoryName:function(O){if(!this.isCategorizable())return ef;var j=O.getCategoryName();return j?j:ef},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(S){var w=this,O=w._dataModel;O!==S&&(O&&(O.umd(w.handlePropertyChange,w),w._selectionModel||O.sm().ums(w.handleSelectionChange,w)),w._dataModel=S,S.md(w.handlePropertyChange,w),w._selectionModel?w._selectionModel._21I(S):S.sm().ms(w.handleSelectionChange,w),w.fp(dq,O,S))},isVisible:function(F){return this._visibleFunc?this._visibleFunc(F):!0},onPropertyChanged:function(L){var g=this,i=L.property;Vs[i]?g.ivm():g.iv(),i===cq&&g._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:io},handlePropertyChange:function(N){this._27o===N.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var e=this;e._96I||(e.setSelectRowIndex(-1),e._96I=1,e.iv())},redraw:function(){this.iv()},validateModel:function(){var R=this,W=R._rows,M=R._28o,i={},q=new le,x=R._27o;R.updateCurrentData(),x!==R._27o&&R.endEditing(),W.clear(),M.clear(),R.getRawProperties().each(function(v){if(R.isVisible(v)){q.add(v);var m=R.getCategoryName(v);i[m]||(M.add(m,m===ef?0:$),i[m]={isExpanded:R.isExpanded(m),properties:new le})}}),R._sortFunc&&q.sort(R._sortFunc);for(var T in R._26o)R._26Q[T]=R.isExpanded(T);R._26o=i,M.each(function(z){z!==ef&&W.add(z);var j=i[z];j.isExpanded&&q.each(function(d){R.getCategoryName(d)===z&&(j.properties.add(d),W.add({property:d,data:R._27o}))},R)})},validateImpl:function(){var n=this;n._76o(),n._96I&&(n.validateModel(),delete n._96I);var k=n._canvas,H=n.getWidth(),r=n.getHeight(),S=-n.ty(),m=n._rowHeight,O=n._indent,x=H-O,l=n._rows,f=l.size(),p=n._9I=O+x*n._10I,$=n._59I=f*m;Yl(k,H,r),n._29I={x:0,y:S,width:H,height:r},n._31I=b(S/m),n._14I=L((S+r)/m),n._31I<0&&(n._31I=0),n._14I>f&&(n._14I=f);var J,v=ye(k),o=n._background;Dd(v,0,-S,1),v.beginPath(),v.rect(0,S,H,r),v.clip(),v.clearRect(0,S,H,r),n._93db(v),o&&Wq(v,0,0,O,$,o);for(var Q=n._31I;Q<n._14I;Q++){var h=l.get(Q),S=m*Q;if(Zq(h))o&&Wq(v,O,S,x,m,o),J=Cc(n.isExpanded(h)?n._expandIcon:n._collapseIcon),J&&kr(v,J,re,0,S,O,m),v.save(),v.beginPath(),v.rect(O,S,x,m),v.clip(),n.drawCategoryName(v,h,Q,O,S,x,m),v.restore();else{var N=h.property,d=h.data,J=Cc(N.getIcon()),C=n._selectRowIndex===Q?n.getSelectBackground():V;if(J&&kr(v,J,re,0,S,O,m),C&&Wq(v,O,S,x,m,C),v.save(),v.beginPath(),v.rect(O,S,p-O,m),v.clip(),n.drawPropertyName(v,N,Q,O,S,p-O,m),v.restore(),!n.isEditing(d,N)){var U=p+1,i=H-p-1;v.save(),v.beginPath(),v.rect(U,S,i,m),v.clip(),n._87o(n.drawPropertyValue(v,N,n.getValue(d,N),Q,U,S,i,m,d),Q,U,S,i,m),v.restore()}}n._rowLineVisible&&Wq(v,O,S+m-1,x,1,n._rowLineColor)}n._columnLineVisible&&(Wq(v,p,0,1,$,n._columnLineColor),Wq(v,H-1,0,1,$)),n._92db(v),n._93I(),v.restore(),n.ty(n.ty())},drawCategoryName:function(Y,J,N,n,Z,S,x){ws(Y,J,this.getCategoryFont(J),this.getCategoryColor(J),n,Z,S,x)},drawPropertyName:function(d,W,u,I,i,H,f){return W.drawPropertyName?(W.drawPropertyName(d,W,u,I,i,H,f,this),void 0):(ws(d,this.getPropertyName(W),this.getPropertyFont(W,u),this.getPropertyColor(W,u),I,i,H,f),void 0)},drawPropertyValue:function(k,R,h,j,A,d,g,S,F){return R.drawPropertyValue?R.drawPropertyValue(k,R,h,j,A,d,g,S,F,this):(Xs(k,h,R,this.getLabelFont(R,h,j),this.getLabelColor(R,h,j),A,d,g,S,F,this),void 0)},isPropertyEditable:function(s){return s.isEditable()&&this.isEditable()},setProperties:function(v){this._propertyModel.clear(),this.addProperties(v)},addProperties:function(f){if(f){var i=this._propertyModel;f.forEach(function(u){if(!(u instanceof ct)){var j=Zh(u.className);u=gi(j?j:ct,u)}i.add(u)})}},getRowIndexAt:function(E){var t=this,I=b(t.lp(E).y/t._rowHeight);return I>=0&&I<t._rows.size()?I:-1},getPropertyAt:function(B){var Q=this,b=Q.getRowIndexAt(B);return b>=0?Q._rows.get(b).property:V},getToolTip:function(e){var t=this,c=t.getPropertyAt(e),F=t._27o;return c&&F?c.getToolTip(F,t._9I<t.lp(e).x,t):V}});var ft=function(_){this.pv=_,this.addListeners()};ym(ft,e,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(c){this.getView().style.cursor=c},clear:function(){var D=this;D._62O=D.cp=D.ty=D.p=V,D.setCursor(Or)},handle_mousedown:function(g){this.handle_touchstart(g)},handle_touchstart:function(D){var j=this,T=j.pv;qk(D),T.setFocus(D)&&(gl(D)?(j.cp=kd(D),j.ty=T.ty(),j.p=T.getColumnPosition(),j.handle_touchmove(D)):T.setSelectRowIndex(T.getRowIndexAt(D)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(x){this.handle_touchend(x)},handle_touchend:function(I){var C=this;if(C.cp&&!C._62O){var $=C.pv,T=$.lp(I),Z=T.x,a=T.y,S=$._indent,p=$.getRowIndexAt(I),m=$._9I;if(p>=0){var B=$._rowHeight,n=B*p,D=$._rows.get(p),H=D.property;if(Zq(D))Cc($.isExpanded(D)?$._expandIcon:$._collapseIcon)&&Z>=0&&S>=Z&&a>=n&&n+B>=a?$.toggle(D):Kr(I)&&$.toggle(D);else if(Z>m&&$.isPropertyEditable(H,I)){var k={x:m+1,y:n,width:$.getWidth()-m-1,height:B},r={x:k.x+$.tx(),y:k.y+$.ty(),width:k.width,height:k.height},x=0,K=$._29I;k.y<K.y?x=k.y-K.y:k.y+B>K.y+K.height&&(x=k.y+B-K.y-K.height),x&&($.ty($.ty()-x),r.y-=x),$.beginEditing({data:D.data,property:H,value:$.getValue(D.data,H),event:I,rect:k,editorRect:r,view:$})}}$.setSelectRowIndex(p)}C.clear()},handleWindowMouseMove:function(V){this.handleWindowTouchMove(V)},handleWindowTouchMove:function(s){var f=this,x=f.pv,E=f.ty,n=f.cp,S=kd(s),J=f._62O;if("p"===J)x.setTranslateY(E+S.y-n.y);else if("c"===J){var P=x.getWidth()-x._indent;if(P>16){var Q=f.p-(n.x-S.x)/P,W=16/P;W>Q&&(Q=W),Q>1-W&&(Q=1-W),x.setColumnPosition(Q)}}else"s"===J&&x.setTranslateY(E+(n.y-S.y)*x._59I/x._29I.height)},handle_mousemove:function(e){this.handle_touchmove(e)},handle_touchmove:function(R){if(!mr&&gl(R)){var Z=this,v=Z.pv,E=r(v.lp(R).x-v._9I)<=(gp?8:3);Z.cp?Z._62O||(E?(Z._62O="c",Lj(Z,R)):r(kd(R).y-Z.cp.y)>=2&&(Z._62O=Z.isV(R)?"s":"p",Lj(Z,R))):(E?Z.setCursor(Hr):Z.setCursor(Or),Z.isV(R)&&v._43o())}},isV:function(Y){var q=this.pv,p=q._29I;return q._41o()&&p.x+p.width-q.lp(Y).x<oc},handle_mousewheel:function(w){this.handleScroll(w,w.wheelDelta/40)},handle_DOMMouseScroll:function(T){2===T.axis&&this.handleScroll(T,-T.detail)},handleScroll:function(Y,S){var x=this.pv;qk(Y),x.endEditing(),x.translate(0,S*x.getRowHeight())},handle_keydown:function(b){var u=this.pv,t=u._rows.size(),a=u._selectRowIndex+(Xe(b)?-1:1);(Xe(b)||Xh(b))&&(0>a&&(a=0),a>=t&&(a=t-1),u.setSelectRowIndex(a))}}),$s.ListView=function(d){this._5o(d),new gt(this)},_s("ListView",e,{ms_ac:[Qm,dl,Rc,Lb,Yh,yq,qc,sj,bj,Pd,gq,nc,Fd,pi],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:He,_rowHeight:hi,_rowLineVisible:B.listViewRowLineVisible,_rowLineColor:B.listViewRowLineColor,_scrollBarColor:kk,_scrollBarSize:Qb,_autoMakeVisible:cp,_autoHideScrollBar:Sr,_selectBackground:B.listViewSelectBackground,_labelColor:B.listViewLabelColor,_labelSelectColor:B.listViewLabelSelectColor,_labelFont:B.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(E){var k=this,y=k._checkMode;k._checkMode=E,k.fp(lp,y,E)},drawRow:function(X,F,y,N,q,x,S){var D=this,H=0,T=D._indent,t=D.getIconWidth(F);D.drawRowBackground(X,F,y,N,q,x,S),D._checkMode&&(mh(X,Cc(D.getCheckIcon(F)),H+T/2,q+S/2,F,D),H+=T),D.drawIcon(X,F,H,q,t,S),D.drawLabel(X,F,H+t,q,S)}});var gt=function(W){this.list=W,this.addListeners()};ym(gt,e,{ms_listener:1,getView:function(){return this.list._view},clear:function(w){var n=this,U=n.list;w&&"d"===n._62O&&!n.dragCancel&&U.handleDragAndDrop(w,"end"),U.draggingData&&(U.draggingData=null,U.redraw()),n.dragCancel=n._62O=n._isV=n._isH=n.cp=n.tx=n.ty=V},handle_mousedown:function(U){this.handle_touchstart(U)},handle_touchstart:function(V){var n=this,E=n.list;if(qk(V),E.setFocus(V)){var C=E.getDataAt(V);n.cp=kd(V),n.tx=E.tx(),n.ty=E.ty(),gl(V)?C&&E.handleDragAndDrop&&!n.isV(V)&&!n.isH(V)&&(E.draggingData=C,E.redraw(),E.handleDragAndDrop(V,"prepare")):(C?n._33o(V,C):this._cancelDataDoubleSelect(),n.clear(V))}},handleWindowMouseUp:function(Z){this.clear(Z)},handleWindowTouchEnd:function(r){this.clear(r)},handle_mouseup:function(m){this.handle_touchend(m)},handle_touchend:function(Z){var L=this,t=L.list;if(!L._isV&&!L._isH&&L.cp&&!L._62O){var m=t.getDataAt(Z);m?(t.isCheckMode()?L._34o(Z,m):L._33o(Z,m),Kr(Z)?t.onDataDoubleClicked(m,Z):t.onDataClicked(m,Z)):(L._cancelDataDoubleSelect(),t.handleBackgroundClick(Z))}L.clear(Z)},handleWindowMouseMove:function(X){this.handleWindowTouchMove(X)},handleWindowTouchMove:function(R){var G=this,b=G.list,P=G._62O,M=G.tx,W=G.ty,t=G.cp,q=kd(R),U=b._29I;"p"===P?b.setTranslate(M+q.x-t.x,W+q.y-t.y):"v"===P?b.ty(W+(t.y-q.y)*b._59I/U.height):"h"===P?b.tx(M+(t.x-q.x)*b._91I/U.width):"d"===P&&(G.dragCancel||b.handleDragAndDrop(R,"between"))},handle_mousemove:function(t){this.handle_touchmove(t)},handle_touchmove:function(f){if(!mr&&gl(f)){var T=this,v=T.list;if(T._isV=T.isV(f),T._isH=T.isH(f),T.cp){if(!T._62O){if(Lf(kd(f),T.cp)<2)return;T._isV?T._62O="v":T._isH?T._62O="h":v.draggingData&&!this.dragCancel?(T._62O="d",v.handleDragAndDrop(f,"begin")):T._62O="p",T._62O&&"d"!==T._62O&&v.draggingData&&(v.draggingData=null,v.redraw()),Lj(T,f)}}else T._isV&&v._43o(),T._isH&&v._42o()}},isV:function(T){var q=this.list,G=q._29I;return q._41o()&&G.x+G.width-q.lp(T).x<oc},isH:function(C){var e=this.list,K=e._29I;return e._40o()&&K.y+K.height-e.lp(C).y<oc},handle_mousewheel:function(G){this.handleScroll(G,G.wheelDelta/40,G.wheelDelta!==G.wheelDeltaX)},handle_DOMMouseScroll:function(V){this.handleScroll(V,-V.detail,1)},handleScroll:function(U,M,T){var v=this.list;qk(U),v.endEditing&&v.endEditing(),T&&v._41o()?v.translate(0,M*v.getRowHeight()):v._40o()&&v.translate(10*M,0)},handle_keydown:function(Y){if(!B.isInput(Y.target)){var K,r=this.list,i=r.sm(),L=r._rows,C=L.size();if($g(Y))r.selectAll();else if(Ab(Y))r.handleDelete&&r.handleDelete(Y);else if($b(Y))"d"!==this._62O||this.dragCancel||(r.handleDragAndDrop(Y,"cancel"),this.dragCancel=!0);else if(uo(Y))r.isCheckMode()&&(K=r.getFocusData(),K&&r.checkData(K));else if(Xe(Y)||Xh(Y)){var Z=r.isCheckMode();if(K=Z?r.getFocusData():i.ld()){var b=r.getRowIndex(K);b>=0&&(Xe(Y)?0!==b&&(K=L.get(b-1),Z?r.setFocusData(K):i.ss(K)):b!==C-1&&(K=L.get(b+1),Z?r.setFocusData(K):i.ss(K)))}else C>0&&(K=L.get(0),Z?r.setFocusData(K):i.ss(K))}}},_34o:function(E,T){var S=this.list,x=S.lp(E).x;return x>=0&&x<=S._indent?(S.checkData(T),void 0):(S.setFocusData(T),void 0)},_33o:function(r,Q){var i=this.list,s=i.sm(),E=s.ld();if(!i.canHandleSelectMode(r,Q))return this._cancelDataDoubleSelect(),void 0;if(kj(r))i.isSelected(Q)?s.rs(Q):s.as(Q);else if(Fk(r))if(E)for(var c=i.getRowIndex(E),Y=i.getRowIndex(Q);c!==Y;)c+=Y>c?1:-1,s.as(i._rows.get(c));else s.ss(Q);else gl(r)?(s.contains(Q)?i.handleDataDoubleSelect&&(this._handleDataDoubleSelect(r,Q),Kr(r)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),s.ss(Q)):s.contains(Q)||s.ss(Q)},_handleDataDoubleSelect:function(Q,C){this._cancelDataDoubleSelect(),this._doubleSelectTimer=fo(function(){this.list.handleDataDoubleSelect(Q,C),this._doubleSelectTimer=$}.bind(this),B.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(dh(this._doubleSelectTimer),this._doubleSelectTimer=$)}}),$s.TreeView=function(L){var m=this;m._35o(),m._5o(L),new ht(m)},_s("TreeView",e,{ms_ac:[Qm,dl,Rc,"rootVisible",lp,"rootData",sj,bj,Pd,gq,nc,Yh,Lb,yq,qc,Vp,Nj,Fd,pi,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:V,_indent:He,_rowHeight:hi,_rowLineVisible:B.treeViewRowLineVisible,_rowLineColor:B.treeViewRowLineColor,_scrollBarColor:kk,_scrollBarSize:Qb,_autoHideScrollBar:Sr,_expandIcon:B.treeViewExpandIcon,_collapseIcon:B.treeViewCollapseIcon,_autoMakeVisible:cp,_selectBackground:B.treeViewSelectBackground,_labelColor:B.treeViewLabelColor,_labelSelectColor:B.treeViewLabelSelectColor,_labelFont:B.treeViewLabelFont,_doubleClickToToggle:B.treeViewDoubleClickToToggle,drawRow:function(E,T,N,r,u,R,M){var F=this;F.drawRowBackground(E,T,N,r,u,R,M),F.drawTree(E,T,N,0,u,R,M)},isOnToggleIcon:function(g){var A=this.getDataAt(g);if(A){var L=this.getIndent(),r=this.lp(g).x;if(Cc(this.getToggleIcon(A))){var U=L*this.getLevel(A);if(r>=U&&U+L>=r)return!0}}return!1}});var ht=function(d){Le(ht,this,[d])};ym(ht,gt,{toggle:function(t,G,X,$){var Z=this.list,e=Z.lp(t).x;if(Cc(Z.getToggleIcon(G))){var J=X*$;if(e>=J&&J+X>=e)return Z.toggle(G),!0}return Z.isDoubleClickToToggle()&&Kr(t)?(Z.toggle(G),!0):!1},_34o:function(v,g){var W=this.list,r=W.lp(v).x,j=W._levelMap[g._id],k=W._indent,J=k*(j+1);return r>=J&&J+k>=r?(W.checkData(g),void 0):(this.toggle(v,g,k,j)||W.setFocusData(g),void 0)},_33o:function(p,T){var m=this,b=m.list;if(!m.toggle(p,T,b._indent,b.getLevel(T)))if(Fk(p)){var q=b.sm();if(q.size()>0){for(var N=b._rows,y=null,O=0,M=N.size();M>O;O++)if(b.isSelected(N.get(O))){y=O;break}for(var K=null,O=N.size()-1;O>=0;O--)if(b.isSelected(N.get(O))){K=O;break}var P,Q,I=b.getRowIndex(T);for(y>I?(P=I-1,Q=y):I>K?(P=K,Q=I):(P=y,Q=K);P!==Q;)P++,q.as(b._rows.get(P))}else q.ss(T)}else ht.superClass._33o.call(m,p,T)},handle_keydown:function(H){if(Yg(H)||hq(H)){var h=this.list,x=h._rows,B=h.isCheckMode(),G=h.sm(),n=B?h.getFocusData():G.ld();n?n.hasChildren()&&(Yg(H)?h.collapse(n):h.expand(n)):x.size()>0&&(n=x.get(0),B?h.setFocusData(n):G.ss(n))}else ht.superClass.handle_keydown.call(this,H)}});var it=$s.TableView=function(P){this._98I(),this._5o(P),new jt(this)};_s("TableView",e,{ms_ac:[Qm,dl,Rc,"sortMode",As,Lm,Lb,yq,qc,Fn,_n,"sortColumn",sj,bj,Pd,gq,nc,Fd,pi],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Kh,_editable:!0,_batchEditable:!1,_rowHeight:hi,_rowLineVisible:B.tableViewRowLineVisible,_rowLineColor:B.tableViewRowLineColor,_columnLineVisible:B.tableViewColumnLineVisible,_columnLineColor:B.tableViewColumnLineColor,_scrollBarColor:kk,_scrollBarSize:Qb,_autoHideScrollBar:Sr,_autoMakeVisible:cp,_selectBackground:B.tableViewSelectBackground,_labelColor:B.tableViewLabelColor,_labelSelectColor:B.tableViewLabelSelectColor,_labelFont:B.tableViewLabelFont,getCheckColumn:function(){var O=this;if(!O._31o){var z=O._31o=new bt;z.setEditable(!0),z.setWidth(40),z.getValue=O.getCheckColumValue,z.drawCell=O.drawCheckColumnCell}return O._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(h){var X=this,F=X._39o,M=X.getCheckColumn();h!==X.isCheckMode()&&(h?F.add(M,0):F.remove(M),X.fp(lp,!h,h))},getCheckColumValue:function(E,q,f){return f.isSelected(E)},drawCheckColumnCell:function(V,E,b,C,L,s,X,e,G){mh(V,G.getCheckIcon(E),L+X/2,s+e/2,E,G)}});var jt=function(K){Le(jt,this,[K])};ym(jt,gt,{_34o:function(J,q){var $=this.list,C=$._31o;if($.isCellEditable(q,C,J)){var R=$._3Q(C),D=$.lp(J).x;if(R&&D>=R.startX&&D<R.startX+C.getWidth())return $.checkData(q),void 0}$._37O(q,J),$.setFocusData(q)},_33o:function(R,o){this.list._37O(o,R),jt.superClass._33o.apply(this,arguments)}});var kt=$s.TreeTableView=function(a){var P=this,W=P._4o=new bt;P._35o(),P._98I(),P._5o(a),W.setDisplayName("Name"),W.setEditable(!0),W.setWidth(180),W.drawCell=lt,W.getValue=mt,P._39o.add(W),new nt(P)},lt=function(c,W,F,w,X,f,t,P,C){C.drawTree(c,W,F,X,f,t,P)},mt=function(n,l,H){return H.getLabel(n)};_s("TreeTableView",e,{ms_ac:[Qm,dl,Rc,"sortMode",As,Lm,Yh,lp,"rootData","rootVisible",sj,bj,"sortColumn",Vp,Nj,Pd,gq,nc,Fd,qc,Lb,yq,Fn,_n,pi,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Kh,_checkMode:V,_editable:!0,_batchEditable:!1,_indent:He,_rowHeight:hi,_rowLineVisible:B.treeTableViewRowLineVisible,_rowLineColor:B.treeTableViewRowLineColor,_columnLineVisible:B.treeTableViewColumnLineVisible,_columnLineColor:B.treeTableViewColumnLineColor,_expandIcon:B.treeTableViewExpandIcon,_collapseIcon:B.treeTableViewCollapseIcon,_scrollBarColor:kk,_scrollBarSize:Qb,_autoHideScrollBar:Sr,_autoMakeVisible:cp,_selectBackground:B.treeTableViewSelectBackground,_labelColor:B.treeTableViewLabelColor,_labelSelectColor:B.treeTableViewLabelSelectColor,_labelFont:B.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var nt=function(k){Le(nt,this,[k])};ym(nt,gt,{_34o:function(D,M){var j=this.list,F=j._4o,N=j._3Q(F),K=j.lp(D).x;if(N){var n=j._indent,o=N.startX+n*j.getLevel(M);if(Cc(j.getToggleIcon(M))&&K>=o&&o+n>=K)return j.toggle(M),void 0;if(j.isCellEditable(M,F)&&(o+=n,K>=o&&o+n>=K))return j.checkData(M),void 0}j._37O(M,D),j.setFocusData(M)},_33o:function(O,a){var T=this.list,S=T.lp(O).x;if(Cc(T.getToggleIcon(a))){var A=T._3Q(T._4o);if(A){var l=T._indent,u=A.startX+l*T.getLevel(a);if(S>=u&&u+l>=S)return T.toggle(a),void 0}}T._37O(a,O),nt.superClass._33o.apply(this,arguments)}});var ot=$s.TableHeader=function(X){var Q=this,r=Q._view=mk(1,Q),D=Q._39o=X.getColumnModel(),v=Q.iv;Q.tv=Q._tableView=X,Q._60I=new le,Q._canvas=ob(r),r.style.background=B.tableHeaderBackground||"",r.style.height=ld+Tn,D.mm(v,Q),D.md(v,Q),D.mh(v,Q),X.mp(function(i){Rs[i.property]&&Q.iv()},Q),new pt(Q),Q.iv()};_s("TableHeader",e,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Qm,Rc,Yh,"moveBackground","insertColor",Fn,_n,"resizable","movable"],_checkIcon:yf,_movable:!0,_resizable:!0,_labelColor:B.tableHeaderLabelColor,_labelFont:B.tableHeaderLabelFont,_columnLineColor:B.tableHeaderColumnLineColor,_columnLineVisible:B.tableHeaderColumnLineVisible,_sortDescIcon:B.tableHeaderSortDescIcon,_sortAscIcon:B.tableHeaderSortAscIcon,_moveBackground:B.tableHeaderMoveBackground,_insertColor:B.tableHeaderInsertColor,_indent:He,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(Q){return Q.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(x){return x.getColor()||this._labelColor},getLabelAlign:function(S){return S._align},onPropertyChanged:function(){this.iv()},_5Q:function(w){this._61I=w,this.iv()},getLogicalPoint:function(q){return Kf(q,this._canvas,this.tv.tx())},validateImpl:function(){var Z=this,Y=Z._canvas,E=Z.getWidth(),H=Z.getHeight(),q=Z.tv,S=Z._60I,e=Z._61I,i=-q.tx(),s=0;(E!==Y.clientWidth||H!==Y.clientHeight)&&Yl(Y,E,H),S.clear(),Z._39o._roots.each(function(o){if(o.isVisible()){var G=s+o.getWidth();i+E>=s&&G>=i&&S.add({column:o,startX:s}),s=G}});var y=ye(Y);if(Dd(y,-i,0,1),y.beginPath(),y.rect(i,0,E,H),y.clip(),y.clearRect(i,0,E,H),S.each(function(D){var O=D.column,i=D.startX,E=O.getWidth();E>0&&(y.save(),y.beginPath(),y.rect(i,0,E,H),y.clip(),e&&e.column===O||Z.drawColumn(y,O,i,0,E,H),Z._columnLineVisible&&Wq(y,i+E-1,0,1,H,Z._columnLineColor),y.restore())}),e){var g=e.column,s=e.startX,v=e.position,k=g.getWidth();y.save(),y.beginPath(),y.rect(s,0,k,H),y.clip(),y.fillStyle=Z._moveBackground,y.fill(),Z.drawColumn(y,g,s,0,k,H),y.restore(),ao(y,Z._insertColor,v,0,H)}y.restore()},_6Q:function(x){var v=this.tv;return v._31o===x&&v.sm().getSelectionMode()===cm},drawColumn:function(U,s,Z,d,r,Q){var K=this,H=K.tv,g=Cc(s.getIcon()),S=K.getLabelAlign(s);if(K._6Q(s)){var t=Cc(K._checkIcon);mh(U,t,Z+r/2,d+Q/2,s,K)}else{var k=K.getLabel(s),n=K.getLabelFont(s),y=K.getLabelColor(s),G=ts(n,k).width,X=g?K._indent:0;S===ar?(g&&kr(U,g,re,Z,d,X,Q),ws(U,k,n,y,Z+X,d,r,Q,ar)):S===ci?(g&&kr(U,g,re,Z+r-G-X,d,X,Q),ws(U,k,n,y,Z,d,r,Q,ci)):(g&&kr(U,g,re,Z+(r-G-X)/2,d,X,Q),ws(U,k,n,y,Z+(r-G+X)/2,d,0,Q,ar))}if(s.isSortable()&&H.getSortColumn()===s&&(g=Cc(s.getSortOrder()===nk?K._sortAscIcon:K._sortDescIcon))){var C=Fe(g,s)/2+2;mh(U,g,S===ci?Z+C:Z+r-C,d+Q/2,s,H)}}});var pt=function(C){var U=this;U.th=C,U.tv=C._tableView,U.addListeners()};ym(pt,e,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(I){this.getView().style.cursor=I},handle_mousemove:function(b){if(!mr){var z=this;delete z._29o,z.setCursor(Or);for(var k=z.th,t=k._60I,y=k.lp(b).x,x=t.size()-1;x>=0;x--){var i=t.get(x),a=i.column,I=i.startX+a.getWidth();if(k.isResizable()&&r(I-y)<=(gp?10:3))return z._29o=i,z.setCursor(Hr),void 0;y>i.startX&&I>y&&(z._29o=i),(a.isClickable()||a.isSortable()||k.isMovable()||z.tv.getCheckColumn&&a===z.tv.getCheckColumn())&&y>i.startX&&I>y&&z.setCursor(Ig)}}},handle_mousedown:function(Y){this.handle_touchstart(Y)},handle_touchstart:function(I){var J=this;qk(I),J.tv.endEditing(),J.handle_mousemove(I),J._29o&&(J.x=kd(I).x,J.lx=J.th.lp(I).x,J.w=J._29o.column.getWidth(),Lj(J,I))},handleWindowMouseMove:function(K){this.handleWindowTouchMove(K)},handleWindowTouchMove:function(t){var w=this,e=w.th,z=w.getView().style.cursor,j=w._29o,P=kd(t).x-w.x;if(w.resizing||w.moving||(z===Hr?w.resizing=1:e.isMovable()&&z===Ig&&r(P)>2&&(w.moving=1)),w.resizing)j.column.setWidth(w.w+P);else if(w.moving){var s=w.lx+P;e._60I.each(function(O){var u=O.startX,N=u+O.column.getWidth();if(s>=u&&N>=s){var J={column:j.column,startX:j.startX+P,front:N-s>s-u,insertColumn:O.column};J.position=J.front?u:N,e._5Q(J)}})}},_16Q:function(x,F){var S=this,n=S.tv,z=S.th,d=z._checkIcon;if(z._6Q(x)){var t=Cc(d),A=S.lx,c=x.getWidth(),i=Fe(t,x);if(A>=F+c/2-i&&F+c/2+i>=A){z.setCheckIcon(d===cf?yf:cf);var r=n.sm(),C=n._rows;return d===cf?r.rs(C):r.ss(C),n.onCheckColumnClicked(x),!0}}return!1},handleWindowMouseUp:function(s){this.handleWindowTouchEnd(s)},handleWindowTouchEnd:function(b){var w=this,F=w.tv,i=w.th,m=w._29o;if(w.moving){var Y=i._61I;
if(Y&&Y.insertColumn!==Y.column){var M=Y.column,c=F.getColumnModel()._roots,C=c.remove(M),D=c.indexOf(Y.insertColumn);D>=0&&(Y.front||D++,D<=c.size()&&(c.add(M,D),F.getColumnModel()._38I(M,C,D)))}i._5Q(V),delete w.moving}else if(!w.resizing&&m){M=m.column;var E=i.lp(b).x,T=m.startX,y=!0;if(i.onColumnClicked){var n=i.onColumnClicked(M,b,T);n===!1&&(y=!1)}if(y&&E>=T&&E<=T+M.getWidth()&&!w._16Q(M,T)){if(M.isSortable()){var k=F.getSortMode(),Q=M.getSortOrder();k===Kh?F.getSortColumn()===M?(Q===ke&&F.setSortColumn(V),M.setSortOrder(Q===nk?ke:nk)):F.setSortColumn(M):"bistate"===k&&(F.getSortColumn()===M?M.setSortOrder(Q===nk?ke:nk):F.setSortColumn(M))}F.onColumnClicked(M,b,T)}}w._29o=w.resizing=w.x=w.lx=w.w=V}}),$s.TablePane=function(z){this.init(new it(z))},_s("TablePane",e,{ms_v:1,_44o:1}),$s.TreeTablePane=function(M){this.init(new kt(M))},_s("TreeTablePane",e,{ms_v:1,_44o:1}),$s.Toolbar=function(H){var f=this,$=f._view=mk(1,f),k=$.style;k.background=B.toolbarBackground||"",k.height=sl+Tn,f._canvas=ob($),f._30o=new le,f._90I=new le,f.setItems(H||[]),$.handleGroupSelectedChanged=function(z){if(z.isSelected()){var C=z.getGroupId();null!=C&&f._items.forEach(function(I){var D=I.element;D&&D!==z&&D.setSelected&&D.getGroupId&&D.getGroupId()===C&&D.setSelected(!1)})}},new qt(f)},_s("Toolbar",e,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[ys,Qm,Rc,dl,pi,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:B.toolbarLabelColor,_labelSelectColor:B.toolbarLabelSelectColor,_labelFont:B.toolbarLabelFont,_selectBackground:B.toolbarSelectBackground,_itemGap:B.toolbarItemGap,_separatorColor:B.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(z){var P=this.getItemInfoAt(z);return P?P.item.toolTip:V},getLabelColor:function(g){return g&&g.selected&&g.type!==cf&&g.type!==Yp?this._labelSelectColor:this._labelColor},onPropertyChanged:function(R){this.iv(),R.property===ys&&this._items.forEach(function(M){ii(M)})},redraw:function(){this.iv()},addItem:function(G,R){var h=this._items;R==V?h.push(G):h.splice(R,0,G),this.fp(ys,V,h)},removeItem:function(v){if(v)for(var M=this._items,p=0;p<M.length;p++)v===M[p]&&(M.splice(p,1),this.fp(ys,V,M))},removeItemById:function(Y){if(Y!=V)for(var p=this._items,d=0;d<p.length;d++)if(Y===p[d].id){var U=p.splice(d,1)[0];return this.fp(ys,V,p),U}},getItemById:function(G){if(G!=V)for(var l=this._items,O=0;O<l.length;O++){var I=l[O];if(G===I.id)return I}},setItemVisible:function(Y,y){var s=this.getItemById(Y);s&&(s.visible=y)},getItemInfos:function(){return this._30o},getItemInfoAt:function(s){var d=this,z=0,Y=d._30o,c=d.lp(s),x=c.x,U=c.y;if(U>=0&&U<=d.getHeight())for(;z<Y.size();z++){var P=Y.get(z);if(P.startX<=x&&x<=P.endX)return P}return V},drawItem:function(V,p,X,E,l){if(p.visible===!1)return 0;if(mj(p.visible)&&!p.visible())return 0;var i=this,r=p.disabled;r&&(V.globalAlpha=_m);var h=i.drawItemImpl(V,p,X,E,l),P=i._itemGap;return r&&(V.globalAlpha=1),this._currentItem!==p||"separator"===p||p.separator===!0||p.unfocusable||hk(V,i._separatorColor,X-P/2,0,h+P,E),h},drawItemImpl:function(O,S,B,o,Y){var Z=this,n=Z._view,c=Z._itemGap,t=o/2,m=S.type,X=S.element,y=S.label;Zq(X)&&(y=X,X=V);var Q,N=Z.getLabelFont(S),r=Z.getLabelColor(S),i=S.selected,l=Cc(S.icon),G=Fe(l,S),P=0,A=G+(y?ts(N,y).width:0);if("separator"===S||S.separator===!0)return ao(O,Z._separatorColor,B,o/4,t),1;if(X){l&&mh(O,l,B+G/2,t,S,Z),ws(O,y,N,r,B+G,0,0,o);var R=Wn(X);Y||Z._90I.add(R),R.parentNode!==n&&os(n,R),X.iv&&X.iv(),X.validate&&X.validate();var $=R.getBoundingClientRect(),U=$.width,g=R.style;return Of(R),g.left=Z.tx()+B+A+Tn,g.top=(o-$.height)/2+Tn,A+U}return m===Yp?Q=Cc(i?tl:Jh):m===cf&&(Q=Cc(i?cf:yf)),Q?(P=Fe(Q,S),mh(O,Q,B+P/2,t,S,Z),B+=P,A+=P):i&&Wq(O,B-c/2,0,A+c,o,Z.getSelectBackground(S)),l&&mh(O,l,B+G/2,t,S,Z),ws(O,y,N,r,B+G,0,0,o),A},validateImpl:function(){var V=this,K=V._canvas,u=V.getWidth(),E=V.getHeight(),w=V._30o,S=V._items;Yl(K,u,E);var p=ye(K),O=V._itemGap,R=O/2;Dd(p,V.tx(),0,1),p.clearRect(0,0,u,E);var Q=V._90I;V._90I=new le,w.clear(),S.forEach(function(S){var Y=V.drawItem(p,S,R,E);w.add({item:S,startX:R,endX:R+Y,width:Y}),Y&&(R+=Y+O)}),Q.each(function(Q){V._90I.contains(Q)||zg(Q)});var v=V._64I;V._64I=g(0,R),p.restore(),V._stickToRight?(V._65O=0,p=ye(K),R=u-V._64I+O,Dd(p,0,0,1),p.clearRect(0,0,u,E),w.clear(),S.forEach(function(J){var S=V.drawItem(p,J,R,E,!0);w.add({item:J,startX:R,endX:R+S,width:S}),S&&(R+=S+O)}),p.restore()):V.tx(V.tx()),v!==V._64I&&V.onSumWidthChanged(v,V._64I)},onSumWidthChanged:function(){},handleClick:function(A,S){var Y=this,K=A.type,z=A.action,s=A.groupId,I=A.selected;A.disabled||(s!=V?I||(A.selected=!0,this._items.forEach(function(E){E.groupId===s&&A!==E&&(E.selected=!1)}),z&&A.action(A,Y,S)):K===cf||"toggle"===K?(A.selected=!I,z&&A.action(A,Y,S)):z&&A.action(A,Y,S)),ur(),Y.iv()}});var qt=function(h){this.tb=h,this.addListeners()};ym(qt,e,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(I){this.handleScroll(I,10*(I.wheelDelta/40))},handle_DOMMouseScroll:function(D){this.handleScroll(D,10*-D.detail)},handleScroll:function(Q,U){qk(Q);var l=this.tb;l.isScrollable()&&!l._stickToRight&&(l.tx(l.tx()+U),Qj())},handle_mousemove:function(C){var L=this;mr||L.setItem(C)},handle_mouseout:function(c){var _=this;c.target===_.getView()?_.tb.setCurrentItem(V):_.handle_mousemove(c)},handle_mousedown:function(Y){this.handle_mousemove(Y),this.handle_touchstart(Y)},handle_touchstart:function(d){var C=this,v=C.tb,X=d.target;gl(d)&&(X===C.getView()||X===v._canvas)&&(qk(d),v.setFocus(d)&&(this.setItem(d,!0),(v.isScrollable()||C.info&&!C.info.item.disabled)&&(C.x=kd(d).x,C.tx=v.tx(),Lj(C,d))))},handleWindowMouseMove:function(g){this.handleWindowTouchMove(g)},handleWindowTouchMove:function(C){var l=this,p=l.tb;if(!p._stickToRight){var F=kd(C).x-l.x;!l._25o&&r(F)>2&&p.isScrollable()&&(l._25o=1),l._25o&&p.tx(l.tx+F)}},handleWindowMouseUp:function(e){this.handleWindowTouchEnd(e)},handleWindowTouchEnd:function(r){var f=this,F=f.tb,l=f.info,z=f.tb.getItemInfoAt(r);if(!f._25o&&l){var Y=l.item;z&&z.item===Y&&F.handleClick(Y,r)}f._25o=f.x=f.tx=V,f.setItem()},setItem:function(o,A){var Z=this,n=Z.tb,z=Z.info=o?n.getItemInfoAt(o):V,N=z?z.item:V;n.setCurrentItem(N),A&&N&&mj(N.onDown)&&N.onDown(o)}}),$s.BorderPane=function(){this._view=mk(1,this),this.iv()},_s("BorderPane",e,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(q,h){this._12o("leftView",q),h!=V&&this.setLeftWidth(h)},getRightView:function(){return this._rightView},setRightView:function(M,H){this._12o("rightView",M),H!=V&&this.setRightWidth(H)},getTopView:function(){return this._topView},setTopView:function(E,$){this._12o("topView",E),$!=V&&this.setTopHeight($)},getBottomView:function(){return this._bottomView},setBottomView:function(J,Z){this._12o("bottomView",J),Z!=V&&this.setBottomHeight(Z)},getCenterView:function(){return this._centerView},setCenterView:function($){this._12o("centerView",$)},_12o:function(s,a){var R=this,j="_"+s,g=R._view,v=R[j];v!==a&&(v&&(v.getView?zg(v.getView()):zg(v)),R[j]=a,a&&(a.getView?os(g,a.getView(),1):os(g,a,1)),R.fp(s,v,a))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var u=this,U=u._topView,T=u._bottomView,k=u._leftView,E=u._rightView,o=u._centerView,P=u.getWidth(),z=u.getHeight(),r=0,B=0,X=P,t=z,w=0,O=0,i=0,I=0;U&&(w=u._topHeight==V?Wo(U):u._topHeight,B=w),T&&(O=u._bottomHeight==V?Wo(T):u._bottomHeight,t=z-O),k&&(i=u._leftWidth==V?Rr(k):u._leftWidth,r=i),E&&(I=u._rightWidth==V?Rr(E):u._rightWidth,X=P-I);var K=g(0,X-r),J=g(0,t-B);U&&$m(U,0,0,P,w),T&&$m(T,0,t,P,O),k&&$m(k,0,B,i,J),E&&$m(E,X,B,I,J),o&&$m(o,r,B,K,J)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);