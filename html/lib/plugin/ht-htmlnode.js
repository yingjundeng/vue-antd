!function(i){"use strict";var R="ht",q=i[R],H=function(){return document},D=function(){return H().body},F=function(v,f,l){v.style.setProperty(f,l,null)},X=function(k){return H().createElement(k)},c=function(){return X("div")},z=function(){var l=X("canvas");return l},Z=function($,T){F($,"-webkit-transform",T),F($,"-ms-transform",T),F($,"transform",T)},E=function(d,s){F(d,"-webkit-transform-origin",s),F(d,"-ms-transform-origin",s),F(d,"transform-origin",s)},Q=function(N,T){N.appendChild(T)},G=function(O,l){O.removeChild(l)},w=i.parseInt,e=q.Default,s=e.getInternal(),T=s.addEventListener,j=(s.removeEventListener,Math.PI),A="white-space",h="visibility",g="left",$="top",u="width",x="height",O="position",S="display",k="z-index",t="px",l="0 0",J="absolute",L="visible",C="hidden",I="none",o="block",U="nowrap",n="rgba(0, 0, 0, 0.005)";e.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var f=q.graph.GraphView.prototype,m=f._42;f.adjustHtmlNodeIndex=!0,f._42=function(p,Y){if(m.call(this,p,Y),this.adjustHtmlNodeIndex)for(var E=this.getDataModel()._datas._as,I=E.length,C=1,M=0;I>M;M++){var Z=E[M];if(Z instanceof d){var $=this.getDataUI(Z);F($.$2f,k,C+""),F($.$3f,k,C+1+""),C+=2}}};var W=q.HtmlNodeUI=function(f,v){var $=this;W.superClass.constructor.call($,f,v);var u=$.$2f=c(),j=$.$3f=z();F(u,O,J),F(u,h,C),F(u,A,U),j.draggable=!1,F(j,O,J),F(j,S,I),E(j,l),T(u,"change",function(D){var I=D.target,C=I.bind||I.getAttribute("bind"),p=I.type&&"checkbox"===I.type?I.checked:I.value,P=v.getContext();C&&P&&(P[C]=p,$.$4f=JSON.stringify(P))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(U){T(u,U,this.$9f.bind(this))},$)};e.def(W,s.ui().NodeUI,{_visible:!0,$11f:function(){var K=this,B=K.$3f,d=K._data,h=d.getDraggerImageWidth(),T=d.getDraggerImageHeight(),L=d.getDraggerImage(),r=s.initContext(B);r.beginPath(),s.setCanvas(B,h,T),s.translateAndScale(r,0,0,1),r.clearRect(0,0,h,T),e.drawImage(r,e.getImage(L),0,0,h,T),r.restore()},_80o:function(y){W.superClass._80o.call(this,y);var U=this,H=U._data,M=H._padding,b=2*M,E=U.$2f,A=U.$3f,B=U.gv,p=B.getZoom(),q=B.getTranslateX(),r=B.getTranslateY(),f=B.getView(),G=U._83o,T=H._width,v=H._height,_=G.position,m=G.rotation,X=(T-b)/H.$5f*p,s=(v-b)/H.$6f*p,P=U._html,d=H._html,V=H.getHtmlType();if("html"===V){var i=H.getContext()||{},Y=U.$4f,z=H.$10f,e=JSON.stringify(i);P&&Y&&P===d&&Y===e||(U.$4f=e,U._html=d,E.innerHTML=z?z(i):d)}else if(null!=V){var a=H.getHtml();"ht"===V&&(a=a.getView()),P&&P===a&&E.contains(P)||(U._html=a,E.innerHTML="",Q(E,a))}if(!E.parentNode){var R=B.$1f;if(!R){var K=c();F(K,O,J),F(K,k,"0"),R=B.$1f=K;var D=B._canvas.nextSibling;D?f.insertBefore(K,D):Q(f,K)}Q(R,E),Q(R,A),H.onContentInitialized&&H.onContentInitialized(E)}if(H._scalable){var N=H.$5f,l=H.$6f;Z(E,"rotate("+180*(m/j)+"deg) scale("+X+","+s+")"),F(E,u,""),F(E,x,""),F(E,g,(_.x-N/p/2)*p+q+t),F(E,$,(_.y-l/p/2)*p+r+t)}else{var rn=w(E.style.width),Ac=w(E.style.height),Fc=w((T-b)*p),Vm=w((v-b)*p),bq="100%",Qe=E.children[0];F(Qe,u,bq),F(Qe,x,bq),(rn!==Fc||Ac!==Vm)&&(F(E,u,Fc+t),F(E,x,Vm+t),"ht"===V&&d.invalidate()),Z(E,"rotate("+180*(m/j)+"deg)"),F(E,g,(_.x-Fc/p/2)*p+q+t),F(E,$,(_.y-Vm/p/2)*p+r+t)}var Pn=U.dragRect;B.isMovable(H)&&B.isSelected(H)&&Pn?(y.save(),y.fillStyle=n,y.fillRect(Pn.x,Pn.y,Pn.width,Pn.height),y.restore(),F(A,g,Pn.x*p+q+t),F(A,$,Pn.y*p+r+t),Z(A,"scale("+p+","+p+")"),F(A,S,o),U.$11f()):F(A,S,I),F(E,h,this._visible?L:C)},dispose:function(){var H=this.gv.$1f;this.$2f.parentNode===H&&H.removeChild(this.$2f),this.$3f.parentNode===H&&H.removeChild(this.$3f)},_84o:function(X){this._visible=X,F(this.$2f,h,X?L:C),F(this.$3f,S,X?o:I)},_3O:function(){var U=this,N=U.gv,g=U._data;W.superClass._3O.call(U);var H=g.getRect();N.isEditable(g)&&(U.dragRect={x:H.x+H.width+g._padding,y:H.y+10,width:g.getDraggerImageWidth(),height:g.getDraggerImageHeight()},U._68o(U.dragRect))},rectIntersects:function(W){var w=this._79o();return q.Default.intersection(w,W)?!0:void 0},$9f:function(w){var U=this.gv,j=this._data;U.sm().contains(j)&&w.stopPropagation()}});var d=q.HtmlNode=function(){d.superClass.constructor.call(this)};q.Default.def(d,q.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:q.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(O){var m=this,j=m._html;m._html=O,"html"===m.getHtmlType()&&"Handlebars"in i&&(m.$10f=Handlebars.compile(O)),m.$13f(),m.fp("html",j,O)},setContext:function(R){var d=this,b=d._context;d._context=R,d.fp("context",b,R),d.$13f()},setScalable:function(R){var c=this,r=c._scalable;c._scalable=R,c.fp("scalable",r,R),c.$13f()},getHtmlType:function(){var r=this._html;return r?"string"==typeof r?"html":r.getView?"ht":"dom":null},$13f:function(){var R=this,L=R._html,u=R.$10f;if(L){var K=c(),E=!1,m=R.getHtmlType();if(F(K,O,J),F(K,A,U),F(K,h,C),"html"===m?(K.innerHTML=u?u(R.getContext()||{}):L,E=!0):"ht"===m?(Q(K,L.getView()),E=!0):"dom"===m&&(Q(K,L),E=!0),E){var r=2*R._padding;Q(D(),K),R.$5f=K.scrollWidth,R.$6f=K.scrollHeight,R._width=R.$5f+r,R._height=R.$6f+r,R._originWidth=R._width,R._originHeight=R._height,G(D(),K)}}},getUIClass:function(){return q.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);