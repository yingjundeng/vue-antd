!function(p,I){"use strict";var U="position",V="absolute",l="relative",m="px",g="left",q="right",Z="top",y="bottom",j="display",D="none",K="block",i=ht.Default,u=i.getInternal(),N=Math.floor,a=Math.ceil,$=Math.PI,f=null,v=p.parseInt,b=function(P){return P.getContext("2d")},x=function(){return document},B=function(h){return x().createElement(h)},R=function(){return B("canvas")},J=function(z,x,S){z.style.setProperty(x,S,f)},c=function(W,y,v){i.def(ht.widget[W],y,v)},Q=function($,k){$.appendChild(k)},e=function(N,k){N.removeChild(k)},u=i.getInternal(),A=u.addEventListener,H=u.removeEventListener;ht.widget.RulerFrame=function(x){var B=this,D=B._view=u.createView(null,B),F=B.$1k=R(),Z=B.$2k=R(),q=B.$3k=R(),K=B.$4k=R();B._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},B._topRulerConfig={visible:!0},B._rightRulerConfig={visible:!1},B._bottomRulerConfig={visible:!1},B._leftRulerConfig={visible:!0},Q(D,F),Q(D,q),Q(D,Z),Q(D,K),J(D,U,l),J(D,"box-sizing","border-box"),J(D,"-moz-box-sizing","border-box"),J(F,U,V),J(Z,U,V),J(q,U,V),J(K,U,V),B.$14k=function(){B.$13k=1,B.iv()},B.$15k=function(n){if(B._topRulerConfig.guideVisible||B._rightRulerConfig.guideVisible||B._bottomRulerConfig.guideVisible||B._leftRulerConfig.guideVisible||B._defaultRulerConfig.guideVisible||(B._topRulerConfig.guideTipVisible||B._rightRulerConfig.guideTipVisible||B._bottomRulerConfig.guideTipVisible||B._leftRulerConfig.guideTipVisible||B._defaultRulerConfig.guideTipVisible)&&B._component){var m=D.getBoundingClientRect();B.$16k={x:n.clientX-m.left,y:n.clientY-m.top},B.$5k()}},B.setComponent(x)},c("RulerFrame",I,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(f){var L=this,o=L._component,I=L.getView();if(I){if(L._component=f,L.fp("component",o,f),o){var F=L.getComponentView(o);e(I,F),H(I,"mousemove",L.$15k),L.removeComponentPropertyChangeListener(o,L.$14k)}if(f){var c=L.getComponentView(f);Q(I,c),J(c,U,V),A(I,"mousemove",L.$15k),L.addComponentPropertyChangeListener(f,L.$14k)}}},addComponentPropertyChangeListener:function(u,T){u&&u.mp&&u.mp(T)},removeComponentPropertyChangeListener:function(o,W){o&&o.ump&&o.ump(W)},getComponentHZoom:function(K){return K&&K.getZoom?K.getZoom():1},getComponentVZoom:function(g){return g&&g.getZoom?g.getZoom():1},getComponentViewRect:function(D){return D&&D.getViewRect?D.getViewRect():void 0},getComponentView:function(v){return v&&v.getView?v.getView():v},invalidateComponent:function(G){G&&G.iv&&G.iv()},validateComponent:function(Q){Q&&Q.validate&&Q.validate()},$7k:function(V,B,i,n,c,_,r,P,E,g,w,h){if(B.visible){var l=this._defaultRulerConfig,X="borderStyle",W="borderColor",L="borderWidth",G="background",p=B[X]||l[X],y=B[W]||l[W],$=B[L]||l[L],I=B.size!=f?B.size:l.size,Y=B[G]||l[G],k=I+$,x=this.$6k($,p,y,V,i,c,k,r,P,E,g,w,h);J(V,c,"0px"),_?u.setCanvas(V,n-x,I):u.setCanvas(V,I,n-x),J(V,"background",Y),J(V,j,K)}else J(V,j,D),J(this.getComponentView(this._component),c,"0px")},$6k:function(E,v,t,r,C,j,k,G,M,w,Z,$,S){var A=0;return J(r,C,E+"px "+v+" "+t),J(this.getComponentView(this._component),j,k+m),G?(J(r,M,w+m),A+=w):J(r,M,"0px"),Z?(J(r,$,S+m),A+=S):J(r,$,"0px"),A},validateImpl:function(){var x=this,m=x._component,b=x.$1k,C=x.$2k,n=x.$3k,p=x.$4k,U=x._view,c=x._defaultRulerConfig,a=x._topRulerConfig,H=x._rightRulerConfig,r=x._bottomRulerConfig,$=x._leftRulerConfig,e=c.size;if(U&&m){var B=a.size!=f?a.size:e,N=H.size!=f?H.size:e,j=r.size!=f?r.size:e,u=$.size!=f?$.size:e;x.$7k(b,a,"border-bottom",U.offsetWidth,Z,!0,$.visible,g,u,H.visible,q,N),x.$7k(C,H,"border-left",U.offsetHeight,q,!1,a.visible,Z,B,r.visible,y,j),x.$7k(n,r,"border-top",U.offsetWidth,y,!0,$.visible,g,u,H.visible,q,N),x.$7k(p,$,"border-right",U.offsetHeight,g,!1,a.visible,Z,B,r.visible,y,j),x.$13k?delete x.$13k:x.invalidateComponent(m),x.validateComponent(m),x.$5k()}},$5k:function(){function m(E,T,u,H,s,I){if(T.visible){var G=b(E),r=T[Z]||D,d=T[S]!=f?T[S]:z,x=T[h]||v,V=T[P]||J,m=T.size!=f?T.size:X,sr=T[i]||a,yi=T[A]||t,bs=T[N]||M,Gg=T[g]!=f?T[g]:O,Ck=T[C]!=f?T[C]:B,Wl=T[F]!=f?T[F]:U,Uk=T[j]!=f?T[j]:$,ze=T[R]!=f?T[R]:_,So=T[n]!=f?T[n]:q,oi=T[K]||Vl,_d=T[p]||_k;d&&(r=e[I]=e.$8k(e[I]||r,T[Q]||c,T[l]||k,H?W:o,yi)),u.call(e,G,Y,y,w,L,m,H?W:o,r,x,V,s,sr,bs);var sg=e.$16k;(Gg||Ck)&&sg&&(H?e.$9k(G,sg.x,m,oi,_d,Gg,Ck,Wl,Uk,ze,So):e.$10k(G,sg.y,m,oi,_d,Gg,Ck,Wl,Uk,ze,So,s))}}var e=this,x=e.$1k,E=e.$2k,G=e.$3k,I=e.$4k,H=e._topRulerConfig,d=e._rightRulerConfig,V=e._bottomRulerConfig,s=e._leftRulerConfig,u=e._defaultRulerConfig,r=e._component,T=e.getComponentViewRect(r),W=e.getComponentHZoom(r),o=e.getComponentVZoom(r),Y=T.x*W,w=Y+T.width*W,y=T.y*o,L=y+T.height*o,X=e._defaultRulerConfig.size,Z="defaultMajorTickSpacing",Q="maxPhysicalMajorTickSpacing",l="minPhysicalMajorTickSpacing",S="tickSpacingAdaptable",h="majorTickTextFont",P="majorTickTextColor",i="majorTickColor",N="minorTickColor",g="guideVisible",C="guideTipVisible",F="guideTipBorderColor",j="guideTipTextColor",R="guideTipTextFont",n="guideTipBackground",K="guideColor",p="guideWidth",A="minMajorTickSpacing",D=u[Z],c=u[Q],k=u[l],z=u[S],v=u[h],J=u[P],a=u[i],t=u[A],M=u[N],O=u[g],B=u[C],U=u[F],$=u[j],_=u[R],q=u[n],Vl=u[K],_k=u[p];e._view&&r&&(m(x,H,e.$11k,!0,!1,"_currentTopMajorTickSpacing"),m(E,d,e.$12k,!1,!0,"_currentRightMajorTickSpacing"),m(G,V,e.$11k,!0,!0,"_currentBottomMajorTickSpacing"),m(I,s,e.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(C,E,$,V,B){return $>C*V?C=N(E/V/B)*B:C*V>E&&(C=a($/V/B)*B),C},getHTipText:function(F){var h=this,d=h._component,g=0,w=h._view.getBoundingClientRect();return d.lp?g=v(d.lp({x:F.x+w.left,y:F.y}).x):g-=v(this.getComponentView(d).style.left)||0,g},$9k:function(L,D,O,s,X,G,P,k,F,Y,t){var B=this,p=B._component;L.save(),u.translateAndScale(L,0,0,1);var r=D-(v(this.getComponentView(p).style.left)||0),d=0;if(D=B.getHTipText(B.$16k),G&&(L.beginPath(),L.fillStyle=s,L.rect(r,d,X,O),L.fill()),P){L.beginPath(),L.textAlign="center",L.textBaseline="middle",L.font=Y;var w=L.measureText(D).width+6;L.fillStyle=t,L.rect(r-w/2,d,w,O),L.fill(),L.strokeStyle=k,L.stroke(),L.beginPath(),L.fillStyle=F,L.fillText(D,r,d+O/2)}L.restore()},getVTipText:function(I){var G=this,e=G._component,k=0,R=G._view.getBoundingClientRect();return e.lp?k=v(e.lp({x:I.x,y:I.y+R.top}).y):k-=v(this.getComponentView(e).style.top)||0,k},formatScaleText:function(G){return Math.round(G)},$10k:function(S,z,G,g,C,O,U,R,T,e,i,H){var B=this,q=B._component;S.save(),u.translateAndScale(S,0,0,1);var _=G/2,Z=z-(v(this.getComponentView(q).style.top)||0);if(z=B.getVTipText(B.$16k),O&&(S.beginPath(),S.fillStyle=g,S.rect(_-G/2,Z,G,C),S.fill()),U){S.translate(_,Z),S.rotate((H?90:-90)*$/180),S.translate(-_,-Z),S.beginPath(),S.textAlign="center",S.textBaseline="middle",S.font=e;var V=S.measureText(z).width+6;S.fillStyle=i,S.rect(_-V/2,Z-G/2,V,G),S.fill(),S.strokeStyle=R,S.stroke(),S.fillStyle=T,S.fillText(z,_,Z)}S.restore()},$11k:function(Z,M,D,K,C,d,b,T,J,g,F,k,B){Z.save(),D=0;var W=M,r=K,j=(W+r)/2;M=0,K=r-W,u.translateAndScale(Z,0,0,1);var w=0,i=0,h=v(d/2),E=d-h,U=F?0:h,f=T*b,p=f/10;M-=f,K+=f,Z.clearRect(M,0,K-M,d),Z.beginPath(),Z.fillStyle=B;var L=N(j/p)*p-W;for(w=L;K>w;w+=p)Z.rect(w,D+U,1,E);for(w=L;w>M;w-=p)Z.rect(w,D+U,1,E);for(Z.fill(),U=F?0:1,Z.beginPath(),Z.fillStyle=k,L=N(j/f)*f-W,w=L;K>w;w+=f)Z.rect(w,D+U,1,d-1);for(w=L;w>M;w-=f)Z.rect(w,D+U,1,d-1);Z.fill();var s=v(/\d+px/.exec(J)[0]),$=(s||10)/2;Z.textBaseline="middle",U=F?d-$-2:$+2,Z.beginPath(),Z.fillStyle=g,Z.font=J;var H=N(j/f)*f/b;for(w=L,i=H;K>w;w+=f,i+=T){var o=this.getHScaleText?this.getHScaleText(w):i;Z.fillText(this.formatScaleText(o),w+2,D+U)}for(w=L,i=H;w>M;w-=f,i-=T){var o=this.getHScaleText?this.getHScaleText(w):i;Z.fillText(this.formatScaleText(o),w+2,D+U)}Z.restore()},$12k:function(Q,Z,k,c,f,V,i,W,O,w,Y,g,D){function S(F,I,v,q,M,P){M=B.getVScaleText?B.getVScaleText(v):M,M=B.formatScaleText(M),Q.translate(F+I,v),Q.rotate(-q),Q.translate(-F-I,-v),Q.fillText(M,F+I+(P?2:1),v),Q.translate(F+I,v),Q.rotate(q),Q.translate(-F-I,-v)}Q.save(),Z=0;var z=k,X=f,K=(z+X)/2;k=0,f=X-z,u.translateAndScale(Q,0,0,1);var h=0,B=this,R=0,d=v(V/2),C=V-d,I=Y?0:d,J=W*i,y=J/10;k-=J,f+=J,Q.clearRect(Z,0,V,f-k),Q.beginPath(),Q.fillStyle=D;var F=N(K/y)*y-z;for(h=F;f>h;h+=y)Q.rect(Z+I,h,C,1);for(h=F;h>k;h-=y)Q.rect(Z+I,h,C,1);for(Q.fill(),I=Y?0:1,Q.beginPath(),Q.fillStyle=g,F=N(K/J)*J-z,h=F;f>h;h+=J)Q.rect(Z+I,h,V-1,1);for(h=F;h>k;h-=J)Q.rect(Z+I,h,V-1,1);Q.fill();var M=v(/\d+px/.exec(O)[0]),l=(M||10)/2,x=90*$/180;Q.textBaseline="middle",I=Y?V-l:l+2,x=Y?-x:x,Q.beginPath(),Q.fillStyle=w,Q.font=O;var r=N(K/J)*J/i;for(h=F,R=r;f>h;h+=J,R+=W)S(Z,I,h,x,R,Y);for(h=F,R=r;h>k;h-=J,R-=W)S(Z,I,h,x,R,Y);Q.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var $=this,R=$._component,O=$._view;R&&$.removeComponentPropertyChangeListener(R,$.$14k),O&&(H(O,"mousemove",$.$15k),e(O.parentNode,O),$._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);